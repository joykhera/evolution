{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4355280987070824, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 3.6534985065460206, "policy_loss": -0.0015839509794084484, "vf_loss": 3.652727033978417, "vf_explained_var": 0.005172347202502862, "kl": 0.011777125570875523, "entropy": 1.5977408717549035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.84597256656677, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 6.777612250191825, "policy_loss": -0.0009228494249915004, "vf_loss": 6.77595000065193, "vf_explained_var": 0.020115045674894222, "kl": 0.012925506023646668, "entropy": 1.5967647719004798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 182.0, "episode_reward_min": -247.0, "episode_reward_mean": 6.666666666666667, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -341.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -33.27777777777778, "predator_policy": 36.611111111111114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 35.0, 149.0, 65.0, 3.0, 52.0, 0.0, 67.0, 22.0, -25.0, -52.0, -112.0, 21.0, 12.0, 17.0, -12.0, -57.0, -247.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -99.0, 31.0, -83.0, 127.0, -3.0, -2.0, -1.0, 0.0, 3.0, -39.0, 2.0, -64.0, 0.0, 9.0, 48.0, -74.0, 14.0, 27.0, -104.0, -84.0, -72.0, -54.0, -160.0, 34.0, -193.0, -10.0, 0.0, 27.0, -20.0, -186.0, 80.0, -55.0, -53.0, -341.0, -92.0], "policy_predator_policy_reward": [0.0, 92.0, 87.0, 0.0, 25.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 89.0, 5.0, 59.0, 0.0, 10.0, 37.0, 45.0, 0.0, 52.0, 0.0, 104.0, 2.0, 100.0, 98.0, 82.0, 0.0, 22.0, 0.0, 10.0, 94.0, 0.0, 0.0, 51.0, 186.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9839980024300599, "mean_inference_ms": 2.5867906897087365, "mean_action_processing_ms": 0.399330774804219, "mean_env_wait_ms": 0.3353410517205107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010550684399074979, "StateBufferConnector_ms": 0.006751881705390083, "ViewRequirementAgentConnector_ms": 0.21395550833808052}, "num_episodes": 18, "episode_return_max": 182.0, "episode_return_min": -247.0, "episode_return_mean": 6.666666666666667, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.9250473658678, "num_env_steps_trained_throughput_per_sec": 220.9250473658678, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 18105.705, "restore_workers_time_ms": 0.025, "training_step_time_ms": 18105.615, "sample_time_ms": 2061.147, "learn_time_ms": 16026.008, "learn_throughput": 249.594, "synch_weights_time_ms": 15.025}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "f1691_00000", "date": "2024-08-13_16-38-39", "timestamp": 1723581519, "time_this_iter_s": 18.25169014930725, "time_total_s": 18.25169014930725, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36ff280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.25169014930725, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 83.70384615384616, "ram_util_percent": 85.13461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7362817323397076, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 3.9774539183056543, "policy_loss": -7.681970782676545e-05, "vf_loss": 3.9745227489521895, "vf_explained_var": 0.006658785463010192, "kl": 0.01504000334365158, "entropy": 1.5853298649586067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1548585679086427, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 6.238204906100319, "policy_loss": 0.001726154695023541, "vf_loss": 6.232882159096854, "vf_explained_var": 0.049184455978807315, "kl": 0.01798298065754806, "entropy": 1.5565551123291097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 182.0, "episode_reward_min": -247.0, "episode_reward_mean": -1.6944444444444444, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -341.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -35.65277777777778, "predator_policy": 34.80555555555556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 35.0, 149.0, 65.0, 3.0, 52.0, 0.0, 67.0, 22.0, -25.0, -52.0, -112.0, 21.0, 12.0, 17.0, -12.0, -57.0, -247.0, 175.0, -58.0, 151.0, -166.0, 68.0, -132.0, 117.0, -1.0, -31.0, -86.0, -67.0, -226.0, 100.0, 0.0, -49.0, -56.0, 46.0, 34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -99.0, 31.0, -83.0, 127.0, -3.0, -2.0, -1.0, 0.0, 3.0, -39.0, 2.0, -64.0, 0.0, 9.0, 48.0, -74.0, 14.0, 27.0, -104.0, -84.0, -72.0, -54.0, -160.0, 34.0, -193.0, -10.0, 0.0, 27.0, -20.0, -186.0, 80.0, -55.0, -53.0, -341.0, -92.0, 158.0, 17.0, -113.0, -89.0, 0.0, 151.0, -178.0, -168.0, 3.0, 65.0, -76.0, -146.0, -6.0, 74.0, -90.0, 28.0, 95.0, -252.0, -74.0, -147.0, -70.0, -34.0, -128.0, -216.0, 0.0, 59.0, 0.0, 0.0, -113.0, 0.0, -70.0, -34.0, 43.0, -84.0, 32.0, -6.0], "policy_predator_policy_reward": [0.0, 92.0, 87.0, 0.0, 25.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 89.0, 5.0, 59.0, 0.0, 10.0, 37.0, 45.0, 0.0, 52.0, 0.0, 104.0, 2.0, 100.0, 98.0, 82.0, 0.0, 22.0, 0.0, 10.0, 94.0, 0.0, 0.0, 51.0, 186.0, 0.0, 0.0, 0.0, 52.0, 92.0, 0.0, 0.0, 91.0, 89.0, 0.0, 0.0, 0.0, 90.0, 14.0, 35.0, 4.0, 57.0, 0.0, 126.0, 41.0, 94.0, 37.0, 0.0, 118.0, 0.0, 38.0, 3.0, 0.0, 0.0, 64.0, 0.0, 19.0, 29.0, 70.0, 17.0, 5.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9602126749600433, "mean_inference_ms": 2.4861602776984935, "mean_action_processing_ms": 0.3833673400472889, "mean_env_wait_ms": 0.3278088552678211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008032388157314725, "StateBufferConnector_ms": 0.0047653913497924805, "ViewRequirementAgentConnector_ms": 0.1677397224638197}, "num_episodes": 18, "episode_return_max": 182.0, "episode_return_min": -247.0, "episode_return_mean": -1.6944444444444444, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.5334854960944, "num_env_steps_trained_throughput_per_sec": 279.5334854960944, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16207.708, "restore_workers_time_ms": 0.209, "training_step_time_ms": 16207.324, "sample_time_ms": 1911.342, "learn_time_ms": 14271.637, "learn_throughput": 280.276, "synch_weights_time_ms": 21.108}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "f1691_00000", "date": "2024-08-13_16-38-57", "timestamp": 1723581537, "time_this_iter_s": 14.387286901473999, "time_total_s": 32.63897705078125, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b361d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.63897705078125, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 78.476, "ram_util_percent": 85.024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5104573168451824, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 4.26933653682628, "policy_loss": -0.001016597581840066, "vf_loss": 4.267489031887559, "vf_explained_var": 0.007951497873931965, "kl": 0.014320534870737036, "entropy": 1.5714750610331378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.215171727837709, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 6.266249623626628, "policy_loss": 0.0022931445095559985, "vf_loss": 6.259578240611566, "vf_explained_var": 0.05549511931560658, "kl": 0.021891182608666883, "entropy": 1.5621461602115128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 182.0, "episode_reward_min": -247.0, "episode_reward_mean": -8.074074074074074, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -341.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -39.388888888888886, "predator_policy": 35.351851851851855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 35.0, 149.0, 65.0, 3.0, 52.0, 0.0, 67.0, 22.0, -25.0, -52.0, -112.0, 21.0, 12.0, 17.0, -12.0, -57.0, -247.0, 175.0, -58.0, 151.0, -166.0, 68.0, -132.0, 117.0, -1.0, -31.0, -86.0, -67.0, -226.0, 100.0, 0.0, -49.0, -56.0, 46.0, 34.0, -3.0, 10.0, -30.0, -165.0, -7.0, 23.0, -89.0, -74.0, 135.0, -139.0, -115.0, 82.0, 120.0, -2.0, 100.0, 18.0, -97.0, -142.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -99.0, 31.0, -83.0, 127.0, -3.0, -2.0, -1.0, 0.0, 3.0, -39.0, 2.0, -64.0, 0.0, 9.0, 48.0, -74.0, 14.0, 27.0, -104.0, -84.0, -72.0, -54.0, -160.0, 34.0, -193.0, -10.0, 0.0, 27.0, -20.0, -186.0, 80.0, -55.0, -53.0, -341.0, -92.0, 158.0, 17.0, -113.0, -89.0, 0.0, 151.0, -178.0, -168.0, 3.0, 65.0, -76.0, -146.0, -6.0, 74.0, -90.0, 28.0, 95.0, -252.0, -74.0, -147.0, -70.0, -34.0, -128.0, -216.0, 0.0, 59.0, 0.0, 0.0, -113.0, 0.0, -70.0, -34.0, 43.0, -84.0, 32.0, -6.0, -12.0, 0.0, -35.0, -2.0, 0.0, -60.0, -152.0, -179.0, -2.0, -46.0, 0.0, 23.0, -108.0, -76.0, 0.0, -148.0, 59.0, 6.0, -112.0, -165.0, -198.0, -42.0, 21.0, 18.0, 0.0, 116.0, 0.0, -4.0, -125.0, 120.0, -61.0, -11.0, -204.0, -40.0, -148.0, -120.0], "policy_predator_policy_reward": [0.0, 92.0, 87.0, 0.0, 25.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 89.0, 5.0, 59.0, 0.0, 10.0, 37.0, 45.0, 0.0, 52.0, 0.0, 104.0, 2.0, 100.0, 98.0, 82.0, 0.0, 22.0, 0.0, 10.0, 94.0, 0.0, 0.0, 51.0, 186.0, 0.0, 0.0, 0.0, 52.0, 92.0, 0.0, 0.0, 91.0, 89.0, 0.0, 0.0, 0.0, 90.0, 14.0, 35.0, 4.0, 57.0, 0.0, 126.0, 41.0, 94.0, 37.0, 0.0, 118.0, 0.0, 38.0, 3.0, 0.0, 0.0, 64.0, 0.0, 19.0, 29.0, 70.0, 17.0, 5.0, 3.0, 0.0, 9.0, 47.0, 0.0, 30.0, 0.0, 90.0, 76.0, 36.0, 5.0, 0.0, 0.0, 95.0, 0.0, 74.0, 0.0, 8.0, 62.0, 116.0, 22.0, 99.0, 26.0, 43.0, 0.0, 0.0, 4.0, 0.0, 2.0, 36.0, 69.0, 39.0, 51.0, 128.0, 19.0, 23.0, 103.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.949149213454231, "mean_inference_ms": 2.421444774862112, "mean_action_processing_ms": 0.37680893270414373, "mean_env_wait_ms": 0.3210680663660994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077967290525083185, "StateBufferConnector_ms": 0.004233695842601635, "ViewRequirementAgentConnector_ms": 0.1558840274810791}, "num_episodes": 18, "episode_return_max": 182.0, "episode_return_min": -247.0, "episode_return_mean": -8.074074074074074, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.1470259289573, "num_env_steps_trained_throughput_per_sec": 266.1470259289573, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15814.904, "restore_workers_time_ms": 0.145, "training_step_time_ms": 15814.629, "sample_time_ms": 1848.207, "learn_time_ms": 13943.059, "learn_throughput": 286.881, "synch_weights_time_ms": 19.271}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "f1691_00000", "date": "2024-08-13_16-39-12", "timestamp": 1723581552, "time_this_iter_s": 15.115671157836914, "time_total_s": 47.754648208618164, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.754648208618164, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 84.74761904761904, "ram_util_percent": 85.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5156502716992267, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 4.293005351793198, "policy_loss": -0.0007011021923510328, "vf_loss": 4.290494420036437, "vf_explained_var": 0.0001419726187589938, "kl": 0.016060152209343707, "entropy": 1.5727593089537646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7888551240560239, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 6.811595775967553, "policy_loss": 0.0015438136493136723, "vf_loss": 6.803057628207736, "vf_explained_var": 0.058228927409207376, "kl": 0.023314405167991634, "entropy": 1.5560164679295172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 304.0, "episode_reward_min": -247.0, "episode_reward_mean": 3.4722222222222223, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -341.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -33.63194444444444, "predator_policy": 35.36805555555556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 35.0, 149.0, 65.0, 3.0, 52.0, 0.0, 67.0, 22.0, -25.0, -52.0, -112.0, 21.0, 12.0, 17.0, -12.0, -57.0, -247.0, 175.0, -58.0, 151.0, -166.0, 68.0, -132.0, 117.0, -1.0, -31.0, -86.0, -67.0, -226.0, 100.0, 0.0, -49.0, -56.0, 46.0, 34.0, -3.0, 10.0, -30.0, -165.0, -7.0, 23.0, -89.0, -74.0, 135.0, -139.0, -115.0, 82.0, 120.0, -2.0, 100.0, 18.0, -97.0, -142.0, 0.0, 39.0, 88.0, -80.0, 1.0, 75.0, 145.0, -47.0, 91.0, 304.0, -97.0, 56.0, 12.0, 241.0, 87.0, -118.0, -42.0, -69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -99.0, 31.0, -83.0, 127.0, -3.0, -2.0, -1.0, 0.0, 3.0, -39.0, 2.0, -64.0, 0.0, 9.0, 48.0, -74.0, 14.0, 27.0, -104.0, -84.0, -72.0, -54.0, -160.0, 34.0, -193.0, -10.0, 0.0, 27.0, -20.0, -186.0, 80.0, -55.0, -53.0, -341.0, -92.0, 158.0, 17.0, -113.0, -89.0, 0.0, 151.0, -178.0, -168.0, 3.0, 65.0, -76.0, -146.0, -6.0, 74.0, -90.0, 28.0, 95.0, -252.0, -74.0, -147.0, -70.0, -34.0, -128.0, -216.0, 0.0, 59.0, 0.0, 0.0, -113.0, 0.0, -70.0, -34.0, 43.0, -84.0, 32.0, -6.0, -12.0, 0.0, -35.0, -2.0, 0.0, -60.0, -152.0, -179.0, -2.0, -46.0, 0.0, 23.0, -108.0, -76.0, 0.0, -148.0, 59.0, 6.0, -112.0, -165.0, -198.0, -42.0, 21.0, 18.0, 0.0, 116.0, 0.0, -4.0, -125.0, 120.0, -61.0, -11.0, -204.0, -40.0, -148.0, -120.0, 0.0, 0.0, 0.0, 39.0, -111.0, 140.0, -292.0, 60.0, -58.0, -24.0, -134.0, 60.0, -54.0, 135.0, -48.0, -38.0, 0.0, 91.0, 133.0, 171.0, 48.0, -316.0, 0.0, 35.0, 3.0, -20.0, 153.0, 72.0, 101.0, -105.0, -55.0, -278.0, -42.0, -117.0, -74.0, -64.0], "policy_predator_policy_reward": [0.0, 92.0, 87.0, 0.0, 25.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 89.0, 5.0, 59.0, 0.0, 10.0, 37.0, 45.0, 0.0, 52.0, 0.0, 104.0, 2.0, 100.0, 98.0, 82.0, 0.0, 22.0, 0.0, 10.0, 94.0, 0.0, 0.0, 51.0, 186.0, 0.0, 0.0, 0.0, 52.0, 92.0, 0.0, 0.0, 91.0, 89.0, 0.0, 0.0, 0.0, 90.0, 14.0, 35.0, 4.0, 57.0, 0.0, 126.0, 41.0, 94.0, 37.0, 0.0, 118.0, 0.0, 38.0, 3.0, 0.0, 0.0, 64.0, 0.0, 19.0, 29.0, 70.0, 17.0, 5.0, 3.0, 0.0, 9.0, 47.0, 0.0, 30.0, 0.0, 90.0, 76.0, 36.0, 5.0, 0.0, 0.0, 95.0, 0.0, 74.0, 0.0, 8.0, 62.0, 116.0, 22.0, 99.0, 26.0, 43.0, 0.0, 0.0, 4.0, 0.0, 2.0, 36.0, 69.0, 39.0, 51.0, 128.0, 19.0, 23.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 15.0, 137.0, 31.0, 52.0, 74.0, 75.0, 44.0, 20.0, 0.0, 39.0, 0.0, 0.0, 0.0, 0.0, 113.0, 58.0, 21.0, 0.0, 29.0, 0.0, 0.0, 16.0, 76.0, 15.0, 133.0, 82.0, 85.0, 32.0, 32.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9452280549378895, "mean_inference_ms": 2.407729782966761, "mean_action_processing_ms": 0.3743610164484502, "mean_env_wait_ms": 0.32215594646458723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075711144341362845, "StateBufferConnector_ms": 0.0040678514374627005, "ViewRequirementAgentConnector_ms": 0.15425831079483032}, "num_episodes": 18, "episode_return_max": 304.0, "episode_return_min": -247.0, "episode_return_mean": 3.4722222222222223, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.3865834867744, "num_env_steps_trained_throughput_per_sec": 275.3865834867744, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15492.44, "restore_workers_time_ms": 0.113, "training_step_time_ms": 15492.221, "sample_time_ms": 1888.624, "learn_time_ms": 13582.145, "learn_throughput": 294.504, "synch_weights_time_ms": 17.977}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "f1691_00000", "date": "2024-08-13_16-39-27", "timestamp": 1723581567, "time_this_iter_s": 14.57349705696106, "time_total_s": 62.328145265579224, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36908b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.328145265579224, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 82.31904761904761, "ram_util_percent": 85.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4246482695378954, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 2.542167012527506, "policy_loss": -0.0015162572437138469, "vf_loss": 2.5403772538616542, "vf_explained_var": -0.0007804785771344705, "kl": 0.016530053244056972, "entropy": 1.5642309057649482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9928532177257159, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 6.968727507919231, "policy_loss": 0.0051291311497272795, "vf_loss": 6.953085925339391, "vf_explained_var": 0.09011856210294855, "kl": 0.023361001296155013, "entropy": 1.5356752654232044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -247.0, "episode_reward_mean": 22.696969696969695, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -341.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -21.78787878787879, "predator_policy": 33.13636363636363}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 35.0, 149.0, 65.0, 3.0, 52.0, 0.0, 67.0, 22.0, -25.0, -52.0, -112.0, 21.0, 12.0, 17.0, -12.0, -57.0, -247.0, 175.0, -58.0, 151.0, -166.0, 68.0, -132.0, 117.0, -1.0, -31.0, -86.0, -67.0, -226.0, 100.0, 0.0, -49.0, -56.0, 46.0, 34.0, -3.0, 10.0, -30.0, -165.0, -7.0, 23.0, -89.0, -74.0, 135.0, -139.0, -115.0, 82.0, 120.0, -2.0, 100.0, 18.0, -97.0, -142.0, 0.0, 39.0, 88.0, -80.0, 1.0, 75.0, 145.0, -47.0, 91.0, 304.0, -97.0, 56.0, 12.0, 241.0, 87.0, -118.0, -42.0, -69.0, -104.0, 96.0, 69.0, 16.0, -117.0, 104.0, -32.0, 316.0, -13.0, 149.0, 41.0, 0.0, -44.0, -80.0, 40.0, 328.0, 199.0, 136.0, -63.0, 143.0, -91.0, 16.0, 354.0, 109.0, -1.0, 123.0, 303.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -99.0, 31.0, -83.0, 127.0, -3.0, -2.0, -1.0, 0.0, 3.0, -39.0, 2.0, -64.0, 0.0, 9.0, 48.0, -74.0, 14.0, 27.0, -104.0, -84.0, -72.0, -54.0, -160.0, 34.0, -193.0, -10.0, 0.0, 27.0, -20.0, -186.0, 80.0, -55.0, -53.0, -341.0, -92.0, 158.0, 17.0, -113.0, -89.0, 0.0, 151.0, -178.0, -168.0, 3.0, 65.0, -76.0, -146.0, -6.0, 74.0, -90.0, 28.0, 95.0, -252.0, -74.0, -147.0, -70.0, -34.0, -128.0, -216.0, 0.0, 59.0, 0.0, 0.0, -113.0, 0.0, -70.0, -34.0, 43.0, -84.0, 32.0, -6.0, -12.0, 0.0, -35.0, -2.0, 0.0, -60.0, -152.0, -179.0, -2.0, -46.0, 0.0, 23.0, -108.0, -76.0, 0.0, -148.0, 59.0, 6.0, -112.0, -165.0, -198.0, -42.0, 21.0, 18.0, 0.0, 116.0, 0.0, -4.0, -125.0, 120.0, -61.0, -11.0, -204.0, -40.0, -148.0, -120.0, 0.0, 0.0, 0.0, 39.0, -111.0, 140.0, -292.0, 60.0, -58.0, -24.0, -134.0, 60.0, -54.0, 135.0, -48.0, -38.0, 0.0, 91.0, 133.0, 171.0, 48.0, -316.0, 0.0, 35.0, 3.0, -20.0, 153.0, 72.0, 101.0, -105.0, -55.0, -278.0, -42.0, -117.0, -74.0, -64.0, 0.0, -208.0, -98.0, 119.0, 4.0, 45.0, -41.0, 0.0, -49.0, -231.0, 85.0, 0.0, -228.0, 45.0, 150.0, 166.0, 0.0, -26.0, -48.0, 115.0, -18.0, -40.0, 0.0, 0.0, 1.0, -164.0, -183.0, -12.0, 121.0, -162.0, 134.0, 193.0, 199.0, 0.0, 27.0, 109.0, -42.0, -108.0, 0.0, 143.0, -88.0, -86.0, -32.0, 31.0, 150.0, 178.0, 117.0, -50.0, -2.0, 0.0, -39.0, 86.0, 96.0, 170.0], "policy_predator_policy_reward": [0.0, 92.0, 87.0, 0.0, 25.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 89.0, 5.0, 59.0, 0.0, 10.0, 37.0, 45.0, 0.0, 52.0, 0.0, 104.0, 2.0, 100.0, 98.0, 82.0, 0.0, 22.0, 0.0, 10.0, 94.0, 0.0, 0.0, 51.0, 186.0, 0.0, 0.0, 0.0, 52.0, 92.0, 0.0, 0.0, 91.0, 89.0, 0.0, 0.0, 0.0, 90.0, 14.0, 35.0, 4.0, 57.0, 0.0, 126.0, 41.0, 94.0, 37.0, 0.0, 118.0, 0.0, 38.0, 3.0, 0.0, 0.0, 64.0, 0.0, 19.0, 29.0, 70.0, 17.0, 5.0, 3.0, 0.0, 9.0, 47.0, 0.0, 30.0, 0.0, 90.0, 76.0, 36.0, 5.0, 0.0, 0.0, 95.0, 0.0, 74.0, 0.0, 8.0, 62.0, 116.0, 22.0, 99.0, 26.0, 43.0, 0.0, 0.0, 4.0, 0.0, 2.0, 36.0, 69.0, 39.0, 51.0, 128.0, 19.0, 23.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 15.0, 137.0, 31.0, 52.0, 74.0, 75.0, 44.0, 20.0, 0.0, 39.0, 0.0, 0.0, 0.0, 0.0, 113.0, 58.0, 21.0, 0.0, 29.0, 0.0, 0.0, 16.0, 76.0, 15.0, 133.0, 82.0, 85.0, 32.0, 32.0, 37.0, 71.0, 33.0, 49.0, 26.0, 0.0, 20.0, 0.0, 57.0, 0.0, 163.0, 0.0, 19.0, 110.0, 41.0, 0.0, 0.0, 13.0, 0.0, 0.0, 82.0, 99.0, 0.0, 0.0, 0.0, 15.0, 104.0, 0.0, 115.0, 11.0, 70.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 2.0, 0.0, 0.0, 43.0, 40.0, 1.0, 16.0, 10.0, 16.0, 0.0, 42.0, 0.0, 1.0, 76.0, 0.0, 6.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9358547426262678, "mean_inference_ms": 2.391554678534659, "mean_action_processing_ms": 0.37058984540845435, "mean_env_wait_ms": 0.32157080361476126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007360511355929905, "StateBufferConnector_ms": 0.0037700238853994044, "ViewRequirementAgentConnector_ms": 0.1477212616891572}, "num_episodes": 27, "episode_return_max": 354.0, "episode_return_min": -247.0, "episode_return_mean": 22.696969696969695, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.2403459357355, "num_env_steps_trained_throughput_per_sec": 260.2403459357355, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 15468.035, "restore_workers_time_ms": 0.094, "training_step_time_ms": 15467.85, "sample_time_ms": 1855.71, "learn_time_ms": 13591.846, "learn_throughput": 294.294, "synch_weights_time_ms": 17.105}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "f1691_00000", "date": "2024-08-13_16-39-42", "timestamp": 1723581582, "time_this_iter_s": 15.406121015548706, "time_total_s": 77.73426628112793, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36bcca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.73426628112793, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.43636363636362, "ram_util_percent": 85.36818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5042633719584614, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 2.340316115926813, "policy_loss": -0.001675414341925668, "vf_loss": 2.3383518838377855, "vf_explained_var": 0.013477491796332062, "kl": 0.018198280013801745, "entropy": 1.5548513608634786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2255745180227138, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 5.309782588923419, "policy_loss": 0.0011072673880440926, "vf_loss": 5.293738907354849, "vf_explained_var": 0.20220441742548867, "kl": 0.022128005932286535, "entropy": 1.550971758807147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -247.0, "episode_reward_mean": 33.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -341.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -13.635, "predator_policy": 30.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-247.0, 175.0, -58.0, 151.0, -166.0, 68.0, -132.0, 117.0, -1.0, -31.0, -86.0, -67.0, -226.0, 100.0, 0.0, -49.0, -56.0, 46.0, 34.0, -3.0, 10.0, -30.0, -165.0, -7.0, 23.0, -89.0, -74.0, 135.0, -139.0, -115.0, 82.0, 120.0, -2.0, 100.0, 18.0, -97.0, -142.0, 0.0, 39.0, 88.0, -80.0, 1.0, 75.0, 145.0, -47.0, 91.0, 304.0, -97.0, 56.0, 12.0, 241.0, 87.0, -118.0, -42.0, -69.0, -104.0, 96.0, 69.0, 16.0, -117.0, 104.0, -32.0, 316.0, -13.0, 149.0, 41.0, 0.0, -44.0, -80.0, 40.0, 328.0, 199.0, 136.0, -63.0, 143.0, -91.0, 16.0, 354.0, 109.0, -1.0, 123.0, 303.0, 160.0, 0.0, 44.0, 80.0, -11.0, 281.0, -9.0, 175.0, 160.0, -24.0, 124.0, -8.0, 0.0, 253.0, 39.0, 0.0, 146.0, 101.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-341.0, -92.0, 158.0, 17.0, -113.0, -89.0, 0.0, 151.0, -178.0, -168.0, 3.0, 65.0, -76.0, -146.0, -6.0, 74.0, -90.0, 28.0, 95.0, -252.0, -74.0, -147.0, -70.0, -34.0, -128.0, -216.0, 0.0, 59.0, 0.0, 0.0, -113.0, 0.0, -70.0, -34.0, 43.0, -84.0, 32.0, -6.0, -12.0, 0.0, -35.0, -2.0, 0.0, -60.0, -152.0, -179.0, -2.0, -46.0, 0.0, 23.0, -108.0, -76.0, 0.0, -148.0, 59.0, 6.0, -112.0, -165.0, -198.0, -42.0, 21.0, 18.0, 0.0, 116.0, 0.0, -4.0, -125.0, 120.0, -61.0, -11.0, -204.0, -40.0, -148.0, -120.0, 0.0, 0.0, 0.0, 39.0, -111.0, 140.0, -292.0, 60.0, -58.0, -24.0, -134.0, 60.0, -54.0, 135.0, -48.0, -38.0, 0.0, 91.0, 133.0, 171.0, 48.0, -316.0, 0.0, 35.0, 3.0, -20.0, 153.0, 72.0, 101.0, -105.0, -55.0, -278.0, -42.0, -117.0, -74.0, -64.0, 0.0, -208.0, -98.0, 119.0, 4.0, 45.0, -41.0, 0.0, -49.0, -231.0, 85.0, 0.0, -228.0, 45.0, 150.0, 166.0, 0.0, -26.0, -48.0, 115.0, -18.0, -40.0, 0.0, 0.0, 1.0, -164.0, -183.0, -12.0, 121.0, -162.0, 134.0, 193.0, 199.0, 0.0, 27.0, 109.0, -42.0, -108.0, 0.0, 143.0, -88.0, -86.0, -32.0, 31.0, 150.0, 178.0, 117.0, -50.0, -2.0, 0.0, -39.0, 86.0, 96.0, 170.0, 42.0, 52.0, 0.0, 0.0, 50.0, -24.0, 97.0, -74.0, 46.0, -114.0, 133.0, 148.0, -90.0, 5.0, 175.0, 0.0, 67.0, 17.0, -32.0, -86.0, 56.0, 42.0, 13.0, -96.0, 0.0, 0.0, 177.0, 71.0, -10.0, 44.0, 0.0, 0.0, 77.0, -35.0, -22.0, 93.0], "policy_predator_policy_reward": [186.0, 0.0, 0.0, 0.0, 52.0, 92.0, 0.0, 0.0, 91.0, 89.0, 0.0, 0.0, 0.0, 90.0, 14.0, 35.0, 4.0, 57.0, 0.0, 126.0, 41.0, 94.0, 37.0, 0.0, 118.0, 0.0, 38.0, 3.0, 0.0, 0.0, 64.0, 0.0, 19.0, 29.0, 70.0, 17.0, 5.0, 3.0, 0.0, 9.0, 47.0, 0.0, 30.0, 0.0, 90.0, 76.0, 36.0, 5.0, 0.0, 0.0, 95.0, 0.0, 74.0, 0.0, 8.0, 62.0, 116.0, 22.0, 99.0, 26.0, 43.0, 0.0, 0.0, 4.0, 0.0, 2.0, 36.0, 69.0, 39.0, 51.0, 128.0, 19.0, 23.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 15.0, 137.0, 31.0, 52.0, 74.0, 75.0, 44.0, 20.0, 0.0, 39.0, 0.0, 0.0, 0.0, 0.0, 113.0, 58.0, 21.0, 0.0, 29.0, 0.0, 0.0, 16.0, 76.0, 15.0, 133.0, 82.0, 85.0, 32.0, 32.0, 37.0, 71.0, 33.0, 49.0, 26.0, 0.0, 20.0, 0.0, 57.0, 0.0, 163.0, 0.0, 19.0, 110.0, 41.0, 0.0, 0.0, 13.0, 0.0, 0.0, 82.0, 99.0, 0.0, 0.0, 0.0, 15.0, 104.0, 0.0, 115.0, 11.0, 70.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 2.0, 0.0, 0.0, 43.0, 40.0, 1.0, 16.0, 10.0, 16.0, 0.0, 42.0, 0.0, 1.0, 76.0, 0.0, 6.0, 31.0, 30.0, 36.0, 0.0, 0.0, 0.0, 18.0, 35.0, 22.0, 57.0, 0.0, 0.0, 0.0, 56.0, 20.0, 0.0, 0.0, 25.0, 51.0, 72.0, 22.0, 9.0, 17.0, 68.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 77.0, 27.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.920585273613882, "mean_inference_ms": 2.3451817142352, "mean_action_processing_ms": 0.36386183717731724, "mean_env_wait_ms": 0.32176631380478216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006096005439758301, "StateBufferConnector_ms": 0.003255009651184082, "ViewRequirementAgentConnector_ms": 0.1279773712158203}, "num_episodes": 18, "episode_return_max": 354.0, "episode_return_min": -247.0, "episode_return_mean": 33.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.1124330756482, "num_env_steps_trained_throughput_per_sec": 276.1124330756482, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 15304.506, "restore_workers_time_ms": 0.081, "training_step_time_ms": 15304.344, "sample_time_ms": 1847.378, "learn_time_ms": 13436.389, "learn_throughput": 297.699, "synch_weights_time_ms": 17.699}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "f1691_00000", "date": "2024-08-13_16-39-57", "timestamp": 1723581597, "time_this_iter_s": 14.559815883636475, "time_total_s": 92.2940821647644, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.2940821647644, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 80.73333333333333, "ram_util_percent": 82.58095238095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.846275840116241, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 5.360808604482621, "policy_loss": -0.00016894825443467765, "vf_loss": 5.356855478488579, "vf_explained_var": 0.005652396294175002, "kl": 0.020610374965007103, "entropy": 1.5568902368898745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3687080600431987, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 7.68333938588541, "policy_loss": 0.00234627072310085, "vf_loss": 7.660224676636791, "vf_explained_var": 0.09514447520018886, "kl": 0.020512045959352628, "entropy": 1.5447287939843677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 366.0, "episode_reward_min": -336.0, "episode_reward_mean": 42.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -10.355, "predator_policy": 31.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, -3.0, 10.0, -30.0, -165.0, -7.0, 23.0, -89.0, -74.0, 135.0, -139.0, -115.0, 82.0, 120.0, -2.0, 100.0, 18.0, -97.0, -142.0, 0.0, 39.0, 88.0, -80.0, 1.0, 75.0, 145.0, -47.0, 91.0, 304.0, -97.0, 56.0, 12.0, 241.0, 87.0, -118.0, -42.0, -69.0, -104.0, 96.0, 69.0, 16.0, -117.0, 104.0, -32.0, 316.0, -13.0, 149.0, 41.0, 0.0, -44.0, -80.0, 40.0, 328.0, 199.0, 136.0, -63.0, 143.0, -91.0, 16.0, 354.0, 109.0, -1.0, 123.0, 303.0, 160.0, 0.0, 44.0, 80.0, -11.0, 281.0, -9.0, 175.0, 160.0, -24.0, 124.0, -8.0, 0.0, 253.0, 39.0, 0.0, 146.0, 101.0, 366.0, -336.0, 88.0, -120.0, 169.0, 58.0, 181.0, 7.0, 60.0, 41.0, 204.0, 34.0, -84.0, -2.0, -39.0, -281.0, -20.0, 76.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [32.0, -6.0, -12.0, 0.0, -35.0, -2.0, 0.0, -60.0, -152.0, -179.0, -2.0, -46.0, 0.0, 23.0, -108.0, -76.0, 0.0, -148.0, 59.0, 6.0, -112.0, -165.0, -198.0, -42.0, 21.0, 18.0, 0.0, 116.0, 0.0, -4.0, -125.0, 120.0, -61.0, -11.0, -204.0, -40.0, -148.0, -120.0, 0.0, 0.0, 0.0, 39.0, -111.0, 140.0, -292.0, 60.0, -58.0, -24.0, -134.0, 60.0, -54.0, 135.0, -48.0, -38.0, 0.0, 91.0, 133.0, 171.0, 48.0, -316.0, 0.0, 35.0, 3.0, -20.0, 153.0, 72.0, 101.0, -105.0, -55.0, -278.0, -42.0, -117.0, -74.0, -64.0, 0.0, -208.0, -98.0, 119.0, 4.0, 45.0, -41.0, 0.0, -49.0, -231.0, 85.0, 0.0, -228.0, 45.0, 150.0, 166.0, 0.0, -26.0, -48.0, 115.0, -18.0, -40.0, 0.0, 0.0, 1.0, -164.0, -183.0, -12.0, 121.0, -162.0, 134.0, 193.0, 199.0, 0.0, 27.0, 109.0, -42.0, -108.0, 0.0, 143.0, -88.0, -86.0, -32.0, 31.0, 150.0, 178.0, 117.0, -50.0, -2.0, 0.0, -39.0, 86.0, 96.0, 170.0, 42.0, 52.0, 0.0, 0.0, 50.0, -24.0, 97.0, -74.0, 46.0, -114.0, 133.0, 148.0, -90.0, 5.0, 175.0, 0.0, 67.0, 17.0, -32.0, -86.0, 56.0, 42.0, 13.0, -96.0, 0.0, 0.0, 177.0, 71.0, -10.0, 44.0, 0.0, 0.0, 77.0, -35.0, -22.0, 93.0, 178.0, 188.0, -220.0, -303.0, -71.0, 69.0, -216.0, -86.0, 94.0, 66.0, 29.0, 0.0, 0.0, 179.0, -178.0, 50.0, -10.0, 48.0, 0.0, 27.0, 62.0, 71.0, 47.0, -84.0, -118.0, -110.0, -1.0, -102.0, -34.0, -88.0, -320.0, -128.0, 0.0, -182.0, 18.0, -47.0], "policy_predator_policy_reward": [5.0, 3.0, 0.0, 9.0, 47.0, 0.0, 30.0, 0.0, 90.0, 76.0, 36.0, 5.0, 0.0, 0.0, 95.0, 0.0, 74.0, 0.0, 8.0, 62.0, 116.0, 22.0, 99.0, 26.0, 43.0, 0.0, 0.0, 4.0, 0.0, 2.0, 36.0, 69.0, 39.0, 51.0, 128.0, 19.0, 23.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 15.0, 137.0, 31.0, 52.0, 74.0, 75.0, 44.0, 20.0, 0.0, 39.0, 0.0, 0.0, 0.0, 0.0, 113.0, 58.0, 21.0, 0.0, 29.0, 0.0, 0.0, 16.0, 76.0, 15.0, 133.0, 82.0, 85.0, 32.0, 32.0, 37.0, 71.0, 33.0, 49.0, 26.0, 0.0, 20.0, 0.0, 57.0, 0.0, 163.0, 0.0, 19.0, 110.0, 41.0, 0.0, 0.0, 13.0, 0.0, 0.0, 82.0, 99.0, 0.0, 0.0, 0.0, 15.0, 104.0, 0.0, 115.0, 11.0, 70.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 2.0, 0.0, 0.0, 43.0, 40.0, 1.0, 16.0, 10.0, 16.0, 0.0, 42.0, 0.0, 1.0, 76.0, 0.0, 6.0, 31.0, 30.0, 36.0, 0.0, 0.0, 0.0, 18.0, 35.0, 22.0, 57.0, 0.0, 0.0, 0.0, 56.0, 20.0, 0.0, 0.0, 25.0, 51.0, 72.0, 22.0, 9.0, 17.0, 68.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 77.0, 27.0, 30.0, 0.0, 0.0, 0.0, 1.0, 186.0, 35.0, 55.0, 53.0, 129.0, 0.0, 9.0, 3.0, 26.0, 2.0, 0.0, 0.0, 135.0, 5.0, 17.0, 14.0, 0.0, 5.0, 66.0, 34.0, 37.0, 59.0, 85.0, 69.0, 32.0, 12.0, 71.0, 167.0, 0.0, 44.0, 118.0, 47.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9148358658452496, "mean_inference_ms": 2.338058511095809, "mean_action_processing_ms": 0.36403994296480013, "mean_env_wait_ms": 0.3210246377485621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006224632263183594, "StateBufferConnector_ms": 0.003413081169128418, "ViewRequirementAgentConnector_ms": 0.1364600658416748}, "num_episodes": 18, "episode_return_max": 366.0, "episode_return_min": -336.0, "episode_return_mean": 42.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.61813140172785, "num_env_steps_trained_throughput_per_sec": 281.61813140172785, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 15147.24, "restore_workers_time_ms": 0.072, "training_step_time_ms": 15147.094, "sample_time_ms": 1859.233, "learn_time_ms": 13266.709, "learn_throughput": 301.507, "synch_weights_time_ms": 18.497}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "f1691_00000", "date": "2024-08-13_16-40-11", "timestamp": 1723581611, "time_this_iter_s": 14.263418197631836, "time_total_s": 106.55750036239624, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.55750036239624, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 85.77000000000001, "ram_util_percent": 83.89}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6638530920106898, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.9194024472640305, "policy_loss": -0.0023943870382570715, "vf_loss": 2.9164948505068584, "vf_explained_var": 0.014996253024964105, "kl": 0.017673284372789005, "entropy": 1.5513279134003575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4532004426553766, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 4.235842316365116, "policy_loss": 0.002214752016071644, "vf_loss": 4.212182204937808, "vf_explained_var": 0.04654416177007887, "kl": 0.014120408819491179, "entropy": 1.534942994546638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 366.0, "episode_reward_min": -336.0, "episode_reward_mean": 51.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -5.47, "predator_policy": 31.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.0, 0.0, 39.0, 88.0, -80.0, 1.0, 75.0, 145.0, -47.0, 91.0, 304.0, -97.0, 56.0, 12.0, 241.0, 87.0, -118.0, -42.0, -69.0, -104.0, 96.0, 69.0, 16.0, -117.0, 104.0, -32.0, 316.0, -13.0, 149.0, 41.0, 0.0, -44.0, -80.0, 40.0, 328.0, 199.0, 136.0, -63.0, 143.0, -91.0, 16.0, 354.0, 109.0, -1.0, 123.0, 303.0, 160.0, 0.0, 44.0, 80.0, -11.0, 281.0, -9.0, 175.0, 160.0, -24.0, 124.0, -8.0, 0.0, 253.0, 39.0, 0.0, 146.0, 101.0, 366.0, -336.0, 88.0, -120.0, 169.0, 58.0, 181.0, 7.0, 60.0, 41.0, 204.0, 34.0, -84.0, -2.0, -39.0, -281.0, -20.0, 76.0, 201.0, 103.0, 281.0, 55.0, 46.0, -9.0, 40.0, 17.0, -123.0, -92.0, -151.0, 53.0, 150.0, 94.0, -70.0, 0.0, 98.0, 43.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-148.0, -120.0, 0.0, 0.0, 0.0, 39.0, -111.0, 140.0, -292.0, 60.0, -58.0, -24.0, -134.0, 60.0, -54.0, 135.0, -48.0, -38.0, 0.0, 91.0, 133.0, 171.0, 48.0, -316.0, 0.0, 35.0, 3.0, -20.0, 153.0, 72.0, 101.0, -105.0, -55.0, -278.0, -42.0, -117.0, -74.0, -64.0, 0.0, -208.0, -98.0, 119.0, 4.0, 45.0, -41.0, 0.0, -49.0, -231.0, 85.0, 0.0, -228.0, 45.0, 150.0, 166.0, 0.0, -26.0, -48.0, 115.0, -18.0, -40.0, 0.0, 0.0, 1.0, -164.0, -183.0, -12.0, 121.0, -162.0, 134.0, 193.0, 199.0, 0.0, 27.0, 109.0, -42.0, -108.0, 0.0, 143.0, -88.0, -86.0, -32.0, 31.0, 150.0, 178.0, 117.0, -50.0, -2.0, 0.0, -39.0, 86.0, 96.0, 170.0, 42.0, 52.0, 0.0, 0.0, 50.0, -24.0, 97.0, -74.0, 46.0, -114.0, 133.0, 148.0, -90.0, 5.0, 175.0, 0.0, 67.0, 17.0, -32.0, -86.0, 56.0, 42.0, 13.0, -96.0, 0.0, 0.0, 177.0, 71.0, -10.0, 44.0, 0.0, 0.0, 77.0, -35.0, -22.0, 93.0, 178.0, 188.0, -220.0, -303.0, -71.0, 69.0, -216.0, -86.0, 94.0, 66.0, 29.0, 0.0, 0.0, 179.0, -178.0, 50.0, -10.0, 48.0, 0.0, 27.0, 62.0, 71.0, 47.0, -84.0, -118.0, -110.0, -1.0, -102.0, -34.0, -88.0, -320.0, -128.0, 0.0, -182.0, 18.0, -47.0, 122.0, 79.0, 39.0, 11.0, 131.0, 120.0, -43.0, 53.0, -107.0, 14.0, 0.0, -78.0, 58.0, -36.0, 104.0, -174.0, -52.0, -185.0, -142.0, -81.0, -152.0, -153.0, 0.0, 18.0, 141.0, 0.0, 76.0, 0.0, -138.0, -8.0, 0.0, 0.0, -174.0, 98.0, 42.0, 1.0], "policy_predator_policy_reward": [23.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 15.0, 137.0, 31.0, 52.0, 74.0, 75.0, 44.0, 20.0, 0.0, 39.0, 0.0, 0.0, 0.0, 0.0, 113.0, 58.0, 21.0, 0.0, 29.0, 0.0, 0.0, 16.0, 76.0, 15.0, 133.0, 82.0, 85.0, 32.0, 32.0, 37.0, 71.0, 33.0, 49.0, 26.0, 0.0, 20.0, 0.0, 57.0, 0.0, 163.0, 0.0, 19.0, 110.0, 41.0, 0.0, 0.0, 13.0, 0.0, 0.0, 82.0, 99.0, 0.0, 0.0, 0.0, 15.0, 104.0, 0.0, 115.0, 11.0, 70.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 2.0, 0.0, 0.0, 43.0, 40.0, 1.0, 16.0, 10.0, 16.0, 0.0, 42.0, 0.0, 1.0, 76.0, 0.0, 6.0, 31.0, 30.0, 36.0, 0.0, 0.0, 0.0, 18.0, 35.0, 22.0, 57.0, 0.0, 0.0, 0.0, 56.0, 20.0, 0.0, 0.0, 25.0, 51.0, 72.0, 22.0, 9.0, 17.0, 68.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 77.0, 27.0, 30.0, 0.0, 0.0, 0.0, 1.0, 186.0, 35.0, 55.0, 53.0, 129.0, 0.0, 9.0, 3.0, 26.0, 2.0, 0.0, 0.0, 135.0, 5.0, 17.0, 14.0, 0.0, 5.0, 66.0, 34.0, 37.0, 59.0, 85.0, 69.0, 32.0, 12.0, 71.0, 167.0, 0.0, 44.0, 118.0, 47.0, 58.0, 0.0, 0.0, 24.0, 29.0, 10.0, 20.0, 23.0, 22.0, 53.0, 86.0, 12.0, 57.0, 0.0, 18.0, 87.0, 0.0, 114.0, 0.0, 11.0, 120.0, 39.0, 115.0, 8.0, 27.0, 3.0, 6.0, 0.0, 18.0, 68.0, 8.0, 0.0, 0.0, 70.0, 104.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.911662231998106, "mean_inference_ms": 2.3469956724411842, "mean_action_processing_ms": 0.3644073072050459, "mean_env_wait_ms": 0.32312661468485104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006052494049072266, "StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.13757944107055664}, "num_episodes": 18, "episode_return_max": 366.0, "episode_return_min": -336.0, "episode_return_mean": 51.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.66686665241957, "num_env_steps_trained_throughput_per_sec": 267.66686665241957, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 15121.846, "restore_workers_time_ms": 0.065, "training_step_time_ms": 15121.693, "sample_time_ms": 1855.314, "learn_time_ms": 13245.332, "learn_throughput": 301.993, "synch_weights_time_ms": 18.115}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "f1691_00000", "date": "2024-08-13_16-40-26", "timestamp": 1723581626, "time_this_iter_s": 14.975707054138184, "time_total_s": 121.53320741653442, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36bcca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.53320741653442, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 84.07619047619048, "ram_util_percent": 83.62380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.605560392803616, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.220604272115798, "policy_loss": -0.0022366511873240587, "vf_loss": 2.2179924618630182, "vf_explained_var": 0.06600793855530875, "kl": 0.01616153060814314, "entropy": 1.5359648573335516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6120824499262705, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 3.7393771693820046, "policy_loss": 0.0008617520331720472, "vf_loss": 3.7147327660252807, "vf_explained_var": 0.035344540536719024, "kl": 0.015659361960597935, "entropy": 1.5269854281945203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 366.0, "episode_reward_min": -336.0, "episode_reward_mean": 52.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -2.49, "predator_policy": 28.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -117.0, 104.0, -32.0, 316.0, -13.0, 149.0, 41.0, 0.0, -44.0, -80.0, 40.0, 328.0, 199.0, 136.0, -63.0, 143.0, -91.0, 16.0, 354.0, 109.0, -1.0, 123.0, 303.0, 160.0, 0.0, 44.0, 80.0, -11.0, 281.0, -9.0, 175.0, 160.0, -24.0, 124.0, -8.0, 0.0, 253.0, 39.0, 0.0, 146.0, 101.0, 366.0, -336.0, 88.0, -120.0, 169.0, 58.0, 181.0, 7.0, 60.0, 41.0, 204.0, 34.0, -84.0, -2.0, -39.0, -281.0, -20.0, 76.0, 201.0, 103.0, 281.0, 55.0, 46.0, -9.0, 40.0, 17.0, -123.0, -92.0, -151.0, 53.0, 150.0, 94.0, -70.0, 0.0, 98.0, 43.0, 22.0, -13.0, 205.0, 6.0, -137.0, 55.0, 37.0, 19.0, 176.0, 60.0, 0.0, 27.0, -8.0, 171.0, -45.0, 103.0, 46.0, 0.0, 0.0, -15.0, -110.0, 78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-41.0, 0.0, -49.0, -231.0, 85.0, 0.0, -228.0, 45.0, 150.0, 166.0, 0.0, -26.0, -48.0, 115.0, -18.0, -40.0, 0.0, 0.0, 1.0, -164.0, -183.0, -12.0, 121.0, -162.0, 134.0, 193.0, 199.0, 0.0, 27.0, 109.0, -42.0, -108.0, 0.0, 143.0, -88.0, -86.0, -32.0, 31.0, 150.0, 178.0, 117.0, -50.0, -2.0, 0.0, -39.0, 86.0, 96.0, 170.0, 42.0, 52.0, 0.0, 0.0, 50.0, -24.0, 97.0, -74.0, 46.0, -114.0, 133.0, 148.0, -90.0, 5.0, 175.0, 0.0, 67.0, 17.0, -32.0, -86.0, 56.0, 42.0, 13.0, -96.0, 0.0, 0.0, 177.0, 71.0, -10.0, 44.0, 0.0, 0.0, 77.0, -35.0, -22.0, 93.0, 178.0, 188.0, -220.0, -303.0, -71.0, 69.0, -216.0, -86.0, 94.0, 66.0, 29.0, 0.0, 0.0, 179.0, -178.0, 50.0, -10.0, 48.0, 0.0, 27.0, 62.0, 71.0, 47.0, -84.0, -118.0, -110.0, -1.0, -102.0, -34.0, -88.0, -320.0, -128.0, 0.0, -182.0, 18.0, -47.0, 122.0, 79.0, 39.0, 11.0, 131.0, 120.0, -43.0, 53.0, -107.0, 14.0, 0.0, -78.0, 58.0, -36.0, 104.0, -174.0, -52.0, -185.0, -142.0, -81.0, -152.0, -153.0, 0.0, 18.0, 141.0, 0.0, 76.0, 0.0, -138.0, -8.0, 0.0, 0.0, -174.0, 98.0, 42.0, 1.0, 5.0, -86.0, 9.0, -93.0, -4.0, 171.0, -3.0, -40.0, -308.0, 0.0, -22.0, 33.0, 0.0, -9.0, -10.0, -28.0, 81.0, 89.0, 0.0, 31.0, 0.0, 0.0, -86.0, 27.0, -16.0, 0.0, 96.0, 74.0, -36.0, -54.0, 88.0, 0.0, 1.0, 45.0, 0.0, 0.0, 0.0, 0.0, -110.0, 0.0, -56.0, -238.0, 37.0, 13.0], "policy_predator_policy_reward": [0.0, 57.0, 0.0, 163.0, 0.0, 19.0, 110.0, 41.0, 0.0, 0.0, 13.0, 0.0, 0.0, 82.0, 99.0, 0.0, 0.0, 0.0, 15.0, 104.0, 0.0, 115.0, 11.0, 70.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 2.0, 0.0, 0.0, 43.0, 40.0, 1.0, 16.0, 10.0, 16.0, 0.0, 42.0, 0.0, 1.0, 76.0, 0.0, 6.0, 31.0, 30.0, 36.0, 0.0, 0.0, 0.0, 18.0, 35.0, 22.0, 57.0, 0.0, 0.0, 0.0, 56.0, 20.0, 0.0, 0.0, 25.0, 51.0, 72.0, 22.0, 9.0, 17.0, 68.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 77.0, 27.0, 30.0, 0.0, 0.0, 0.0, 1.0, 186.0, 35.0, 55.0, 53.0, 129.0, 0.0, 9.0, 3.0, 26.0, 2.0, 0.0, 0.0, 135.0, 5.0, 17.0, 14.0, 0.0, 5.0, 66.0, 34.0, 37.0, 59.0, 85.0, 69.0, 32.0, 12.0, 71.0, 167.0, 0.0, 44.0, 118.0, 47.0, 58.0, 0.0, 0.0, 24.0, 29.0, 10.0, 20.0, 23.0, 22.0, 53.0, 86.0, 12.0, 57.0, 0.0, 18.0, 87.0, 0.0, 114.0, 0.0, 11.0, 120.0, 39.0, 115.0, 8.0, 27.0, 3.0, 6.0, 0.0, 18.0, 68.0, 8.0, 0.0, 0.0, 70.0, 104.0, 0.0, 0.0, 46.0, 57.0, 9.0, 62.0, 6.0, 32.0, 20.0, 29.0, 50.0, 121.0, 0.0, 44.0, 0.0, 46.0, 36.0, 21.0, 6.0, 0.0, 29.0, 0.0, 0.0, 0.0, 83.0, 3.0, 8.0, 0.0, 0.0, 1.0, 27.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 76.0, 19.0, 119.0, 65.0, 23.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051957989299013, "mean_inference_ms": 2.3391459371184578, "mean_action_processing_ms": 0.3636873264029658, "mean_env_wait_ms": 0.32150673946415514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005322098731994629, "StateBufferConnector_ms": 0.003423929214477539, "ViewRequirementAgentConnector_ms": 0.13167572021484375}, "num_episodes": 22, "episode_return_max": 366.0, "episode_return_min": -336.0, "episode_return_mean": 52.62, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.81616893011574, "num_env_steps_trained_throughput_per_sec": 264.81616893011574, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 15119.955, "restore_workers_time_ms": 0.059, "training_step_time_ms": 15119.814, "sample_time_ms": 1829.638, "learn_time_ms": 13269.67, "learn_throughput": 301.439, "synch_weights_time_ms": 17.759}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "f1691_00000", "date": "2024-08-13_16-40-41", "timestamp": 1723581641, "time_this_iter_s": 15.15096402168274, "time_total_s": 136.68417143821716, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.68417143821716, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 77.94545454545455, "ram_util_percent": 84.65454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7520195595801823, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.1473864921817074, "policy_loss": -0.0008163657492746121, "vf_loss": 2.141415790338365, "vf_explained_var": 0.071344918643356, "kl": 0.022623558102350217, "entropy": 1.520968744237587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5843090007387142, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 4.641022905723128, "policy_loss": 0.0024718319851826267, "vf_loss": 4.615575189943667, "vf_explained_var": 0.06070584437203786, "kl": 0.015128149586544024, "entropy": 1.4999542267234236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 366.0, "episode_reward_min": -336.0, "episode_reward_mean": 43.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -4.87, "predator_policy": 26.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.0, 160.0, 0.0, 44.0, 80.0, -11.0, 281.0, -9.0, 175.0, 160.0, -24.0, 124.0, -8.0, 0.0, 253.0, 39.0, 0.0, 146.0, 101.0, 366.0, -336.0, 88.0, -120.0, 169.0, 58.0, 181.0, 7.0, 60.0, 41.0, 204.0, 34.0, -84.0, -2.0, -39.0, -281.0, -20.0, 76.0, 201.0, 103.0, 281.0, 55.0, 46.0, -9.0, 40.0, 17.0, -123.0, -92.0, -151.0, 53.0, 150.0, 94.0, -70.0, 0.0, 98.0, 43.0, 22.0, -13.0, 205.0, 6.0, -137.0, 55.0, 37.0, 19.0, 176.0, 60.0, 0.0, 27.0, -8.0, 171.0, -45.0, 103.0, 46.0, 0.0, 0.0, -15.0, -110.0, 78.0, 132.0, -6.0, 0.0, 175.0, 11.0, -18.0, 69.0, 0.0, 19.0, -31.0, 200.0, -30.0, -60.0, -59.0, 80.0, 1.0, -98.0, -17.0, 88.0, -48.0, 28.0, 159.0, 136.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [96.0, 170.0, 42.0, 52.0, 0.0, 0.0, 50.0, -24.0, 97.0, -74.0, 46.0, -114.0, 133.0, 148.0, -90.0, 5.0, 175.0, 0.0, 67.0, 17.0, -32.0, -86.0, 56.0, 42.0, 13.0, -96.0, 0.0, 0.0, 177.0, 71.0, -10.0, 44.0, 0.0, 0.0, 77.0, -35.0, -22.0, 93.0, 178.0, 188.0, -220.0, -303.0, -71.0, 69.0, -216.0, -86.0, 94.0, 66.0, 29.0, 0.0, 0.0, 179.0, -178.0, 50.0, -10.0, 48.0, 0.0, 27.0, 62.0, 71.0, 47.0, -84.0, -118.0, -110.0, -1.0, -102.0, -34.0, -88.0, -320.0, -128.0, 0.0, -182.0, 18.0, -47.0, 122.0, 79.0, 39.0, 11.0, 131.0, 120.0, -43.0, 53.0, -107.0, 14.0, 0.0, -78.0, 58.0, -36.0, 104.0, -174.0, -52.0, -185.0, -142.0, -81.0, -152.0, -153.0, 0.0, 18.0, 141.0, 0.0, 76.0, 0.0, -138.0, -8.0, 0.0, 0.0, -174.0, 98.0, 42.0, 1.0, 5.0, -86.0, 9.0, -93.0, -4.0, 171.0, -3.0, -40.0, -308.0, 0.0, -22.0, 33.0, 0.0, -9.0, -10.0, -28.0, 81.0, 89.0, 0.0, 31.0, 0.0, 0.0, -86.0, 27.0, -16.0, 0.0, 96.0, 74.0, -36.0, -54.0, 88.0, 0.0, 1.0, 45.0, 0.0, 0.0, 0.0, 0.0, -110.0, 0.0, -56.0, -238.0, 37.0, 13.0, 0.0, 107.0, -66.0, 14.0, 18.0, -36.0, 199.0, -48.0, 7.0, -36.0, -37.0, 0.0, 0.0, 8.0, 5.0, -146.0, 19.0, 0.0, -62.0, 0.0, 98.0, 96.0, 0.0, -68.0, -91.0, -54.0, -34.0, -52.0, 80.0, 0.0, 1.0, 0.0, -74.0, -157.0, 0.0, -34.0, 69.0, 0.0, -57.0, -39.0, 2.0, 5.0, 8.0, 144.0, 0.0, 136.0], "policy_predator_policy_reward": [6.0, 31.0, 30.0, 36.0, 0.0, 0.0, 0.0, 18.0, 35.0, 22.0, 57.0, 0.0, 0.0, 0.0, 56.0, 20.0, 0.0, 0.0, 25.0, 51.0, 72.0, 22.0, 9.0, 17.0, 68.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 77.0, 27.0, 30.0, 0.0, 0.0, 0.0, 1.0, 186.0, 35.0, 55.0, 53.0, 129.0, 0.0, 9.0, 3.0, 26.0, 2.0, 0.0, 0.0, 135.0, 5.0, 17.0, 14.0, 0.0, 5.0, 66.0, 34.0, 37.0, 59.0, 85.0, 69.0, 32.0, 12.0, 71.0, 167.0, 0.0, 44.0, 118.0, 47.0, 58.0, 0.0, 0.0, 24.0, 29.0, 10.0, 20.0, 23.0, 22.0, 53.0, 86.0, 12.0, 57.0, 0.0, 18.0, 87.0, 0.0, 114.0, 0.0, 11.0, 120.0, 39.0, 115.0, 8.0, 27.0, 3.0, 6.0, 0.0, 18.0, 68.0, 8.0, 0.0, 0.0, 70.0, 104.0, 0.0, 0.0, 46.0, 57.0, 9.0, 62.0, 6.0, 32.0, 20.0, 29.0, 50.0, 121.0, 0.0, 44.0, 0.0, 46.0, 36.0, 21.0, 6.0, 0.0, 29.0, 0.0, 0.0, 0.0, 83.0, 3.0, 8.0, 0.0, 0.0, 1.0, 27.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 76.0, 19.0, 119.0, 65.0, 23.0, 5.0, 2.0, 23.0, 46.0, 0.0, 0.0, 18.0, 0.0, 24.0, 7.0, 33.0, 0.0, 19.0, 0.0, 61.0, 105.0, 36.0, 0.0, 0.0, 31.0, 0.0, 3.0, 3.0, 34.0, 4.0, 47.0, 38.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 0.0, 17.0, 0.0, 10.0, 9.0, 13.0, 35.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9008297936914075, "mean_inference_ms": 2.3369610504515466, "mean_action_processing_ms": 0.3651853857600497, "mean_env_wait_ms": 0.32336098946103836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00527799129486084, "StateBufferConnector_ms": 0.0036606788635253906, "ViewRequirementAgentConnector_ms": 0.14928531646728516}, "num_episodes": 23, "episode_return_max": 366.0, "episode_return_min": -336.0, "episode_return_mean": 43.6, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.692216402649, "num_env_steps_trained_throughput_per_sec": 272.692216402649, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 15074.816, "restore_workers_time_ms": 0.055, "training_step_time_ms": 15074.684, "sample_time_ms": 1849.672, "learn_time_ms": 13204.824, "learn_throughput": 302.92, "synch_weights_time_ms": 17.49}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "f1691_00000", "date": "2024-08-13_16-40-56", "timestamp": 1723581656, "time_this_iter_s": 14.698609828948975, "time_total_s": 151.38278126716614, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3748040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 151.38278126716614, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 80.05238095238096, "ram_util_percent": 85.45714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9109023863360995, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 4.163964415479589, "policy_loss": -0.0044886837353703204, "vf_loss": 4.15914792308101, "vf_explained_var": 0.02355891330532296, "kl": 0.020678183830791598, "entropy": 1.49432694489363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5756422206680611, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 8.913981658945639, "policy_loss": 0.0026372438328705295, "vf_loss": 8.88119068095293, "vf_explained_var": 0.012651015621013742, "kl": 0.01985433166400149, "entropy": 1.4355137145708479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -336.0, "episode_reward_mean": 36.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -13.19, "predator_policy": 31.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.0, 366.0, -336.0, 88.0, -120.0, 169.0, 58.0, 181.0, 7.0, 60.0, 41.0, 204.0, 34.0, -84.0, -2.0, -39.0, -281.0, -20.0, 76.0, 201.0, 103.0, 281.0, 55.0, 46.0, -9.0, 40.0, 17.0, -123.0, -92.0, -151.0, 53.0, 150.0, 94.0, -70.0, 0.0, 98.0, 43.0, 22.0, -13.0, 205.0, 6.0, -137.0, 55.0, 37.0, 19.0, 176.0, 60.0, 0.0, 27.0, -8.0, 171.0, -45.0, 103.0, 46.0, 0.0, 0.0, -15.0, -110.0, 78.0, 132.0, -6.0, 0.0, 175.0, 11.0, -18.0, 69.0, 0.0, 19.0, -31.0, 200.0, -30.0, -60.0, -59.0, 80.0, 1.0, -98.0, -17.0, 88.0, -48.0, 28.0, 159.0, 136.0, -75.0, 48.0, -70.0, 99.0, 0.0, -19.0, 367.0, -80.0, 253.0, 58.0, 279.0, 157.0, -90.0, -89.0, 11.0, -161.0, 88.0, 251.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 93.0, 178.0, 188.0, -220.0, -303.0, -71.0, 69.0, -216.0, -86.0, 94.0, 66.0, 29.0, 0.0, 0.0, 179.0, -178.0, 50.0, -10.0, 48.0, 0.0, 27.0, 62.0, 71.0, 47.0, -84.0, -118.0, -110.0, -1.0, -102.0, -34.0, -88.0, -320.0, -128.0, 0.0, -182.0, 18.0, -47.0, 122.0, 79.0, 39.0, 11.0, 131.0, 120.0, -43.0, 53.0, -107.0, 14.0, 0.0, -78.0, 58.0, -36.0, 104.0, -174.0, -52.0, -185.0, -142.0, -81.0, -152.0, -153.0, 0.0, 18.0, 141.0, 0.0, 76.0, 0.0, -138.0, -8.0, 0.0, 0.0, -174.0, 98.0, 42.0, 1.0, 5.0, -86.0, 9.0, -93.0, -4.0, 171.0, -3.0, -40.0, -308.0, 0.0, -22.0, 33.0, 0.0, -9.0, -10.0, -28.0, 81.0, 89.0, 0.0, 31.0, 0.0, 0.0, -86.0, 27.0, -16.0, 0.0, 96.0, 74.0, -36.0, -54.0, 88.0, 0.0, 1.0, 45.0, 0.0, 0.0, 0.0, 0.0, -110.0, 0.0, -56.0, -238.0, 37.0, 13.0, 0.0, 107.0, -66.0, 14.0, 18.0, -36.0, 199.0, -48.0, 7.0, -36.0, -37.0, 0.0, 0.0, 8.0, 5.0, -146.0, 19.0, 0.0, -62.0, 0.0, 98.0, 96.0, 0.0, -68.0, -91.0, -54.0, -34.0, -52.0, 80.0, 0.0, 1.0, 0.0, -74.0, -157.0, 0.0, -34.0, 69.0, 0.0, -57.0, -39.0, 2.0, 5.0, 8.0, 144.0, 0.0, 136.0, -134.0, -83.0, -130.0, 76.0, -190.0, -50.0, -138.0, 131.0, 0.0, 0.0, 2.0, -179.0, 190.0, 177.0, -148.0, -94.0, 122.0, 126.0, 40.0, -91.0, 96.0, 160.0, 143.0, 0.0, -42.0, -246.0, 29.0, -291.0, 48.0, -102.0, -264.0, -34.0, 20.0, -42.0, 81.0, 170.0], "policy_predator_policy_reward": [30.0, 0.0, 0.0, 0.0, 1.0, 186.0, 35.0, 55.0, 53.0, 129.0, 0.0, 9.0, 3.0, 26.0, 2.0, 0.0, 0.0, 135.0, 5.0, 17.0, 14.0, 0.0, 5.0, 66.0, 34.0, 37.0, 59.0, 85.0, 69.0, 32.0, 12.0, 71.0, 167.0, 0.0, 44.0, 118.0, 47.0, 58.0, 0.0, 0.0, 24.0, 29.0, 10.0, 20.0, 23.0, 22.0, 53.0, 86.0, 12.0, 57.0, 0.0, 18.0, 87.0, 0.0, 114.0, 0.0, 11.0, 120.0, 39.0, 115.0, 8.0, 27.0, 3.0, 6.0, 0.0, 18.0, 68.0, 8.0, 0.0, 0.0, 70.0, 104.0, 0.0, 0.0, 46.0, 57.0, 9.0, 62.0, 6.0, 32.0, 20.0, 29.0, 50.0, 121.0, 0.0, 44.0, 0.0, 46.0, 36.0, 21.0, 6.0, 0.0, 29.0, 0.0, 0.0, 0.0, 83.0, 3.0, 8.0, 0.0, 0.0, 1.0, 27.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 76.0, 19.0, 119.0, 65.0, 23.0, 5.0, 2.0, 23.0, 46.0, 0.0, 0.0, 18.0, 0.0, 24.0, 7.0, 33.0, 0.0, 19.0, 0.0, 61.0, 105.0, 36.0, 0.0, 0.0, 31.0, 0.0, 3.0, 3.0, 34.0, 4.0, 47.0, 38.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 0.0, 17.0, 0.0, 10.0, 9.0, 13.0, 35.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 133.0, 9.0, 37.0, 65.0, 124.0, 46.0, 22.0, 84.0, 0.0, 0.0, 50.0, 108.0, 0.0, 0.0, 126.0, 36.0, 5.0, 0.0, 101.0, 8.0, 16.0, 7.0, 14.0, 0.0, 84.0, 114.0, 6.0, 167.0, 14.0, 51.0, 5.0, 132.0, 76.0, 34.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8972599610983161, "mean_inference_ms": 2.3323932606900155, "mean_action_processing_ms": 0.36505883531582156, "mean_env_wait_ms": 0.32279467761835007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005276322364807129, "StateBufferConnector_ms": 0.0036846399307250977, "ViewRequirementAgentConnector_ms": 0.156838059425354}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -336.0, "episode_return_mean": 36.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.69658372562014, "num_env_steps_trained_throughput_per_sec": 298.69658372562014, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14603.399, "restore_workers_time_ms": 0.056, "training_step_time_ms": 14603.264, "sample_time_ms": 1793.016, "learn_time_ms": 12787.911, "learn_throughput": 312.795, "synch_weights_time_ms": 18.817}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "f1691_00000", "date": "2024-08-13_16-41-10", "timestamp": 1723581670, "time_this_iter_s": 13.509011030197144, "time_total_s": 164.89179229736328, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f9700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 164.89179229736328, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 72.40526315789472, "ram_util_percent": 84.92631578947366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7923126824791469, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.973212759078495, "policy_loss": -0.003454849736213132, "vf_loss": 3.966245015840682, "vf_explained_var": 0.006304572972040328, "kl": 0.015440879921756778, "entropy": 1.50663190783647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2433348129981407, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 7.689164724047222, "policy_loss": 0.003446564956681517, "vf_loss": 7.649549439596751, "vf_explained_var": 0.06230043169682619, "kl": 0.023814796377731783, "entropy": 1.3763189938964036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -161.0, "episode_reward_mean": 55.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -308.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -3.4, "predator_policy": 31.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0, 201.0, 103.0, 281.0, 55.0, 46.0, -9.0, 40.0, 17.0, -123.0, -92.0, -151.0, 53.0, 150.0, 94.0, -70.0, 0.0, 98.0, 43.0, 22.0, -13.0, 205.0, 6.0, -137.0, 55.0, 37.0, 19.0, 176.0, 60.0, 0.0, 27.0, -8.0, 171.0, -45.0, 103.0, 46.0, 0.0, 0.0, -15.0, -110.0, 78.0, 132.0, -6.0, 0.0, 175.0, 11.0, -18.0, 69.0, 0.0, 19.0, -31.0, 200.0, -30.0, -60.0, -59.0, 80.0, 1.0, -98.0, -17.0, 88.0, -48.0, 28.0, 159.0, 136.0, -75.0, 48.0, -70.0, 99.0, 0.0, -19.0, 367.0, -80.0, 253.0, 58.0, 279.0, 157.0, -90.0, -89.0, 11.0, -161.0, 88.0, 251.0, -61.0, -3.0, 286.0, 11.0, 88.0, -36.0, 70.0, 271.0, 268.0, 352.0, 328.0, 223.0, 275.0, 47.0, 133.0, 86.0, -99.0, 65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.0, -47.0, 122.0, 79.0, 39.0, 11.0, 131.0, 120.0, -43.0, 53.0, -107.0, 14.0, 0.0, -78.0, 58.0, -36.0, 104.0, -174.0, -52.0, -185.0, -142.0, -81.0, -152.0, -153.0, 0.0, 18.0, 141.0, 0.0, 76.0, 0.0, -138.0, -8.0, 0.0, 0.0, -174.0, 98.0, 42.0, 1.0, 5.0, -86.0, 9.0, -93.0, -4.0, 171.0, -3.0, -40.0, -308.0, 0.0, -22.0, 33.0, 0.0, -9.0, -10.0, -28.0, 81.0, 89.0, 0.0, 31.0, 0.0, 0.0, -86.0, 27.0, -16.0, 0.0, 96.0, 74.0, -36.0, -54.0, 88.0, 0.0, 1.0, 45.0, 0.0, 0.0, 0.0, 0.0, -110.0, 0.0, -56.0, -238.0, 37.0, 13.0, 0.0, 107.0, -66.0, 14.0, 18.0, -36.0, 199.0, -48.0, 7.0, -36.0, -37.0, 0.0, 0.0, 8.0, 5.0, -146.0, 19.0, 0.0, -62.0, 0.0, 98.0, 96.0, 0.0, -68.0, -91.0, -54.0, -34.0, -52.0, 80.0, 0.0, 1.0, 0.0, -74.0, -157.0, 0.0, -34.0, 69.0, 0.0, -57.0, -39.0, 2.0, 5.0, 8.0, 144.0, 0.0, 136.0, -134.0, -83.0, -130.0, 76.0, -190.0, -50.0, -138.0, 131.0, 0.0, 0.0, 2.0, -179.0, 190.0, 177.0, -148.0, -94.0, 122.0, 126.0, 40.0, -91.0, 96.0, 160.0, 143.0, 0.0, -42.0, -246.0, 29.0, -291.0, 48.0, -102.0, -264.0, -34.0, 20.0, -42.0, 81.0, 170.0, -37.0, -143.0, -6.0, 0.0, 65.0, 200.0, -57.0, -146.0, -38.0, 8.0, -178.0, 0.0, 128.0, -198.0, 34.0, 200.0, 125.0, 112.0, 189.0, 142.0, 171.0, 145.0, -41.0, 184.0, 136.0, 88.0, 0.0, -61.0, 0.0, 101.0, 0.0, 9.0, -32.0, -154.0, 85.0, -145.0], "policy_predator_policy_reward": [47.0, 58.0, 0.0, 0.0, 24.0, 29.0, 10.0, 20.0, 23.0, 22.0, 53.0, 86.0, 12.0, 57.0, 0.0, 18.0, 87.0, 0.0, 114.0, 0.0, 11.0, 120.0, 39.0, 115.0, 8.0, 27.0, 3.0, 6.0, 0.0, 18.0, 68.0, 8.0, 0.0, 0.0, 70.0, 104.0, 0.0, 0.0, 46.0, 57.0, 9.0, 62.0, 6.0, 32.0, 20.0, 29.0, 50.0, 121.0, 0.0, 44.0, 0.0, 46.0, 36.0, 21.0, 6.0, 0.0, 29.0, 0.0, 0.0, 0.0, 83.0, 3.0, 8.0, 0.0, 0.0, 1.0, 27.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 76.0, 19.0, 119.0, 65.0, 23.0, 5.0, 2.0, 23.0, 46.0, 0.0, 0.0, 18.0, 0.0, 24.0, 7.0, 33.0, 0.0, 19.0, 0.0, 61.0, 105.0, 36.0, 0.0, 0.0, 31.0, 0.0, 3.0, 3.0, 34.0, 4.0, 47.0, 38.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 0.0, 17.0, 0.0, 10.0, 9.0, 13.0, 35.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 133.0, 9.0, 37.0, 65.0, 124.0, 46.0, 22.0, 84.0, 0.0, 0.0, 50.0, 108.0, 0.0, 0.0, 126.0, 36.0, 5.0, 0.0, 101.0, 8.0, 16.0, 7.0, 14.0, 0.0, 84.0, 114.0, 6.0, 167.0, 14.0, 51.0, 5.0, 132.0, 76.0, 34.0, 0.0, 0.0, 0.0, 119.0, 0.0, 3.0, 9.0, 12.0, 153.0, 61.0, 38.0, 80.0, 53.0, 89.0, 0.0, 140.0, 28.0, 9.0, 31.0, 0.0, 18.0, 3.0, 0.0, 12.0, 15.0, 65.0, 23.0, 28.0, 79.0, 29.0, 32.0, 0.0, 30.0, 47.0, 87.0, 0.0, 67.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8988003802062908, "mean_inference_ms": 2.342883022780966, "mean_action_processing_ms": 0.3656214849074728, "mean_env_wait_ms": 0.32461270544364784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004846692085266113, "StateBufferConnector_ms": 0.004769325256347656, "ViewRequirementAgentConnector_ms": 0.16198396682739258}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -161.0, "episode_return_mean": 55.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.15961113363915, "num_env_steps_trained_throughput_per_sec": 291.15961113363915, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14546.251, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14546.169, "sample_time_ms": 1894.483, "learn_time_ms": 12627.775, "learn_throughput": 316.762, "synch_weights_time_ms": 20.365}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "f1691_00000", "date": "2024-08-13_16-41-24", "timestamp": 1723581684, "time_this_iter_s": 14.246214866638184, "time_total_s": 179.13800716400146, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.13800716400146, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 72.72999999999999, "ram_util_percent": 85.09}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6144005258168493, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 4.985186334892555, "policy_loss": 0.00016149883552715575, "vf_loss": 4.974807294083651, "vf_explained_var": 0.0019961692038036527, "kl": 0.015137121528201, "entropy": 1.5043851820249405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.44188241009359, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 6.7270308953744395, "policy_loss": 0.0022313336696396903, "vf_loss": 6.689814531487762, "vf_explained_var": 0.010292696511303937, "kl": 0.015356933934338861, "entropy": 1.3882338832925867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -558.0, "episode_reward_mean": 54.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -696.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 704.0}, "policy_reward_mean": {"prey_policy": -11.85, "predator_policy": 38.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 22.0, -13.0, 205.0, 6.0, -137.0, 55.0, 37.0, 19.0, 176.0, 60.0, 0.0, 27.0, -8.0, 171.0, -45.0, 103.0, 46.0, 0.0, 0.0, -15.0, -110.0, 78.0, 132.0, -6.0, 0.0, 175.0, 11.0, -18.0, 69.0, 0.0, 19.0, -31.0, 200.0, -30.0, -60.0, -59.0, 80.0, 1.0, -98.0, -17.0, 88.0, -48.0, 28.0, 159.0, 136.0, -75.0, 48.0, -70.0, 99.0, 0.0, -19.0, 367.0, -80.0, 253.0, 58.0, 279.0, 157.0, -90.0, -89.0, 11.0, -161.0, 88.0, 251.0, -61.0, -3.0, 286.0, 11.0, 88.0, -36.0, 70.0, 271.0, 268.0, 352.0, 328.0, 223.0, 275.0, 47.0, 133.0, 86.0, -99.0, 65.0, 196.0, -15.0, 43.0, 38.0, -558.0, 172.0, 123.0, 23.0, 6.0, -45.0, 288.0, -14.0, 68.0, 110.0, 124.0, 99.0, 58.0, -76.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.0, 1.0, 5.0, -86.0, 9.0, -93.0, -4.0, 171.0, -3.0, -40.0, -308.0, 0.0, -22.0, 33.0, 0.0, -9.0, -10.0, -28.0, 81.0, 89.0, 0.0, 31.0, 0.0, 0.0, -86.0, 27.0, -16.0, 0.0, 96.0, 74.0, -36.0, -54.0, 88.0, 0.0, 1.0, 45.0, 0.0, 0.0, 0.0, 0.0, -110.0, 0.0, -56.0, -238.0, 37.0, 13.0, 0.0, 107.0, -66.0, 14.0, 18.0, -36.0, 199.0, -48.0, 7.0, -36.0, -37.0, 0.0, 0.0, 8.0, 5.0, -146.0, 19.0, 0.0, -62.0, 0.0, 98.0, 96.0, 0.0, -68.0, -91.0, -54.0, -34.0, -52.0, 80.0, 0.0, 1.0, 0.0, -74.0, -157.0, 0.0, -34.0, 69.0, 0.0, -57.0, -39.0, 2.0, 5.0, 8.0, 144.0, 0.0, 136.0, -134.0, -83.0, -130.0, 76.0, -190.0, -50.0, -138.0, 131.0, 0.0, 0.0, 2.0, -179.0, 190.0, 177.0, -148.0, -94.0, 122.0, 126.0, 40.0, -91.0, 96.0, 160.0, 143.0, 0.0, -42.0, -246.0, 29.0, -291.0, 48.0, -102.0, -264.0, -34.0, 20.0, -42.0, 81.0, 170.0, -37.0, -143.0, -6.0, 0.0, 65.0, 200.0, -57.0, -146.0, -38.0, 8.0, -178.0, 0.0, 128.0, -198.0, 34.0, 200.0, 125.0, 112.0, 189.0, 142.0, 171.0, 145.0, -41.0, 184.0, 136.0, 88.0, 0.0, -61.0, 0.0, 101.0, 0.0, 9.0, -32.0, -154.0, 85.0, -145.0, 0.0, 194.0, -92.0, -22.0, -216.0, 151.0, 0.0, -106.0, -696.0, -566.0, 35.0, 65.0, 173.0, -259.0, -19.0, -92.0, -85.0, -67.0, -326.0, 0.0, 92.0, 144.0, 0.0, -28.0, -130.0, 70.0, 164.0, -134.0, 35.0, 0.0, 0.0, 77.0, 0.0, -13.0, -25.0, -502.0], "policy_predator_policy_reward": [0.0, 0.0, 46.0, 57.0, 9.0, 62.0, 6.0, 32.0, 20.0, 29.0, 50.0, 121.0, 0.0, 44.0, 0.0, 46.0, 36.0, 21.0, 6.0, 0.0, 29.0, 0.0, 0.0, 0.0, 83.0, 3.0, 8.0, 0.0, 0.0, 1.0, 27.0, 18.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 76.0, 19.0, 119.0, 65.0, 23.0, 5.0, 2.0, 23.0, 46.0, 0.0, 0.0, 18.0, 0.0, 24.0, 7.0, 33.0, 0.0, 19.0, 0.0, 61.0, 105.0, 36.0, 0.0, 0.0, 31.0, 0.0, 3.0, 3.0, 34.0, 4.0, 47.0, 38.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 0.0, 17.0, 0.0, 10.0, 9.0, 13.0, 35.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 133.0, 9.0, 37.0, 65.0, 124.0, 46.0, 22.0, 84.0, 0.0, 0.0, 50.0, 108.0, 0.0, 0.0, 126.0, 36.0, 5.0, 0.0, 101.0, 8.0, 16.0, 7.0, 14.0, 0.0, 84.0, 114.0, 6.0, 167.0, 14.0, 51.0, 5.0, 132.0, 76.0, 34.0, 0.0, 0.0, 0.0, 119.0, 0.0, 3.0, 9.0, 12.0, 153.0, 61.0, 38.0, 80.0, 53.0, 89.0, 0.0, 140.0, 28.0, 9.0, 31.0, 0.0, 18.0, 3.0, 0.0, 12.0, 15.0, 65.0, 23.0, 28.0, 79.0, 29.0, 32.0, 0.0, 30.0, 47.0, 87.0, 0.0, 67.0, 58.0, 2.0, 0.0, 78.0, 21.0, 108.0, 0.0, 95.0, 49.0, 704.0, 0.0, 0.0, 72.0, 93.0, 116.0, 88.0, 46.0, 41.0, 117.0, 119.0, 162.0, 47.0, 5.0, 0.0, 14.0, 120.0, 8.0, 8.0, 72.0, 53.0, 36.0, 10.0, 12.0, 0.0, 71.0, 75.0, 376.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9113437714729092, "mean_inference_ms": 2.3874009304158865, "mean_action_processing_ms": 0.3703219453399921, "mean_env_wait_ms": 0.3307033670125917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067408084869384766, "StateBufferConnector_ms": 0.01233828067779541, "ViewRequirementAgentConnector_ms": 0.22225570678710938}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -558.0, "episode_return_mean": 54.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.6331067701918, "num_env_steps_trained_throughput_per_sec": 243.6331067701918, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14685.139, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14685.043, "sample_time_ms": 2088.875, "learn_time_ms": 12571.632, "learn_throughput": 318.177, "synch_weights_time_ms": 21.203}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "f1691_00000", "date": "2024-08-13_16-41-41", "timestamp": 1723581701, "time_this_iter_s": 16.50382113456726, "time_total_s": 195.64182829856873, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3748ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.64182829856873, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 79.07916666666667, "ram_util_percent": 85.09166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8045645739981737, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 4.669841930727479, "policy_loss": -0.003051795693922532, "vf_loss": 4.661723329655077, "vf_explained_var": 0.011365894003519936, "kl": 0.016548747490565157, "entropy": 1.4771881601167103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.988698264719948, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 6.969309472280836, "policy_loss": 0.002945328788787481, "vf_loss": 6.9255614071296, "vf_explained_var": 0.07010969907518418, "kl": 0.017910670409868806, "entropy": 1.3554507060025736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -558.0, "episode_reward_mean": 59.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -696.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 704.0}, "policy_reward_mean": {"prey_policy": -16.33, "predator_policy": 46.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -18.0, 69.0, 0.0, 19.0, -31.0, 200.0, -30.0, -60.0, -59.0, 80.0, 1.0, -98.0, -17.0, 88.0, -48.0, 28.0, 159.0, 136.0, -75.0, 48.0, -70.0, 99.0, 0.0, -19.0, 367.0, -80.0, 253.0, 58.0, 279.0, 157.0, -90.0, -89.0, 11.0, -161.0, 88.0, 251.0, -61.0, -3.0, 286.0, 11.0, 88.0, -36.0, 70.0, 271.0, 268.0, 352.0, 328.0, 223.0, 275.0, 47.0, 133.0, 86.0, -99.0, 65.0, 196.0, -15.0, 43.0, 38.0, -558.0, 172.0, 123.0, 23.0, 6.0, -45.0, 288.0, -14.0, 68.0, 110.0, 124.0, 99.0, 58.0, -76.0, 0.0, 256.0, 9.0, -176.0, 39.0, 149.0, 17.0, 62.0, 115.0, -216.0, 154.0, 25.0, 364.0, -7.0, 112.0, -124.0, 87.0, 9.0, -269.0, 149.0, 213.0, 150.0, -41.0, 360.0, -6.0, 111.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.0, -36.0, -37.0, 0.0, 0.0, 8.0, 5.0, -146.0, 19.0, 0.0, -62.0, 0.0, 98.0, 96.0, 0.0, -68.0, -91.0, -54.0, -34.0, -52.0, 80.0, 0.0, 1.0, 0.0, -74.0, -157.0, 0.0, -34.0, 69.0, 0.0, -57.0, -39.0, 2.0, 5.0, 8.0, 144.0, 0.0, 136.0, -134.0, -83.0, -130.0, 76.0, -190.0, -50.0, -138.0, 131.0, 0.0, 0.0, 2.0, -179.0, 190.0, 177.0, -148.0, -94.0, 122.0, 126.0, 40.0, -91.0, 96.0, 160.0, 143.0, 0.0, -42.0, -246.0, 29.0, -291.0, 48.0, -102.0, -264.0, -34.0, 20.0, -42.0, 81.0, 170.0, -37.0, -143.0, -6.0, 0.0, 65.0, 200.0, -57.0, -146.0, -38.0, 8.0, -178.0, 0.0, 128.0, -198.0, 34.0, 200.0, 125.0, 112.0, 189.0, 142.0, 171.0, 145.0, -41.0, 184.0, 136.0, 88.0, 0.0, -61.0, 0.0, 101.0, 0.0, 9.0, -32.0, -154.0, 85.0, -145.0, 0.0, 194.0, -92.0, -22.0, -216.0, 151.0, 0.0, -106.0, -696.0, -566.0, 35.0, 65.0, 173.0, -259.0, -19.0, -92.0, -85.0, -67.0, -326.0, 0.0, 92.0, 144.0, 0.0, -28.0, -130.0, 70.0, 164.0, -134.0, 35.0, 0.0, 0.0, 77.0, 0.0, -13.0, -25.0, -502.0, 0.0, 0.0, 161.0, 32.0, -148.0, 0.0, -340.0, -145.0, -56.0, 0.0, -220.0, 128.0, -201.0, -16.0, -188.0, 134.0, 101.0, -38.0, -160.0, -223.0, 0.0, 135.0, -268.0, 139.0, 199.0, 148.0, 0.0, -14.0, 185.0, -166.0, 0.0, -358.0, 81.0, 0.0, -53.0, -73.0, -188.0, -180.0, -88.0, 193.0, 186.0, -122.0, 137.0, 0.0, 0.0, -116.0, 164.0, 194.0, 0.0, -12.0, 0.0, 68.0, -90.0, 14.0], "policy_predator_policy_reward": [7.0, 33.0, 0.0, 19.0, 0.0, 61.0, 105.0, 36.0, 0.0, 0.0, 31.0, 0.0, 3.0, 3.0, 34.0, 4.0, 47.0, 38.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 0.0, 17.0, 0.0, 10.0, 9.0, 13.0, 35.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 133.0, 9.0, 37.0, 65.0, 124.0, 46.0, 22.0, 84.0, 0.0, 0.0, 50.0, 108.0, 0.0, 0.0, 126.0, 36.0, 5.0, 0.0, 101.0, 8.0, 16.0, 7.0, 14.0, 0.0, 84.0, 114.0, 6.0, 167.0, 14.0, 51.0, 5.0, 132.0, 76.0, 34.0, 0.0, 0.0, 0.0, 119.0, 0.0, 3.0, 9.0, 12.0, 153.0, 61.0, 38.0, 80.0, 53.0, 89.0, 0.0, 140.0, 28.0, 9.0, 31.0, 0.0, 18.0, 3.0, 0.0, 12.0, 15.0, 65.0, 23.0, 28.0, 79.0, 29.0, 32.0, 0.0, 30.0, 47.0, 87.0, 0.0, 67.0, 58.0, 2.0, 0.0, 78.0, 21.0, 108.0, 0.0, 95.0, 49.0, 704.0, 0.0, 0.0, 72.0, 93.0, 116.0, 88.0, 46.0, 41.0, 117.0, 119.0, 162.0, 47.0, 5.0, 0.0, 14.0, 120.0, 8.0, 8.0, 72.0, 53.0, 36.0, 10.0, 12.0, 0.0, 71.0, 75.0, 376.0, 0.0, 0.0, 33.0, 30.0, 43.0, 114.0, 175.0, 134.0, 24.0, 71.0, 110.0, 131.0, 114.0, 120.0, 22.0, 94.0, 19.0, 33.0, 167.0, 0.0, 12.0, 7.0, 49.0, 105.0, 17.0, 0.0, 0.0, 7.0, 93.0, 0.0, 58.0, 176.0, 0.0, 6.0, 73.0, 62.0, 99.0, 0.0, 44.0, 0.0, 71.0, 78.0, 13.0, 0.0, 12.0, 63.0, 0.0, 2.0, 6.0, 0.0, 43.0, 0.0, 45.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9474928648771629, "mean_inference_ms": 2.4939577045885426, "mean_action_processing_ms": 0.38155791667780603, "mean_env_wait_ms": 0.34271622893244014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071103572845458984, "StateBufferConnector_ms": 0.0124741792678833, "ViewRequirementAgentConnector_ms": 0.3035619258880615}, "num_episodes": 27, "episode_return_max": 367.0, "episode_return_min": -558.0, "episode_return_mean": 59.71, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.7650161968424, "num_env_steps_trained_throughput_per_sec": 253.7650161968424, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 14808.897, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14808.801, "sample_time_ms": 2214.495, "learn_time_ms": 12569.842, "learn_throughput": 318.222, "synch_weights_time_ms": 21.152}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "f1691_00000", "date": "2024-08-13_16-41-56", "timestamp": 1723581716, "time_this_iter_s": 15.795126676559448, "time_total_s": 211.43695497512817, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3748280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 211.43695497512817, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 82.30454545454546, "ram_util_percent": 84.68636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9586822231610616, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.0203003366157493, "policy_loss": -0.001322688749700627, "vf_loss": 3.0098490393350996, "vf_explained_var": 0.03294004290192216, "kl": 0.017442946972173187, "entropy": 1.4532281150262822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6256955376377813, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 6.6718812632182285, "policy_loss": 0.006019160116372246, "vf_loss": 6.613989612538979, "vf_explained_var": 0.2776267799750838, "kl": 0.022769822349404494, "entropy": 1.3581445623327184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -558.0, "episode_reward_mean": 83.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -696.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 704.0}, "policy_reward_mean": {"prey_policy": -5.575, "predator_policy": 47.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.0, -75.0, 48.0, -70.0, 99.0, 0.0, -19.0, 367.0, -80.0, 253.0, 58.0, 279.0, 157.0, -90.0, -89.0, 11.0, -161.0, 88.0, 251.0, -61.0, -3.0, 286.0, 11.0, 88.0, -36.0, 70.0, 271.0, 268.0, 352.0, 328.0, 223.0, 275.0, 47.0, 133.0, 86.0, -99.0, 65.0, 196.0, -15.0, 43.0, 38.0, -558.0, 172.0, 123.0, 23.0, 6.0, -45.0, 288.0, -14.0, 68.0, 110.0, 124.0, 99.0, 58.0, -76.0, 0.0, 256.0, 9.0, -176.0, 39.0, 149.0, 17.0, 62.0, 115.0, -216.0, 154.0, 25.0, 364.0, -7.0, 112.0, -124.0, 87.0, 9.0, -269.0, 149.0, 213.0, 150.0, -41.0, 360.0, -6.0, 111.0, 28.0, 186.0, 199.0, 86.0, 0.0, -1.0, 120.0, 201.0, 85.0, 140.0, 130.0, 80.0, 257.0, 197.0, 336.0, 17.0, 179.0, 247.0, 172.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 136.0, -134.0, -83.0, -130.0, 76.0, -190.0, -50.0, -138.0, 131.0, 0.0, 0.0, 2.0, -179.0, 190.0, 177.0, -148.0, -94.0, 122.0, 126.0, 40.0, -91.0, 96.0, 160.0, 143.0, 0.0, -42.0, -246.0, 29.0, -291.0, 48.0, -102.0, -264.0, -34.0, 20.0, -42.0, 81.0, 170.0, -37.0, -143.0, -6.0, 0.0, 65.0, 200.0, -57.0, -146.0, -38.0, 8.0, -178.0, 0.0, 128.0, -198.0, 34.0, 200.0, 125.0, 112.0, 189.0, 142.0, 171.0, 145.0, -41.0, 184.0, 136.0, 88.0, 0.0, -61.0, 0.0, 101.0, 0.0, 9.0, -32.0, -154.0, 85.0, -145.0, 0.0, 194.0, -92.0, -22.0, -216.0, 151.0, 0.0, -106.0, -696.0, -566.0, 35.0, 65.0, 173.0, -259.0, -19.0, -92.0, -85.0, -67.0, -326.0, 0.0, 92.0, 144.0, 0.0, -28.0, -130.0, 70.0, 164.0, -134.0, 35.0, 0.0, 0.0, 77.0, 0.0, -13.0, -25.0, -502.0, 0.0, 0.0, 161.0, 32.0, -148.0, 0.0, -340.0, -145.0, -56.0, 0.0, -220.0, 128.0, -201.0, -16.0, -188.0, 134.0, 101.0, -38.0, -160.0, -223.0, 0.0, 135.0, -268.0, 139.0, 199.0, 148.0, 0.0, -14.0, 185.0, -166.0, 0.0, -358.0, 81.0, 0.0, -53.0, -73.0, -188.0, -180.0, -88.0, 193.0, 186.0, -122.0, 137.0, 0.0, 0.0, -116.0, 164.0, 194.0, 0.0, -12.0, 0.0, 68.0, -90.0, 14.0, 0.0, 185.0, 62.0, 88.0, -22.0, -64.0, 0.0, 0.0, -2.0, 0.0, 109.0, 0.0, 149.0, -6.0, -29.0, 65.0, 191.0, -108.0, 0.0, 109.0, -7.0, 0.0, 124.0, 23.0, -2.0, 197.0, 194.0, 123.0, -61.0, -64.0, 169.0, 0.0, 99.0, 65.0, 0.0, 165.0], "policy_predator_policy_reward": [0.0, 0.0, 133.0, 9.0, 37.0, 65.0, 124.0, 46.0, 22.0, 84.0, 0.0, 0.0, 50.0, 108.0, 0.0, 0.0, 126.0, 36.0, 5.0, 0.0, 101.0, 8.0, 16.0, 7.0, 14.0, 0.0, 84.0, 114.0, 6.0, 167.0, 14.0, 51.0, 5.0, 132.0, 76.0, 34.0, 0.0, 0.0, 0.0, 119.0, 0.0, 3.0, 9.0, 12.0, 153.0, 61.0, 38.0, 80.0, 53.0, 89.0, 0.0, 140.0, 28.0, 9.0, 31.0, 0.0, 18.0, 3.0, 0.0, 12.0, 15.0, 65.0, 23.0, 28.0, 79.0, 29.0, 32.0, 0.0, 30.0, 47.0, 87.0, 0.0, 67.0, 58.0, 2.0, 0.0, 78.0, 21.0, 108.0, 0.0, 95.0, 49.0, 704.0, 0.0, 0.0, 72.0, 93.0, 116.0, 88.0, 46.0, 41.0, 117.0, 119.0, 162.0, 47.0, 5.0, 0.0, 14.0, 120.0, 8.0, 8.0, 72.0, 53.0, 36.0, 10.0, 12.0, 0.0, 71.0, 75.0, 376.0, 0.0, 0.0, 33.0, 30.0, 43.0, 114.0, 175.0, 134.0, 24.0, 71.0, 110.0, 131.0, 114.0, 120.0, 22.0, 94.0, 19.0, 33.0, 167.0, 0.0, 12.0, 7.0, 49.0, 105.0, 17.0, 0.0, 0.0, 7.0, 93.0, 0.0, 58.0, 176.0, 0.0, 6.0, 73.0, 62.0, 99.0, 0.0, 44.0, 0.0, 71.0, 78.0, 13.0, 0.0, 12.0, 63.0, 0.0, 2.0, 6.0, 0.0, 43.0, 0.0, 45.0, 59.0, 1.0, 0.0, 28.0, 21.0, 84.0, 88.0, 0.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 58.0, 44.0, 5.0, 3.0, 54.0, 10.0, 11.0, 22.0, 65.0, 55.0, 55.0, 2.0, 0.0, 0.0, 19.0, 64.0, 78.0, 10.0, 0.0, 41.0, 42.0, 1.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9750632884810944, "mean_inference_ms": 2.5581950680489602, "mean_action_processing_ms": 0.3875373162340949, "mean_env_wait_ms": 0.35217335998900795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006503462791442871, "StateBufferConnector_ms": 0.012360215187072754, "ViewRequirementAgentConnector_ms": 0.30805158615112305}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -558.0, "episode_return_mean": 83.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.49139155307506, "num_env_steps_trained_throughput_per_sec": 281.49139155307506, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 14692.859, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14692.762, "sample_time_ms": 2278.072, "learn_time_ms": 12390.166, "learn_throughput": 322.837, "synch_weights_time_ms": 21.205}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "f1691_00000", "date": "2024-08-13_16-42-11", "timestamp": 1723581731, "time_this_iter_s": 14.266266822814941, "time_total_s": 225.70322179794312, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 225.70322179794312, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 76.24285714285713, "ram_util_percent": 85.42380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0390287466938533, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.5491830986643595, "policy_loss": -0.0013869502867458674, "vf_loss": 2.53951485056095, "vf_explained_var": 0.008203901784129875, "kl": 0.016378083017289193, "entropy": 1.42326237985066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.097576909721213, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.375276439656656, "policy_loss": 0.002081692945113573, "vf_loss": 6.312670308572275, "vf_explained_var": 0.4316442256566709, "kl": 0.0177117647927742, "entropy": 1.4115790104109143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 364.0, "episode_reward_min": -558.0, "episode_reward_mean": 95.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -696.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 704.0}, "policy_reward_mean": {"prey_policy": 3.905, "predator_policy": 43.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.0, -61.0, -3.0, 286.0, 11.0, 88.0, -36.0, 70.0, 271.0, 268.0, 352.0, 328.0, 223.0, 275.0, 47.0, 133.0, 86.0, -99.0, 65.0, 196.0, -15.0, 43.0, 38.0, -558.0, 172.0, 123.0, 23.0, 6.0, -45.0, 288.0, -14.0, 68.0, 110.0, 124.0, 99.0, 58.0, -76.0, 0.0, 256.0, 9.0, -176.0, 39.0, 149.0, 17.0, 62.0, 115.0, -216.0, 154.0, 25.0, 364.0, -7.0, 112.0, -124.0, 87.0, 9.0, -269.0, 149.0, 213.0, 150.0, -41.0, 360.0, -6.0, 111.0, 28.0, 186.0, 199.0, 86.0, 0.0, -1.0, 120.0, 201.0, 85.0, 140.0, 130.0, 80.0, 257.0, 197.0, 336.0, 17.0, 179.0, 247.0, 172.0, -178.0, -335.0, 111.0, 290.0, 320.0, -2.0, 140.0, 0.0, 41.0, 262.0, 268.0, 276.0, 237.0, 54.0, 323.0, 186.0, 168.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [81.0, 170.0, -37.0, -143.0, -6.0, 0.0, 65.0, 200.0, -57.0, -146.0, -38.0, 8.0, -178.0, 0.0, 128.0, -198.0, 34.0, 200.0, 125.0, 112.0, 189.0, 142.0, 171.0, 145.0, -41.0, 184.0, 136.0, 88.0, 0.0, -61.0, 0.0, 101.0, 0.0, 9.0, -32.0, -154.0, 85.0, -145.0, 0.0, 194.0, -92.0, -22.0, -216.0, 151.0, 0.0, -106.0, -696.0, -566.0, 35.0, 65.0, 173.0, -259.0, -19.0, -92.0, -85.0, -67.0, -326.0, 0.0, 92.0, 144.0, 0.0, -28.0, -130.0, 70.0, 164.0, -134.0, 35.0, 0.0, 0.0, 77.0, 0.0, -13.0, -25.0, -502.0, 0.0, 0.0, 161.0, 32.0, -148.0, 0.0, -340.0, -145.0, -56.0, 0.0, -220.0, 128.0, -201.0, -16.0, -188.0, 134.0, 101.0, -38.0, -160.0, -223.0, 0.0, 135.0, -268.0, 139.0, 199.0, 148.0, 0.0, -14.0, 185.0, -166.0, 0.0, -358.0, 81.0, 0.0, -53.0, -73.0, -188.0, -180.0, -88.0, 193.0, 186.0, -122.0, 137.0, 0.0, 0.0, -116.0, 164.0, 194.0, 0.0, -12.0, 0.0, 68.0, -90.0, 14.0, 0.0, 185.0, 62.0, 88.0, -22.0, -64.0, 0.0, 0.0, -2.0, 0.0, 109.0, 0.0, 149.0, -6.0, -29.0, 65.0, 191.0, -108.0, 0.0, 109.0, -7.0, 0.0, 124.0, 23.0, -2.0, 197.0, 194.0, 123.0, -61.0, -64.0, 169.0, 0.0, 99.0, 65.0, 0.0, 165.0, -390.0, 12.0, -246.0, -324.0, 2.0, 24.0, 147.0, 104.0, 141.0, 165.0, 0.0, -168.0, 101.0, 0.0, 0.0, 0.0, 95.0, -174.0, 193.0, 67.0, 106.0, 162.0, 79.0, 140.0, 173.0, 21.0, 63.0, -18.0, 121.0, 197.0, 179.0, 0.0, 0.0, 162.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 119.0, 0.0, 3.0, 9.0, 12.0, 153.0, 61.0, 38.0, 80.0, 53.0, 89.0, 0.0, 140.0, 28.0, 9.0, 31.0, 0.0, 18.0, 3.0, 0.0, 12.0, 15.0, 65.0, 23.0, 28.0, 79.0, 29.0, 32.0, 0.0, 30.0, 47.0, 87.0, 0.0, 67.0, 58.0, 2.0, 0.0, 78.0, 21.0, 108.0, 0.0, 95.0, 49.0, 704.0, 0.0, 0.0, 72.0, 93.0, 116.0, 88.0, 46.0, 41.0, 117.0, 119.0, 162.0, 47.0, 5.0, 0.0, 14.0, 120.0, 8.0, 8.0, 72.0, 53.0, 36.0, 10.0, 12.0, 0.0, 71.0, 75.0, 376.0, 0.0, 0.0, 33.0, 30.0, 43.0, 114.0, 175.0, 134.0, 24.0, 71.0, 110.0, 131.0, 114.0, 120.0, 22.0, 94.0, 19.0, 33.0, 167.0, 0.0, 12.0, 7.0, 49.0, 105.0, 17.0, 0.0, 0.0, 7.0, 93.0, 0.0, 58.0, 176.0, 0.0, 6.0, 73.0, 62.0, 99.0, 0.0, 44.0, 0.0, 71.0, 78.0, 13.0, 0.0, 12.0, 63.0, 0.0, 2.0, 6.0, 0.0, 43.0, 0.0, 45.0, 59.0, 1.0, 0.0, 28.0, 21.0, 84.0, 88.0, 0.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 58.0, 44.0, 5.0, 3.0, 54.0, 10.0, 11.0, 22.0, 65.0, 55.0, 55.0, 2.0, 0.0, 0.0, 19.0, 64.0, 78.0, 10.0, 0.0, 41.0, 42.0, 1.0, 6.0, 200.0, 0.0, 0.0, 235.0, 39.0, 46.0, 25.0, 14.0, 14.0, 0.0, 109.0, 57.0, 15.0, 24.0, 0.0, 0.0, 87.0, 33.0, 0.0, 2.0, 0.0, 0.0, 46.0, 11.0, 17.0, 26.0, 9.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.005407237766275, "mean_inference_ms": 2.6353113489852062, "mean_action_processing_ms": 0.39634022549285564, "mean_env_wait_ms": 0.36153383422201346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065937042236328125, "StateBufferConnector_ms": 0.012171506881713867, "ViewRequirementAgentConnector_ms": 0.30568158626556396}, "num_episodes": 18, "episode_return_max": 364.0, "episode_return_min": -558.0, "episode_return_mean": 95.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.9852179957661, "num_env_steps_trained_throughput_per_sec": 258.9852179957661, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 14788.664, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14788.566, "sample_time_ms": 2352.831, "learn_time_ms": 12411.37, "learn_throughput": 322.285, "synch_weights_time_ms": 21.033}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "f1691_00000", "date": "2024-08-13_16-42-26", "timestamp": 1723581746, "time_this_iter_s": 15.502887964248657, "time_total_s": 241.20610976219177, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 241.20610976219177, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 79.28636363636365, "ram_util_percent": 86.45909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6284384891075432, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.263598240557171, "policy_loss": -0.0025155649269147525, "vf_loss": 1.2557743036084705, "vf_explained_var": 0.008208509065486766, "kl": 0.015317781291628427, "entropy": 1.4189466454364634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.974644914379827, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.705339962212497, "policy_loss": -0.0003710381962634899, "vf_loss": 4.651073861626721, "vf_explained_var": 0.39976975797976133, "kl": 0.015988923636929938, "entropy": 1.4395136256697316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 364.0, "episode_reward_min": -558.0, "episode_reward_mean": 88.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -696.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 704.0}, "policy_reward_mean": {"prey_policy": 3.53, "predator_policy": 40.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 196.0, -15.0, 43.0, 38.0, -558.0, 172.0, 123.0, 23.0, 6.0, -45.0, 288.0, -14.0, 68.0, 110.0, 124.0, 99.0, 58.0, -76.0, 0.0, 256.0, 9.0, -176.0, 39.0, 149.0, 17.0, 62.0, 115.0, -216.0, 154.0, 25.0, 364.0, -7.0, 112.0, -124.0, 87.0, 9.0, -269.0, 149.0, 213.0, 150.0, -41.0, 360.0, -6.0, 111.0, 28.0, 186.0, 199.0, 86.0, 0.0, -1.0, 120.0, 201.0, 85.0, 140.0, 130.0, 80.0, 257.0, 197.0, 336.0, 17.0, 179.0, 247.0, 172.0, -178.0, -335.0, 111.0, 290.0, 320.0, -2.0, 140.0, 0.0, 41.0, 262.0, 268.0, 276.0, 237.0, 54.0, 323.0, 186.0, 168.0, 0.0, 201.0, 122.0, -42.0, 197.0, 199.0, -32.0, 194.0, -77.0, 124.0, 83.0, 22.0, 169.0, 194.0, 191.0, -212.0, 228.0, 153.0, 91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, -145.0, 0.0, 194.0, -92.0, -22.0, -216.0, 151.0, 0.0, -106.0, -696.0, -566.0, 35.0, 65.0, 173.0, -259.0, -19.0, -92.0, -85.0, -67.0, -326.0, 0.0, 92.0, 144.0, 0.0, -28.0, -130.0, 70.0, 164.0, -134.0, 35.0, 0.0, 0.0, 77.0, 0.0, -13.0, -25.0, -502.0, 0.0, 0.0, 161.0, 32.0, -148.0, 0.0, -340.0, -145.0, -56.0, 0.0, -220.0, 128.0, -201.0, -16.0, -188.0, 134.0, 101.0, -38.0, -160.0, -223.0, 0.0, 135.0, -268.0, 139.0, 199.0, 148.0, 0.0, -14.0, 185.0, -166.0, 0.0, -358.0, 81.0, 0.0, -53.0, -73.0, -188.0, -180.0, -88.0, 193.0, 186.0, -122.0, 137.0, 0.0, 0.0, -116.0, 164.0, 194.0, 0.0, -12.0, 0.0, 68.0, -90.0, 14.0, 0.0, 185.0, 62.0, 88.0, -22.0, -64.0, 0.0, 0.0, -2.0, 0.0, 109.0, 0.0, 149.0, -6.0, -29.0, 65.0, 191.0, -108.0, 0.0, 109.0, -7.0, 0.0, 124.0, 23.0, -2.0, 197.0, 194.0, 123.0, -61.0, -64.0, 169.0, 0.0, 99.0, 65.0, 0.0, 165.0, -390.0, 12.0, -246.0, -324.0, 2.0, 24.0, 147.0, 104.0, 141.0, 165.0, 0.0, -168.0, 101.0, 0.0, 0.0, 0.0, 95.0, -174.0, 193.0, 67.0, 106.0, 162.0, 79.0, 140.0, 173.0, 21.0, 63.0, -18.0, 121.0, 197.0, 179.0, 0.0, 0.0, 162.0, 0.0, 0.0, 111.0, 51.0, 0.0, 80.0, -53.0, -32.0, 10.0, 157.0, -2.0, 200.0, -58.0, -6.0, 0.0, 194.0, -72.0, -82.0, 0.0, 77.0, 16.0, 0.0, 0.0, -49.0, 154.0, 0.0, -15.0, 174.0, 0.0, 190.0, -244.0, -96.0, 87.0, 141.0, -1.0, 126.0, 0.0, 64.0], "policy_predator_policy_reward": [67.0, 58.0, 2.0, 0.0, 78.0, 21.0, 108.0, 0.0, 95.0, 49.0, 704.0, 0.0, 0.0, 72.0, 93.0, 116.0, 88.0, 46.0, 41.0, 117.0, 119.0, 162.0, 47.0, 5.0, 0.0, 14.0, 120.0, 8.0, 8.0, 72.0, 53.0, 36.0, 10.0, 12.0, 0.0, 71.0, 75.0, 376.0, 0.0, 0.0, 33.0, 30.0, 43.0, 114.0, 175.0, 134.0, 24.0, 71.0, 110.0, 131.0, 114.0, 120.0, 22.0, 94.0, 19.0, 33.0, 167.0, 0.0, 12.0, 7.0, 49.0, 105.0, 17.0, 0.0, 0.0, 7.0, 93.0, 0.0, 58.0, 176.0, 0.0, 6.0, 73.0, 62.0, 99.0, 0.0, 44.0, 0.0, 71.0, 78.0, 13.0, 0.0, 12.0, 63.0, 0.0, 2.0, 6.0, 0.0, 43.0, 0.0, 45.0, 59.0, 1.0, 0.0, 28.0, 21.0, 84.0, 88.0, 0.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 58.0, 44.0, 5.0, 3.0, 54.0, 10.0, 11.0, 22.0, 65.0, 55.0, 55.0, 2.0, 0.0, 0.0, 19.0, 64.0, 78.0, 10.0, 0.0, 41.0, 42.0, 1.0, 6.0, 200.0, 0.0, 0.0, 235.0, 39.0, 46.0, 25.0, 14.0, 14.0, 0.0, 109.0, 57.0, 15.0, 24.0, 0.0, 0.0, 87.0, 33.0, 0.0, 2.0, 0.0, 0.0, 46.0, 11.0, 17.0, 26.0, 9.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 39.0, 0.0, 29.0, 13.0, 16.0, 27.0, 27.0, 3.0, 1.0, 0.0, 29.0, 3.0, 0.0, 0.0, 41.0, 36.0, 8.0, 39.0, 54.0, 13.0, 25.0, 46.0, 0.0, 15.0, 31.0, 4.0, 1.0, 0.0, 3.0, 125.0, 0.0, 0.0, 12.0, 16.0, 27.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0294612965233272, "mean_inference_ms": 2.6910101017081263, "mean_action_processing_ms": 0.4027958122540468, "mean_env_wait_ms": 0.36816960748498034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007733464241027832, "StateBufferConnector_ms": 0.011091351509094238, "ViewRequirementAgentConnector_ms": 0.30219829082489014}, "num_episodes": 18, "episode_return_max": 364.0, "episode_return_min": -558.0, "episode_return_mean": 88.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.6029561101992, "num_env_steps_trained_throughput_per_sec": 262.6029561101992, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 14891.513, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14891.401, "sample_time_ms": 2348.307, "learn_time_ms": 12518.823, "learn_throughput": 319.519, "synch_weights_time_ms": 20.716}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "f1691_00000", "date": "2024-08-13_16-42-42", "timestamp": 1723581762, "time_this_iter_s": 15.302477836608887, "time_total_s": 256.50858759880066, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c1be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 256.50858759880066, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 79.72857142857143, "ram_util_percent": 86.07619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0159073644844943, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.8421483217723786, "policy_loss": -0.00307081903099383, "vf_loss": 1.833429322671638, "vf_explained_var": 0.024860859484899613, "kl": 0.01746640127225223, "entropy": 1.4122111165334308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7123778859774275, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 5.215083500947902, "policy_loss": 0.0004762888684001549, "vf_loss": 5.153096595895353, "vf_explained_var": 0.35402613256974197, "kl": 0.018000364716817267, "entropy": 1.4217788311539503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 364.0, "episode_reward_min": -335.0, "episode_reward_mean": 103.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -488.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 364.0}, "policy_reward_mean": {"prey_policy": 21.265, "predator_policy": 30.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.0, 39.0, 149.0, 17.0, 62.0, 115.0, -216.0, 154.0, 25.0, 364.0, -7.0, 112.0, -124.0, 87.0, 9.0, -269.0, 149.0, 213.0, 150.0, -41.0, 360.0, -6.0, 111.0, 28.0, 186.0, 199.0, 86.0, 0.0, -1.0, 120.0, 201.0, 85.0, 140.0, 130.0, 80.0, 257.0, 197.0, 336.0, 17.0, 179.0, 247.0, 172.0, -178.0, -335.0, 111.0, 290.0, 320.0, -2.0, 140.0, 0.0, 41.0, 262.0, 268.0, 276.0, 237.0, 54.0, 323.0, 186.0, 168.0, 0.0, 201.0, 122.0, -42.0, 197.0, 199.0, -32.0, 194.0, -77.0, 124.0, 83.0, 22.0, 169.0, 194.0, 191.0, -212.0, 228.0, 153.0, 91.0, 267.0, 5.0, 97.0, 231.0, 18.0, 107.0, 122.0, -61.0, 178.0, 126.0, 142.0, 41.0, 16.0, 175.0, 87.0, 57.0, 0.0, 208.0, -65.0, 287.0, 250.0, 147.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-340.0, -145.0, -56.0, 0.0, -220.0, 128.0, -201.0, -16.0, -188.0, 134.0, 101.0, -38.0, -160.0, -223.0, 0.0, 135.0, -268.0, 139.0, 199.0, 148.0, 0.0, -14.0, 185.0, -166.0, 0.0, -358.0, 81.0, 0.0, -53.0, -73.0, -188.0, -180.0, -88.0, 193.0, 186.0, -122.0, 137.0, 0.0, 0.0, -116.0, 164.0, 194.0, 0.0, -12.0, 0.0, 68.0, -90.0, 14.0, 0.0, 185.0, 62.0, 88.0, -22.0, -64.0, 0.0, 0.0, -2.0, 0.0, 109.0, 0.0, 149.0, -6.0, -29.0, 65.0, 191.0, -108.0, 0.0, 109.0, -7.0, 0.0, 124.0, 23.0, -2.0, 197.0, 194.0, 123.0, -61.0, -64.0, 169.0, 0.0, 99.0, 65.0, 0.0, 165.0, -390.0, 12.0, -246.0, -324.0, 2.0, 24.0, 147.0, 104.0, 141.0, 165.0, 0.0, -168.0, 101.0, 0.0, 0.0, 0.0, 95.0, -174.0, 193.0, 67.0, 106.0, 162.0, 79.0, 140.0, 173.0, 21.0, 63.0, -18.0, 121.0, 197.0, 179.0, 0.0, 0.0, 162.0, 0.0, 0.0, 111.0, 51.0, 0.0, 80.0, -53.0, -32.0, 10.0, 157.0, -2.0, 200.0, -58.0, -6.0, 0.0, 194.0, -72.0, -82.0, 0.0, 77.0, 16.0, 0.0, 0.0, -49.0, 154.0, 0.0, -15.0, 174.0, 0.0, 190.0, -244.0, -96.0, 87.0, 141.0, -1.0, 126.0, 0.0, 64.0, 159.0, 90.0, 0.0, 5.0, 16.0, 0.0, 59.0, 87.0, -6.0, 6.0, 4.0, 32.0, 108.0, 0.0, 39.0, -488.0, 27.0, 116.0, 33.0, 74.0, 0.0, 119.0, 27.0, -14.0, 15.0, 0.0, 179.0, -10.0, 42.0, 0.0, -58.0, 0.0, 0.0, 0.0, 59.0, 92.0, -28.0, -78.0, 134.0, 131.0, 148.0, 92.0, 0.0, 143.0], "policy_predator_policy_reward": [175.0, 134.0, 24.0, 71.0, 110.0, 131.0, 114.0, 120.0, 22.0, 94.0, 19.0, 33.0, 167.0, 0.0, 12.0, 7.0, 49.0, 105.0, 17.0, 0.0, 0.0, 7.0, 93.0, 0.0, 58.0, 176.0, 0.0, 6.0, 73.0, 62.0, 99.0, 0.0, 44.0, 0.0, 71.0, 78.0, 13.0, 0.0, 12.0, 63.0, 0.0, 2.0, 6.0, 0.0, 43.0, 0.0, 45.0, 59.0, 1.0, 0.0, 28.0, 21.0, 84.0, 88.0, 0.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 58.0, 44.0, 5.0, 3.0, 54.0, 10.0, 11.0, 22.0, 65.0, 55.0, 55.0, 2.0, 0.0, 0.0, 19.0, 64.0, 78.0, 10.0, 0.0, 41.0, 42.0, 1.0, 6.0, 200.0, 0.0, 0.0, 235.0, 39.0, 46.0, 25.0, 14.0, 14.0, 0.0, 109.0, 57.0, 15.0, 24.0, 0.0, 0.0, 87.0, 33.0, 0.0, 2.0, 0.0, 0.0, 46.0, 11.0, 17.0, 26.0, 9.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 39.0, 0.0, 29.0, 13.0, 16.0, 27.0, 27.0, 3.0, 1.0, 0.0, 29.0, 3.0, 0.0, 0.0, 41.0, 36.0, 8.0, 39.0, 54.0, 13.0, 25.0, 46.0, 0.0, 15.0, 31.0, 4.0, 1.0, 0.0, 3.0, 125.0, 0.0, 0.0, 12.0, 16.0, 27.0, 0.0, 0.0, 18.0, 0.0, 0.0, 36.0, 45.0, 34.0, 51.0, 2.0, 16.0, 42.0, 29.0, 0.0, 14.0, 24.0, 364.0, 1.0, 34.0, 4.0, 15.0, 2.0, 21.0, 0.0, 28.0, 1.0, 0.0, 5.0, 1.0, 18.0, 27.0, 73.0, 42.0, 0.0, 0.0, 39.0, 18.0, 0.0, 41.0, 0.0, 22.0, 0.0, 10.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0438457120049263, "mean_inference_ms": 2.7268447970128022, "mean_action_processing_ms": 0.4065904417760386, "mean_env_wait_ms": 0.370886977351104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005645275115966797, "StateBufferConnector_ms": 0.0036009550094604492, "ViewRequirementAgentConnector_ms": 0.234674334526062}, "num_episodes": 22, "episode_return_max": 364.0, "episode_return_min": -335.0, "episode_return_mean": 103.37, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.52588667909583, "num_env_steps_trained_throughput_per_sec": 256.52588667909583, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 14956.402, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14956.303, "sample_time_ms": 2417.757, "learn_time_ms": 12514.633, "learn_throughput": 319.626, "synch_weights_time_ms": 20.344}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "f1691_00000", "date": "2024-08-13_16-42-57", "timestamp": 1723581777, "time_this_iter_s": 15.649394035339355, "time_total_s": 272.15798163414, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c1b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 272.15798163414, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 78.65652173913043, "ram_util_percent": 86.31739130434782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7886280966104654, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.2958116995909856, "policy_loss": -0.00045370899323157217, "vf_loss": 1.2860711836467975, "vf_explained_var": 0.017005195472606274, "kl": 0.015102556032620403, "entropy": 1.455649667063718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.675163986695506, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.1138737529673906, "policy_loss": 0.0017850253352816538, "vf_loss": 4.049414326904943, "vf_explained_var": 0.12903008606068042, "kl": 0.018340930400198772, "entropy": 1.392127771541555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -335.0, "episode_reward_mean": 111.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -656.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 518.0}, "policy_reward_mean": {"prey_policy": 31.53, "predator_policy": 24.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 186.0, 199.0, 86.0, 0.0, -1.0, 120.0, 201.0, 85.0, 140.0, 130.0, 80.0, 257.0, 197.0, 336.0, 17.0, 179.0, 247.0, 172.0, -178.0, -335.0, 111.0, 290.0, 320.0, -2.0, 140.0, 0.0, 41.0, 262.0, 268.0, 276.0, 237.0, 54.0, 323.0, 186.0, 168.0, 0.0, 201.0, 122.0, -42.0, 197.0, 199.0, -32.0, 194.0, -77.0, 124.0, 83.0, 22.0, 169.0, 194.0, 191.0, -212.0, 228.0, 153.0, 91.0, 267.0, 5.0, 97.0, 231.0, 18.0, 107.0, 122.0, -61.0, 178.0, 126.0, 142.0, 41.0, 16.0, 175.0, 87.0, 57.0, 0.0, 208.0, -65.0, 287.0, 250.0, 147.0, 255.0, -142.0, 132.0, 96.0, 147.0, 132.0, 18.0, 201.0, 105.0, 21.0, 23.0, 157.0, 101.0, -14.0, 174.0, 123.0, 1.0, 131.0, 119.0, 72.0, 97.0, -4.0, 121.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.0, 14.0, 0.0, 185.0, 62.0, 88.0, -22.0, -64.0, 0.0, 0.0, -2.0, 0.0, 109.0, 0.0, 149.0, -6.0, -29.0, 65.0, 191.0, -108.0, 0.0, 109.0, -7.0, 0.0, 124.0, 23.0, -2.0, 197.0, 194.0, 123.0, -61.0, -64.0, 169.0, 0.0, 99.0, 65.0, 0.0, 165.0, -390.0, 12.0, -246.0, -324.0, 2.0, 24.0, 147.0, 104.0, 141.0, 165.0, 0.0, -168.0, 101.0, 0.0, 0.0, 0.0, 95.0, -174.0, 193.0, 67.0, 106.0, 162.0, 79.0, 140.0, 173.0, 21.0, 63.0, -18.0, 121.0, 197.0, 179.0, 0.0, 0.0, 162.0, 0.0, 0.0, 111.0, 51.0, 0.0, 80.0, -53.0, -32.0, 10.0, 157.0, -2.0, 200.0, -58.0, -6.0, 0.0, 194.0, -72.0, -82.0, 0.0, 77.0, 16.0, 0.0, 0.0, -49.0, 154.0, 0.0, -15.0, 174.0, 0.0, 190.0, -244.0, -96.0, 87.0, 141.0, -1.0, 126.0, 0.0, 64.0, 159.0, 90.0, 0.0, 5.0, 16.0, 0.0, 59.0, 87.0, -6.0, 6.0, 4.0, 32.0, 108.0, 0.0, 39.0, -488.0, 27.0, 116.0, 33.0, 74.0, 0.0, 119.0, 27.0, -14.0, 15.0, 0.0, 179.0, -10.0, 42.0, 0.0, -58.0, 0.0, 0.0, 0.0, 59.0, 92.0, -28.0, -78.0, 134.0, 131.0, 148.0, 92.0, 0.0, 143.0, 67.0, 186.0, -656.0, -15.0, 97.0, 0.0, 96.0, 0.0, 0.0, 141.0, 39.0, 81.0, 0.0, -11.0, 135.0, 47.0, 13.0, 0.0, 9.0, 0.0, 0.0, -19.0, 172.0, -30.0, 95.0, 0.0, 0.0, -28.0, 0.0, 174.0, -98.0, 128.0, 0.0, 1.0, 88.0, 5.0, 64.0, 53.0, 33.0, -3.0, 63.0, 0.0, -8.0, 0.0, 101.0, 0.0], "policy_predator_policy_reward": [45.0, 59.0, 1.0, 0.0, 28.0, 21.0, 84.0, 88.0, 0.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 58.0, 44.0, 5.0, 3.0, 54.0, 10.0, 11.0, 22.0, 65.0, 55.0, 55.0, 2.0, 0.0, 0.0, 19.0, 64.0, 78.0, 10.0, 0.0, 41.0, 42.0, 1.0, 6.0, 200.0, 0.0, 0.0, 235.0, 39.0, 46.0, 25.0, 14.0, 14.0, 0.0, 109.0, 57.0, 15.0, 24.0, 0.0, 0.0, 87.0, 33.0, 0.0, 2.0, 0.0, 0.0, 46.0, 11.0, 17.0, 26.0, 9.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 39.0, 0.0, 29.0, 13.0, 16.0, 27.0, 27.0, 3.0, 1.0, 0.0, 29.0, 3.0, 0.0, 0.0, 41.0, 36.0, 8.0, 39.0, 54.0, 13.0, 25.0, 46.0, 0.0, 15.0, 31.0, 4.0, 1.0, 0.0, 3.0, 125.0, 0.0, 0.0, 12.0, 16.0, 27.0, 0.0, 0.0, 18.0, 0.0, 0.0, 36.0, 45.0, 34.0, 51.0, 2.0, 16.0, 42.0, 29.0, 0.0, 14.0, 24.0, 364.0, 1.0, 34.0, 4.0, 15.0, 2.0, 21.0, 0.0, 28.0, 1.0, 0.0, 5.0, 1.0, 18.0, 27.0, 73.0, 42.0, 0.0, 0.0, 39.0, 18.0, 0.0, 41.0, 0.0, 22.0, 0.0, 10.0, 4.0, 0.0, 2.0, 0.0, 11.0, 518.0, 20.0, 15.0, 0.0, 0.0, 6.0, 0.0, 3.0, 9.0, 29.0, 0.0, 0.0, 19.0, 34.0, 58.0, 12.0, 0.0, 18.0, 24.0, 0.0, 15.0, 6.0, 0.0, 14.0, 0.0, 0.0, 0.0, 24.0, 69.0, 0.0, 0.0, 38.0, 0.0, 0.0, 2.0, 18.0, 24.0, 4.0, 30.0, 0.0, 4.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0468886235885606, "mean_inference_ms": 2.7279416590340655, "mean_action_processing_ms": 0.4070812648480253, "mean_env_wait_ms": 0.3707704338594954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058678388595581055, "StateBufferConnector_ms": 0.0038323402404785156, "ViewRequirementAgentConnector_ms": 0.17313122749328613}, "num_episodes": 23, "episode_return_max": 336.0, "episode_return_min": -335.0, "episode_return_mean": 111.26, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6847066388919, "num_env_steps_trained_throughput_per_sec": 288.6847066388919, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 14831.514, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14831.415, "sample_time_ms": 2428.439, "learn_time_ms": 12378.786, "learn_throughput": 323.133, "synch_weights_time_ms": 20.459}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "f1691_00000", "date": "2024-08-13_16-43-11", "timestamp": 1723581791, "time_this_iter_s": 13.918846368789673, "time_total_s": 286.0768280029297, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 286.0768280029297, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 77.49473684210527, "ram_util_percent": 86.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7010963735441682, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.7875923458545928, "policy_loss": -0.004127525887821638, "vf_loss": 1.7800500414989613, "vf_explained_var": 0.012871759341507362, "kl": 0.017288633741550954, "entropy": 1.4632779871975934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.044330013681341, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.420917959188027, "policy_loss": 0.001504075099719028, "vf_loss": 4.366391036245558, "vf_explained_var": 0.07792126208386094, "kl": 0.015516518628921672, "entropy": 1.382174538115345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 323.0, "episode_reward_min": -554.0, "episode_reward_mean": 89.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -656.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 518.0}, "policy_reward_mean": {"prey_policy": 19.64, "predator_policy": 24.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.0, -178.0, -335.0, 111.0, 290.0, 320.0, -2.0, 140.0, 0.0, 41.0, 262.0, 268.0, 276.0, 237.0, 54.0, 323.0, 186.0, 168.0, 0.0, 201.0, 122.0, -42.0, 197.0, 199.0, -32.0, 194.0, -77.0, 124.0, 83.0, 22.0, 169.0, 194.0, 191.0, -212.0, 228.0, 153.0, 91.0, 267.0, 5.0, 97.0, 231.0, 18.0, 107.0, 122.0, -61.0, 178.0, 126.0, 142.0, 41.0, 16.0, 175.0, 87.0, 57.0, 0.0, 208.0, -65.0, 287.0, 250.0, 147.0, 255.0, -142.0, 132.0, 96.0, 147.0, 132.0, 18.0, 201.0, 105.0, 21.0, 23.0, 157.0, 101.0, -14.0, 174.0, 123.0, 1.0, 131.0, 119.0, 72.0, 97.0, -4.0, 121.0, 74.0, 44.0, 141.0, -554.0, 75.0, 242.0, -40.0, 0.0, -2.0, 19.0, 54.0, -33.0, -17.0, 97.0, 0.0, 68.0, 120.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 165.0, -390.0, 12.0, -246.0, -324.0, 2.0, 24.0, 147.0, 104.0, 141.0, 165.0, 0.0, -168.0, 101.0, 0.0, 0.0, 0.0, 95.0, -174.0, 193.0, 67.0, 106.0, 162.0, 79.0, 140.0, 173.0, 21.0, 63.0, -18.0, 121.0, 197.0, 179.0, 0.0, 0.0, 162.0, 0.0, 0.0, 111.0, 51.0, 0.0, 80.0, -53.0, -32.0, 10.0, 157.0, -2.0, 200.0, -58.0, -6.0, 0.0, 194.0, -72.0, -82.0, 0.0, 77.0, 16.0, 0.0, 0.0, -49.0, 154.0, 0.0, -15.0, 174.0, 0.0, 190.0, -244.0, -96.0, 87.0, 141.0, -1.0, 126.0, 0.0, 64.0, 159.0, 90.0, 0.0, 5.0, 16.0, 0.0, 59.0, 87.0, -6.0, 6.0, 4.0, 32.0, 108.0, 0.0, 39.0, -488.0, 27.0, 116.0, 33.0, 74.0, 0.0, 119.0, 27.0, -14.0, 15.0, 0.0, 179.0, -10.0, 42.0, 0.0, -58.0, 0.0, 0.0, 0.0, 59.0, 92.0, -28.0, -78.0, 134.0, 131.0, 148.0, 92.0, 0.0, 143.0, 67.0, 186.0, -656.0, -15.0, 97.0, 0.0, 96.0, 0.0, 0.0, 141.0, 39.0, 81.0, 0.0, -11.0, 135.0, 47.0, 13.0, 0.0, 9.0, 0.0, 0.0, -19.0, 172.0, -30.0, 95.0, 0.0, 0.0, -28.0, 0.0, 174.0, -98.0, 128.0, 0.0, 1.0, 88.0, 5.0, 64.0, 53.0, 33.0, -3.0, 63.0, 0.0, -8.0, 0.0, 101.0, 0.0, 0.0, 62.0, 0.0, -9.0, 45.0, 96.0, -550.0, -522.0, 71.0, -6.0, 115.0, 88.0, -185.0, -7.0, 0.0, 0.0, -51.0, 15.0, -1.0, 0.0, 22.0, 8.0, 0.0, -89.0, -34.0, 0.0, 138.0, -110.0, 0.0, 0.0, 0.0, 68.0, 70.0, 24.0, -21.0, -104.0], "policy_predator_policy_reward": [1.0, 6.0, 200.0, 0.0, 0.0, 235.0, 39.0, 46.0, 25.0, 14.0, 14.0, 0.0, 109.0, 57.0, 15.0, 24.0, 0.0, 0.0, 87.0, 33.0, 0.0, 2.0, 0.0, 0.0, 46.0, 11.0, 17.0, 26.0, 9.0, 0.0, 0.0, 5.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 39.0, 0.0, 29.0, 13.0, 16.0, 27.0, 27.0, 3.0, 1.0, 0.0, 29.0, 3.0, 0.0, 0.0, 41.0, 36.0, 8.0, 39.0, 54.0, 13.0, 25.0, 46.0, 0.0, 15.0, 31.0, 4.0, 1.0, 0.0, 3.0, 125.0, 0.0, 0.0, 12.0, 16.0, 27.0, 0.0, 0.0, 18.0, 0.0, 0.0, 36.0, 45.0, 34.0, 51.0, 2.0, 16.0, 42.0, 29.0, 0.0, 14.0, 24.0, 364.0, 1.0, 34.0, 4.0, 15.0, 2.0, 21.0, 0.0, 28.0, 1.0, 0.0, 5.0, 1.0, 18.0, 27.0, 73.0, 42.0, 0.0, 0.0, 39.0, 18.0, 0.0, 41.0, 0.0, 22.0, 0.0, 10.0, 4.0, 0.0, 2.0, 0.0, 11.0, 518.0, 20.0, 15.0, 0.0, 0.0, 6.0, 0.0, 3.0, 9.0, 29.0, 0.0, 0.0, 19.0, 34.0, 58.0, 12.0, 0.0, 18.0, 24.0, 0.0, 15.0, 6.0, 0.0, 14.0, 0.0, 0.0, 0.0, 24.0, 69.0, 0.0, 0.0, 38.0, 0.0, 0.0, 2.0, 18.0, 24.0, 4.0, 30.0, 0.0, 4.0, 20.0, 0.0, 12.0, 0.0, 18.0, 35.0, 0.0, 0.0, 0.0, 518.0, 0.0, 10.0, 38.0, 1.0, 152.0, 0.0, 0.0, 0.0, 0.0, 34.0, 0.0, 20.0, 21.0, 3.0, 39.0, 17.0, 17.0, 0.0, 55.0, 14.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 97.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0451304955663467, "mean_inference_ms": 2.7261348076912766, "mean_action_processing_ms": 0.40707169039953917, "mean_env_wait_ms": 0.370485655130433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058286190032958984, "StateBufferConnector_ms": 0.0037305355072021484, "ViewRequirementAgentConnector_ms": 0.1528686285018921}, "num_episodes": 18, "episode_return_max": 323.0, "episode_return_min": -554.0, "episode_return_mean": 89.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.0268323995194, "num_env_steps_trained_throughput_per_sec": 279.0268323995194, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 14798.213, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14798.113, "sample_time_ms": 2415.349, "learn_time_ms": 12358.558, "learn_throughput": 323.662, "synch_weights_time_ms": 20.426}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "f1691_00000", "date": "2024-08-13_16-43-26", "timestamp": 1723581806, "time_this_iter_s": 14.39084529876709, "time_total_s": 300.4676733016968, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 300.4676733016968, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 77.00952380952381, "ram_util_percent": 86.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8286647280214956, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.246245234731644, "policy_loss": -0.0022334107137457642, "vf_loss": 2.237476443014448, "vf_explained_var": 0.015687938152797638, "kl": 0.016299555269775657, "entropy": 1.4512129987989153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.391623344055559, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.048902895210912, "policy_loss": 0.0027550152509113546, "vf_loss": 3.9901340190695707, "vf_explained_var": 0.023492505373778165, "kl": 0.01639180225136387, "entropy": 1.3629944569219357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 287.0, "episode_reward_min": -554.0, "episode_reward_mean": 69.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -656.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 518.0}, "policy_reward_mean": {"prey_policy": 8.12, "predator_policy": 26.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 201.0, 122.0, -42.0, 197.0, 199.0, -32.0, 194.0, -77.0, 124.0, 83.0, 22.0, 169.0, 194.0, 191.0, -212.0, 228.0, 153.0, 91.0, 267.0, 5.0, 97.0, 231.0, 18.0, 107.0, 122.0, -61.0, 178.0, 126.0, 142.0, 41.0, 16.0, 175.0, 87.0, 57.0, 0.0, 208.0, -65.0, 287.0, 250.0, 147.0, 255.0, -142.0, 132.0, 96.0, 147.0, 132.0, 18.0, 201.0, 105.0, 21.0, 23.0, 157.0, 101.0, -14.0, 174.0, 123.0, 1.0, 131.0, 119.0, 72.0, 97.0, -4.0, 121.0, 74.0, 44.0, 141.0, -554.0, 75.0, 242.0, -40.0, 0.0, -2.0, 19.0, 54.0, -33.0, -17.0, 97.0, 0.0, 68.0, 120.0, -7.0, 181.0, -175.0, 14.0, -16.0, 53.0, -11.0, 116.0, 9.0, 80.0, 40.0, -83.0, -181.0, 40.0, 51.0, 64.0, 22.0, 100.0, 75.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 111.0, 51.0, 0.0, 80.0, -53.0, -32.0, 10.0, 157.0, -2.0, 200.0, -58.0, -6.0, 0.0, 194.0, -72.0, -82.0, 0.0, 77.0, 16.0, 0.0, 0.0, -49.0, 154.0, 0.0, -15.0, 174.0, 0.0, 190.0, -244.0, -96.0, 87.0, 141.0, -1.0, 126.0, 0.0, 64.0, 159.0, 90.0, 0.0, 5.0, 16.0, 0.0, 59.0, 87.0, -6.0, 6.0, 4.0, 32.0, 108.0, 0.0, 39.0, -488.0, 27.0, 116.0, 33.0, 74.0, 0.0, 119.0, 27.0, -14.0, 15.0, 0.0, 179.0, -10.0, 42.0, 0.0, -58.0, 0.0, 0.0, 0.0, 59.0, 92.0, -28.0, -78.0, 134.0, 131.0, 148.0, 92.0, 0.0, 143.0, 67.0, 186.0, -656.0, -15.0, 97.0, 0.0, 96.0, 0.0, 0.0, 141.0, 39.0, 81.0, 0.0, -11.0, 135.0, 47.0, 13.0, 0.0, 9.0, 0.0, 0.0, -19.0, 172.0, -30.0, 95.0, 0.0, 0.0, -28.0, 0.0, 174.0, -98.0, 128.0, 0.0, 1.0, 88.0, 5.0, 64.0, 53.0, 33.0, -3.0, 63.0, 0.0, -8.0, 0.0, 101.0, 0.0, 0.0, 62.0, 0.0, -9.0, 45.0, 96.0, -550.0, -522.0, 71.0, -6.0, 115.0, 88.0, -185.0, -7.0, 0.0, 0.0, -51.0, 15.0, -1.0, 0.0, 22.0, 8.0, 0.0, -89.0, -34.0, 0.0, 138.0, -110.0, 0.0, 0.0, 0.0, 68.0, 70.0, 24.0, -21.0, -104.0, 39.0, 115.0, -130.0, -164.0, 0.0, 14.0, -28.0, -34.0, -27.0, 45.0, 0.0, -22.0, 97.0, -16.0, -24.0, 0.0, -35.0, 89.0, 27.0, -18.0, -544.0, 9.0, -602.0, -39.0, 40.0, 0.0, 30.0, -22.0, 0.0, 56.0, 6.0, 0.0, 0.0, 85.0, -15.0, 63.0], "policy_predator_policy_reward": [0.0, 0.0, 39.0, 0.0, 29.0, 13.0, 16.0, 27.0, 27.0, 3.0, 1.0, 0.0, 29.0, 3.0, 0.0, 0.0, 41.0, 36.0, 8.0, 39.0, 54.0, 13.0, 25.0, 46.0, 0.0, 15.0, 31.0, 4.0, 1.0, 0.0, 3.0, 125.0, 0.0, 0.0, 12.0, 16.0, 27.0, 0.0, 0.0, 18.0, 0.0, 0.0, 36.0, 45.0, 34.0, 51.0, 2.0, 16.0, 42.0, 29.0, 0.0, 14.0, 24.0, 364.0, 1.0, 34.0, 4.0, 15.0, 2.0, 21.0, 0.0, 28.0, 1.0, 0.0, 5.0, 1.0, 18.0, 27.0, 73.0, 42.0, 0.0, 0.0, 39.0, 18.0, 0.0, 41.0, 0.0, 22.0, 0.0, 10.0, 4.0, 0.0, 2.0, 0.0, 11.0, 518.0, 20.0, 15.0, 0.0, 0.0, 6.0, 0.0, 3.0, 9.0, 29.0, 0.0, 0.0, 19.0, 34.0, 58.0, 12.0, 0.0, 18.0, 24.0, 0.0, 15.0, 6.0, 0.0, 14.0, 0.0, 0.0, 0.0, 24.0, 69.0, 0.0, 0.0, 38.0, 0.0, 0.0, 2.0, 18.0, 24.0, 4.0, 30.0, 0.0, 4.0, 20.0, 0.0, 12.0, 0.0, 18.0, 35.0, 0.0, 0.0, 0.0, 518.0, 0.0, 10.0, 38.0, 1.0, 152.0, 0.0, 0.0, 0.0, 0.0, 34.0, 0.0, 20.0, 21.0, 3.0, 39.0, 17.0, 17.0, 0.0, 55.0, 14.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 97.0, 21.0, 27.0, 0.0, 0.0, 119.0, 0.0, 0.0, 36.0, 10.0, 0.0, 35.0, 11.0, 0.0, 11.0, 24.0, 7.0, 26.0, 26.0, 0.0, 17.0, 14.0, 452.0, 0.0, 14.0, 446.0, 0.0, 0.0, 24.0, 19.0, 0.0, 8.0, 7.0, 9.0, 2.0, 13.0, 27.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.040805781363406, "mean_inference_ms": 2.7196126611566958, "mean_action_processing_ms": 0.4056259321862442, "mean_env_wait_ms": 0.3698004532256674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005945324897766113, "StateBufferConnector_ms": 0.003881216049194336, "ViewRequirementAgentConnector_ms": 0.17227864265441895}, "num_episodes": 18, "episode_return_max": 287.0, "episode_return_min": -554.0, "episode_return_mean": 69.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.06503842103973, "num_env_steps_trained_throughput_per_sec": 271.06503842103973, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 14934.721, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14934.628, "sample_time_ms": 2460.417, "learn_time_ms": 12451.697, "learn_throughput": 321.241, "synch_weights_time_ms": 19.715}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "f1691_00000", "date": "2024-08-13_16-43-41", "timestamp": 1723581821, "time_this_iter_s": 14.8333420753479, "time_total_s": 315.3010153770447, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f99d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 315.3010153770447, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 78.27619047619046, "ram_util_percent": 86.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8444746751160849, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.149798068230745, "policy_loss": -0.001285884234926136, "vf_loss": 2.141113825134499, "vf_explained_var": 0.017413711516314715, "kl": 0.014770560217965838, "entropy": 1.4241687821963476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.462171989710874, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.03101619576651, "policy_loss": 0.0019493163495556151, "vf_loss": 3.976853956999602, "vf_explained_var": 0.010037076567846632, "kl": 0.015279500393244891, "entropy": 1.3157179115310549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 287.0, "episode_reward_min": -554.0, "episode_reward_mean": 45.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -726.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 676.0}, "policy_reward_mean": {"prey_policy": -12.465, "predator_policy": 35.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.0, 267.0, 5.0, 97.0, 231.0, 18.0, 107.0, 122.0, -61.0, 178.0, 126.0, 142.0, 41.0, 16.0, 175.0, 87.0, 57.0, 0.0, 208.0, -65.0, 287.0, 250.0, 147.0, 255.0, -142.0, 132.0, 96.0, 147.0, 132.0, 18.0, 201.0, 105.0, 21.0, 23.0, 157.0, 101.0, -14.0, 174.0, 123.0, 1.0, 131.0, 119.0, 72.0, 97.0, -4.0, 121.0, 74.0, 44.0, 141.0, -554.0, 75.0, 242.0, -40.0, 0.0, -2.0, 19.0, 54.0, -33.0, -17.0, 97.0, 0.0, 68.0, 120.0, -7.0, 181.0, -175.0, 14.0, -16.0, 53.0, -11.0, 116.0, 9.0, 80.0, 40.0, -83.0, -181.0, 40.0, 51.0, 64.0, 22.0, 100.0, 75.0, -89.0, 5.0, -546.0, -16.0, 1.0, -16.0, -42.0, 51.0, 5.0, 36.0, 22.0, -34.0, 54.0, 4.0, -5.0, -77.0, -126.0, 51.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 64.0, 159.0, 90.0, 0.0, 5.0, 16.0, 0.0, 59.0, 87.0, -6.0, 6.0, 4.0, 32.0, 108.0, 0.0, 39.0, -488.0, 27.0, 116.0, 33.0, 74.0, 0.0, 119.0, 27.0, -14.0, 15.0, 0.0, 179.0, -10.0, 42.0, 0.0, -58.0, 0.0, 0.0, 0.0, 59.0, 92.0, -28.0, -78.0, 134.0, 131.0, 148.0, 92.0, 0.0, 143.0, 67.0, 186.0, -656.0, -15.0, 97.0, 0.0, 96.0, 0.0, 0.0, 141.0, 39.0, 81.0, 0.0, -11.0, 135.0, 47.0, 13.0, 0.0, 9.0, 0.0, 0.0, -19.0, 172.0, -30.0, 95.0, 0.0, 0.0, -28.0, 0.0, 174.0, -98.0, 128.0, 0.0, 1.0, 88.0, 5.0, 64.0, 53.0, 33.0, -3.0, 63.0, 0.0, -8.0, 0.0, 101.0, 0.0, 0.0, 62.0, 0.0, -9.0, 45.0, 96.0, -550.0, -522.0, 71.0, -6.0, 115.0, 88.0, -185.0, -7.0, 0.0, 0.0, -51.0, 15.0, -1.0, 0.0, 22.0, 8.0, 0.0, -89.0, -34.0, 0.0, 138.0, -110.0, 0.0, 0.0, 0.0, 68.0, 70.0, 24.0, -21.0, -104.0, 39.0, 115.0, -130.0, -164.0, 0.0, 14.0, -28.0, -34.0, -27.0, 45.0, 0.0, -22.0, 97.0, -16.0, -24.0, 0.0, -35.0, 89.0, 27.0, -18.0, -544.0, 9.0, -602.0, -39.0, 40.0, 0.0, 30.0, -22.0, 0.0, 56.0, 6.0, 0.0, 0.0, 85.0, -15.0, 63.0, -344.0, 8.0, 0.0, -1.0, -544.0, -678.0, -22.0, -10.0, -13.0, 1.0, 0.0, -33.0, -722.0, 99.0, 19.0, 25.0, -84.0, 47.0, 0.0, 36.0, 5.0, 0.0, -47.0, -29.0, -26.0, 65.0, 12.0, -18.0, 0.0, -10.0, -35.0, -84.0, -726.0, 21.0, -1.0, 30.0], "policy_predator_policy_reward": [27.0, 0.0, 0.0, 18.0, 0.0, 0.0, 36.0, 45.0, 34.0, 51.0, 2.0, 16.0, 42.0, 29.0, 0.0, 14.0, 24.0, 364.0, 1.0, 34.0, 4.0, 15.0, 2.0, 21.0, 0.0, 28.0, 1.0, 0.0, 5.0, 1.0, 18.0, 27.0, 73.0, 42.0, 0.0, 0.0, 39.0, 18.0, 0.0, 41.0, 0.0, 22.0, 0.0, 10.0, 4.0, 0.0, 2.0, 0.0, 11.0, 518.0, 20.0, 15.0, 0.0, 0.0, 6.0, 0.0, 3.0, 9.0, 29.0, 0.0, 0.0, 19.0, 34.0, 58.0, 12.0, 0.0, 18.0, 24.0, 0.0, 15.0, 6.0, 0.0, 14.0, 0.0, 0.0, 0.0, 24.0, 69.0, 0.0, 0.0, 38.0, 0.0, 0.0, 2.0, 18.0, 24.0, 4.0, 30.0, 0.0, 4.0, 20.0, 0.0, 12.0, 0.0, 18.0, 35.0, 0.0, 0.0, 0.0, 518.0, 0.0, 10.0, 38.0, 1.0, 152.0, 0.0, 0.0, 0.0, 0.0, 34.0, 0.0, 20.0, 21.0, 3.0, 39.0, 17.0, 17.0, 0.0, 55.0, 14.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 97.0, 21.0, 27.0, 0.0, 0.0, 119.0, 0.0, 0.0, 36.0, 10.0, 0.0, 35.0, 11.0, 0.0, 11.0, 24.0, 7.0, 26.0, 26.0, 0.0, 17.0, 14.0, 452.0, 0.0, 14.0, 446.0, 0.0, 0.0, 24.0, 19.0, 0.0, 8.0, 7.0, 9.0, 2.0, 13.0, 27.0, 0.0, 243.0, 4.0, 0.0, 6.0, 676.0, 0.0, 0.0, 16.0, 12.0, 1.0, 17.0, 0.0, 0.0, 581.0, 7.0, 0.0, 0.0, 42.0, 0.0, 0.0, 17.0, 0.0, 42.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 5.0, 42.0, 0.0, 11.0, 568.0, 3.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0382680195334921, "mean_inference_ms": 2.719940924820025, "mean_action_processing_ms": 0.40520586647432366, "mean_env_wait_ms": 0.3692951150331427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00510096549987793, "StateBufferConnector_ms": 0.011224865913391113, "ViewRequirementAgentConnector_ms": 0.1827702522277832}, "num_episodes": 18, "episode_return_max": 287.0, "episode_return_min": -554.0, "episode_return_mean": 45.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.5268022861423, "num_env_steps_trained_throughput_per_sec": 267.5268022861423, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15056.077, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15055.992, "sample_time_ms": 2420.7, "learn_time_ms": 12615.948, "learn_throughput": 317.059, "synch_weights_time_ms": 16.719}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "f1691_00000", "date": "2024-08-13_16-43-56", "timestamp": 1723581836, "time_this_iter_s": 15.000686168670654, "time_total_s": 330.30170154571533, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 330.30170154571533, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 80.55714285714285, "ram_util_percent": 86.49047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7850604011425897, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.6480357901444511, "policy_loss": -0.0011873211089531502, "vf_loss": 1.6363040614065039, "vf_explained_var": 0.0508215899189944, "kl": 0.019139335673628407, "entropy": 1.4431522433719939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.220259277530448, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.9107713869639804, "policy_loss": 0.002219354191661945, "vf_loss": 2.862356064874659, "vf_explained_var": 0.018346446437179725, "kl": 0.01351871110531113, "entropy": 1.2789786710940971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -554.0, "episode_reward_mean": 5.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -726.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 174.0, "predator_policy": 737.0}, "policy_reward_mean": {"prey_policy": -35.655, "predator_policy": 38.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 132.0, 18.0, 201.0, 105.0, 21.0, 23.0, 157.0, 101.0, -14.0, 174.0, 123.0, 1.0, 131.0, 119.0, 72.0, 97.0, -4.0, 121.0, 74.0, 44.0, 141.0, -554.0, 75.0, 242.0, -40.0, 0.0, -2.0, 19.0, 54.0, -33.0, -17.0, 97.0, 0.0, 68.0, 120.0, -7.0, 181.0, -175.0, 14.0, -16.0, 53.0, -11.0, 116.0, 9.0, 80.0, 40.0, -83.0, -181.0, 40.0, 51.0, 64.0, 22.0, 100.0, 75.0, -89.0, 5.0, -546.0, -16.0, 1.0, -16.0, -42.0, 51.0, 5.0, 36.0, 22.0, -34.0, 54.0, 4.0, -5.0, -77.0, -126.0, 51.0, 21.0, 39.0, -42.0, -464.0, -97.0, 9.0, -186.0, -6.0, 24.0, 37.0, 10.0, 1.0, 16.0, 14.0, 14.0, -131.0, 18.0, -165.0, 39.0, -294.0, -8.0, -4.0, 45.0, 18.0, -47.0, 0.0, -22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 141.0, 39.0, 81.0, 0.0, -11.0, 135.0, 47.0, 13.0, 0.0, 9.0, 0.0, 0.0, -19.0, 172.0, -30.0, 95.0, 0.0, 0.0, -28.0, 0.0, 174.0, -98.0, 128.0, 0.0, 1.0, 88.0, 5.0, 64.0, 53.0, 33.0, -3.0, 63.0, 0.0, -8.0, 0.0, 101.0, 0.0, 0.0, 62.0, 0.0, -9.0, 45.0, 96.0, -550.0, -522.0, 71.0, -6.0, 115.0, 88.0, -185.0, -7.0, 0.0, 0.0, -51.0, 15.0, -1.0, 0.0, 22.0, 8.0, 0.0, -89.0, -34.0, 0.0, 138.0, -110.0, 0.0, 0.0, 0.0, 68.0, 70.0, 24.0, -21.0, -104.0, 39.0, 115.0, -130.0, -164.0, 0.0, 14.0, -28.0, -34.0, -27.0, 45.0, 0.0, -22.0, 97.0, -16.0, -24.0, 0.0, -35.0, 89.0, 27.0, -18.0, -544.0, 9.0, -602.0, -39.0, 40.0, 0.0, 30.0, -22.0, 0.0, 56.0, 6.0, 0.0, 0.0, 85.0, -15.0, 63.0, -344.0, 8.0, 0.0, -1.0, -544.0, -678.0, -22.0, -10.0, -13.0, 1.0, 0.0, -33.0, -722.0, 99.0, 19.0, 25.0, -84.0, 47.0, 0.0, 36.0, 5.0, 0.0, -47.0, -29.0, -26.0, 65.0, 12.0, -18.0, 0.0, -10.0, -35.0, -84.0, -726.0, 21.0, -1.0, 30.0, 0.0, 18.0, 0.0, 39.0, -211.0, 10.0, -551.0, -653.0, -64.0, -196.0, 0.0, -108.0, -102.0, -478.0, 0.0, -22.0, -22.0, 17.0, -2.0, 9.0, 8.0, 0.0, 0.0, -19.0, -10.0, 0.0, 14.0, 0.0, 0.0, 14.0, -52.0, -254.0, 18.0, 0.0, -146.0, -130.0, 21.0, 15.0, -167.0, -278.0, 1.0, -18.0, 38.0, -90.0, 45.0, 0.0, 12.0, 0.0, -87.0, -20.0, 0.0, 0.0, -38.0, -6.0], "policy_predator_policy_reward": [6.0, 0.0, 3.0, 9.0, 29.0, 0.0, 0.0, 19.0, 34.0, 58.0, 12.0, 0.0, 18.0, 24.0, 0.0, 15.0, 6.0, 0.0, 14.0, 0.0, 0.0, 0.0, 24.0, 69.0, 0.0, 0.0, 38.0, 0.0, 0.0, 2.0, 18.0, 24.0, 4.0, 30.0, 0.0, 4.0, 20.0, 0.0, 12.0, 0.0, 18.0, 35.0, 0.0, 0.0, 0.0, 518.0, 0.0, 10.0, 38.0, 1.0, 152.0, 0.0, 0.0, 0.0, 0.0, 34.0, 0.0, 20.0, 21.0, 3.0, 39.0, 17.0, 17.0, 0.0, 55.0, 14.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 97.0, 21.0, 27.0, 0.0, 0.0, 119.0, 0.0, 0.0, 36.0, 10.0, 0.0, 35.0, 11.0, 0.0, 11.0, 24.0, 7.0, 26.0, 26.0, 0.0, 17.0, 14.0, 452.0, 0.0, 14.0, 446.0, 0.0, 0.0, 24.0, 19.0, 0.0, 8.0, 7.0, 9.0, 2.0, 13.0, 27.0, 0.0, 243.0, 4.0, 0.0, 6.0, 676.0, 0.0, 0.0, 16.0, 12.0, 1.0, 17.0, 0.0, 0.0, 581.0, 7.0, 0.0, 0.0, 42.0, 0.0, 0.0, 17.0, 0.0, 42.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 5.0, 42.0, 0.0, 11.0, 568.0, 3.0, 19.0, 3.0, 0.0, 0.0, 0.0, 10.0, 149.0, 3.0, 737.0, 163.0, 0.0, 0.0, 117.0, 394.0, 0.0, 16.0, 0.0, 4.0, 25.0, 0.0, 30.0, 2.0, 0.0, 20.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 111.0, 0.0, 3.0, 0.0, 13.0, 138.0, 9.0, 0.0, 3.0, 45.0, 0.0, 0.0, 0.0, 6.0, 60.0, 0.0, 0.0, 0.0, 3.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0314606646309739, "mean_inference_ms": 2.7099612674652342, "mean_action_processing_ms": 0.4040082642325357, "mean_env_wait_ms": 0.36696337369359944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005635976791381836, "StateBufferConnector_ms": 0.0112379789352417, "ViewRequirementAgentConnector_ms": 0.18613433837890625}, "num_episodes": 27, "episode_return_max": 242.0, "episode_return_min": -554.0, "episode_return_mean": 5.02, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.08410584254364, "num_env_steps_trained_throughput_per_sec": 281.08410584254364, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 14837.321, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14837.252, "sample_time_ms": 2233.537, "learn_time_ms": 12584.757, "learn_throughput": 317.845, "synch_weights_time_ms": 16.298}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "f1691_00000", "date": "2024-08-13_16-44-10", "timestamp": 1723581850, "time_this_iter_s": 14.349370956420898, "time_total_s": 344.65107250213623, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 344.65107250213623, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 77.21000000000001, "ram_util_percent": 86.36500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7571387609397924, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.6984366268392592, "policy_loss": 0.0014353356171379645, "vf_loss": 1.6881837446853598, "vf_explained_var": 0.012550600622066114, "kl": 0.013063027669965374, "entropy": 1.3808331084629846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.703714650680149, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.0722297421208133, "policy_loss": 0.0016260526830419188, "vf_loss": 3.0206153178341175, "vf_explained_var": 0.008674283033956296, "kl": 0.014628513544204544, "entropy": 1.242754512552231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -554.0, "episode_reward_mean": -18.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -800.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 138.0, "predator_policy": 934.0}, "policy_reward_mean": {"prey_policy": -54.565, "predator_policy": 45.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 74.0, 44.0, 141.0, -554.0, 75.0, 242.0, -40.0, 0.0, -2.0, 19.0, 54.0, -33.0, -17.0, 97.0, 0.0, 68.0, 120.0, -7.0, 181.0, -175.0, 14.0, -16.0, 53.0, -11.0, 116.0, 9.0, 80.0, 40.0, -83.0, -181.0, 40.0, 51.0, 64.0, 22.0, 100.0, 75.0, -89.0, 5.0, -546.0, -16.0, 1.0, -16.0, -42.0, 51.0, 5.0, 36.0, 22.0, -34.0, 54.0, 4.0, -5.0, -77.0, -126.0, 51.0, 21.0, 39.0, -42.0, -464.0, -97.0, 9.0, -186.0, -6.0, 24.0, 37.0, 10.0, 1.0, 16.0, 14.0, 14.0, -131.0, 18.0, -165.0, 39.0, -294.0, -8.0, -4.0, 45.0, 18.0, -47.0, 0.0, -22.0, 65.0, 23.0, 21.0, -316.0, 19.0, -30.0, 40.0, -16.0, 0.0, 37.0, 39.0, 16.0, -200.0, 5.0, 66.0, -20.0, 0.0, -538.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, 0.0, 0.0, 62.0, 0.0, -9.0, 45.0, 96.0, -550.0, -522.0, 71.0, -6.0, 115.0, 88.0, -185.0, -7.0, 0.0, 0.0, -51.0, 15.0, -1.0, 0.0, 22.0, 8.0, 0.0, -89.0, -34.0, 0.0, 138.0, -110.0, 0.0, 0.0, 0.0, 68.0, 70.0, 24.0, -21.0, -104.0, 39.0, 115.0, -130.0, -164.0, 0.0, 14.0, -28.0, -34.0, -27.0, 45.0, 0.0, -22.0, 97.0, -16.0, -24.0, 0.0, -35.0, 89.0, 27.0, -18.0, -544.0, 9.0, -602.0, -39.0, 40.0, 0.0, 30.0, -22.0, 0.0, 56.0, 6.0, 0.0, 0.0, 85.0, -15.0, 63.0, -344.0, 8.0, 0.0, -1.0, -544.0, -678.0, -22.0, -10.0, -13.0, 1.0, 0.0, -33.0, -722.0, 99.0, 19.0, 25.0, -84.0, 47.0, 0.0, 36.0, 5.0, 0.0, -47.0, -29.0, -26.0, 65.0, 12.0, -18.0, 0.0, -10.0, -35.0, -84.0, -726.0, 21.0, -1.0, 30.0, 0.0, 18.0, 0.0, 39.0, -211.0, 10.0, -551.0, -653.0, -64.0, -196.0, 0.0, -108.0, -102.0, -478.0, 0.0, -22.0, -22.0, 17.0, -2.0, 9.0, 8.0, 0.0, 0.0, -19.0, -10.0, 0.0, 14.0, 0.0, 0.0, 14.0, -52.0, -254.0, 18.0, 0.0, -146.0, -130.0, 21.0, 15.0, -167.0, -278.0, 1.0, -18.0, 38.0, -90.0, 45.0, 0.0, 12.0, 0.0, -87.0, -20.0, 0.0, 0.0, -38.0, -6.0, 13.0, 52.0, 0.0, 23.0, 1.0, 19.0, -334.0, -206.0, 7.0, -33.0, -14.0, -46.0, 0.0, 40.0, -32.0, 0.0, 0.0, 0.0, 0.0, 33.0, -2.0, 19.0, 9.0, 0.0, -464.0, -194.0, 0.0, -4.0, 30.0, 13.0, -41.0, 0.0, -21.0, 0.0, -706.0, -800.0], "policy_predator_policy_reward": [20.0, 0.0, 12.0, 0.0, 18.0, 35.0, 0.0, 0.0, 0.0, 518.0, 0.0, 10.0, 38.0, 1.0, 152.0, 0.0, 0.0, 0.0, 0.0, 34.0, 0.0, 20.0, 21.0, 3.0, 39.0, 17.0, 17.0, 0.0, 55.0, 14.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 97.0, 21.0, 27.0, 0.0, 0.0, 119.0, 0.0, 0.0, 36.0, 10.0, 0.0, 35.0, 11.0, 0.0, 11.0, 24.0, 7.0, 26.0, 26.0, 0.0, 17.0, 14.0, 452.0, 0.0, 14.0, 446.0, 0.0, 0.0, 24.0, 19.0, 0.0, 8.0, 7.0, 9.0, 2.0, 13.0, 27.0, 0.0, 243.0, 4.0, 0.0, 6.0, 676.0, 0.0, 0.0, 16.0, 12.0, 1.0, 17.0, 0.0, 0.0, 581.0, 7.0, 0.0, 0.0, 42.0, 0.0, 0.0, 17.0, 0.0, 42.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 5.0, 42.0, 0.0, 11.0, 568.0, 3.0, 19.0, 3.0, 0.0, 0.0, 0.0, 10.0, 149.0, 3.0, 737.0, 163.0, 0.0, 0.0, 117.0, 394.0, 0.0, 16.0, 0.0, 4.0, 25.0, 0.0, 30.0, 2.0, 0.0, 20.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 111.0, 0.0, 3.0, 0.0, 13.0, 138.0, 9.0, 0.0, 3.0, 45.0, 0.0, 0.0, 0.0, 6.0, 60.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 224.0, 0.0, 11.0, 34.0, 30.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 4.0, 0.0, 21.0, 1.0, 0.0, 7.0, 448.0, 10.0, 0.0, 9.0, 5.0, 18.0, 0.0, 21.0, 1.0, 20.0, 34.0, 934.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0271836592339236, "mean_inference_ms": 2.7013262728298555, "mean_action_processing_ms": 0.40206907488890165, "mean_env_wait_ms": 0.36553137670228536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005645632743835449, "StateBufferConnector_ms": 0.011534929275512695, "ViewRequirementAgentConnector_ms": 0.18403208255767822}, "num_episodes": 18, "episode_return_max": 242.0, "episode_return_min": -554.0, "episode_return_mean": -18.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.22100283636416, "num_env_steps_trained_throughput_per_sec": 262.22100283636416, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 14786.491, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14786.42, "sample_time_ms": 2093.72, "learn_time_ms": 12673.223, "learn_throughput": 315.626, "synch_weights_time_ms": 16.189}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "f1691_00000", "date": "2024-08-13_16-44-25", "timestamp": 1723581865, "time_this_iter_s": 15.309723138809204, "time_total_s": 359.96079564094543, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 359.96079564094543, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 81.45454545454547, "ram_util_percent": 85.08636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6771368344545995, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.6095402008326596, "policy_loss": -0.000543167458098165, "vf_loss": 1.6004742603138011, "vf_explained_var": 0.010060046558026914, "kl": 0.014235715675010214, "entropy": 1.369699855140908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.33412052809246, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.159882607220342, "policy_loss": 0.0021065968524901168, "vf_loss": 3.109910794666835, "vf_explained_var": 0.004223070573554468, "kl": 0.014007194179103146, "entropy": 1.1534000839505876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 181.0, "episode_reward_min": -581.0, "episode_reward_mean": -32.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -826.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 115.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -67.465, "predator_policy": 51.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 181.0, -175.0, 14.0, -16.0, 53.0, -11.0, 116.0, 9.0, 80.0, 40.0, -83.0, -181.0, 40.0, 51.0, 64.0, 22.0, 100.0, 75.0, -89.0, 5.0, -546.0, -16.0, 1.0, -16.0, -42.0, 51.0, 5.0, 36.0, 22.0, -34.0, 54.0, 4.0, -5.0, -77.0, -126.0, 51.0, 21.0, 39.0, -42.0, -464.0, -97.0, 9.0, -186.0, -6.0, 24.0, 37.0, 10.0, 1.0, 16.0, 14.0, 14.0, -131.0, 18.0, -165.0, 39.0, -294.0, -8.0, -4.0, 45.0, 18.0, -47.0, 0.0, -22.0, 65.0, 23.0, 21.0, -316.0, 19.0, -30.0, 40.0, -16.0, 0.0, 37.0, 39.0, 16.0, -200.0, 5.0, 66.0, -20.0, 0.0, -538.0, -61.0, 72.0, -37.0, 8.0, -326.0, 17.0, -75.0, -18.0, 29.0, -40.0, 0.0, 28.0, 46.0, -4.0, 14.0, 0.0, -581.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.0, -104.0, 39.0, 115.0, -130.0, -164.0, 0.0, 14.0, -28.0, -34.0, -27.0, 45.0, 0.0, -22.0, 97.0, -16.0, -24.0, 0.0, -35.0, 89.0, 27.0, -18.0, -544.0, 9.0, -602.0, -39.0, 40.0, 0.0, 30.0, -22.0, 0.0, 56.0, 6.0, 0.0, 0.0, 85.0, -15.0, 63.0, -344.0, 8.0, 0.0, -1.0, -544.0, -678.0, -22.0, -10.0, -13.0, 1.0, 0.0, -33.0, -722.0, 99.0, 19.0, 25.0, -84.0, 47.0, 0.0, 36.0, 5.0, 0.0, -47.0, -29.0, -26.0, 65.0, 12.0, -18.0, 0.0, -10.0, -35.0, -84.0, -726.0, 21.0, -1.0, 30.0, 0.0, 18.0, 0.0, 39.0, -211.0, 10.0, -551.0, -653.0, -64.0, -196.0, 0.0, -108.0, -102.0, -478.0, 0.0, -22.0, -22.0, 17.0, -2.0, 9.0, 8.0, 0.0, 0.0, -19.0, -10.0, 0.0, 14.0, 0.0, 0.0, 14.0, -52.0, -254.0, 18.0, 0.0, -146.0, -130.0, 21.0, 15.0, -167.0, -278.0, 1.0, -18.0, 38.0, -90.0, 45.0, 0.0, 12.0, 0.0, -87.0, -20.0, 0.0, 0.0, -38.0, -6.0, 13.0, 52.0, 0.0, 23.0, 1.0, 19.0, -334.0, -206.0, 7.0, -33.0, -14.0, -46.0, 0.0, 40.0, -32.0, 0.0, 0.0, 0.0, 0.0, 33.0, -2.0, 19.0, 9.0, 0.0, -464.0, -194.0, 0.0, -4.0, 30.0, 13.0, -41.0, 0.0, -21.0, 0.0, -706.0, -800.0, -322.0, -22.0, 33.0, 32.0, -4.0, -77.0, 1.0, 0.0, -506.0, -438.0, 14.0, -20.0, -66.0, -140.0, -46.0, 0.0, 0.0, 17.0, -22.0, -52.0, 0.0, 0.0, 28.0, 0.0, 22.0, 10.0, 0.0, -8.0, 0.0, -1.0, 0.0, 0.0, -786.0, -826.0, -16.0, -26.0], "policy_predator_policy_reward": [97.0, 21.0, 27.0, 0.0, 0.0, 119.0, 0.0, 0.0, 36.0, 10.0, 0.0, 35.0, 11.0, 0.0, 11.0, 24.0, 7.0, 26.0, 26.0, 0.0, 17.0, 14.0, 452.0, 0.0, 14.0, 446.0, 0.0, 0.0, 24.0, 19.0, 0.0, 8.0, 7.0, 9.0, 2.0, 13.0, 27.0, 0.0, 243.0, 4.0, 0.0, 6.0, 676.0, 0.0, 0.0, 16.0, 12.0, 1.0, 17.0, 0.0, 0.0, 581.0, 7.0, 0.0, 0.0, 42.0, 0.0, 0.0, 17.0, 0.0, 42.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 5.0, 42.0, 0.0, 11.0, 568.0, 3.0, 19.0, 3.0, 0.0, 0.0, 0.0, 10.0, 149.0, 3.0, 737.0, 163.0, 0.0, 0.0, 117.0, 394.0, 0.0, 16.0, 0.0, 4.0, 25.0, 0.0, 30.0, 2.0, 0.0, 20.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 111.0, 0.0, 3.0, 0.0, 13.0, 138.0, 9.0, 0.0, 3.0, 45.0, 0.0, 0.0, 0.0, 6.0, 60.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 224.0, 0.0, 11.0, 34.0, 30.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 4.0, 0.0, 21.0, 1.0, 0.0, 7.0, 448.0, 10.0, 0.0, 9.0, 5.0, 18.0, 0.0, 21.0, 1.0, 20.0, 34.0, 934.0, 11.0, 272.0, 6.0, 1.0, 29.0, 15.0, 7.0, 0.0, 15.0, 603.0, 23.0, 0.0, 15.0, 116.0, 19.0, 9.0, 3.0, 9.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 4.0, 0.0, 12.0, 3.0, 0.0, 0.0, 0.0, 1031.0, 23.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0224889140649982, "mean_inference_ms": 2.6937631883628925, "mean_action_processing_ms": 0.4341135087640046, "mean_env_wait_ms": 0.36401381054787324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006517767906188965, "StateBufferConnector_ms": 0.011580824851989746, "ViewRequirementAgentConnector_ms": 0.18139266967773438}, "num_episodes": 18, "episode_return_max": 181.0, "episode_return_min": -581.0, "episode_return_mean": -32.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.66997838090464, "num_env_steps_trained_throughput_per_sec": 226.66997838090464, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 15130.169, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15130.096, "sample_time_ms": 2249.825, "learn_time_ms": 12860.638, "learn_throughput": 311.027, "synch_weights_time_ms": 16.371}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "f1691_00000", "date": "2024-08-13_16-44-43", "timestamp": 1723581883, "time_this_iter_s": 17.674314975738525, "time_total_s": 377.63511061668396, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 377.63511061668396, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 79.888, "ram_util_percent": 85.49600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7605602816299156, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.7627697110176086, "policy_loss": -0.0018257815548509517, "vf_loss": 1.7544258015811758, "vf_explained_var": 0.06239866652185955, "kl": 0.0150662166365928, "entropy": 1.3472173306677075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.816610485473007, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.8490484188473415, "policy_loss": 0.0033124150535850613, "vf_loss": 2.7991365295238597, "vf_explained_var": 0.004538529890554923, "kl": 0.013636790551657783, "entropy": 1.140825230293173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 75.0, "episode_reward_min": -581.0, "episode_reward_mean": -43.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -826.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 99.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -78.6, "predator_policy": 56.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0, -89.0, 5.0, -546.0, -16.0, 1.0, -16.0, -42.0, 51.0, 5.0, 36.0, 22.0, -34.0, 54.0, 4.0, -5.0, -77.0, -126.0, 51.0, 21.0, 39.0, -42.0, -464.0, -97.0, 9.0, -186.0, -6.0, 24.0, 37.0, 10.0, 1.0, 16.0, 14.0, 14.0, -131.0, 18.0, -165.0, 39.0, -294.0, -8.0, -4.0, 45.0, 18.0, -47.0, 0.0, -22.0, 65.0, 23.0, 21.0, -316.0, 19.0, -30.0, 40.0, -16.0, 0.0, 37.0, 39.0, 16.0, -200.0, 5.0, 66.0, -20.0, 0.0, -538.0, -61.0, 72.0, -37.0, 8.0, -326.0, 17.0, -75.0, -18.0, 29.0, -40.0, 0.0, 28.0, 46.0, -4.0, 14.0, 0.0, -581.0, 4.0, 24.0, 42.0, -218.0, -7.0, -187.0, 9.0, -398.0, 0.0, 33.0, 31.0, -263.0, 15.0, 14.0, 3.0, -18.0, 0.0, 61.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, 63.0, -344.0, 8.0, 0.0, -1.0, -544.0, -678.0, -22.0, -10.0, -13.0, 1.0, 0.0, -33.0, -722.0, 99.0, 19.0, 25.0, -84.0, 47.0, 0.0, 36.0, 5.0, 0.0, -47.0, -29.0, -26.0, 65.0, 12.0, -18.0, 0.0, -10.0, -35.0, -84.0, -726.0, 21.0, -1.0, 30.0, 0.0, 18.0, 0.0, 39.0, -211.0, 10.0, -551.0, -653.0, -64.0, -196.0, 0.0, -108.0, -102.0, -478.0, 0.0, -22.0, -22.0, 17.0, -2.0, 9.0, 8.0, 0.0, 0.0, -19.0, -10.0, 0.0, 14.0, 0.0, 0.0, 14.0, -52.0, -254.0, 18.0, 0.0, -146.0, -130.0, 21.0, 15.0, -167.0, -278.0, 1.0, -18.0, 38.0, -90.0, 45.0, 0.0, 12.0, 0.0, -87.0, -20.0, 0.0, 0.0, -38.0, -6.0, 13.0, 52.0, 0.0, 23.0, 1.0, 19.0, -334.0, -206.0, 7.0, -33.0, -14.0, -46.0, 0.0, 40.0, -32.0, 0.0, 0.0, 0.0, 0.0, 33.0, -2.0, 19.0, 9.0, 0.0, -464.0, -194.0, 0.0, -4.0, 30.0, 13.0, -41.0, 0.0, -21.0, 0.0, -706.0, -800.0, -322.0, -22.0, 33.0, 32.0, -4.0, -77.0, 1.0, 0.0, -506.0, -438.0, 14.0, -20.0, -66.0, -140.0, -46.0, 0.0, 0.0, 17.0, -22.0, -52.0, 0.0, 0.0, 28.0, 0.0, 22.0, 10.0, 0.0, -8.0, 0.0, -1.0, 0.0, 0.0, -786.0, -826.0, -16.0, -26.0, 21.0, 0.0, 40.0, 0.0, -282.0, -413.0, 0.0, -17.0, -178.0, -140.0, 0.0, -17.0, -520.0, -535.0, 0.0, 0.0, 31.0, 0.0, 27.0, -24.0, -285.0, -252.0, 1.0, -6.0, -5.0, 0.0, -15.0, 4.0, -49.0, 0.0, 0.0, 0.0, -125.0, -666.0, 0.0, 0.0], "policy_predator_policy_reward": [27.0, 0.0, 243.0, 4.0, 0.0, 6.0, 676.0, 0.0, 0.0, 16.0, 12.0, 1.0, 17.0, 0.0, 0.0, 581.0, 7.0, 0.0, 0.0, 42.0, 0.0, 0.0, 17.0, 0.0, 42.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 5.0, 42.0, 0.0, 11.0, 568.0, 3.0, 19.0, 3.0, 0.0, 0.0, 0.0, 10.0, 149.0, 3.0, 737.0, 163.0, 0.0, 0.0, 117.0, 394.0, 0.0, 16.0, 0.0, 4.0, 25.0, 0.0, 30.0, 2.0, 0.0, 20.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 111.0, 0.0, 3.0, 0.0, 13.0, 138.0, 9.0, 0.0, 3.0, 45.0, 0.0, 0.0, 0.0, 6.0, 60.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 224.0, 0.0, 11.0, 34.0, 30.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 4.0, 0.0, 21.0, 1.0, 0.0, 7.0, 448.0, 10.0, 0.0, 9.0, 5.0, 18.0, 0.0, 21.0, 1.0, 20.0, 34.0, 934.0, 11.0, 272.0, 6.0, 1.0, 29.0, 15.0, 7.0, 0.0, 15.0, 603.0, 23.0, 0.0, 15.0, 116.0, 19.0, 9.0, 3.0, 9.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 4.0, 0.0, 12.0, 3.0, 0.0, 0.0, 0.0, 1031.0, 23.0, 23.0, 0.0, 3.0, 2.0, 0.0, 448.0, 29.0, 0.0, 10.0, 17.0, 114.0, 10.0, 16.0, 657.0, 0.0, 0.0, 0.0, 2.0, 0.0, 13.0, 15.0, 274.0, 0.0, 16.0, 4.0, 19.0, 0.0, 14.0, 0.0, 31.0, 0.0, 0.0, 0.0, 399.0, 453.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0182636084287882, "mean_inference_ms": 2.6876714702784854, "mean_action_processing_ms": 0.46525534098863786, "mean_env_wait_ms": 0.3627583919923177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009104728698730469, "StateBufferConnector_ms": 0.01161801815032959, "ViewRequirementAgentConnector_ms": 0.18289422988891602}, "num_episodes": 18, "episode_return_max": 75.0, "episode_return_min": -581.0, "episode_return_mean": -43.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.768345250353, "num_env_steps_trained_throughput_per_sec": 286.768345250353, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14980.533, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14980.46, "sample_time_ms": 2198.448, "learn_time_ms": 12761.898, "learn_throughput": 313.433, "synch_weights_time_ms": 16.156}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "f1691_00000", "date": "2024-08-13_16-44-57", "timestamp": 1723581897, "time_this_iter_s": 14.124664783477783, "time_total_s": 391.75977540016174, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 391.75977540016174, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 76.84, "ram_util_percent": 86.235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.911247530358809, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.826232991899763, "policy_loss": -0.001093194775884508, "vf_loss": 3.8150529566265288, "vf_explained_var": 0.05139556814123083, "kl": 0.018182569407866275, "entropy": 1.2951343624049394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.369419212623564, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 5.374276918204373, "policy_loss": 0.002099106725916345, "vf_loss": 5.327157453002123, "vf_explained_var": 0.0038185398730020675, "kl": 0.013174684916589886, "entropy": 1.2173661404185825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 194.0, "episode_reward_min": -581.0, "episode_reward_mean": -56.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -838.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 52.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -101.7, "predator_policy": 73.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-464.0, -97.0, 9.0, -186.0, -6.0, 24.0, 37.0, 10.0, 1.0, 16.0, 14.0, 14.0, -131.0, 18.0, -165.0, 39.0, -294.0, -8.0, -4.0, 45.0, 18.0, -47.0, 0.0, -22.0, 65.0, 23.0, 21.0, -316.0, 19.0, -30.0, 40.0, -16.0, 0.0, 37.0, 39.0, 16.0, -200.0, 5.0, 66.0, -20.0, 0.0, -538.0, -61.0, 72.0, -37.0, 8.0, -326.0, 17.0, -75.0, -18.0, 29.0, -40.0, 0.0, 28.0, 46.0, -4.0, 14.0, 0.0, -581.0, 4.0, 24.0, 42.0, -218.0, -7.0, -187.0, 9.0, -398.0, 0.0, 33.0, 31.0, -263.0, 15.0, 14.0, 3.0, -18.0, 0.0, 61.0, 0.0, 0.0, -18.0, 1.0, -23.0, -80.0, 194.0, -270.0, 0.0, -120.0, 0.0, -219.0, -202.0, -33.0, 24.0, -155.0, -315.0, -366.0, -247.0, -7.0, -24.0, 0.0, -18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-551.0, -653.0, -64.0, -196.0, 0.0, -108.0, -102.0, -478.0, 0.0, -22.0, -22.0, 17.0, -2.0, 9.0, 8.0, 0.0, 0.0, -19.0, -10.0, 0.0, 14.0, 0.0, 0.0, 14.0, -52.0, -254.0, 18.0, 0.0, -146.0, -130.0, 21.0, 15.0, -167.0, -278.0, 1.0, -18.0, 38.0, -90.0, 45.0, 0.0, 12.0, 0.0, -87.0, -20.0, 0.0, 0.0, -38.0, -6.0, 13.0, 52.0, 0.0, 23.0, 1.0, 19.0, -334.0, -206.0, 7.0, -33.0, -14.0, -46.0, 0.0, 40.0, -32.0, 0.0, 0.0, 0.0, 0.0, 33.0, -2.0, 19.0, 9.0, 0.0, -464.0, -194.0, 0.0, -4.0, 30.0, 13.0, -41.0, 0.0, -21.0, 0.0, -706.0, -800.0, -322.0, -22.0, 33.0, 32.0, -4.0, -77.0, 1.0, 0.0, -506.0, -438.0, 14.0, -20.0, -66.0, -140.0, -46.0, 0.0, 0.0, 17.0, -22.0, -52.0, 0.0, 0.0, 28.0, 0.0, 22.0, 10.0, 0.0, -8.0, 0.0, -1.0, 0.0, 0.0, -786.0, -826.0, -16.0, -26.0, 21.0, 0.0, 40.0, 0.0, -282.0, -413.0, 0.0, -17.0, -178.0, -140.0, 0.0, -17.0, -520.0, -535.0, 0.0, 0.0, 31.0, 0.0, 27.0, -24.0, -285.0, -252.0, 1.0, -6.0, -5.0, 0.0, -15.0, 4.0, -49.0, 0.0, 0.0, 0.0, -125.0, -666.0, 0.0, 0.0, 3.0, -28.0, -62.0, 2.0, 27.0, -248.0, -126.0, 12.0, -54.0, -54.0, -838.0, -288.0, -326.0, -451.0, -20.0, 10.0, -88.0, -286.0, 0.0, 0.0, -193.0, -608.0, -144.0, -268.0, -7.0, -60.0, 24.0, 0.0, -584.0, -88.0, -380.0, -704.0, -835.0, -311.0, -280.0, -414.0, -34.0, 0.0, -28.0, -10.0, 0.0, 0.0, -36.0, 0.0], "policy_predator_policy_reward": [3.0, 737.0, 163.0, 0.0, 0.0, 117.0, 394.0, 0.0, 16.0, 0.0, 4.0, 25.0, 0.0, 30.0, 2.0, 0.0, 20.0, 0.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 111.0, 0.0, 3.0, 0.0, 13.0, 138.0, 9.0, 0.0, 3.0, 45.0, 0.0, 0.0, 0.0, 6.0, 60.0, 0.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 224.0, 0.0, 11.0, 34.0, 30.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 4.0, 0.0, 21.0, 1.0, 0.0, 7.0, 448.0, 10.0, 0.0, 9.0, 5.0, 18.0, 0.0, 21.0, 1.0, 20.0, 34.0, 934.0, 11.0, 272.0, 6.0, 1.0, 29.0, 15.0, 7.0, 0.0, 15.0, 603.0, 23.0, 0.0, 15.0, 116.0, 19.0, 9.0, 3.0, 9.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 4.0, 0.0, 12.0, 3.0, 0.0, 0.0, 0.0, 1031.0, 23.0, 23.0, 0.0, 3.0, 2.0, 0.0, 448.0, 29.0, 0.0, 10.0, 17.0, 114.0, 10.0, 16.0, 657.0, 0.0, 0.0, 0.0, 2.0, 0.0, 13.0, 15.0, 274.0, 0.0, 16.0, 4.0, 19.0, 0.0, 14.0, 0.0, 31.0, 0.0, 0.0, 0.0, 399.0, 453.0, 0.0, 0.0, 12.0, 13.0, 18.0, 24.0, 204.0, 18.0, 73.0, 18.0, 24.0, 4.0, 657.0, 663.0, 507.0, 0.0, 0.0, 10.0, 15.0, 239.0, 0.0, 0.0, 29.0, 553.0, 210.0, 0.0, 30.0, 4.0, 0.0, 0.0, 0.0, 517.0, 0.0, 769.0, 4.0, 776.0, 408.0, 39.0, 13.0, 14.0, 0.0, 14.0, 0.0, 0.0, 17.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0116510969723438, "mean_inference_ms": 2.676324504476329, "mean_action_processing_ms": 0.4999904260805969, "mean_env_wait_ms": 0.36035794120587383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014574050903320312, "StateBufferConnector_ms": 0.0042531490325927734, "ViewRequirementAgentConnector_ms": 0.17834973335266113}, "num_episodes": 22, "episode_return_max": 194.0, "episode_return_min": -581.0, "episode_return_mean": -56.29, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3193018173801, "num_env_steps_trained_throughput_per_sec": 310.3193018173801, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14746.316, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14746.256, "sample_time_ms": 2183.62, "learn_time_ms": 12542.42, "learn_throughput": 318.918, "synch_weights_time_ms": 16.132}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "f1691_00000", "date": "2024-08-13_16-45-10", "timestamp": 1723581910, "time_this_iter_s": 12.969478130340576, "time_total_s": 404.7292535305023, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c1b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 404.7292535305023, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 71.47222222222223, "ram_util_percent": 85.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6686077415233567, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.509304167101623, "policy_loss": -0.002576943515016446, "vf_loss": 3.5018014026066613, "vf_explained_var": 0.05429211880164172, "kl": 0.014932897035910246, "entropy": 1.2793384237894936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.284210945405658, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.881396731371602, "policy_loss": 0.004722935869112098, "vf_loss": 4.816944062520587, "vf_explained_var": 0.005654611852433947, "kl": 0.017479206487576598, "entropy": 1.2589400695114539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 306.0, "episode_reward_min": -612.0, "episode_reward_mean": -55.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -857.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 52.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -118.98, "predator_policy": 91.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, 65.0, 23.0, 21.0, -316.0, 19.0, -30.0, 40.0, -16.0, 0.0, 37.0, 39.0, 16.0, -200.0, 5.0, 66.0, -20.0, 0.0, -538.0, -61.0, 72.0, -37.0, 8.0, -326.0, 17.0, -75.0, -18.0, 29.0, -40.0, 0.0, 28.0, 46.0, -4.0, 14.0, 0.0, -581.0, 4.0, 24.0, 42.0, -218.0, -7.0, -187.0, 9.0, -398.0, 0.0, 33.0, 31.0, -263.0, 15.0, 14.0, 3.0, -18.0, 0.0, 61.0, 0.0, 0.0, -18.0, 1.0, -23.0, -80.0, 194.0, -270.0, 0.0, -120.0, 0.0, -219.0, -202.0, -33.0, 24.0, -155.0, -315.0, -366.0, -247.0, -7.0, -24.0, 0.0, -18.0, -23.0, 306.0, -276.0, -274.0, -90.0, -200.0, -29.0, -612.0, -29.0, 42.0, 0.0, 20.0, -7.0, -129.0, 14.0, 296.0, -63.0, -7.0, 9.0, 6.0, 28.0, -24.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.0, -6.0, 13.0, 52.0, 0.0, 23.0, 1.0, 19.0, -334.0, -206.0, 7.0, -33.0, -14.0, -46.0, 0.0, 40.0, -32.0, 0.0, 0.0, 0.0, 0.0, 33.0, -2.0, 19.0, 9.0, 0.0, -464.0, -194.0, 0.0, -4.0, 30.0, 13.0, -41.0, 0.0, -21.0, 0.0, -706.0, -800.0, -322.0, -22.0, 33.0, 32.0, -4.0, -77.0, 1.0, 0.0, -506.0, -438.0, 14.0, -20.0, -66.0, -140.0, -46.0, 0.0, 0.0, 17.0, -22.0, -52.0, 0.0, 0.0, 28.0, 0.0, 22.0, 10.0, 0.0, -8.0, 0.0, -1.0, 0.0, 0.0, -786.0, -826.0, -16.0, -26.0, 21.0, 0.0, 40.0, 0.0, -282.0, -413.0, 0.0, -17.0, -178.0, -140.0, 0.0, -17.0, -520.0, -535.0, 0.0, 0.0, 31.0, 0.0, 27.0, -24.0, -285.0, -252.0, 1.0, -6.0, -5.0, 0.0, -15.0, 4.0, -49.0, 0.0, 0.0, 0.0, -125.0, -666.0, 0.0, 0.0, 3.0, -28.0, -62.0, 2.0, 27.0, -248.0, -126.0, 12.0, -54.0, -54.0, -838.0, -288.0, -326.0, -451.0, -20.0, 10.0, -88.0, -286.0, 0.0, 0.0, -193.0, -608.0, -144.0, -268.0, -7.0, -60.0, 24.0, 0.0, -584.0, -88.0, -380.0, -704.0, -835.0, -311.0, -280.0, -414.0, -34.0, 0.0, -28.0, -10.0, 0.0, 0.0, -36.0, 0.0, -20.0, -28.0, -10.0, -553.0, -460.0, -371.0, -250.0, -228.0, -804.0, -49.0, -200.0, -310.0, -22.0, -65.0, -804.0, -758.0, -60.0, -4.0, 26.0, 3.0, 0.0, 0.0, 0.0, 20.0, 0.0, -28.0, -152.0, -127.0, 14.0, 0.0, -857.0, -66.0, -83.0, -40.0, 0.0, -20.0, -5.0, -15.0, 0.0, -32.0, -180.0, -101.0, 0.0, -48.0, 2.0, -28.0], "policy_predator_policy_reward": [3.0, 19.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 224.0, 0.0, 11.0, 34.0, 30.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 4.0, 0.0, 21.0, 1.0, 0.0, 7.0, 448.0, 10.0, 0.0, 9.0, 5.0, 18.0, 0.0, 21.0, 1.0, 20.0, 34.0, 934.0, 11.0, 272.0, 6.0, 1.0, 29.0, 15.0, 7.0, 0.0, 15.0, 603.0, 23.0, 0.0, 15.0, 116.0, 19.0, 9.0, 3.0, 9.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 4.0, 0.0, 12.0, 3.0, 0.0, 0.0, 0.0, 1031.0, 23.0, 23.0, 0.0, 3.0, 2.0, 0.0, 448.0, 29.0, 0.0, 10.0, 17.0, 114.0, 10.0, 16.0, 657.0, 0.0, 0.0, 0.0, 2.0, 0.0, 13.0, 15.0, 274.0, 0.0, 16.0, 4.0, 19.0, 0.0, 14.0, 0.0, 31.0, 0.0, 0.0, 0.0, 399.0, 453.0, 0.0, 0.0, 12.0, 13.0, 18.0, 24.0, 204.0, 18.0, 73.0, 18.0, 24.0, 4.0, 657.0, 663.0, 507.0, 0.0, 0.0, 10.0, 15.0, 239.0, 0.0, 0.0, 29.0, 553.0, 210.0, 0.0, 30.0, 4.0, 0.0, 0.0, 0.0, 517.0, 0.0, 769.0, 4.0, 776.0, 408.0, 39.0, 13.0, 14.0, 0.0, 14.0, 0.0, 0.0, 17.0, 1.0, 15.0, 10.0, 414.0, 455.0, 555.0, 0.0, 0.0, 204.0, 30.0, 733.0, 310.0, 0.0, 26.0, 32.0, 0.0, 950.0, 29.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 82.0, 68.0, 0.0, 0.0, 486.0, 733.0, 39.0, 21.0, 13.0, 0.0, 13.0, 16.0, 26.0, 12.0, 143.0, 166.0, 24.0, 0.0, 14.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0113990354508013, "mean_inference_ms": 2.6712489112000886, "mean_action_processing_ms": 0.5389191534812113, "mean_env_wait_ms": 0.36063665301931436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018250584602355957, "StateBufferConnector_ms": 0.004301905632019043, "ViewRequirementAgentConnector_ms": 0.18163836002349854}, "num_episodes": 23, "episode_return_max": 306.0, "episode_return_min": -612.0, "episode_return_mean": -55.15, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.54504939686836, "num_env_steps_trained_throughput_per_sec": 281.54504939686836, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14607.751, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14607.693, "sample_time_ms": 2242.539, "learn_time_ms": 12344.383, "learn_throughput": 324.034, "synch_weights_time_ms": 16.663}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "f1691_00000", "date": "2024-08-13_16-45-25", "timestamp": 1723581925, "time_this_iter_s": 14.29733920097351, "time_total_s": 419.02659273147583, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 419.02659273147583, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 72.92999999999999, "ram_util_percent": 86.08500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.050839976548518, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.8754880019596647, "policy_loss": -0.0016580671025193715, "vf_loss": 3.8639370045333945, "vf_explained_var": 0.04470613229842413, "kl": 0.019568968975293585, "entropy": 1.2461023982239778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.346267846841661, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.165021161932163, "policy_loss": 0.00321408666635829, "vf_loss": 6.111359671940879, "vf_explained_var": 0.007533070681587098, "kl": 0.014762843109614537, "entropy": 1.264315141256524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -612.0, "episode_reward_mean": -68.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -158.795, "predator_policy": 124.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-538.0, -61.0, 72.0, -37.0, 8.0, -326.0, 17.0, -75.0, -18.0, 29.0, -40.0, 0.0, 28.0, 46.0, -4.0, 14.0, 0.0, -581.0, 4.0, 24.0, 42.0, -218.0, -7.0, -187.0, 9.0, -398.0, 0.0, 33.0, 31.0, -263.0, 15.0, 14.0, 3.0, -18.0, 0.0, 61.0, 0.0, 0.0, -18.0, 1.0, -23.0, -80.0, 194.0, -270.0, 0.0, -120.0, 0.0, -219.0, -202.0, -33.0, 24.0, -155.0, -315.0, -366.0, -247.0, -7.0, -24.0, 0.0, -18.0, -23.0, 306.0, -276.0, -274.0, -90.0, -200.0, -29.0, -612.0, -29.0, 42.0, 0.0, 20.0, -7.0, -129.0, 14.0, 296.0, -63.0, -7.0, 9.0, 6.0, 28.0, -24.0, -1.0, 254.0, 2.0, -136.0, 32.0, -110.0, -133.0, -244.0, -342.0, -492.0, 352.0, 98.0, 58.0, -257.0, 16.0, 51.0, -589.0, -178.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-706.0, -800.0, -322.0, -22.0, 33.0, 32.0, -4.0, -77.0, 1.0, 0.0, -506.0, -438.0, 14.0, -20.0, -66.0, -140.0, -46.0, 0.0, 0.0, 17.0, -22.0, -52.0, 0.0, 0.0, 28.0, 0.0, 22.0, 10.0, 0.0, -8.0, 0.0, -1.0, 0.0, 0.0, -786.0, -826.0, -16.0, -26.0, 21.0, 0.0, 40.0, 0.0, -282.0, -413.0, 0.0, -17.0, -178.0, -140.0, 0.0, -17.0, -520.0, -535.0, 0.0, 0.0, 31.0, 0.0, 27.0, -24.0, -285.0, -252.0, 1.0, -6.0, -5.0, 0.0, -15.0, 4.0, -49.0, 0.0, 0.0, 0.0, -125.0, -666.0, 0.0, 0.0, 3.0, -28.0, -62.0, 2.0, 27.0, -248.0, -126.0, 12.0, -54.0, -54.0, -838.0, -288.0, -326.0, -451.0, -20.0, 10.0, -88.0, -286.0, 0.0, 0.0, -193.0, -608.0, -144.0, -268.0, -7.0, -60.0, 24.0, 0.0, -584.0, -88.0, -380.0, -704.0, -835.0, -311.0, -280.0, -414.0, -34.0, 0.0, -28.0, -10.0, 0.0, 0.0, -36.0, 0.0, -20.0, -28.0, -10.0, -553.0, -460.0, -371.0, -250.0, -228.0, -804.0, -49.0, -200.0, -310.0, -22.0, -65.0, -804.0, -758.0, -60.0, -4.0, 26.0, 3.0, 0.0, 0.0, 0.0, 20.0, 0.0, -28.0, -152.0, -127.0, 14.0, 0.0, -857.0, -66.0, -83.0, -40.0, 0.0, -20.0, -5.0, -15.0, 0.0, -32.0, -180.0, -101.0, 0.0, -48.0, 2.0, -28.0, -12.0, -446.0, 0.0, -12.0, -61.0, -430.0, 0.0, 12.0, -126.0, -86.0, -176.0, -413.0, -330.0, -365.0, -481.0, -381.0, -822.0, -606.0, -54.0, -1184.0, 56.0, 42.0, 25.0, 25.0, -343.0, -858.0, -2.0, 8.0, 1.0, 27.0, -750.0, -866.0, -266.0, -282.0, 0.0, 17.0], "policy_predator_policy_reward": [34.0, 934.0, 11.0, 272.0, 6.0, 1.0, 29.0, 15.0, 7.0, 0.0, 15.0, 603.0, 23.0, 0.0, 15.0, 116.0, 19.0, 9.0, 3.0, 9.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 4.0, 0.0, 12.0, 3.0, 0.0, 0.0, 0.0, 1031.0, 23.0, 23.0, 0.0, 3.0, 2.0, 0.0, 448.0, 29.0, 0.0, 10.0, 17.0, 114.0, 10.0, 16.0, 657.0, 0.0, 0.0, 0.0, 2.0, 0.0, 13.0, 15.0, 274.0, 0.0, 16.0, 4.0, 19.0, 0.0, 14.0, 0.0, 31.0, 0.0, 0.0, 0.0, 399.0, 453.0, 0.0, 0.0, 12.0, 13.0, 18.0, 24.0, 204.0, 18.0, 73.0, 18.0, 24.0, 4.0, 657.0, 663.0, 507.0, 0.0, 0.0, 10.0, 15.0, 239.0, 0.0, 0.0, 29.0, 553.0, 210.0, 0.0, 30.0, 4.0, 0.0, 0.0, 0.0, 517.0, 0.0, 769.0, 4.0, 776.0, 408.0, 39.0, 13.0, 14.0, 0.0, 14.0, 0.0, 0.0, 17.0, 1.0, 15.0, 10.0, 414.0, 455.0, 555.0, 0.0, 0.0, 204.0, 30.0, 733.0, 310.0, 0.0, 26.0, 32.0, 0.0, 950.0, 29.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 82.0, 68.0, 0.0, 0.0, 486.0, 733.0, 39.0, 21.0, 13.0, 0.0, 13.0, 16.0, 26.0, 12.0, 143.0, 166.0, 24.0, 0.0, 14.0, 11.0, 314.0, 398.0, 4.0, 10.0, 5.0, 350.0, 11.0, 9.0, 102.0, 0.0, 16.0, 440.0, 0.0, 451.0, 0.0, 520.0, 0.0, 936.0, 911.0, 679.0, 0.0, 0.0, 2.0, 6.0, 0.0, 944.0, 0.0, 10.0, 7.0, 16.0, 9.0, 1018.0, 356.0, 14.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.012105529811054, "mean_inference_ms": 2.671502513826235, "mean_action_processing_ms": 0.5674521900677433, "mean_env_wait_ms": 0.3612080220822116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017942070960998535, "StateBufferConnector_ms": 0.0038299560546875, "ViewRequirementAgentConnector_ms": 0.17714190483093262}, "num_episodes": 18, "episode_return_max": 352.0, "episode_return_min": -612.0, "episode_return_mean": -68.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.72458081408493, "num_env_steps_trained_throughput_per_sec": 244.72458081408493, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14856.647, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14856.589, "sample_time_ms": 2270.938, "learn_time_ms": 12564.545, "learn_throughput": 318.356, "synch_weights_time_ms": 16.892}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "f1691_00000", "date": "2024-08-13_16-45-41", "timestamp": 1723581941, "time_this_iter_s": 16.403598070144653, "time_total_s": 435.4301908016205, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c49550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 435.4301908016205, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 79.81739130434782, "ram_util_percent": 86.29565217391306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2786754152604511, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.2482341895027766, "policy_loss": 0.0003425104121022202, "vf_loss": 3.2354664074680795, "vf_explained_var": 0.026123071536815985, "kl": 0.01840781442766437, "entropy": 1.2639444836863765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.747003311864914, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.149062312216985, "policy_loss": 0.0022874655628271363, "vf_loss": 4.096530618869439, "vf_explained_var": 0.007606227183468127, "kl": 0.014703386815111042, "entropy": 1.2504292361950748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -612.0, "episode_reward_mean": -59.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -164.37, "predator_policy": 134.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 24.0, 42.0, -218.0, -7.0, -187.0, 9.0, -398.0, 0.0, 33.0, 31.0, -263.0, 15.0, 14.0, 3.0, -18.0, 0.0, 61.0, 0.0, 0.0, -18.0, 1.0, -23.0, -80.0, 194.0, -270.0, 0.0, -120.0, 0.0, -219.0, -202.0, -33.0, 24.0, -155.0, -315.0, -366.0, -247.0, -7.0, -24.0, 0.0, -18.0, -23.0, 306.0, -276.0, -274.0, -90.0, -200.0, -29.0, -612.0, -29.0, 42.0, 0.0, 20.0, -7.0, -129.0, 14.0, 296.0, -63.0, -7.0, 9.0, 6.0, 28.0, -24.0, -1.0, 254.0, 2.0, -136.0, 32.0, -110.0, -133.0, -244.0, -342.0, -492.0, 352.0, 98.0, 58.0, -257.0, 16.0, 51.0, -589.0, -178.0, 17.0, -104.0, 15.0, 23.0, 0.0, 5.0, 23.0, -3.0, 21.0, -74.0, 352.0, 45.0, 11.0, -379.0, 36.0, -236.0, 17.0, -260.0, -52.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, -26.0, 21.0, 0.0, 40.0, 0.0, -282.0, -413.0, 0.0, -17.0, -178.0, -140.0, 0.0, -17.0, -520.0, -535.0, 0.0, 0.0, 31.0, 0.0, 27.0, -24.0, -285.0, -252.0, 1.0, -6.0, -5.0, 0.0, -15.0, 4.0, -49.0, 0.0, 0.0, 0.0, -125.0, -666.0, 0.0, 0.0, 3.0, -28.0, -62.0, 2.0, 27.0, -248.0, -126.0, 12.0, -54.0, -54.0, -838.0, -288.0, -326.0, -451.0, -20.0, 10.0, -88.0, -286.0, 0.0, 0.0, -193.0, -608.0, -144.0, -268.0, -7.0, -60.0, 24.0, 0.0, -584.0, -88.0, -380.0, -704.0, -835.0, -311.0, -280.0, -414.0, -34.0, 0.0, -28.0, -10.0, 0.0, 0.0, -36.0, 0.0, -20.0, -28.0, -10.0, -553.0, -460.0, -371.0, -250.0, -228.0, -804.0, -49.0, -200.0, -310.0, -22.0, -65.0, -804.0, -758.0, -60.0, -4.0, 26.0, 3.0, 0.0, 0.0, 0.0, 20.0, 0.0, -28.0, -152.0, -127.0, 14.0, 0.0, -857.0, -66.0, -83.0, -40.0, 0.0, -20.0, -5.0, -15.0, 0.0, -32.0, -180.0, -101.0, 0.0, -48.0, 2.0, -28.0, -12.0, -446.0, 0.0, -12.0, -61.0, -430.0, 0.0, 12.0, -126.0, -86.0, -176.0, -413.0, -330.0, -365.0, -481.0, -381.0, -822.0, -606.0, -54.0, -1184.0, 56.0, 42.0, 25.0, 25.0, -343.0, -858.0, -2.0, 8.0, 1.0, 27.0, -750.0, -866.0, -266.0, -282.0, 0.0, 17.0, -66.0, -256.0, 0.0, 15.0, -4.0, 18.0, 0.0, 0.0, -14.0, -8.0, 23.0, 0.0, 0.0, -6.0, -38.0, 40.0, -800.0, -750.0, -750.0, -34.0, -230.0, 50.0, -2.0, 12.0, -970.0, -440.0, 36.0, 0.0, -178.0, -594.0, 0.0, 17.0, -431.0, -336.0, 0.0, -104.0], "policy_predator_policy_reward": [23.0, 23.0, 0.0, 3.0, 2.0, 0.0, 448.0, 29.0, 0.0, 10.0, 17.0, 114.0, 10.0, 16.0, 657.0, 0.0, 0.0, 0.0, 2.0, 0.0, 13.0, 15.0, 274.0, 0.0, 16.0, 4.0, 19.0, 0.0, 14.0, 0.0, 31.0, 0.0, 0.0, 0.0, 399.0, 453.0, 0.0, 0.0, 12.0, 13.0, 18.0, 24.0, 204.0, 18.0, 73.0, 18.0, 24.0, 4.0, 657.0, 663.0, 507.0, 0.0, 0.0, 10.0, 15.0, 239.0, 0.0, 0.0, 29.0, 553.0, 210.0, 0.0, 30.0, 4.0, 0.0, 0.0, 0.0, 517.0, 0.0, 769.0, 4.0, 776.0, 408.0, 39.0, 13.0, 14.0, 0.0, 14.0, 0.0, 0.0, 17.0, 1.0, 15.0, 10.0, 414.0, 455.0, 555.0, 0.0, 0.0, 204.0, 30.0, 733.0, 310.0, 0.0, 26.0, 32.0, 0.0, 950.0, 29.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 82.0, 68.0, 0.0, 0.0, 486.0, 733.0, 39.0, 21.0, 13.0, 0.0, 13.0, 16.0, 26.0, 12.0, 143.0, 166.0, 24.0, 0.0, 14.0, 11.0, 314.0, 398.0, 4.0, 10.0, 5.0, 350.0, 11.0, 9.0, 102.0, 0.0, 16.0, 440.0, 0.0, 451.0, 0.0, 520.0, 0.0, 936.0, 911.0, 679.0, 0.0, 0.0, 2.0, 6.0, 0.0, 944.0, 0.0, 10.0, 7.0, 16.0, 9.0, 1018.0, 356.0, 14.0, 0.0, 0.0, 0.0, 218.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 24.0, 0.0, 0.0, 0.0, 3.0, 0.0, 19.0, 713.0, 763.0, 602.0, 534.0, 224.0, 1.0, 1.0, 0.0, 0.0, 1031.0, 0.0, 0.0, 26.0, 510.0, 0.0, 0.0, 507.0, 0.0, 0.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0143106759400558, "mean_inference_ms": 2.6743999298242933, "mean_action_processing_ms": 0.564826426666938, "mean_env_wait_ms": 0.3620361918665535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018097281455993652, "StateBufferConnector_ms": 0.0042961835861206055, "ViewRequirementAgentConnector_ms": 0.2053689956665039}, "num_episodes": 18, "episode_return_max": 352.0, "episode_return_min": -612.0, "episode_return_mean": -59.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.14492094043, "num_env_steps_trained_throughput_per_sec": 274.14492094043, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14882.175, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14882.117, "sample_time_ms": 2284.786, "learn_time_ms": 12576.29, "learn_throughput": 318.059, "synch_weights_time_ms": 16.607}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "f1691_00000", "date": "2024-08-13_16-45-56", "timestamp": 1723581956, "time_this_iter_s": 14.659098863601685, "time_total_s": 450.08928966522217, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 450.08928966522217, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 77.44761904761906, "ram_util_percent": 86.61904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9676485590518467, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.5444642621373372, "policy_loss": -0.00010648315745312228, "vf_loss": 2.5337490018082676, "vf_explained_var": 0.027942798188123754, "kl": 0.016032208226032425, "entropy": 1.2757902536442671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.283789665705313, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.1075760643318215, "policy_loss": 0.0023107299809073095, "vf_loss": 3.055457399572645, "vf_explained_var": 0.007634976332780545, "kl": 0.014575711424311126, "entropy": 1.3266573494704312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -612.0, "episode_reward_mean": -58.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -164.645, "predator_policy": 135.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -18.0, 1.0, -23.0, -80.0, 194.0, -270.0, 0.0, -120.0, 0.0, -219.0, -202.0, -33.0, 24.0, -155.0, -315.0, -366.0, -247.0, -7.0, -24.0, 0.0, -18.0, -23.0, 306.0, -276.0, -274.0, -90.0, -200.0, -29.0, -612.0, -29.0, 42.0, 0.0, 20.0, -7.0, -129.0, 14.0, 296.0, -63.0, -7.0, 9.0, 6.0, 28.0, -24.0, -1.0, 254.0, 2.0, -136.0, 32.0, -110.0, -133.0, -244.0, -342.0, -492.0, 352.0, 98.0, 58.0, -257.0, 16.0, 51.0, -589.0, -178.0, 17.0, -104.0, 15.0, 23.0, 0.0, 5.0, 23.0, -3.0, 21.0, -74.0, 352.0, 45.0, 11.0, -379.0, 36.0, -236.0, 17.0, -260.0, -52.0, -367.0, -71.0, -17.0, -70.0, 8.0, 51.0, 90.0, 52.0, -136.0, 11.0, -411.0, 0.0, 18.0, 25.0, 47.0, 39.0, -22.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 3.0, -28.0, -62.0, 2.0, 27.0, -248.0, -126.0, 12.0, -54.0, -54.0, -838.0, -288.0, -326.0, -451.0, -20.0, 10.0, -88.0, -286.0, 0.0, 0.0, -193.0, -608.0, -144.0, -268.0, -7.0, -60.0, 24.0, 0.0, -584.0, -88.0, -380.0, -704.0, -835.0, -311.0, -280.0, -414.0, -34.0, 0.0, -28.0, -10.0, 0.0, 0.0, -36.0, 0.0, -20.0, -28.0, -10.0, -553.0, -460.0, -371.0, -250.0, -228.0, -804.0, -49.0, -200.0, -310.0, -22.0, -65.0, -804.0, -758.0, -60.0, -4.0, 26.0, 3.0, 0.0, 0.0, 0.0, 20.0, 0.0, -28.0, -152.0, -127.0, 14.0, 0.0, -857.0, -66.0, -83.0, -40.0, 0.0, -20.0, -5.0, -15.0, 0.0, -32.0, -180.0, -101.0, 0.0, -48.0, 2.0, -28.0, -12.0, -446.0, 0.0, -12.0, -61.0, -430.0, 0.0, 12.0, -126.0, -86.0, -176.0, -413.0, -330.0, -365.0, -481.0, -381.0, -822.0, -606.0, -54.0, -1184.0, 56.0, 42.0, 25.0, 25.0, -343.0, -858.0, -2.0, 8.0, 1.0, 27.0, -750.0, -866.0, -266.0, -282.0, 0.0, 17.0, -66.0, -256.0, 0.0, 15.0, -4.0, 18.0, 0.0, 0.0, -14.0, -8.0, 23.0, 0.0, 0.0, -6.0, -38.0, 40.0, -800.0, -750.0, -750.0, -34.0, -230.0, 50.0, -2.0, 12.0, -970.0, -440.0, 36.0, 0.0, -178.0, -594.0, 0.0, 17.0, -431.0, -336.0, 0.0, -104.0, -318.0, -706.0, 17.0, -236.0, 32.0, -394.0, -221.0, 0.0, 0.0, 0.0, 0.0, 51.0, 38.0, 50.0, 31.0, 20.0, -138.0, -126.0, 0.0, 11.0, -698.0, -424.0, 0.0, 0.0, 14.0, 0.0, 13.0, -410.0, 0.0, 47.0, 4.0, 35.0, -43.0, -146.0, -20.0, 15.0], "policy_predator_policy_reward": [0.0, 0.0, 12.0, 13.0, 18.0, 24.0, 204.0, 18.0, 73.0, 18.0, 24.0, 4.0, 657.0, 663.0, 507.0, 0.0, 0.0, 10.0, 15.0, 239.0, 0.0, 0.0, 29.0, 553.0, 210.0, 0.0, 30.0, 4.0, 0.0, 0.0, 0.0, 517.0, 0.0, 769.0, 4.0, 776.0, 408.0, 39.0, 13.0, 14.0, 0.0, 14.0, 0.0, 0.0, 17.0, 1.0, 15.0, 10.0, 414.0, 455.0, 555.0, 0.0, 0.0, 204.0, 30.0, 733.0, 310.0, 0.0, 26.0, 32.0, 0.0, 950.0, 29.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 82.0, 68.0, 0.0, 0.0, 486.0, 733.0, 39.0, 21.0, 13.0, 0.0, 13.0, 16.0, 26.0, 12.0, 143.0, 166.0, 24.0, 0.0, 14.0, 11.0, 314.0, 398.0, 4.0, 10.0, 5.0, 350.0, 11.0, 9.0, 102.0, 0.0, 16.0, 440.0, 0.0, 451.0, 0.0, 520.0, 0.0, 936.0, 911.0, 679.0, 0.0, 0.0, 2.0, 6.0, 0.0, 944.0, 0.0, 10.0, 7.0, 16.0, 9.0, 1018.0, 356.0, 14.0, 0.0, 0.0, 0.0, 218.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 24.0, 0.0, 0.0, 0.0, 3.0, 0.0, 19.0, 713.0, 763.0, 602.0, 534.0, 224.0, 1.0, 1.0, 0.0, 0.0, 1031.0, 0.0, 0.0, 26.0, 510.0, 0.0, 0.0, 507.0, 0.0, 0.0, 52.0, 642.0, 15.0, 0.0, 148.0, 9.0, 336.0, 0.0, 151.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 103.0, 25.0, 0.0, 0.0, 711.0, 0.0, 0.0, 0.0, 1.0, 3.0, 175.0, 247.0, 0.0, 0.0, 0.0, 0.0, 167.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0161782771207775, "mean_inference_ms": 2.6760786616868497, "mean_action_processing_ms": 0.5600491807872962, "mean_env_wait_ms": 0.36247965708272006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015624523162841797, "StateBufferConnector_ms": 0.004333615303039551, "ViewRequirementAgentConnector_ms": 0.18530237674713135}, "num_episodes": 18, "episode_return_max": 352.0, "episode_return_min": -612.0, "episode_return_mean": -58.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.6851407809049, "num_env_steps_trained_throughput_per_sec": 260.6851407809049, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 14940.933, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14940.875, "sample_time_ms": 2272.123, "learn_time_ms": 12648.085, "learn_throughput": 316.253, "synch_weights_time_ms": 16.029}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "f1691_00000", "date": "2024-08-13_16-46-11", "timestamp": 1723581971, "time_this_iter_s": 15.408087015151978, "time_total_s": 465.49737668037415, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 465.49737668037415, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 78.40454545454544, "ram_util_percent": 85.81363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7389476230535558, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 4.451296619385007, "policy_loss": -0.0011476031582181652, "vf_loss": 4.4412180536007755, "vf_explained_var": 0.023585020013587185, "kl": 0.01663135840937094, "entropy": 1.1802858421411464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.54461246258998, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.086646913599085, "policy_loss": 0.0035959581235946014, "vf_loss": 6.036005314821919, "vf_explained_var": 0.005613735523173418, "kl": 0.01376735602579073, "entropy": 1.302299195811862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 352.0, "episode_reward_min": -612.0, "episode_reward_mean": -58.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -170.42, "predator_policy": 141.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0, -200.0, -29.0, -612.0, -29.0, 42.0, 0.0, 20.0, -7.0, -129.0, 14.0, 296.0, -63.0, -7.0, 9.0, 6.0, 28.0, -24.0, -1.0, 254.0, 2.0, -136.0, 32.0, -110.0, -133.0, -244.0, -342.0, -492.0, 352.0, 98.0, 58.0, -257.0, 16.0, 51.0, -589.0, -178.0, 17.0, -104.0, 15.0, 23.0, 0.0, 5.0, 23.0, -3.0, 21.0, -74.0, 352.0, 45.0, 11.0, -379.0, 36.0, -236.0, 17.0, -260.0, -52.0, -367.0, -71.0, -17.0, -70.0, 8.0, 51.0, 90.0, 52.0, -136.0, 11.0, -411.0, 0.0, 18.0, 25.0, 47.0, 39.0, -22.0, 5.0, -3.0, 0.0, -86.0, 9.0, -67.0, -121.0, -31.0, -439.0, 43.0, 3.0, 6.0, -543.0, -94.0, -46.0, -522.0, 22.0, -59.0, -182.0, -80.0, 345.0, -199.0, 38.0, 18.0, 9.0, -212.0, 19.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-804.0, -49.0, -200.0, -310.0, -22.0, -65.0, -804.0, -758.0, -60.0, -4.0, 26.0, 3.0, 0.0, 0.0, 0.0, 20.0, 0.0, -28.0, -152.0, -127.0, 14.0, 0.0, -857.0, -66.0, -83.0, -40.0, 0.0, -20.0, -5.0, -15.0, 0.0, -32.0, -180.0, -101.0, 0.0, -48.0, 2.0, -28.0, -12.0, -446.0, 0.0, -12.0, -61.0, -430.0, 0.0, 12.0, -126.0, -86.0, -176.0, -413.0, -330.0, -365.0, -481.0, -381.0, -822.0, -606.0, -54.0, -1184.0, 56.0, 42.0, 25.0, 25.0, -343.0, -858.0, -2.0, 8.0, 1.0, 27.0, -750.0, -866.0, -266.0, -282.0, 0.0, 17.0, -66.0, -256.0, 0.0, 15.0, -4.0, 18.0, 0.0, 0.0, -14.0, -8.0, 23.0, 0.0, 0.0, -6.0, -38.0, 40.0, -800.0, -750.0, -750.0, -34.0, -230.0, 50.0, -2.0, 12.0, -970.0, -440.0, 36.0, 0.0, -178.0, -594.0, 0.0, 17.0, -431.0, -336.0, 0.0, -104.0, -318.0, -706.0, 17.0, -236.0, 32.0, -394.0, -221.0, 0.0, 0.0, 0.0, 0.0, 51.0, 38.0, 50.0, 31.0, 20.0, -138.0, -126.0, 0.0, 11.0, -698.0, -424.0, 0.0, 0.0, 14.0, 0.0, 13.0, -410.0, 0.0, 47.0, 4.0, 35.0, -43.0, -146.0, -20.0, 15.0, 0.0, -31.0, 0.0, 0.0, -768.0, 38.0, 0.0, 5.0, 39.0, -542.0, -434.0, 1.0, -56.0, -17.0, -498.0, -457.0, 42.0, 0.0, -10.0, 0.0, 0.0, -190.0, -642.0, -810.0, -33.0, -282.0, -441.0, 17.0, -810.0, -614.0, 0.0, 14.0, -624.0, -222.0, -700.0, -92.0, -12.0, -298.0, -792.0, 22.0, -88.0, -776.0, 45.0, -14.0, 19.0, -31.0, -6.0, 7.0, -96.0, -656.0, -70.0, 10.0, 0.0, 3.0], "policy_predator_policy_reward": [30.0, 733.0, 310.0, 0.0, 26.0, 32.0, 0.0, 950.0, 29.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 82.0, 68.0, 0.0, 0.0, 486.0, 733.0, 39.0, 21.0, 13.0, 0.0, 13.0, 16.0, 26.0, 12.0, 143.0, 166.0, 24.0, 0.0, 14.0, 11.0, 314.0, 398.0, 4.0, 10.0, 5.0, 350.0, 11.0, 9.0, 102.0, 0.0, 16.0, 440.0, 0.0, 451.0, 0.0, 520.0, 0.0, 936.0, 911.0, 679.0, 0.0, 0.0, 2.0, 6.0, 0.0, 944.0, 0.0, 10.0, 7.0, 16.0, 9.0, 1018.0, 356.0, 14.0, 0.0, 0.0, 0.0, 218.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 24.0, 0.0, 0.0, 0.0, 3.0, 0.0, 19.0, 713.0, 763.0, 602.0, 534.0, 224.0, 1.0, 1.0, 0.0, 0.0, 1031.0, 0.0, 0.0, 26.0, 510.0, 0.0, 0.0, 507.0, 0.0, 0.0, 52.0, 642.0, 15.0, 0.0, 148.0, 9.0, 336.0, 0.0, 151.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 103.0, 25.0, 0.0, 0.0, 711.0, 0.0, 0.0, 0.0, 1.0, 3.0, 175.0, 247.0, 0.0, 0.0, 0.0, 0.0, 167.0, 0.0, 10.0, 0.0, 21.0, 7.0, 0.0, 0.0, 644.0, 0.0, 0.0, 4.0, 0.0, 436.0, 0.0, 312.0, 0.0, 42.0, 516.0, 0.0, 1.0, 0.0, 0.0, 13.0, 48.0, 148.0, 0.0, 909.0, 201.0, 20.0, 0.0, 378.0, 0.0, 902.0, 8.0, 0.0, 464.0, 323.0, 0.0, 610.0, 6.0, 224.0, 554.0, 561.0, 8.0, 657.0, 7.0, 0.0, 22.0, 8.0, 0.0, 8.0, 540.0, 0.0, 79.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0189547436260677, "mean_inference_ms": 2.6835325885622803, "mean_action_processing_ms": 0.5561571603043999, "mean_env_wait_ms": 0.3631424981386401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010351777076721191, "StateBufferConnector_ms": 0.00523531436920166, "ViewRequirementAgentConnector_ms": 0.19101500511169434}, "num_episodes": 27, "episode_return_max": 352.0, "episode_return_min": -612.0, "episode_return_mean": -58.54, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.4686439289556, "num_env_steps_trained_throughput_per_sec": 276.4686439289556, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 14892.575, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14892.512, "sample_time_ms": 2239.434, "learn_time_ms": 12632.29, "learn_throughput": 316.649, "synch_weights_time_ms": 16.076}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "f1691_00000", "date": "2024-08-13_16-46-26", "timestamp": 1723581986, "time_this_iter_s": 14.540840864181519, "time_total_s": 480.03821754455566, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 480.03821754455566, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 77.1095238095238, "ram_util_percent": 86.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8344147111846025, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 7.610315945034936, "policy_loss": -0.0016204217981014932, "vf_loss": 7.599801781316283, "vf_explained_var": 0.01781720550602706, "kl": 0.017977167010906635, "entropy": 1.1637858275698607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.642841545520006, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 9.286762589752358, "policy_loss": 0.003156842078111829, "vf_loss": 9.231141592964294, "vf_explained_var": 0.01091495361277666, "kl": 0.015353018950095223, "entropy": 1.3490078034224333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 447.0, "episode_reward_min": -589.0, "episode_reward_mean": -70.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 56.0, "predator_policy": 1031.0}, "policy_reward_mean": {"prey_policy": -224.155, "predator_policy": 189.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 254.0, 2.0, -136.0, 32.0, -110.0, -133.0, -244.0, -342.0, -492.0, 352.0, 98.0, 58.0, -257.0, 16.0, 51.0, -589.0, -178.0, 17.0, -104.0, 15.0, 23.0, 0.0, 5.0, 23.0, -3.0, 21.0, -74.0, 352.0, 45.0, 11.0, -379.0, 36.0, -236.0, 17.0, -260.0, -52.0, -367.0, -71.0, -17.0, -70.0, 8.0, 51.0, 90.0, 52.0, -136.0, 11.0, -411.0, 0.0, 18.0, 25.0, 47.0, 39.0, -22.0, 5.0, -3.0, 0.0, -86.0, 9.0, -67.0, -121.0, -31.0, -439.0, 43.0, 3.0, 6.0, -543.0, -94.0, -46.0, -522.0, 22.0, -59.0, -182.0, -80.0, 345.0, -199.0, 38.0, 18.0, 9.0, -212.0, 19.0, 3.0, -5.0, -588.0, -49.0, 447.0, -391.0, 65.0, -113.0, -30.0, -263.0, -133.0, -383.0, -381.0, -361.0, 40.0, 332.0, -44.0, -348.0, 268.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, -28.0, -12.0, -446.0, 0.0, -12.0, -61.0, -430.0, 0.0, 12.0, -126.0, -86.0, -176.0, -413.0, -330.0, -365.0, -481.0, -381.0, -822.0, -606.0, -54.0, -1184.0, 56.0, 42.0, 25.0, 25.0, -343.0, -858.0, -2.0, 8.0, 1.0, 27.0, -750.0, -866.0, -266.0, -282.0, 0.0, 17.0, -66.0, -256.0, 0.0, 15.0, -4.0, 18.0, 0.0, 0.0, -14.0, -8.0, 23.0, 0.0, 0.0, -6.0, -38.0, 40.0, -800.0, -750.0, -750.0, -34.0, -230.0, 50.0, -2.0, 12.0, -970.0, -440.0, 36.0, 0.0, -178.0, -594.0, 0.0, 17.0, -431.0, -336.0, 0.0, -104.0, -318.0, -706.0, 17.0, -236.0, 32.0, -394.0, -221.0, 0.0, 0.0, 0.0, 0.0, 51.0, 38.0, 50.0, 31.0, 20.0, -138.0, -126.0, 0.0, 11.0, -698.0, -424.0, 0.0, 0.0, 14.0, 0.0, 13.0, -410.0, 0.0, 47.0, 4.0, 35.0, -43.0, -146.0, -20.0, 15.0, 0.0, -31.0, 0.0, 0.0, -768.0, 38.0, 0.0, 5.0, 39.0, -542.0, -434.0, 1.0, -56.0, -17.0, -498.0, -457.0, 42.0, 0.0, -10.0, 0.0, 0.0, -190.0, -642.0, -810.0, -33.0, -282.0, -441.0, 17.0, -810.0, -614.0, 0.0, 14.0, -624.0, -222.0, -700.0, -92.0, -12.0, -298.0, -792.0, 22.0, -88.0, -776.0, 45.0, -14.0, 19.0, -31.0, -6.0, 7.0, -96.0, -656.0, -70.0, 10.0, 0.0, 3.0, -700.0, -636.0, -822.0, -738.0, -38.0, -54.0, -189.0, -932.0, -418.0, -538.0, -81.0, -128.0, -204.0, -1038.0, -128.0, -22.0, -319.0, -262.0, -586.0, -622.0, -475.0, -704.0, -844.0, -488.0, -405.0, -529.0, -122.0, 13.0, -804.0, -153.0, -188.0, -70.0, -365.0, -366.0, -880.0, -679.0], "policy_predator_policy_reward": [14.0, 11.0, 314.0, 398.0, 4.0, 10.0, 5.0, 350.0, 11.0, 9.0, 102.0, 0.0, 16.0, 440.0, 0.0, 451.0, 0.0, 520.0, 0.0, 936.0, 911.0, 679.0, 0.0, 0.0, 2.0, 6.0, 0.0, 944.0, 0.0, 10.0, 7.0, 16.0, 9.0, 1018.0, 356.0, 14.0, 0.0, 0.0, 0.0, 218.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 24.0, 0.0, 0.0, 0.0, 3.0, 0.0, 19.0, 713.0, 763.0, 602.0, 534.0, 224.0, 1.0, 1.0, 0.0, 0.0, 1031.0, 0.0, 0.0, 26.0, 510.0, 0.0, 0.0, 507.0, 0.0, 0.0, 52.0, 642.0, 15.0, 0.0, 148.0, 9.0, 336.0, 0.0, 151.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 103.0, 25.0, 0.0, 0.0, 711.0, 0.0, 0.0, 0.0, 1.0, 3.0, 175.0, 247.0, 0.0, 0.0, 0.0, 0.0, 167.0, 0.0, 10.0, 0.0, 21.0, 7.0, 0.0, 0.0, 644.0, 0.0, 0.0, 4.0, 0.0, 436.0, 0.0, 312.0, 0.0, 42.0, 516.0, 0.0, 1.0, 0.0, 0.0, 13.0, 48.0, 148.0, 0.0, 909.0, 201.0, 20.0, 0.0, 378.0, 0.0, 902.0, 8.0, 0.0, 464.0, 323.0, 0.0, 610.0, 6.0, 224.0, 554.0, 561.0, 8.0, 657.0, 7.0, 0.0, 22.0, 8.0, 0.0, 8.0, 540.0, 0.0, 79.0, 0.0, 0.0, 0.0, 971.0, 360.0, 0.0, 972.0, 28.0, 15.0, 767.0, 801.0, 565.0, 0.0, 161.0, 113.0, 162.0, 967.0, 15.0, 105.0, 296.0, 22.0, 292.0, 783.0, 757.0, 39.0, 951.0, 0.0, 35.0, 538.0, 73.0, 76.0, 727.0, 562.0, 89.0, 125.0, 18.0, 365.0, 909.0, 918.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.017244292562315, "mean_inference_ms": 2.67600638645086, "mean_action_processing_ms": 0.5486407051447428, "mean_env_wait_ms": 0.3630907655024086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007094144821166992, "StateBufferConnector_ms": 0.005560755729675293, "ViewRequirementAgentConnector_ms": 0.18356537818908691}, "num_episodes": 18, "episode_return_max": 447.0, "episode_return_min": -589.0, "episode_return_mean": -70.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.82984476530305, "num_env_steps_trained_throughput_per_sec": 266.82984476530305, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 14968.596, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14968.534, "sample_time_ms": 2242.78, "learn_time_ms": 12705.887, "learn_throughput": 314.815, "synch_weights_time_ms": 15.45}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "f1691_00000", "date": "2024-08-13_16-46-41", "timestamp": 1723582001, "time_this_iter_s": 15.019858121871948, "time_total_s": 495.0580756664276, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 495.0580756664276, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 78.74285714285715, "ram_util_percent": 86.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2282563560538822, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 5.345562465102584, "policy_loss": -0.00035114892704225093, "vf_loss": 5.332790096726998, "vf_explained_var": 0.0198390610318966, "kl": 0.019442245681374704, "entropy": 1.1818233954528021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.488867787961607, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 7.170715573225072, "policy_loss": 0.002707421952099712, "vf_loss": 7.119006961489481, "vf_explained_var": 0.004869974132568117, "kl": 0.014339624600603534, "entropy": 1.3464266262357196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 447.0, "episode_reward_min": -612.0, "episode_reward_mean": -78.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1038.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 51.0, "predator_policy": 1046.0}, "policy_reward_mean": {"prey_policy": -235.125, "predator_policy": 196.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, -104.0, 15.0, 23.0, 0.0, 5.0, 23.0, -3.0, 21.0, -74.0, 352.0, 45.0, 11.0, -379.0, 36.0, -236.0, 17.0, -260.0, -52.0, -367.0, -71.0, -17.0, -70.0, 8.0, 51.0, 90.0, 52.0, -136.0, 11.0, -411.0, 0.0, 18.0, 25.0, 47.0, 39.0, -22.0, 5.0, -3.0, 0.0, -86.0, 9.0, -67.0, -121.0, -31.0, -439.0, 43.0, 3.0, 6.0, -543.0, -94.0, -46.0, -522.0, 22.0, -59.0, -182.0, -80.0, 345.0, -199.0, 38.0, 18.0, 9.0, -212.0, 19.0, 3.0, -5.0, -588.0, -49.0, 447.0, -391.0, 65.0, -113.0, -30.0, -263.0, -133.0, -383.0, -381.0, -361.0, 40.0, 332.0, -44.0, -348.0, 268.0, 154.0, -18.0, -256.0, -22.0, -486.0, -173.0, -80.0, 25.0, -144.0, -318.0, -172.0, 4.0, -144.0, -368.0, -70.0, -612.0, 240.0, 19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 17.0, -66.0, -256.0, 0.0, 15.0, -4.0, 18.0, 0.0, 0.0, -14.0, -8.0, 23.0, 0.0, 0.0, -6.0, -38.0, 40.0, -800.0, -750.0, -750.0, -34.0, -230.0, 50.0, -2.0, 12.0, -970.0, -440.0, 36.0, 0.0, -178.0, -594.0, 0.0, 17.0, -431.0, -336.0, 0.0, -104.0, -318.0, -706.0, 17.0, -236.0, 32.0, -394.0, -221.0, 0.0, 0.0, 0.0, 0.0, 51.0, 38.0, 50.0, 31.0, 20.0, -138.0, -126.0, 0.0, 11.0, -698.0, -424.0, 0.0, 0.0, 14.0, 0.0, 13.0, -410.0, 0.0, 47.0, 4.0, 35.0, -43.0, -146.0, -20.0, 15.0, 0.0, -31.0, 0.0, 0.0, -768.0, 38.0, 0.0, 5.0, 39.0, -542.0, -434.0, 1.0, -56.0, -17.0, -498.0, -457.0, 42.0, 0.0, -10.0, 0.0, 0.0, -190.0, -642.0, -810.0, -33.0, -282.0, -441.0, 17.0, -810.0, -614.0, 0.0, 14.0, -624.0, -222.0, -700.0, -92.0, -12.0, -298.0, -792.0, 22.0, -88.0, -776.0, 45.0, -14.0, 19.0, -31.0, -6.0, 7.0, -96.0, -656.0, -70.0, 10.0, 0.0, 3.0, -700.0, -636.0, -822.0, -738.0, -38.0, -54.0, -189.0, -932.0, -418.0, -538.0, -81.0, -128.0, -204.0, -1038.0, -128.0, -22.0, -319.0, -262.0, -586.0, -622.0, -475.0, -704.0, -844.0, -488.0, -405.0, -529.0, -122.0, 13.0, -804.0, -153.0, -188.0, -70.0, -365.0, -366.0, -880.0, -679.0, 41.0, -362.0, -8.0, -38.0, -268.0, -459.0, -16.0, -14.0, -772.0, -657.0, -164.0, -347.0, -402.0, -15.0, -826.0, 43.0, -266.0, -46.0, -708.0, -254.0, -446.0, -48.0, -4.0, -362.0, -588.0, -150.0, -490.0, -626.0, -766.0, 38.0, -764.0, -894.0, -750.0, -6.0, 0.0, 18.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 218.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 24.0, 0.0, 0.0, 0.0, 3.0, 0.0, 19.0, 713.0, 763.0, 602.0, 534.0, 224.0, 1.0, 1.0, 0.0, 0.0, 1031.0, 0.0, 0.0, 26.0, 510.0, 0.0, 0.0, 507.0, 0.0, 0.0, 52.0, 642.0, 15.0, 0.0, 148.0, 9.0, 336.0, 0.0, 151.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 103.0, 25.0, 0.0, 0.0, 711.0, 0.0, 0.0, 0.0, 1.0, 3.0, 175.0, 247.0, 0.0, 0.0, 0.0, 0.0, 167.0, 0.0, 10.0, 0.0, 21.0, 7.0, 0.0, 0.0, 644.0, 0.0, 0.0, 4.0, 0.0, 436.0, 0.0, 312.0, 0.0, 42.0, 516.0, 0.0, 1.0, 0.0, 0.0, 13.0, 48.0, 148.0, 0.0, 909.0, 201.0, 20.0, 0.0, 378.0, 0.0, 902.0, 8.0, 0.0, 464.0, 323.0, 0.0, 610.0, 6.0, 224.0, 554.0, 561.0, 8.0, 657.0, 7.0, 0.0, 22.0, 8.0, 0.0, 8.0, 540.0, 0.0, 79.0, 0.0, 0.0, 0.0, 971.0, 360.0, 0.0, 972.0, 28.0, 15.0, 767.0, 801.0, 565.0, 0.0, 161.0, 113.0, 162.0, 967.0, 15.0, 105.0, 296.0, 22.0, 292.0, 783.0, 757.0, 39.0, 951.0, 0.0, 35.0, 538.0, 73.0, 76.0, 727.0, 562.0, 89.0, 125.0, 18.0, 365.0, 909.0, 918.0, 243.0, 232.0, 13.0, 15.0, 16.0, 455.0, 8.0, 0.0, 0.0, 943.0, 0.0, 338.0, 32.0, 305.0, 647.0, 161.0, 0.0, 168.0, 605.0, 39.0, 322.0, 0.0, 195.0, 175.0, 0.0, 594.0, 0.0, 748.0, 0.0, 658.0, 0.0, 1046.0, 491.0, 505.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0140372940126476, "mean_inference_ms": 2.6680989745950034, "mean_action_processing_ms": 0.5437624538144763, "mean_env_wait_ms": 0.3620191009615151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007106184959411621, "StateBufferConnector_ms": 0.005585312843322754, "ViewRequirementAgentConnector_ms": 0.17943966388702393}, "num_episodes": 18, "episode_return_max": 447.0, "episode_return_min": -612.0, "episode_return_mean": -78.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.38187289187186, "num_env_steps_trained_throughput_per_sec": 292.38187289187186, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 14811.241, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14811.176, "sample_time_ms": 2210.011, "learn_time_ms": 12578.921, "learn_throughput": 317.992, "synch_weights_time_ms": 18.221}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "f1691_00000", "date": "2024-08-13_16-46-55", "timestamp": 1723582015, "time_this_iter_s": 13.775176286697388, "time_total_s": 508.833251953125, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 508.833251953125, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 74.14736842105262, "ram_util_percent": 85.21578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.005235811673775, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 7.407370291815864, "policy_loss": -0.0007383181683955685, "vf_loss": 7.394883498186788, "vf_explained_var": 0.03525776882020254, "kl": 0.01959274938370136, "entropy": 1.1413132321897639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.921488030057736, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 8.59746413230896, "policy_loss": 0.002431686255568392, "vf_loss": 8.5444526589106, "vf_explained_var": 0.00494062723936858, "kl": 0.014801574604295781, "entropy": 1.3509569497335525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 447.0, "episode_reward_min": -612.0, "episode_reward_mean": -75.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1038.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 51.0, "predator_policy": 1046.0}, "policy_reward_mean": {"prey_policy": -261.725, "predator_policy": 223.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.0, -367.0, -71.0, -17.0, -70.0, 8.0, 51.0, 90.0, 52.0, -136.0, 11.0, -411.0, 0.0, 18.0, 25.0, 47.0, 39.0, -22.0, 5.0, -3.0, 0.0, -86.0, 9.0, -67.0, -121.0, -31.0, -439.0, 43.0, 3.0, 6.0, -543.0, -94.0, -46.0, -522.0, 22.0, -59.0, -182.0, -80.0, 345.0, -199.0, 38.0, 18.0, 9.0, -212.0, 19.0, 3.0, -5.0, -588.0, -49.0, 447.0, -391.0, 65.0, -113.0, -30.0, -263.0, -133.0, -383.0, -381.0, -361.0, 40.0, 332.0, -44.0, -348.0, 268.0, 154.0, -18.0, -256.0, -22.0, -486.0, -173.0, -80.0, 25.0, -144.0, -318.0, -172.0, 4.0, -144.0, -368.0, -70.0, -612.0, 240.0, 19.0, -20.0, 203.0, -154.0, -5.0, -101.0, 33.0, -103.0, -42.0, -14.0, -94.0, -83.0, -100.0, 150.0, -94.0, -54.0, -128.0, 59.0, 285.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -104.0, -318.0, -706.0, 17.0, -236.0, 32.0, -394.0, -221.0, 0.0, 0.0, 0.0, 0.0, 51.0, 38.0, 50.0, 31.0, 20.0, -138.0, -126.0, 0.0, 11.0, -698.0, -424.0, 0.0, 0.0, 14.0, 0.0, 13.0, -410.0, 0.0, 47.0, 4.0, 35.0, -43.0, -146.0, -20.0, 15.0, 0.0, -31.0, 0.0, 0.0, -768.0, 38.0, 0.0, 5.0, 39.0, -542.0, -434.0, 1.0, -56.0, -17.0, -498.0, -457.0, 42.0, 0.0, -10.0, 0.0, 0.0, -190.0, -642.0, -810.0, -33.0, -282.0, -441.0, 17.0, -810.0, -614.0, 0.0, 14.0, -624.0, -222.0, -700.0, -92.0, -12.0, -298.0, -792.0, 22.0, -88.0, -776.0, 45.0, -14.0, 19.0, -31.0, -6.0, 7.0, -96.0, -656.0, -70.0, 10.0, 0.0, 3.0, -700.0, -636.0, -822.0, -738.0, -38.0, -54.0, -189.0, -932.0, -418.0, -538.0, -81.0, -128.0, -204.0, -1038.0, -128.0, -22.0, -319.0, -262.0, -586.0, -622.0, -475.0, -704.0, -844.0, -488.0, -405.0, -529.0, -122.0, 13.0, -804.0, -153.0, -188.0, -70.0, -365.0, -366.0, -880.0, -679.0, 41.0, -362.0, -8.0, -38.0, -268.0, -459.0, -16.0, -14.0, -772.0, -657.0, -164.0, -347.0, -402.0, -15.0, -826.0, 43.0, -266.0, -46.0, -708.0, -254.0, -446.0, -48.0, -4.0, -362.0, -588.0, -150.0, -490.0, -626.0, -766.0, 38.0, -764.0, -894.0, -750.0, -6.0, 0.0, 18.0, 43.0, -516.0, -352.0, -497.0, -416.0, -147.0, -365.0, -434.0, -496.0, -16.0, -596.0, -728.0, -346.0, -100.0, -32.0, -26.0, -60.0, 0.0, -250.0, -684.0, -210.0, -126.0, -110.0, -212.0, -373.0, -532.0, -450.0, -390.0, -36.0, -36.0, -780.0, -200.0, 36.0, -8.0, -572.0, -982.0], "policy_predator_policy_reward": [0.0, 52.0, 642.0, 15.0, 0.0, 148.0, 9.0, 336.0, 0.0, 151.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 103.0, 25.0, 0.0, 0.0, 711.0, 0.0, 0.0, 0.0, 1.0, 3.0, 175.0, 247.0, 0.0, 0.0, 0.0, 0.0, 167.0, 0.0, 10.0, 0.0, 21.0, 7.0, 0.0, 0.0, 644.0, 0.0, 0.0, 4.0, 0.0, 436.0, 0.0, 312.0, 0.0, 42.0, 516.0, 0.0, 1.0, 0.0, 0.0, 13.0, 48.0, 148.0, 0.0, 909.0, 201.0, 20.0, 0.0, 378.0, 0.0, 902.0, 8.0, 0.0, 464.0, 323.0, 0.0, 610.0, 6.0, 224.0, 554.0, 561.0, 8.0, 657.0, 7.0, 0.0, 22.0, 8.0, 0.0, 8.0, 540.0, 0.0, 79.0, 0.0, 0.0, 0.0, 971.0, 360.0, 0.0, 972.0, 28.0, 15.0, 767.0, 801.0, 565.0, 0.0, 161.0, 113.0, 162.0, 967.0, 15.0, 105.0, 296.0, 22.0, 292.0, 783.0, 757.0, 39.0, 951.0, 0.0, 35.0, 538.0, 73.0, 76.0, 727.0, 562.0, 89.0, 125.0, 18.0, 365.0, 909.0, 918.0, 243.0, 232.0, 13.0, 15.0, 16.0, 455.0, 8.0, 0.0, 0.0, 943.0, 0.0, 338.0, 32.0, 305.0, 647.0, 161.0, 0.0, 168.0, 605.0, 39.0, 322.0, 0.0, 195.0, 175.0, 0.0, 594.0, 0.0, 748.0, 0.0, 658.0, 0.0, 1046.0, 491.0, 505.0, 1.0, 0.0, 5.0, 448.0, 526.0, 526.0, 37.0, 372.0, 355.0, 439.0, 403.0, 8.0, 845.0, 512.0, 293.0, 50.0, 0.0, 16.0, 31.0, 15.0, 656.0, 184.0, 131.0, 122.0, 42.0, 180.0, 531.0, 524.0, 579.0, 167.0, 18.0, 0.0, 692.0, 160.0, 16.0, 15.0, 926.0, 913.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0114712148783418, "mean_inference_ms": 2.6633625434240344, "mean_action_processing_ms": 0.5394184643240604, "mean_env_wait_ms": 0.36121194566744236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00608980655670166, "StateBufferConnector_ms": 0.005101561546325684, "ViewRequirementAgentConnector_ms": 0.16710138320922852}, "num_episodes": 18, "episode_return_max": 447.0, "episode_return_min": -612.0, "episode_return_mean": -75.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.6620913134694, "num_env_steps_trained_throughput_per_sec": 285.6620913134694, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 14446.816, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14446.753, "sample_time_ms": 2056.719, "learn_time_ms": 12367.758, "learn_throughput": 323.422, "synch_weights_time_ms": 18.201}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "f1691_00000", "date": "2024-08-13_16-47-09", "timestamp": 1723582029, "time_this_iter_s": 14.074749231338501, "time_total_s": 522.9080011844635, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 522.9080011844635, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 74.615, "ram_util_percent": 85.72999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.895914172022431, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 8.591911906540078, "policy_loss": -0.002833438869664278, "vf_loss": 8.581335841032564, "vf_explained_var": 0.03475789490830961, "kl": 0.01986594242030052, "entropy": 1.0331885672120191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.549689056854399, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 9.664164167232615, "policy_loss": 0.0028811746028069626, "vf_loss": 9.612723266763032, "vf_explained_var": 0.01144382780191129, "kl": 0.014210439409404224, "entropy": 1.2667057302263047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 509.0, "episode_reward_min": -711.0, "episode_reward_mean": -90.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1112.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.0, "predator_policy": 1099.0}, "policy_reward_mean": {"prey_policy": -348.915, "predator_policy": 303.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, -67.0, -121.0, -31.0, -439.0, 43.0, 3.0, 6.0, -543.0, -94.0, -46.0, -522.0, 22.0, -59.0, -182.0, -80.0, 345.0, -199.0, 38.0, 18.0, 9.0, -212.0, 19.0, 3.0, -5.0, -588.0, -49.0, 447.0, -391.0, 65.0, -113.0, -30.0, -263.0, -133.0, -383.0, -381.0, -361.0, 40.0, 332.0, -44.0, -348.0, 268.0, 154.0, -18.0, -256.0, -22.0, -486.0, -173.0, -80.0, 25.0, -144.0, -318.0, -172.0, 4.0, -144.0, -368.0, -70.0, -612.0, 240.0, 19.0, -20.0, 203.0, -154.0, -5.0, -101.0, 33.0, -103.0, -42.0, -14.0, -94.0, -83.0, -100.0, 150.0, -94.0, -54.0, -128.0, 59.0, 285.0, -124.0, -439.0, 282.0, -393.0, 116.0, -389.0, -82.0, -4.0, -59.0, -106.0, -241.0, -711.0, -126.0, -175.0, -300.0, 414.0, -156.0, 4.0, -196.0, 509.0, 0.0, -124.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 5.0, 39.0, -542.0, -434.0, 1.0, -56.0, -17.0, -498.0, -457.0, 42.0, 0.0, -10.0, 0.0, 0.0, -190.0, -642.0, -810.0, -33.0, -282.0, -441.0, 17.0, -810.0, -614.0, 0.0, 14.0, -624.0, -222.0, -700.0, -92.0, -12.0, -298.0, -792.0, 22.0, -88.0, -776.0, 45.0, -14.0, 19.0, -31.0, -6.0, 7.0, -96.0, -656.0, -70.0, 10.0, 0.0, 3.0, -700.0, -636.0, -822.0, -738.0, -38.0, -54.0, -189.0, -932.0, -418.0, -538.0, -81.0, -128.0, -204.0, -1038.0, -128.0, -22.0, -319.0, -262.0, -586.0, -622.0, -475.0, -704.0, -844.0, -488.0, -405.0, -529.0, -122.0, 13.0, -804.0, -153.0, -188.0, -70.0, -365.0, -366.0, -880.0, -679.0, 41.0, -362.0, -8.0, -38.0, -268.0, -459.0, -16.0, -14.0, -772.0, -657.0, -164.0, -347.0, -402.0, -15.0, -826.0, 43.0, -266.0, -46.0, -708.0, -254.0, -446.0, -48.0, -4.0, -362.0, -588.0, -150.0, -490.0, -626.0, -766.0, 38.0, -764.0, -894.0, -750.0, -6.0, 0.0, 18.0, 43.0, -516.0, -352.0, -497.0, -416.0, -147.0, -365.0, -434.0, -496.0, -16.0, -596.0, -728.0, -346.0, -100.0, -32.0, -26.0, -60.0, 0.0, -250.0, -684.0, -210.0, -126.0, -110.0, -212.0, -373.0, -532.0, -450.0, -390.0, -36.0, -36.0, -780.0, -200.0, 36.0, -8.0, -572.0, -982.0, -78.0, -98.0, -662.0, -602.0, -177.0, -628.0, -416.0, -504.0, -946.0, -700.0, -818.0, -738.0, -654.0, -2.0, -726.0, -822.0, -326.0, -779.0, -59.0, -526.0, -470.0, -682.0, -1010.0, -800.0, -250.0, -143.0, -134.0, -242.0, -287.0, -848.0, -859.0, -269.0, -975.0, -420.0, -924.0, -649.0, -362.0, -447.0, -412.0, -1112.0, 0.0, 0.0, -111.0, -138.0], "policy_predator_policy_reward": [0.0, 4.0, 0.0, 436.0, 0.0, 312.0, 0.0, 42.0, 516.0, 0.0, 1.0, 0.0, 0.0, 13.0, 48.0, 148.0, 0.0, 909.0, 201.0, 20.0, 0.0, 378.0, 0.0, 902.0, 8.0, 0.0, 464.0, 323.0, 0.0, 610.0, 6.0, 224.0, 554.0, 561.0, 8.0, 657.0, 7.0, 0.0, 22.0, 8.0, 0.0, 8.0, 540.0, 0.0, 79.0, 0.0, 0.0, 0.0, 971.0, 360.0, 0.0, 972.0, 28.0, 15.0, 767.0, 801.0, 565.0, 0.0, 161.0, 113.0, 162.0, 967.0, 15.0, 105.0, 296.0, 22.0, 292.0, 783.0, 757.0, 39.0, 951.0, 0.0, 35.0, 538.0, 73.0, 76.0, 727.0, 562.0, 89.0, 125.0, 18.0, 365.0, 909.0, 918.0, 243.0, 232.0, 13.0, 15.0, 16.0, 455.0, 8.0, 0.0, 0.0, 943.0, 0.0, 338.0, 32.0, 305.0, 647.0, 161.0, 0.0, 168.0, 605.0, 39.0, 322.0, 0.0, 195.0, 175.0, 0.0, 594.0, 0.0, 748.0, 0.0, 658.0, 0.0, 1046.0, 491.0, 505.0, 1.0, 0.0, 5.0, 448.0, 526.0, 526.0, 37.0, 372.0, 355.0, 439.0, 403.0, 8.0, 845.0, 512.0, 293.0, 50.0, 0.0, 16.0, 31.0, 15.0, 656.0, 184.0, 131.0, 122.0, 42.0, 180.0, 531.0, 524.0, 579.0, 167.0, 18.0, 0.0, 692.0, 160.0, 16.0, 15.0, 926.0, 913.0, 52.0, 0.0, 15.0, 810.0, 536.0, 551.0, 510.0, 17.0, 861.0, 901.0, 225.0, 942.0, 551.0, 23.0, 695.0, 849.0, 725.0, 321.0, 41.0, 438.0, 117.0, 794.0, 1099.0, 0.0, 195.0, 72.0, 10.0, 191.0, 812.0, 23.0, 800.0, 742.0, 1001.0, 238.0, 618.0, 959.0, 436.0, 177.0, 1081.0, 952.0, 0.0, 0.0, 104.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.012686014746042, "mean_inference_ms": 2.6679097635050004, "mean_action_processing_ms": 0.5352960380323587, "mean_env_wait_ms": 0.36092788344195526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013462543487548828, "StateBufferConnector_ms": 0.005020618438720703, "ViewRequirementAgentConnector_ms": 0.18909108638763428}, "num_episodes": 22, "episode_return_max": 509.0, "episode_return_min": -711.0, "episode_return_mean": -90.0, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.9009549215592, "num_env_steps_trained_throughput_per_sec": 274.9009549215592, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 14507.032, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14506.969, "sample_time_ms": 2146.027, "learn_time_ms": 12339.469, "learn_throughput": 324.163, "synch_weights_time_ms": 17.77}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "f1691_00000", "date": "2024-08-13_16-47-24", "timestamp": 1723582044, "time_this_iter_s": 14.591828107833862, "time_total_s": 537.4998292922974, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 537.4998292922974, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 75.21000000000001, "ram_util_percent": 85.89500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1768411490494612, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 8.06808263410336, "policy_loss": 0.0033328899337599677, "vf_loss": 8.049362908469305, "vf_explained_var": 0.027583151425003373, "kl": 0.022795285433926855, "entropy": 1.0696808701154417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9216190867007725, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 8.91257776154412, "policy_loss": 0.0014722777546565763, "vf_loss": 8.875269581022717, "vf_explained_var": 0.004219286057053419, "kl": 0.010486956729189733, "entropy": 1.0106416867838965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 509.0, "episode_reward_min": -711.0, "episode_reward_mean": -103.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 1379.0}, "policy_reward_mean": {"prey_policy": -405.76, "predator_policy": 353.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -5.0, -588.0, -49.0, 447.0, -391.0, 65.0, -113.0, -30.0, -263.0, -133.0, -383.0, -381.0, -361.0, 40.0, 332.0, -44.0, -348.0, 268.0, 154.0, -18.0, -256.0, -22.0, -486.0, -173.0, -80.0, 25.0, -144.0, -318.0, -172.0, 4.0, -144.0, -368.0, -70.0, -612.0, 240.0, 19.0, -20.0, 203.0, -154.0, -5.0, -101.0, 33.0, -103.0, -42.0, -14.0, -94.0, -83.0, -100.0, 150.0, -94.0, -54.0, -128.0, 59.0, 285.0, -124.0, -439.0, 282.0, -393.0, 116.0, -389.0, -82.0, -4.0, -59.0, -106.0, -241.0, -711.0, -126.0, -175.0, -300.0, 414.0, -156.0, 4.0, -196.0, 509.0, 0.0, -124.0, -117.0, -160.0, -244.0, 80.0, -227.0, -101.0, -312.0, -193.0, -673.0, -117.0, -271.0, 199.0, -27.0, -238.0, -375.0, -194.0, -518.0, -274.0, 0.0, -87.0, 139.0, 360.0, -122.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 3.0, -700.0, -636.0, -822.0, -738.0, -38.0, -54.0, -189.0, -932.0, -418.0, -538.0, -81.0, -128.0, -204.0, -1038.0, -128.0, -22.0, -319.0, -262.0, -586.0, -622.0, -475.0, -704.0, -844.0, -488.0, -405.0, -529.0, -122.0, 13.0, -804.0, -153.0, -188.0, -70.0, -365.0, -366.0, -880.0, -679.0, 41.0, -362.0, -8.0, -38.0, -268.0, -459.0, -16.0, -14.0, -772.0, -657.0, -164.0, -347.0, -402.0, -15.0, -826.0, 43.0, -266.0, -46.0, -708.0, -254.0, -446.0, -48.0, -4.0, -362.0, -588.0, -150.0, -490.0, -626.0, -766.0, 38.0, -764.0, -894.0, -750.0, -6.0, 0.0, 18.0, 43.0, -516.0, -352.0, -497.0, -416.0, -147.0, -365.0, -434.0, -496.0, -16.0, -596.0, -728.0, -346.0, -100.0, -32.0, -26.0, -60.0, 0.0, -250.0, -684.0, -210.0, -126.0, -110.0, -212.0, -373.0, -532.0, -450.0, -390.0, -36.0, -36.0, -780.0, -200.0, 36.0, -8.0, -572.0, -982.0, -78.0, -98.0, -662.0, -602.0, -177.0, -628.0, -416.0, -504.0, -946.0, -700.0, -818.0, -738.0, -654.0, -2.0, -726.0, -822.0, -326.0, -779.0, -59.0, -526.0, -470.0, -682.0, -1010.0, -800.0, -250.0, -143.0, -134.0, -242.0, -287.0, -848.0, -859.0, -269.0, -975.0, -420.0, -924.0, -649.0, -362.0, -447.0, -412.0, -1112.0, 0.0, 0.0, -111.0, -138.0, -354.0, -84.0, -84.0, -634.0, -160.0, -1014.0, -280.0, -768.0, -465.0, -416.0, -165.0, -32.0, -818.0, -468.0, -127.0, -234.0, -816.0, -1023.0, -256.0, -866.0, -520.0, -312.0, -1008.0, -1142.0, -40.0, -29.0, -594.0, -484.0, -556.0, -862.0, -869.0, -858.0, -754.0, -662.0, -313.0, -360.0, -8.0, 0.0, -454.0, -42.0, -437.0, -666.0, -891.0, -176.0, -233.0, -127.0], "policy_predator_policy_reward": [0.0, 0.0, 971.0, 360.0, 0.0, 972.0, 28.0, 15.0, 767.0, 801.0, 565.0, 0.0, 161.0, 113.0, 162.0, 967.0, 15.0, 105.0, 296.0, 22.0, 292.0, 783.0, 757.0, 39.0, 951.0, 0.0, 35.0, 538.0, 73.0, 76.0, 727.0, 562.0, 89.0, 125.0, 18.0, 365.0, 909.0, 918.0, 243.0, 232.0, 13.0, 15.0, 16.0, 455.0, 8.0, 0.0, 0.0, 943.0, 0.0, 338.0, 32.0, 305.0, 647.0, 161.0, 0.0, 168.0, 605.0, 39.0, 322.0, 0.0, 195.0, 175.0, 0.0, 594.0, 0.0, 748.0, 0.0, 658.0, 0.0, 1046.0, 491.0, 505.0, 1.0, 0.0, 5.0, 448.0, 526.0, 526.0, 37.0, 372.0, 355.0, 439.0, 403.0, 8.0, 845.0, 512.0, 293.0, 50.0, 0.0, 16.0, 31.0, 15.0, 656.0, 184.0, 131.0, 122.0, 42.0, 180.0, 531.0, 524.0, 579.0, 167.0, 18.0, 0.0, 692.0, 160.0, 16.0, 15.0, 926.0, 913.0, 52.0, 0.0, 15.0, 810.0, 536.0, 551.0, 510.0, 17.0, 861.0, 901.0, 225.0, 942.0, 551.0, 23.0, 695.0, 849.0, 725.0, 321.0, 41.0, 438.0, 117.0, 794.0, 1099.0, 0.0, 195.0, 72.0, 10.0, 191.0, 812.0, 23.0, 800.0, 742.0, 1001.0, 238.0, 618.0, 959.0, 436.0, 177.0, 1081.0, 952.0, 0.0, 0.0, 104.0, 21.0, 312.0, 9.0, 11.0, 547.0, 901.0, 29.0, 757.0, 371.0, 577.0, 77.0, 10.0, 86.0, 917.0, 57.0, 26.0, 142.0, 1166.0, 0.0, 868.0, 137.0, 0.0, 561.0, 970.0, 1379.0, 30.0, 12.0, 600.0, 240.0, 190.0, 853.0, 462.0, 1071.0, 0.0, 898.0, 354.0, 45.0, 4.0, 4.0, 42.0, 367.0, 658.0, 584.0, 640.0, 787.0, 90.0, 148.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0143681230216623, "mean_inference_ms": 2.668195203776436, "mean_action_processing_ms": 0.5320108498545321, "mean_env_wait_ms": 0.3615536599702083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01281893253326416, "StateBufferConnector_ms": 0.004708051681518555, "ViewRequirementAgentConnector_ms": 0.191461443901062}, "num_episodes": 23, "episode_return_max": 509.0, "episode_return_min": -711.0, "episode_return_mean": -103.89, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.2608682753125, "num_env_steps_trained_throughput_per_sec": 280.2608682753125, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 14645.278, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14645.216, "sample_time_ms": 2193.024, "learn_time_ms": 12431.709, "learn_throughput": 321.758, "synch_weights_time_ms": 17.084}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "f1691_00000", "date": "2024-08-13_16-47-38", "timestamp": 1723582058, "time_this_iter_s": 14.332616090774536, "time_total_s": 551.8324453830719, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 551.8324453830719, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 73.56190476190476, "ram_util_percent": 85.87142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.366404415706478, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 6.975574802469324, "policy_loss": 0.0014976313945014403, "vf_loss": 6.9578506101376165, "vf_explained_var": 0.015952115021054706, "kl": 0.01602624366279333, "entropy": 1.0526360840078384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.169971028143767, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 5.841136566293303, "policy_loss": 0.002231729832458157, "vf_loss": 5.8009211782425165, "vf_explained_var": 0.005939710140228272, "kl": 0.011115474392856952, "entropy": 0.9745176113787152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 559.0, "episode_reward_min": -711.0, "episode_reward_mean": -68.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 46.0, "predator_policy": 1379.0}, "policy_reward_mean": {"prey_policy": -377.04, "predator_policy": 342.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [268.0, 154.0, -18.0, -256.0, -22.0, -486.0, -173.0, -80.0, 25.0, -144.0, -318.0, -172.0, 4.0, -144.0, -368.0, -70.0, -612.0, 240.0, 19.0, -20.0, 203.0, -154.0, -5.0, -101.0, 33.0, -103.0, -42.0, -14.0, -94.0, -83.0, -100.0, 150.0, -94.0, -54.0, -128.0, 59.0, 285.0, -124.0, -439.0, 282.0, -393.0, 116.0, -389.0, -82.0, -4.0, -59.0, -106.0, -241.0, -711.0, -126.0, -175.0, -300.0, 414.0, -156.0, 4.0, -196.0, 509.0, 0.0, -124.0, -117.0, -160.0, -244.0, 80.0, -227.0, -101.0, -312.0, -193.0, -673.0, -117.0, -271.0, 199.0, -27.0, -238.0, -375.0, -194.0, -518.0, -274.0, 0.0, -87.0, 139.0, 360.0, -122.0, 559.0, -33.0, -80.0, 0.0, 7.0, -44.0, 18.0, 150.0, -214.0, 41.0, 330.0, 0.0, -364.0, 10.0, 308.0, 63.0, 319.0, 272.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-880.0, -679.0, 41.0, -362.0, -8.0, -38.0, -268.0, -459.0, -16.0, -14.0, -772.0, -657.0, -164.0, -347.0, -402.0, -15.0, -826.0, 43.0, -266.0, -46.0, -708.0, -254.0, -446.0, -48.0, -4.0, -362.0, -588.0, -150.0, -490.0, -626.0, -766.0, 38.0, -764.0, -894.0, -750.0, -6.0, 0.0, 18.0, 43.0, -516.0, -352.0, -497.0, -416.0, -147.0, -365.0, -434.0, -496.0, -16.0, -596.0, -728.0, -346.0, -100.0, -32.0, -26.0, -60.0, 0.0, -250.0, -684.0, -210.0, -126.0, -110.0, -212.0, -373.0, -532.0, -450.0, -390.0, -36.0, -36.0, -780.0, -200.0, 36.0, -8.0, -572.0, -982.0, -78.0, -98.0, -662.0, -602.0, -177.0, -628.0, -416.0, -504.0, -946.0, -700.0, -818.0, -738.0, -654.0, -2.0, -726.0, -822.0, -326.0, -779.0, -59.0, -526.0, -470.0, -682.0, -1010.0, -800.0, -250.0, -143.0, -134.0, -242.0, -287.0, -848.0, -859.0, -269.0, -975.0, -420.0, -924.0, -649.0, -362.0, -447.0, -412.0, -1112.0, 0.0, 0.0, -111.0, -138.0, -354.0, -84.0, -84.0, -634.0, -160.0, -1014.0, -280.0, -768.0, -465.0, -416.0, -165.0, -32.0, -818.0, -468.0, -127.0, -234.0, -816.0, -1023.0, -256.0, -866.0, -520.0, -312.0, -1008.0, -1142.0, -40.0, -29.0, -594.0, -484.0, -556.0, -862.0, -869.0, -858.0, -754.0, -662.0, -313.0, -360.0, -8.0, 0.0, -454.0, -42.0, -437.0, -666.0, -891.0, -176.0, -233.0, -127.0, -8.0, -967.0, 0.0, -141.0, -58.0, -782.0, 0.0, 0.0, -373.0, 0.0, -633.0, 46.0, 10.0, 4.0, -37.0, -582.0, -1026.0, -134.0, -67.0, 0.0, -501.0, 0.0, 0.0, -34.0, -615.0, -318.0, 14.0, -32.0, -670.0, -24.0, -6.0, 4.0, -732.0, -14.0, -4.0, -528.0], "policy_predator_policy_reward": [909.0, 918.0, 243.0, 232.0, 13.0, 15.0, 16.0, 455.0, 8.0, 0.0, 0.0, 943.0, 0.0, 338.0, 32.0, 305.0, 647.0, 161.0, 0.0, 168.0, 605.0, 39.0, 322.0, 0.0, 195.0, 175.0, 0.0, 594.0, 0.0, 748.0, 0.0, 658.0, 0.0, 1046.0, 491.0, 505.0, 1.0, 0.0, 5.0, 448.0, 526.0, 526.0, 37.0, 372.0, 355.0, 439.0, 403.0, 8.0, 845.0, 512.0, 293.0, 50.0, 0.0, 16.0, 31.0, 15.0, 656.0, 184.0, 131.0, 122.0, 42.0, 180.0, 531.0, 524.0, 579.0, 167.0, 18.0, 0.0, 692.0, 160.0, 16.0, 15.0, 926.0, 913.0, 52.0, 0.0, 15.0, 810.0, 536.0, 551.0, 510.0, 17.0, 861.0, 901.0, 225.0, 942.0, 551.0, 23.0, 695.0, 849.0, 725.0, 321.0, 41.0, 438.0, 117.0, 794.0, 1099.0, 0.0, 195.0, 72.0, 10.0, 191.0, 812.0, 23.0, 800.0, 742.0, 1001.0, 238.0, 618.0, 959.0, 436.0, 177.0, 1081.0, 952.0, 0.0, 0.0, 104.0, 21.0, 312.0, 9.0, 11.0, 547.0, 901.0, 29.0, 757.0, 371.0, 577.0, 77.0, 10.0, 86.0, 917.0, 57.0, 26.0, 142.0, 1166.0, 0.0, 868.0, 137.0, 0.0, 561.0, 970.0, 1379.0, 30.0, 12.0, 600.0, 240.0, 190.0, 853.0, 462.0, 1071.0, 0.0, 898.0, 354.0, 45.0, 4.0, 4.0, 42.0, 367.0, 658.0, 584.0, 640.0, 787.0, 90.0, 148.0, 726.0, 808.0, 42.0, 66.0, 667.0, 93.0, 0.0, 0.0, 3.0, 377.0, 6.0, 537.0, 0.0, 4.0, 345.0, 424.0, 926.0, 20.0, 62.0, 46.0, 428.0, 403.0, 17.0, 17.0, 18.0, 551.0, 11.0, 17.0, 493.0, 509.0, 43.0, 22.0, 490.0, 575.0, 414.0, 390.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0166512564210581, "mean_inference_ms": 2.6731163632922104, "mean_action_processing_ms": 0.529395098273626, "mean_env_wait_ms": 0.3622617763562465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01357269287109375, "StateBufferConnector_ms": 0.0043392181396484375, "ViewRequirementAgentConnector_ms": 0.19395339488983154}, "num_episodes": 18, "episode_return_max": 559.0, "episode_return_min": -711.0, "episode_return_mean": -68.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.3887718856113, "num_env_steps_trained_throughput_per_sec": 266.3887718856113, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 14726.111, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14726.049, "sample_time_ms": 2108.214, "learn_time_ms": 12597.989, "learn_throughput": 317.511, "synch_weights_time_ms": 16.775}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "f1691_00000", "date": "2024-08-13_16-47-53", "timestamp": 1723582073, "time_this_iter_s": 15.071974992752075, "time_total_s": 566.904420375824, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 566.904420375824, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 78.79523809523809, "ram_util_percent": 85.66190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1493739103514051, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 6.582865946633476, "policy_loss": -0.0009756868663268588, "vf_loss": 6.568249732224399, "vf_explained_var": 0.005616124439491796, "kl": 0.015399406934331021, "entropy": 1.0467314743806446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.530520060894981, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.99410352378926, "policy_loss": 0.0031611459420885515, "vf_loss": 6.960752661266024, "vf_explained_var": 0.0008736874060656027, "kl": 0.008834665300057106, "entropy": 0.7779954571099509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 621.0, "episode_reward_min": -765.0, "episode_reward_mean": -57.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1252.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.0, "predator_policy": 1379.0}, "policy_reward_mean": {"prey_policy": -379.185, "predator_policy": 350.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, -20.0, 203.0, -154.0, -5.0, -101.0, 33.0, -103.0, -42.0, -14.0, -94.0, -83.0, -100.0, 150.0, -94.0, -54.0, -128.0, 59.0, 285.0, -124.0, -439.0, 282.0, -393.0, 116.0, -389.0, -82.0, -4.0, -59.0, -106.0, -241.0, -711.0, -126.0, -175.0, -300.0, 414.0, -156.0, 4.0, -196.0, 509.0, 0.0, -124.0, -117.0, -160.0, -244.0, 80.0, -227.0, -101.0, -312.0, -193.0, -673.0, -117.0, -271.0, 199.0, -27.0, -238.0, -375.0, -194.0, -518.0, -274.0, 0.0, -87.0, 139.0, 360.0, -122.0, 559.0, -33.0, -80.0, 0.0, 7.0, -44.0, 18.0, 150.0, -214.0, 41.0, 330.0, 0.0, -364.0, 10.0, 308.0, 63.0, 319.0, 272.0, 0.0, -240.0, 621.0, -62.0, -19.0, 7.0, -59.0, -71.0, -97.0, -765.0, 58.0, -14.0, -20.0, -1.0, -103.0, -180.0, -87.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 18.0, 43.0, -516.0, -352.0, -497.0, -416.0, -147.0, -365.0, -434.0, -496.0, -16.0, -596.0, -728.0, -346.0, -100.0, -32.0, -26.0, -60.0, 0.0, -250.0, -684.0, -210.0, -126.0, -110.0, -212.0, -373.0, -532.0, -450.0, -390.0, -36.0, -36.0, -780.0, -200.0, 36.0, -8.0, -572.0, -982.0, -78.0, -98.0, -662.0, -602.0, -177.0, -628.0, -416.0, -504.0, -946.0, -700.0, -818.0, -738.0, -654.0, -2.0, -726.0, -822.0, -326.0, -779.0, -59.0, -526.0, -470.0, -682.0, -1010.0, -800.0, -250.0, -143.0, -134.0, -242.0, -287.0, -848.0, -859.0, -269.0, -975.0, -420.0, -924.0, -649.0, -362.0, -447.0, -412.0, -1112.0, 0.0, 0.0, -111.0, -138.0, -354.0, -84.0, -84.0, -634.0, -160.0, -1014.0, -280.0, -768.0, -465.0, -416.0, -165.0, -32.0, -818.0, -468.0, -127.0, -234.0, -816.0, -1023.0, -256.0, -866.0, -520.0, -312.0, -1008.0, -1142.0, -40.0, -29.0, -594.0, -484.0, -556.0, -862.0, -869.0, -858.0, -754.0, -662.0, -313.0, -360.0, -8.0, 0.0, -454.0, -42.0, -437.0, -666.0, -891.0, -176.0, -233.0, -127.0, -8.0, -967.0, 0.0, -141.0, -58.0, -782.0, 0.0, 0.0, -373.0, 0.0, -633.0, 46.0, 10.0, 4.0, -37.0, -582.0, -1026.0, -134.0, -67.0, 0.0, -501.0, 0.0, 0.0, -34.0, -615.0, -318.0, 14.0, -32.0, -670.0, -24.0, -6.0, 4.0, -732.0, -14.0, -4.0, -528.0, -170.0, -472.0, -1252.0, -998.0, -1122.0, 42.0, -672.0, -26.0, 0.0, -68.0, -760.0, -834.0, 0.0, -583.0, -30.0, -152.0, -12.0, -1080.0, -1028.0, -932.0, 58.0, -86.0, 0.0, -528.0, -583.0, -6.0, -2.0, 0.0, -18.0, -186.0, -820.0, -81.0, -832.0, -98.0, 3.0, -54.0], "policy_predator_policy_reward": [1.0, 0.0, 5.0, 448.0, 526.0, 526.0, 37.0, 372.0, 355.0, 439.0, 403.0, 8.0, 845.0, 512.0, 293.0, 50.0, 0.0, 16.0, 31.0, 15.0, 656.0, 184.0, 131.0, 122.0, 42.0, 180.0, 531.0, 524.0, 579.0, 167.0, 18.0, 0.0, 692.0, 160.0, 16.0, 15.0, 926.0, 913.0, 52.0, 0.0, 15.0, 810.0, 536.0, 551.0, 510.0, 17.0, 861.0, 901.0, 225.0, 942.0, 551.0, 23.0, 695.0, 849.0, 725.0, 321.0, 41.0, 438.0, 117.0, 794.0, 1099.0, 0.0, 195.0, 72.0, 10.0, 191.0, 812.0, 23.0, 800.0, 742.0, 1001.0, 238.0, 618.0, 959.0, 436.0, 177.0, 1081.0, 952.0, 0.0, 0.0, 104.0, 21.0, 312.0, 9.0, 11.0, 547.0, 901.0, 29.0, 757.0, 371.0, 577.0, 77.0, 10.0, 86.0, 917.0, 57.0, 26.0, 142.0, 1166.0, 0.0, 868.0, 137.0, 0.0, 561.0, 970.0, 1379.0, 30.0, 12.0, 600.0, 240.0, 190.0, 853.0, 462.0, 1071.0, 0.0, 898.0, 354.0, 45.0, 4.0, 4.0, 42.0, 367.0, 658.0, 584.0, 640.0, 787.0, 90.0, 148.0, 726.0, 808.0, 42.0, 66.0, 667.0, 93.0, 0.0, 0.0, 3.0, 377.0, 6.0, 537.0, 0.0, 4.0, 345.0, 424.0, 926.0, 20.0, 62.0, 46.0, 428.0, 403.0, 17.0, 17.0, 18.0, 551.0, 11.0, 17.0, 493.0, 509.0, 43.0, 22.0, 490.0, 575.0, 414.0, 390.0, 292.0, 350.0, 1286.0, 724.0, 958.0, 743.0, 0.0, 636.0, 0.0, 49.0, 702.0, 899.0, 39.0, 485.0, 88.0, 23.0, 995.0, 0.0, 1195.0, 0.0, 43.0, 43.0, 390.0, 124.0, 540.0, 29.0, 0.0, 1.0, 86.0, 15.0, 715.0, 6.0, 828.0, 15.0, 27.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0196342163146108, "mean_inference_ms": 2.6793855291489534, "mean_action_processing_ms": 0.5271094524467991, "mean_env_wait_ms": 0.3632297210789461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013963699340820312, "StateBufferConnector_ms": 0.0042601823806762695, "ViewRequirementAgentConnector_ms": 0.19354760646820068}, "num_episodes": 18, "episode_return_max": 621.0, "episode_return_min": -765.0, "episode_return_mean": -57.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.6177357498066, "num_env_steps_trained_throughput_per_sec": 289.6177357498066, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 14472.751, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14472.689, "sample_time_ms": 2082.89, "learn_time_ms": 12368.92, "learn_throughput": 323.391, "synch_weights_time_ms": 17.819}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "f1691_00000", "date": "2024-08-13_16-48-07", "timestamp": 1723582087, "time_this_iter_s": 13.962402105331421, "time_total_s": 580.8668224811554, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 580.8668224811554, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 74.15500000000002, "ram_util_percent": 86.49499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7867234778782678, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 7.502659853173311, "policy_loss": -0.0014996864042052674, "vf_loss": 7.490117271110495, "vf_explained_var": 0.003770225514810552, "kl": 0.01386890312123569, "entropy": 0.9923317828191021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.729532756155761, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 7.039771095154777, "policy_loss": 0.0036198735997208923, "vf_loss": 7.002761689191142, "vf_explained_var": 0.0003597307142126497, "kl": 0.009771056304622333, "entropy": 0.7863641850532047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 621.0, "episode_reward_min": -857.0, "episode_reward_mean": -62.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1402.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.0, "predator_policy": 1480.0}, "policy_reward_mean": {"prey_policy": -410.105, "predator_policy": 378.695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-393.0, 116.0, -389.0, -82.0, -4.0, -59.0, -106.0, -241.0, -711.0, -126.0, -175.0, -300.0, 414.0, -156.0, 4.0, -196.0, 509.0, 0.0, -124.0, -117.0, -160.0, -244.0, 80.0, -227.0, -101.0, -312.0, -193.0, -673.0, -117.0, -271.0, 199.0, -27.0, -238.0, -375.0, -194.0, -518.0, -274.0, 0.0, -87.0, 139.0, 360.0, -122.0, 559.0, -33.0, -80.0, 0.0, 7.0, -44.0, 18.0, 150.0, -214.0, 41.0, 330.0, 0.0, -364.0, 10.0, 308.0, 63.0, 319.0, 272.0, 0.0, -240.0, 621.0, -62.0, -19.0, 7.0, -59.0, -71.0, -97.0, -765.0, 58.0, -14.0, -20.0, -1.0, -103.0, -180.0, -87.0, -13.0, -126.0, 341.0, -857.0, 0.0, -51.0, -463.0, -85.0, 14.0, 181.0, -87.0, -123.0, -228.0, -47.0, -641.0, 61.0, 441.0, -125.0, -48.0, 13.0, 0.0, 193.0, 549.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-416.0, -504.0, -946.0, -700.0, -818.0, -738.0, -654.0, -2.0, -726.0, -822.0, -326.0, -779.0, -59.0, -526.0, -470.0, -682.0, -1010.0, -800.0, -250.0, -143.0, -134.0, -242.0, -287.0, -848.0, -859.0, -269.0, -975.0, -420.0, -924.0, -649.0, -362.0, -447.0, -412.0, -1112.0, 0.0, 0.0, -111.0, -138.0, -354.0, -84.0, -84.0, -634.0, -160.0, -1014.0, -280.0, -768.0, -465.0, -416.0, -165.0, -32.0, -818.0, -468.0, -127.0, -234.0, -816.0, -1023.0, -256.0, -866.0, -520.0, -312.0, -1008.0, -1142.0, -40.0, -29.0, -594.0, -484.0, -556.0, -862.0, -869.0, -858.0, -754.0, -662.0, -313.0, -360.0, -8.0, 0.0, -454.0, -42.0, -437.0, -666.0, -891.0, -176.0, -233.0, -127.0, -8.0, -967.0, 0.0, -141.0, -58.0, -782.0, 0.0, 0.0, -373.0, 0.0, -633.0, 46.0, 10.0, 4.0, -37.0, -582.0, -1026.0, -134.0, -67.0, 0.0, -501.0, 0.0, 0.0, -34.0, -615.0, -318.0, 14.0, -32.0, -670.0, -24.0, -6.0, 4.0, -732.0, -14.0, -4.0, -528.0, -170.0, -472.0, -1252.0, -998.0, -1122.0, 42.0, -672.0, -26.0, 0.0, -68.0, -760.0, -834.0, 0.0, -583.0, -30.0, -152.0, -12.0, -1080.0, -1028.0, -932.0, 58.0, -86.0, 0.0, -528.0, -583.0, -6.0, -2.0, 0.0, -18.0, -186.0, -820.0, -81.0, -832.0, -98.0, 3.0, -54.0, -274.0, 0.0, -1124.0, 0.0, -968.0, -786.0, 0.0, 0.0, -183.0, 12.0, -582.0, -1402.0, 0.0, -1010.0, -72.0, -664.0, -1104.0, -543.0, -482.0, -118.0, -97.0, -1012.0, -886.0, -384.0, -113.0, -58.0, -875.0, -802.0, -14.0, -822.0, -772.0, -14.0, -45.0, -176.0, -2.0, -1134.0, 0.0, -53.0, 0.0, 0.0, -1194.0, -655.0, -62.0, -940.0], "policy_predator_policy_reward": [510.0, 17.0, 861.0, 901.0, 225.0, 942.0, 551.0, 23.0, 695.0, 849.0, 725.0, 321.0, 41.0, 438.0, 117.0, 794.0, 1099.0, 0.0, 195.0, 72.0, 10.0, 191.0, 812.0, 23.0, 800.0, 742.0, 1001.0, 238.0, 618.0, 959.0, 436.0, 177.0, 1081.0, 952.0, 0.0, 0.0, 104.0, 21.0, 312.0, 9.0, 11.0, 547.0, 901.0, 29.0, 757.0, 371.0, 577.0, 77.0, 10.0, 86.0, 917.0, 57.0, 26.0, 142.0, 1166.0, 0.0, 868.0, 137.0, 0.0, 561.0, 970.0, 1379.0, 30.0, 12.0, 600.0, 240.0, 190.0, 853.0, 462.0, 1071.0, 0.0, 898.0, 354.0, 45.0, 4.0, 4.0, 42.0, 367.0, 658.0, 584.0, 640.0, 787.0, 90.0, 148.0, 726.0, 808.0, 42.0, 66.0, 667.0, 93.0, 0.0, 0.0, 3.0, 377.0, 6.0, 537.0, 0.0, 4.0, 345.0, 424.0, 926.0, 20.0, 62.0, 46.0, 428.0, 403.0, 17.0, 17.0, 18.0, 551.0, 11.0, 17.0, 493.0, 509.0, 43.0, 22.0, 490.0, 575.0, 414.0, 390.0, 292.0, 350.0, 1286.0, 724.0, 958.0, 743.0, 0.0, 636.0, 0.0, 49.0, 702.0, 899.0, 39.0, 485.0, 88.0, 23.0, 995.0, 0.0, 1195.0, 0.0, 43.0, 43.0, 390.0, 124.0, 540.0, 29.0, 0.0, 1.0, 86.0, 15.0, 715.0, 6.0, 828.0, 15.0, 27.0, 11.0, 2.0, 146.0, 1006.0, 459.0, 0.0, 897.0, 0.0, 0.0, 120.0, 0.0, 41.0, 1480.0, 0.0, 925.0, 558.0, 192.0, 903.0, 925.0, 77.0, 436.0, 921.0, 65.0, 806.0, 236.0, 62.0, 62.0, 1036.0, 0.0, 136.0, 761.0, 634.0, 593.0, 7.0, 89.0, 1.0, 1087.0, 33.0, 33.0, 0.0, 0.0, 891.0, 1151.0, 682.0, 869.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0232043011440901, "mean_inference_ms": 2.6901288452491974, "mean_action_processing_ms": 0.524893449101774, "mean_env_wait_ms": 0.3643794104015394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014051556587219238, "StateBufferConnector_ms": 0.00434267520904541, "ViewRequirementAgentConnector_ms": 0.17770838737487793}, "num_episodes": 22, "episode_return_max": 621.0, "episode_return_min": -857.0, "episode_return_mean": -62.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.142624701519, "num_env_steps_trained_throughput_per_sec": 278.142624701519, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 14451.78, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14451.719, "sample_time_ms": 2144.493, "learn_time_ms": 12286.591, "learn_throughput": 325.558, "synch_weights_time_ms": 17.814}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "f1691_00000", "date": "2024-08-13_16-48-22", "timestamp": 1723582102, "time_this_iter_s": 14.448187112808228, "time_total_s": 595.3150095939636, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37420d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 595.3150095939636, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 78.34, "ram_util_percent": 86.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0478031391819949, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 8.359766143213504, "policy_loss": 0.0011358227304838322, "vf_loss": 8.339889849052227, "vf_explained_var": 0.015103024685824359, "kl": 0.0185090898722845, "entropy": 1.0102112502017349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.014615355676444, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 7.177780339326808, "policy_loss": 0.0033397038236861586, "vf_loss": 7.138836342947823, "vf_explained_var": 0.0001248900852506123, "kl": 0.01041918074974517, "entropy": 0.7772668032734482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 785.0, "episode_reward_min": -857.0, "episode_reward_mean": -27.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1402.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.0, "predator_policy": 1480.0}, "policy_reward_mean": {"prey_policy": -384.955, "predator_policy": 371.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.0, -101.0, -312.0, -193.0, -673.0, -117.0, -271.0, 199.0, -27.0, -238.0, -375.0, -194.0, -518.0, -274.0, 0.0, -87.0, 139.0, 360.0, -122.0, 559.0, -33.0, -80.0, 0.0, 7.0, -44.0, 18.0, 150.0, -214.0, 41.0, 330.0, 0.0, -364.0, 10.0, 308.0, 63.0, 319.0, 272.0, 0.0, -240.0, 621.0, -62.0, -19.0, 7.0, -59.0, -71.0, -97.0, -765.0, 58.0, -14.0, -20.0, -1.0, -103.0, -180.0, -87.0, -13.0, -126.0, 341.0, -857.0, 0.0, -51.0, -463.0, -85.0, 14.0, 181.0, -87.0, -123.0, -228.0, -47.0, -641.0, 61.0, 441.0, -125.0, -48.0, 13.0, 0.0, 193.0, 549.0, 99.0, -67.0, 211.0, 320.0, 6.0, -302.0, -43.0, 243.0, -24.0, 456.0, 576.0, -119.0, 785.0, -67.0, -599.0, -6.0, 41.0, 9.0, -598.0, -7.0, -50.0, 210.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-465.0, -416.0, -165.0, -32.0, -818.0, -468.0, -127.0, -234.0, -816.0, -1023.0, -256.0, -866.0, -520.0, -312.0, -1008.0, -1142.0, -40.0, -29.0, -594.0, -484.0, -556.0, -862.0, -869.0, -858.0, -754.0, -662.0, -313.0, -360.0, -8.0, 0.0, -454.0, -42.0, -437.0, -666.0, -891.0, -176.0, -233.0, -127.0, -8.0, -967.0, 0.0, -141.0, -58.0, -782.0, 0.0, 0.0, -373.0, 0.0, -633.0, 46.0, 10.0, 4.0, -37.0, -582.0, -1026.0, -134.0, -67.0, 0.0, -501.0, 0.0, 0.0, -34.0, -615.0, -318.0, 14.0, -32.0, -670.0, -24.0, -6.0, 4.0, -732.0, -14.0, -4.0, -528.0, -170.0, -472.0, -1252.0, -998.0, -1122.0, 42.0, -672.0, -26.0, 0.0, -68.0, -760.0, -834.0, 0.0, -583.0, -30.0, -152.0, -12.0, -1080.0, -1028.0, -932.0, 58.0, -86.0, 0.0, -528.0, -583.0, -6.0, -2.0, 0.0, -18.0, -186.0, -820.0, -81.0, -832.0, -98.0, 3.0, -54.0, -274.0, 0.0, -1124.0, 0.0, -968.0, -786.0, 0.0, 0.0, -183.0, 12.0, -582.0, -1402.0, 0.0, -1010.0, -72.0, -664.0, -1104.0, -543.0, -482.0, -118.0, -97.0, -1012.0, -886.0, -384.0, -113.0, -58.0, -875.0, -802.0, -14.0, -822.0, -772.0, -14.0, -45.0, -176.0, -2.0, -1134.0, 0.0, -53.0, 0.0, 0.0, -1194.0, -655.0, -62.0, -940.0, -456.0, -62.0, -312.0, -78.0, -38.0, -1186.0, -616.0, 23.0, -32.0, -44.0, -716.0, -646.0, -1316.0, 0.0, -573.0, 0.0, -28.0, -151.0, -926.0, -229.0, -34.0, -964.0, 15.0, -758.0, 0.0, -1144.0, -12.0, -850.0, -824.0, -1142.0, 0.0, -19.0, -558.0, -372.0, -40.0, -2.0, -861.0, -630.0, -68.0, -280.0, 0.0, -107.0, -750.0, -970.0, -152.0, 0.0], "policy_predator_policy_reward": [577.0, 77.0, 10.0, 86.0, 917.0, 57.0, 26.0, 142.0, 1166.0, 0.0, 868.0, 137.0, 0.0, 561.0, 970.0, 1379.0, 30.0, 12.0, 600.0, 240.0, 190.0, 853.0, 462.0, 1071.0, 0.0, 898.0, 354.0, 45.0, 4.0, 4.0, 42.0, 367.0, 658.0, 584.0, 640.0, 787.0, 90.0, 148.0, 726.0, 808.0, 42.0, 66.0, 667.0, 93.0, 0.0, 0.0, 3.0, 377.0, 6.0, 537.0, 0.0, 4.0, 345.0, 424.0, 926.0, 20.0, 62.0, 46.0, 428.0, 403.0, 17.0, 17.0, 18.0, 551.0, 11.0, 17.0, 493.0, 509.0, 43.0, 22.0, 490.0, 575.0, 414.0, 390.0, 292.0, 350.0, 1286.0, 724.0, 958.0, 743.0, 0.0, 636.0, 0.0, 49.0, 702.0, 899.0, 39.0, 485.0, 88.0, 23.0, 995.0, 0.0, 1195.0, 0.0, 43.0, 43.0, 390.0, 124.0, 540.0, 29.0, 0.0, 1.0, 86.0, 15.0, 715.0, 6.0, 828.0, 15.0, 27.0, 11.0, 2.0, 146.0, 1006.0, 459.0, 0.0, 897.0, 0.0, 0.0, 120.0, 0.0, 41.0, 1480.0, 0.0, 925.0, 558.0, 192.0, 903.0, 925.0, 77.0, 436.0, 921.0, 65.0, 806.0, 236.0, 62.0, 62.0, 1036.0, 0.0, 136.0, 761.0, 634.0, 593.0, 7.0, 89.0, 1.0, 1087.0, 33.0, 33.0, 0.0, 0.0, 891.0, 1151.0, 682.0, 869.0, 332.0, 285.0, 153.0, 170.0, 1080.0, 355.0, 474.0, 439.0, 58.0, 24.0, 347.0, 713.0, 29.0, 1244.0, 398.0, 418.0, 70.0, 85.0, 787.0, 824.0, 839.0, 735.0, 624.0, 0.0, 958.0, 971.0, 0.0, 795.0, 1109.0, 258.0, 13.0, 0.0, 484.0, 487.0, 19.0, 32.0, 0.0, 893.0, 141.0, 200.0, 0.0, 57.0, 899.0, 1031.0, 6.0, 116.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0254679451879058, "mean_inference_ms": 2.699080029345386, "mean_action_processing_ms": 0.525585437963633, "mean_env_wait_ms": 0.36622159729300024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006410956382751465, "StateBufferConnector_ms": 0.005419611930847168, "ViewRequirementAgentConnector_ms": 0.18602001667022705}, "num_episodes": 23, "episode_return_max": 785.0, "episode_return_min": -857.0, "episode_return_mean": -27.78, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.3526819867348, "num_env_steps_trained_throughput_per_sec": 277.3526819867348, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 14359.57, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14359.501, "sample_time_ms": 2255.92, "learn_time_ms": 12082.831, "learn_throughput": 331.048, "synch_weights_time_ms": 17.627}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "f1691_00000", "date": "2024-08-13_16-48-36", "timestamp": 1723582116, "time_this_iter_s": 14.507603168487549, "time_total_s": 609.8226127624512, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c18670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 609.8226127624512, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 74.6952380952381, "ram_util_percent": 86.12380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1652982124418179, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 8.980789588241981, "policy_loss": 0.0003926735642371039, "vf_loss": 8.9632000716275, "vf_explained_var": 0.01770513442458299, "kl": 0.016984549623998927, "entropy": 0.9470021873554856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.517524243851818, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 7.596939925037364, "policy_loss": 0.0034645216162538244, "vf_loss": 7.560125837376509, "vf_explained_var": -1.166863416237806e-09, "kl": 0.009759359160997762, "entropy": 0.7376874177071152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 946.0, "episode_reward_min": -857.0, "episode_reward_mean": 52.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1568.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.0, "predator_policy": 1595.0}, "policy_reward_mean": {"prey_policy": -384.195, "predator_policy": 410.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.0, 559.0, -33.0, -80.0, 0.0, 7.0, -44.0, 18.0, 150.0, -214.0, 41.0, 330.0, 0.0, -364.0, 10.0, 308.0, 63.0, 319.0, 272.0, 0.0, -240.0, 621.0, -62.0, -19.0, 7.0, -59.0, -71.0, -97.0, -765.0, 58.0, -14.0, -20.0, -1.0, -103.0, -180.0, -87.0, -13.0, -126.0, 341.0, -857.0, 0.0, -51.0, -463.0, -85.0, 14.0, 181.0, -87.0, -123.0, -228.0, -47.0, -641.0, 61.0, 441.0, -125.0, -48.0, 13.0, 0.0, 193.0, 549.0, 99.0, -67.0, 211.0, 320.0, 6.0, -302.0, -43.0, 243.0, -24.0, 456.0, 576.0, -119.0, 785.0, -67.0, -599.0, -6.0, 41.0, 9.0, -598.0, -7.0, -50.0, 210.0, -30.0, -24.0, 772.0, -96.0, 946.0, 717.0, -184.0, 130.0, 550.0, -22.0, 794.0, 450.0, 143.0, 135.0, 386.0, 191.0, 684.0, -399.0, -71.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-233.0, -127.0, -8.0, -967.0, 0.0, -141.0, -58.0, -782.0, 0.0, 0.0, -373.0, 0.0, -633.0, 46.0, 10.0, 4.0, -37.0, -582.0, -1026.0, -134.0, -67.0, 0.0, -501.0, 0.0, 0.0, -34.0, -615.0, -318.0, 14.0, -32.0, -670.0, -24.0, -6.0, 4.0, -732.0, -14.0, -4.0, -528.0, -170.0, -472.0, -1252.0, -998.0, -1122.0, 42.0, -672.0, -26.0, 0.0, -68.0, -760.0, -834.0, 0.0, -583.0, -30.0, -152.0, -12.0, -1080.0, -1028.0, -932.0, 58.0, -86.0, 0.0, -528.0, -583.0, -6.0, -2.0, 0.0, -18.0, -186.0, -820.0, -81.0, -832.0, -98.0, 3.0, -54.0, -274.0, 0.0, -1124.0, 0.0, -968.0, -786.0, 0.0, 0.0, -183.0, 12.0, -582.0, -1402.0, 0.0, -1010.0, -72.0, -664.0, -1104.0, -543.0, -482.0, -118.0, -97.0, -1012.0, -886.0, -384.0, -113.0, -58.0, -875.0, -802.0, -14.0, -822.0, -772.0, -14.0, -45.0, -176.0, -2.0, -1134.0, 0.0, -53.0, 0.0, 0.0, -1194.0, -655.0, -62.0, -940.0, -456.0, -62.0, -312.0, -78.0, -38.0, -1186.0, -616.0, 23.0, -32.0, -44.0, -716.0, -646.0, -1316.0, 0.0, -573.0, 0.0, -28.0, -151.0, -926.0, -229.0, -34.0, -964.0, 15.0, -758.0, 0.0, -1144.0, -12.0, -850.0, -824.0, -1142.0, 0.0, -19.0, -558.0, -372.0, -40.0, -2.0, -861.0, -630.0, -68.0, -280.0, 0.0, -107.0, -750.0, -970.0, -152.0, 0.0, -178.0, 0.0, 0.0, -1246.0, -128.0, -102.0, -26.0, -1384.0, -714.0, -1532.0, -1096.0, -858.0, -70.0, -329.0, -53.0, -942.0, -24.0, -22.0, 9.0, -1162.0, -761.0, 5.0, 0.0, -264.0, 0.0, -232.0, -796.0, -70.0, -1166.0, -1568.0, -1384.0, -274.0, -520.0, -515.0, -98.0, -71.0], "policy_predator_policy_reward": [90.0, 148.0, 726.0, 808.0, 42.0, 66.0, 667.0, 93.0, 0.0, 0.0, 3.0, 377.0, 6.0, 537.0, 0.0, 4.0, 345.0, 424.0, 926.0, 20.0, 62.0, 46.0, 428.0, 403.0, 17.0, 17.0, 18.0, 551.0, 11.0, 17.0, 493.0, 509.0, 43.0, 22.0, 490.0, 575.0, 414.0, 390.0, 292.0, 350.0, 1286.0, 724.0, 958.0, 743.0, 0.0, 636.0, 0.0, 49.0, 702.0, 899.0, 39.0, 485.0, 88.0, 23.0, 995.0, 0.0, 1195.0, 0.0, 43.0, 43.0, 390.0, 124.0, 540.0, 29.0, 0.0, 1.0, 86.0, 15.0, 715.0, 6.0, 828.0, 15.0, 27.0, 11.0, 2.0, 146.0, 1006.0, 459.0, 0.0, 897.0, 0.0, 0.0, 120.0, 0.0, 41.0, 1480.0, 0.0, 925.0, 558.0, 192.0, 903.0, 925.0, 77.0, 436.0, 921.0, 65.0, 806.0, 236.0, 62.0, 62.0, 1036.0, 0.0, 136.0, 761.0, 634.0, 593.0, 7.0, 89.0, 1.0, 1087.0, 33.0, 33.0, 0.0, 0.0, 891.0, 1151.0, 682.0, 869.0, 332.0, 285.0, 153.0, 170.0, 1080.0, 355.0, 474.0, 439.0, 58.0, 24.0, 347.0, 713.0, 29.0, 1244.0, 398.0, 418.0, 70.0, 85.0, 787.0, 824.0, 839.0, 735.0, 624.0, 0.0, 958.0, 971.0, 0.0, 795.0, 1109.0, 258.0, 13.0, 0.0, 484.0, 487.0, 19.0, 32.0, 0.0, 893.0, 141.0, 200.0, 0.0, 57.0, 899.0, 1031.0, 6.0, 116.0, 0.0, 154.0, 1130.0, 888.0, 87.0, 47.0, 1175.0, 1181.0, 1495.0, 1468.0, 642.0, 1128.0, 278.0, 251.0, 830.0, 715.0, 12.0, 12.0, 990.0, 957.0, 628.0, 578.0, 210.0, 197.0, 197.0, 170.0, 738.0, 514.0, 1330.0, 1595.0, 1252.0, 1090.0, 546.0, 90.0, 77.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0284981161028677, "mean_inference_ms": 2.70497319448255, "mean_action_processing_ms": 0.5224052636030045, "mean_env_wait_ms": 0.3683612422912537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006381988525390625, "StateBufferConnector_ms": 0.008374810218811035, "ViewRequirementAgentConnector_ms": 0.1765000820159912}, "num_episodes": 18, "episode_return_max": 946.0, "episode_return_min": -857.0, "episode_return_mean": 52.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.9302874048187, "num_env_steps_trained_throughput_per_sec": 221.9302874048187, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 14715.119, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14715.049, "sample_time_ms": 2302.968, "learn_time_ms": 12390.331, "learn_throughput": 322.832, "synch_weights_time_ms": 18.219}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "f1691_00000", "date": "2024-08-13_16-48-54", "timestamp": 1723582134, "time_this_iter_s": 18.10103988647461, "time_total_s": 627.9236526489258, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.9236526489258, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 90.06, "ram_util_percent": 83.28399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.282744444804217, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 8.79825145655839, "policy_loss": -0.0006417625835017552, "vf_loss": 8.780032991984534, "vf_explained_var": 0.01218644273344171, "kl": 0.018627384113903665, "entropy": 0.9881395331450871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6656212046663597, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 8.219706025199285, "policy_loss": 0.003209639257978076, "vf_loss": 8.183668506208551, "vf_explained_var": -8.294191310014673e-09, "kl": 0.00960669992993028, "entropy": 0.7817099257594063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 946.0, "episode_reward_min": -857.0, "episode_reward_mean": 62.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1568.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 58.0, "predator_policy": 1595.0}, "policy_reward_mean": {"prey_policy": -442.67, "predator_policy": 473.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [272.0, 0.0, -240.0, 621.0, -62.0, -19.0, 7.0, -59.0, -71.0, -97.0, -765.0, 58.0, -14.0, -20.0, -1.0, -103.0, -180.0, -87.0, -13.0, -126.0, 341.0, -857.0, 0.0, -51.0, -463.0, -85.0, 14.0, 181.0, -87.0, -123.0, -228.0, -47.0, -641.0, 61.0, 441.0, -125.0, -48.0, 13.0, 0.0, 193.0, 549.0, 99.0, -67.0, 211.0, 320.0, 6.0, -302.0, -43.0, 243.0, -24.0, 456.0, 576.0, -119.0, 785.0, -67.0, -599.0, -6.0, 41.0, 9.0, -598.0, -7.0, -50.0, 210.0, -30.0, -24.0, 772.0, -96.0, 946.0, 717.0, -184.0, 130.0, 550.0, -22.0, 794.0, 450.0, 143.0, 135.0, 386.0, 191.0, 684.0, -399.0, -71.0, -456.0, -323.0, 467.0, 22.0, 203.0, -167.0, 194.0, -211.0, 450.0, 242.0, -3.0, 304.0, 649.0, -369.0, 53.0, 208.0, 711.0, -55.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -528.0, -170.0, -472.0, -1252.0, -998.0, -1122.0, 42.0, -672.0, -26.0, 0.0, -68.0, -760.0, -834.0, 0.0, -583.0, -30.0, -152.0, -12.0, -1080.0, -1028.0, -932.0, 58.0, -86.0, 0.0, -528.0, -583.0, -6.0, -2.0, 0.0, -18.0, -186.0, -820.0, -81.0, -832.0, -98.0, 3.0, -54.0, -274.0, 0.0, -1124.0, 0.0, -968.0, -786.0, 0.0, 0.0, -183.0, 12.0, -582.0, -1402.0, 0.0, -1010.0, -72.0, -664.0, -1104.0, -543.0, -482.0, -118.0, -97.0, -1012.0, -886.0, -384.0, -113.0, -58.0, -875.0, -802.0, -14.0, -822.0, -772.0, -14.0, -45.0, -176.0, -2.0, -1134.0, 0.0, -53.0, 0.0, 0.0, -1194.0, -655.0, -62.0, -940.0, -456.0, -62.0, -312.0, -78.0, -38.0, -1186.0, -616.0, 23.0, -32.0, -44.0, -716.0, -646.0, -1316.0, 0.0, -573.0, 0.0, -28.0, -151.0, -926.0, -229.0, -34.0, -964.0, 15.0, -758.0, 0.0, -1144.0, -12.0, -850.0, -824.0, -1142.0, 0.0, -19.0, -558.0, -372.0, -40.0, -2.0, -861.0, -630.0, -68.0, -280.0, 0.0, -107.0, -750.0, -970.0, -152.0, 0.0, -178.0, 0.0, 0.0, -1246.0, -128.0, -102.0, -26.0, -1384.0, -714.0, -1532.0, -1096.0, -858.0, -70.0, -329.0, -53.0, -942.0, -24.0, -22.0, 9.0, -1162.0, -761.0, 5.0, 0.0, -264.0, 0.0, -232.0, -796.0, -70.0, -1166.0, -1568.0, -1384.0, -274.0, -520.0, -515.0, -98.0, -71.0, -1088.0, -1038.0, -474.0, -448.0, -606.0, -1510.0, -154.0, 0.0, -123.0, -1240.0, -212.0, -219.0, -534.0, -77.0, -763.0, -1178.0, 0.0, -646.0, -129.0, -1356.0, -696.0, -414.0, -17.0, -558.0, -70.0, -1056.0, -900.0, -379.0, 3.0, -162.0, -493.0, -1054.0, -144.0, -1386.0, 0.0, -610.0], "policy_predator_policy_reward": [414.0, 390.0, 292.0, 350.0, 1286.0, 724.0, 958.0, 743.0, 0.0, 636.0, 0.0, 49.0, 702.0, 899.0, 39.0, 485.0, 88.0, 23.0, 995.0, 0.0, 1195.0, 0.0, 43.0, 43.0, 390.0, 124.0, 540.0, 29.0, 0.0, 1.0, 86.0, 15.0, 715.0, 6.0, 828.0, 15.0, 27.0, 11.0, 2.0, 146.0, 1006.0, 459.0, 0.0, 897.0, 0.0, 0.0, 120.0, 0.0, 41.0, 1480.0, 0.0, 925.0, 558.0, 192.0, 903.0, 925.0, 77.0, 436.0, 921.0, 65.0, 806.0, 236.0, 62.0, 62.0, 1036.0, 0.0, 136.0, 761.0, 634.0, 593.0, 7.0, 89.0, 1.0, 1087.0, 33.0, 33.0, 0.0, 0.0, 891.0, 1151.0, 682.0, 869.0, 332.0, 285.0, 153.0, 170.0, 1080.0, 355.0, 474.0, 439.0, 58.0, 24.0, 347.0, 713.0, 29.0, 1244.0, 398.0, 418.0, 70.0, 85.0, 787.0, 824.0, 839.0, 735.0, 624.0, 0.0, 958.0, 971.0, 0.0, 795.0, 1109.0, 258.0, 13.0, 0.0, 484.0, 487.0, 19.0, 32.0, 0.0, 893.0, 141.0, 200.0, 0.0, 57.0, 899.0, 1031.0, 6.0, 116.0, 0.0, 154.0, 1130.0, 888.0, 87.0, 47.0, 1175.0, 1181.0, 1495.0, 1468.0, 642.0, 1128.0, 278.0, 251.0, 830.0, 715.0, 12.0, 12.0, 990.0, 957.0, 628.0, 578.0, 210.0, 197.0, 197.0, 170.0, 738.0, 514.0, 1330.0, 1595.0, 1252.0, 1090.0, 546.0, 90.0, 77.0, 21.0, 349.0, 1321.0, 280.0, 319.0, 1411.0, 1172.0, 97.0, 79.0, 1207.0, 359.0, 253.0, 11.0, 409.0, 396.0, 674.0, 1056.0, 530.0, 566.0, 1235.0, 492.0, 600.0, 507.0, 428.0, 451.0, 901.0, 874.0, 903.0, 7.0, 106.0, 106.0, 946.0, 809.0, 960.0, 1281.0, 0.0, 555.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0333990627874388, "mean_inference_ms": 2.718463927665482, "mean_action_processing_ms": 0.5224592972161135, "mean_env_wait_ms": 0.37076458907005816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005640149116516113, "StateBufferConnector_ms": 0.008598804473876953, "ViewRequirementAgentConnector_ms": 0.19715452194213867}, "num_episodes": 18, "episode_return_max": 946.0, "episode_return_min": -857.0, "episode_return_mean": 62.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.94284438248042, "num_env_steps_trained_throughput_per_sec": 252.94284438248042, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 14797.421, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14797.351, "sample_time_ms": 2449.483, "learn_time_ms": 12325.942, "learn_throughput": 324.519, "synch_weights_time_ms": 18.244}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "f1691_00000", "date": "2024-08-13_16-49-10", "timestamp": 1723582150, "time_this_iter_s": 15.882461786270142, "time_total_s": 643.8061144351959, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c49af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 643.8061144351959, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 80.68260869565219, "ram_util_percent": 83.64782608695654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2276121272769556, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 8.919047194435484, "policy_loss": -0.0009527372211099617, "vf_loss": 8.901562910735922, "vf_explained_var": 0.013035687693843135, "kl": 0.018209401982705226, "entropy": 1.0096413923949792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9658035740808204, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 8.733089643811423, "policy_loss": 0.0035570972525174657, "vf_loss": 8.695594714179872, "vf_explained_var": -3.6898113432384674e-09, "kl": 0.009931510120127338, "entropy": 0.7984957443185584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 946.0, "episode_reward_min": -857.0, "episode_reward_mean": 99.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1568.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 1595.0}, "policy_reward_mean": {"prey_policy": -503.825, "predator_policy": 553.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, -126.0, 341.0, -857.0, 0.0, -51.0, -463.0, -85.0, 14.0, 181.0, -87.0, -123.0, -228.0, -47.0, -641.0, 61.0, 441.0, -125.0, -48.0, 13.0, 0.0, 193.0, 549.0, 99.0, -67.0, 211.0, 320.0, 6.0, -302.0, -43.0, 243.0, -24.0, 456.0, 576.0, -119.0, 785.0, -67.0, -599.0, -6.0, 41.0, 9.0, -598.0, -7.0, -50.0, 210.0, -30.0, -24.0, 772.0, -96.0, 946.0, 717.0, -184.0, 130.0, 550.0, -22.0, 794.0, 450.0, 143.0, 135.0, 386.0, 191.0, 684.0, -399.0, -71.0, -456.0, -323.0, 467.0, 22.0, 203.0, -167.0, 194.0, -211.0, 450.0, 242.0, -3.0, 304.0, 649.0, -369.0, 53.0, 208.0, 711.0, -55.0, 507.0, 268.0, -17.0, -551.0, 382.0, 0.0, 25.0, -58.0, -75.0, -3.0, 50.0, 476.0, 671.0, 94.0, 18.0, 379.0, 159.0, 628.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, -54.0, -274.0, 0.0, -1124.0, 0.0, -968.0, -786.0, 0.0, 0.0, -183.0, 12.0, -582.0, -1402.0, 0.0, -1010.0, -72.0, -664.0, -1104.0, -543.0, -482.0, -118.0, -97.0, -1012.0, -886.0, -384.0, -113.0, -58.0, -875.0, -802.0, -14.0, -822.0, -772.0, -14.0, -45.0, -176.0, -2.0, -1134.0, 0.0, -53.0, 0.0, 0.0, -1194.0, -655.0, -62.0, -940.0, -456.0, -62.0, -312.0, -78.0, -38.0, -1186.0, -616.0, 23.0, -32.0, -44.0, -716.0, -646.0, -1316.0, 0.0, -573.0, 0.0, -28.0, -151.0, -926.0, -229.0, -34.0, -964.0, 15.0, -758.0, 0.0, -1144.0, -12.0, -850.0, -824.0, -1142.0, 0.0, -19.0, -558.0, -372.0, -40.0, -2.0, -861.0, -630.0, -68.0, -280.0, 0.0, -107.0, -750.0, -970.0, -152.0, 0.0, -178.0, 0.0, 0.0, -1246.0, -128.0, -102.0, -26.0, -1384.0, -714.0, -1532.0, -1096.0, -858.0, -70.0, -329.0, -53.0, -942.0, -24.0, -22.0, 9.0, -1162.0, -761.0, 5.0, 0.0, -264.0, 0.0, -232.0, -796.0, -70.0, -1166.0, -1568.0, -1384.0, -274.0, -520.0, -515.0, -98.0, -71.0, -1088.0, -1038.0, -474.0, -448.0, -606.0, -1510.0, -154.0, 0.0, -123.0, -1240.0, -212.0, -219.0, -534.0, -77.0, -763.0, -1178.0, 0.0, -646.0, -129.0, -1356.0, -696.0, -414.0, -17.0, -558.0, -70.0, -1056.0, -900.0, -379.0, 3.0, -162.0, -493.0, -1054.0, -144.0, -1386.0, 0.0, -610.0, -1232.0, -508.0, -351.0, -908.0, -26.0, -38.0, -567.0, -1126.0, -166.0, -1314.0, 0.0, -56.0, -1462.0, -1568.0, -1302.0, -1365.0, -44.0, -74.0, -1300.0, -1520.0, -610.0, -710.0, -50.0, -910.0, -422.0, -1360.0, -481.0, -651.0, 0.0, 6.0, -810.0, -1276.0, -1330.0, -1346.0, -126.0, -1091.0], "policy_predator_policy_reward": [27.0, 11.0, 2.0, 146.0, 1006.0, 459.0, 0.0, 897.0, 0.0, 0.0, 120.0, 0.0, 41.0, 1480.0, 0.0, 925.0, 558.0, 192.0, 903.0, 925.0, 77.0, 436.0, 921.0, 65.0, 806.0, 236.0, 62.0, 62.0, 1036.0, 0.0, 136.0, 761.0, 634.0, 593.0, 7.0, 89.0, 1.0, 1087.0, 33.0, 33.0, 0.0, 0.0, 891.0, 1151.0, 682.0, 869.0, 332.0, 285.0, 153.0, 170.0, 1080.0, 355.0, 474.0, 439.0, 58.0, 24.0, 347.0, 713.0, 29.0, 1244.0, 398.0, 418.0, 70.0, 85.0, 787.0, 824.0, 839.0, 735.0, 624.0, 0.0, 958.0, 971.0, 0.0, 795.0, 1109.0, 258.0, 13.0, 0.0, 484.0, 487.0, 19.0, 32.0, 0.0, 893.0, 141.0, 200.0, 0.0, 57.0, 899.0, 1031.0, 6.0, 116.0, 0.0, 154.0, 1130.0, 888.0, 87.0, 47.0, 1175.0, 1181.0, 1495.0, 1468.0, 642.0, 1128.0, 278.0, 251.0, 830.0, 715.0, 12.0, 12.0, 990.0, 957.0, 628.0, 578.0, 210.0, 197.0, 197.0, 170.0, 738.0, 514.0, 1330.0, 1595.0, 1252.0, 1090.0, 546.0, 90.0, 77.0, 21.0, 349.0, 1321.0, 280.0, 319.0, 1411.0, 1172.0, 97.0, 79.0, 1207.0, 359.0, 253.0, 11.0, 409.0, 396.0, 674.0, 1056.0, 530.0, 566.0, 1235.0, 492.0, 600.0, 507.0, 428.0, 451.0, 901.0, 874.0, 903.0, 7.0, 106.0, 106.0, 946.0, 809.0, 960.0, 1281.0, 0.0, 555.0, 1128.0, 1119.0, 757.0, 770.0, 25.0, 22.0, 17.0, 1125.0, 709.0, 1153.0, 28.0, 28.0, 1595.0, 1460.0, 1197.0, 1412.0, 1.0, 42.0, 1424.0, 1393.0, 790.0, 580.0, 744.0, 692.0, 1182.0, 1271.0, 604.0, 622.0, 6.0, 6.0, 1301.0, 1164.0, 1418.0, 1417.0, 947.0, 898.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0377054220780821, "mean_inference_ms": 2.730204493837557, "mean_action_processing_ms": 0.5222440839005708, "mean_env_wait_ms": 0.3728708361505943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005200028419494629, "StateBufferConnector_ms": 0.008844971656799316, "ViewRequirementAgentConnector_ms": 0.19723045825958252}, "num_episodes": 18, "episode_return_max": 946.0, "episode_return_min": -857.0, "episode_return_mean": 99.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.3759839605365, "num_env_steps_trained_throughput_per_sec": 329.3759839605365, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 14643.762, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14643.686, "sample_time_ms": 2443.022, "learn_time_ms": 12181.104, "learn_throughput": 328.377, "synch_weights_time_ms": 15.521}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "f1691_00000", "date": "2024-08-13_16-49-22", "timestamp": 1723582162, "time_this_iter_s": 12.190480709075928, "time_total_s": 655.9965951442719, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c49b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 655.9965951442719, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 69.89999999999999, "ram_util_percent": 83.81764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8400631514491228, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 9.130002731747098, "policy_loss": -0.006074251097050451, "vf_loss": 9.119002891722179, "vf_explained_var": 0.025727633572129347, "kl": 0.016863318835010962, "entropy": 1.0412069374606723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8670218188453602, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 9.197371628675512, "policy_loss": 0.0020182383416723166, "vf_loss": 9.1680159210528, "vf_explained_var": -1.6714530016379382e-09, "kl": 0.007999998779770812, "entropy": 0.6667651129462732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 946.0, "episode_reward_min": -1193.0, "episode_reward_mean": 102.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1664.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 1595.0}, "policy_reward_mean": {"prey_policy": -584.72, "predator_policy": 635.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.0, 99.0, -67.0, 211.0, 320.0, 6.0, -302.0, -43.0, 243.0, -24.0, 456.0, 576.0, -119.0, 785.0, -67.0, -599.0, -6.0, 41.0, 9.0, -598.0, -7.0, -50.0, 210.0, -30.0, -24.0, 772.0, -96.0, 946.0, 717.0, -184.0, 130.0, 550.0, -22.0, 794.0, 450.0, 143.0, 135.0, 386.0, 191.0, 684.0, -399.0, -71.0, -456.0, -323.0, 467.0, 22.0, 203.0, -167.0, 194.0, -211.0, 450.0, 242.0, -3.0, 304.0, 649.0, -369.0, 53.0, 208.0, 711.0, -55.0, 507.0, 268.0, -17.0, -551.0, 382.0, 0.0, 25.0, -58.0, -75.0, -3.0, 50.0, 476.0, 671.0, 94.0, 18.0, 379.0, 159.0, 628.0, 31.0, -124.0, -83.0, -58.0, 132.0, -570.0, -53.0, -103.0, 0.0, -135.0, 851.0, -1193.0, -113.0, 413.0, 239.0, -13.0, 17.0, 362.0, 31.0, -204.0, -33.0, -720.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-62.0, -940.0, -456.0, -62.0, -312.0, -78.0, -38.0, -1186.0, -616.0, 23.0, -32.0, -44.0, -716.0, -646.0, -1316.0, 0.0, -573.0, 0.0, -28.0, -151.0, -926.0, -229.0, -34.0, -964.0, 15.0, -758.0, 0.0, -1144.0, -12.0, -850.0, -824.0, -1142.0, 0.0, -19.0, -558.0, -372.0, -40.0, -2.0, -861.0, -630.0, -68.0, -280.0, 0.0, -107.0, -750.0, -970.0, -152.0, 0.0, -178.0, 0.0, 0.0, -1246.0, -128.0, -102.0, -26.0, -1384.0, -714.0, -1532.0, -1096.0, -858.0, -70.0, -329.0, -53.0, -942.0, -24.0, -22.0, 9.0, -1162.0, -761.0, 5.0, 0.0, -264.0, 0.0, -232.0, -796.0, -70.0, -1166.0, -1568.0, -1384.0, -274.0, -520.0, -515.0, -98.0, -71.0, -1088.0, -1038.0, -474.0, -448.0, -606.0, -1510.0, -154.0, 0.0, -123.0, -1240.0, -212.0, -219.0, -534.0, -77.0, -763.0, -1178.0, 0.0, -646.0, -129.0, -1356.0, -696.0, -414.0, -17.0, -558.0, -70.0, -1056.0, -900.0, -379.0, 3.0, -162.0, -493.0, -1054.0, -144.0, -1386.0, 0.0, -610.0, -1232.0, -508.0, -351.0, -908.0, -26.0, -38.0, -567.0, -1126.0, -166.0, -1314.0, 0.0, -56.0, -1462.0, -1568.0, -1302.0, -1365.0, -44.0, -74.0, -1300.0, -1520.0, -610.0, -710.0, -50.0, -910.0, -422.0, -1360.0, -481.0, -651.0, 0.0, 6.0, -810.0, -1276.0, -1330.0, -1346.0, -126.0, -1091.0, -1312.0, -1009.0, -688.0, -318.0, 0.0, -746.0, -578.0, -24.0, -1006.0, -494.0, -1572.0, -1364.0, -1020.0, -869.0, -342.0, -329.0, -610.0, -723.0, -809.0, -1018.0, -60.0, -1396.0, -1418.0, -1290.0, -919.0, -56.0, -905.0, -1664.0, -447.0, -964.0, -312.0, -224.0, -3.0, 13.0, -1360.0, -733.0, -931.0, -1354.0, -611.0, -1376.0, -956.0, -683.0, -1112.0, -1046.0], "policy_predator_policy_reward": [682.0, 869.0, 332.0, 285.0, 153.0, 170.0, 1080.0, 355.0, 474.0, 439.0, 58.0, 24.0, 347.0, 713.0, 29.0, 1244.0, 398.0, 418.0, 70.0, 85.0, 787.0, 824.0, 839.0, 735.0, 624.0, 0.0, 958.0, 971.0, 0.0, 795.0, 1109.0, 258.0, 13.0, 0.0, 484.0, 487.0, 19.0, 32.0, 0.0, 893.0, 141.0, 200.0, 0.0, 57.0, 899.0, 1031.0, 6.0, 116.0, 0.0, 154.0, 1130.0, 888.0, 87.0, 47.0, 1175.0, 1181.0, 1495.0, 1468.0, 642.0, 1128.0, 278.0, 251.0, 830.0, 715.0, 12.0, 12.0, 990.0, 957.0, 628.0, 578.0, 210.0, 197.0, 197.0, 170.0, 738.0, 514.0, 1330.0, 1595.0, 1252.0, 1090.0, 546.0, 90.0, 77.0, 21.0, 349.0, 1321.0, 280.0, 319.0, 1411.0, 1172.0, 97.0, 79.0, 1207.0, 359.0, 253.0, 11.0, 409.0, 396.0, 674.0, 1056.0, 530.0, 566.0, 1235.0, 492.0, 600.0, 507.0, 428.0, 451.0, 901.0, 874.0, 903.0, 7.0, 106.0, 106.0, 946.0, 809.0, 960.0, 1281.0, 0.0, 555.0, 1128.0, 1119.0, 757.0, 770.0, 25.0, 22.0, 17.0, 1125.0, 709.0, 1153.0, 28.0, 28.0, 1595.0, 1460.0, 1197.0, 1412.0, 1.0, 42.0, 1424.0, 1393.0, 790.0, 580.0, 744.0, 692.0, 1182.0, 1271.0, 604.0, 622.0, 6.0, 6.0, 1301.0, 1164.0, 1418.0, 1417.0, 947.0, 898.0, 1306.0, 1046.0, 190.0, 692.0, 663.0, 0.0, 2.0, 542.0, 839.0, 793.0, 1566.0, 800.0, 815.0, 1021.0, 215.0, 353.0, 671.0, 662.0, 1003.0, 689.0, 1232.0, 1075.0, 1452.0, 63.0, 857.0, 5.0, 1459.0, 1523.0, 829.0, 821.0, 252.0, 271.0, 7.0, 0.0, 1284.0, 1171.0, 1092.0, 1224.0, 361.0, 1422.0, 871.0, 735.0, 304.0, 1134.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0404184456927223, "mean_inference_ms": 2.734841358853871, "mean_action_processing_ms": 0.5205774109732882, "mean_env_wait_ms": 0.37414060868487525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004985809326171875, "StateBufferConnector_ms": 0.008708477020263672, "ViewRequirementAgentConnector_ms": 0.18265235424041748}, "num_episodes": 22, "episode_return_max": 946.0, "episode_return_min": -1193.0, "episode_return_mean": 102.41, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.7952787141068, "num_env_steps_trained_throughput_per_sec": 324.7952787141068, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 14475.052, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14474.975, "sample_time_ms": 2334.141, "learn_time_ms": 12121.762, "learn_throughput": 329.985, "synch_weights_time_ms": 15.067}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "f1691_00000", "date": "2024-08-13_16-49-35", "timestamp": 1723582175, "time_this_iter_s": 12.367508888244629, "time_total_s": 668.3641040325165, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3742790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 668.3641040325165, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 67.44444444444446, "ram_util_percent": 83.77777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9564438754288608, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 9.164881300043177, "policy_loss": -0.003498953036968867, "vf_loss": 9.1494806234168, "vf_explained_var": 0.02148416275700564, "kl": 0.018666280254384538, "entropy": 1.012717480508108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1445477494329372, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 8.99412308748437, "policy_loss": 0.001994715573231655, "vf_loss": 8.967221851449795, "vf_explained_var": -1.986821492513021e-09, "kl": 0.00728860637962759, "entropy": 0.6008485293577588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 1056.0, "episode_reward_min": -1193.0, "episode_reward_mean": 127.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1664.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 13.0, "predator_policy": 1595.0}, "policy_reward_mean": {"prey_policy": -650.445, "predator_policy": 714.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, -24.0, 772.0, -96.0, 946.0, 717.0, -184.0, 130.0, 550.0, -22.0, 794.0, 450.0, 143.0, 135.0, 386.0, 191.0, 684.0, -399.0, -71.0, -456.0, -323.0, 467.0, 22.0, 203.0, -167.0, 194.0, -211.0, 450.0, 242.0, -3.0, 304.0, 649.0, -369.0, 53.0, 208.0, 711.0, -55.0, 507.0, 268.0, -17.0, -551.0, 382.0, 0.0, 25.0, -58.0, -75.0, -3.0, 50.0, 476.0, 671.0, 94.0, 18.0, 379.0, 159.0, 628.0, 31.0, -124.0, -83.0, -58.0, 132.0, -570.0, -53.0, -103.0, 0.0, -135.0, 851.0, -1193.0, -113.0, 413.0, 239.0, -13.0, 17.0, 362.0, 31.0, -204.0, -33.0, -720.0, 649.0, 166.0, 1056.0, 306.0, 258.0, 307.0, -278.0, 20.0, -288.0, -8.0, -503.0, 117.0, -70.0, -47.0, 621.0, -231.0, 23.0, -99.0, 315.0, 955.0, 632.0, 931.0, -676.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-152.0, 0.0, -178.0, 0.0, 0.0, -1246.0, -128.0, -102.0, -26.0, -1384.0, -714.0, -1532.0, -1096.0, -858.0, -70.0, -329.0, -53.0, -942.0, -24.0, -22.0, 9.0, -1162.0, -761.0, 5.0, 0.0, -264.0, 0.0, -232.0, -796.0, -70.0, -1166.0, -1568.0, -1384.0, -274.0, -520.0, -515.0, -98.0, -71.0, -1088.0, -1038.0, -474.0, -448.0, -606.0, -1510.0, -154.0, 0.0, -123.0, -1240.0, -212.0, -219.0, -534.0, -77.0, -763.0, -1178.0, 0.0, -646.0, -129.0, -1356.0, -696.0, -414.0, -17.0, -558.0, -70.0, -1056.0, -900.0, -379.0, 3.0, -162.0, -493.0, -1054.0, -144.0, -1386.0, 0.0, -610.0, -1232.0, -508.0, -351.0, -908.0, -26.0, -38.0, -567.0, -1126.0, -166.0, -1314.0, 0.0, -56.0, -1462.0, -1568.0, -1302.0, -1365.0, -44.0, -74.0, -1300.0, -1520.0, -610.0, -710.0, -50.0, -910.0, -422.0, -1360.0, -481.0, -651.0, 0.0, 6.0, -810.0, -1276.0, -1330.0, -1346.0, -126.0, -1091.0, -1312.0, -1009.0, -688.0, -318.0, 0.0, -746.0, -578.0, -24.0, -1006.0, -494.0, -1572.0, -1364.0, -1020.0, -869.0, -342.0, -329.0, -610.0, -723.0, -809.0, -1018.0, -60.0, -1396.0, -1418.0, -1290.0, -919.0, -56.0, -905.0, -1664.0, -447.0, -964.0, -312.0, -224.0, -3.0, 13.0, -1360.0, -733.0, -931.0, -1354.0, -611.0, -1376.0, -956.0, -683.0, -1112.0, -1046.0, -879.0, 0.0, -1255.0, -935.0, -48.0, -1350.0, -884.0, -1352.0, -1366.0, -788.0, -382.0, -849.0, -1264.0, -406.0, -117.0, -246.0, -865.0, -304.0, -110.0, -165.0, -519.0, -1078.0, -1322.0, -373.0, -86.0, -1430.0, -562.0, -588.0, -1021.0, -4.0, -247.0, -542.0, -804.0, -646.0, -118.0, -566.0, -1334.0, -791.0, -1466.0, 0.0, -134.0, -1614.0, -1395.0, -14.0, -750.0, -934.0], "policy_predator_policy_reward": [6.0, 116.0, 0.0, 154.0, 1130.0, 888.0, 87.0, 47.0, 1175.0, 1181.0, 1495.0, 1468.0, 642.0, 1128.0, 278.0, 251.0, 830.0, 715.0, 12.0, 12.0, 990.0, 957.0, 628.0, 578.0, 210.0, 197.0, 197.0, 170.0, 738.0, 514.0, 1330.0, 1595.0, 1252.0, 1090.0, 546.0, 90.0, 77.0, 21.0, 349.0, 1321.0, 280.0, 319.0, 1411.0, 1172.0, 97.0, 79.0, 1207.0, 359.0, 253.0, 11.0, 409.0, 396.0, 674.0, 1056.0, 530.0, 566.0, 1235.0, 492.0, 600.0, 507.0, 428.0, 451.0, 901.0, 874.0, 903.0, 7.0, 106.0, 106.0, 946.0, 809.0, 960.0, 1281.0, 0.0, 555.0, 1128.0, 1119.0, 757.0, 770.0, 25.0, 22.0, 17.0, 1125.0, 709.0, 1153.0, 28.0, 28.0, 1595.0, 1460.0, 1197.0, 1412.0, 1.0, 42.0, 1424.0, 1393.0, 790.0, 580.0, 744.0, 692.0, 1182.0, 1271.0, 604.0, 622.0, 6.0, 6.0, 1301.0, 1164.0, 1418.0, 1417.0, 947.0, 898.0, 1306.0, 1046.0, 190.0, 692.0, 663.0, 0.0, 2.0, 542.0, 839.0, 793.0, 1566.0, 800.0, 815.0, 1021.0, 215.0, 353.0, 671.0, 662.0, 1003.0, 689.0, 1232.0, 1075.0, 1452.0, 63.0, 857.0, 5.0, 1459.0, 1523.0, 829.0, 821.0, 252.0, 271.0, 7.0, 0.0, 1284.0, 1171.0, 1092.0, 1224.0, 361.0, 1422.0, 871.0, 735.0, 304.0, 1134.0, 770.0, 758.0, 1187.0, 1169.0, 1308.0, 1146.0, 1277.0, 1265.0, 1285.0, 1127.0, 736.0, 802.0, 185.0, 1207.0, 195.0, 188.0, 86.0, 795.0, 148.0, 119.0, 2.0, 1092.0, 600.0, 1212.0, 71.0, 1375.0, 532.0, 571.0, 854.0, 792.0, 27.0, 531.0, 716.0, 757.0, 525.0, 60.0, 1202.0, 1238.0, 1329.0, 1092.0, 856.0, 1524.0, 1261.0, 1079.0, 958.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0391069974885392, "mean_inference_ms": 2.72907093187017, "mean_action_processing_ms": 0.5169430808891886, "mean_env_wait_ms": 0.3739020883402731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005030393600463867, "StateBufferConnector_ms": 0.007055401802062988, "ViewRequirementAgentConnector_ms": 0.15226566791534424}, "num_episodes": 23, "episode_return_max": 1056.0, "episode_return_min": -1193.0, "episode_return_mean": 127.74, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.9231855957827, "num_env_steps_trained_throughput_per_sec": 326.9231855957827, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 14243.511, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14243.435, "sample_time_ms": 2171.08, "learn_time_ms": 12053.513, "learn_throughput": 331.853, "synch_weights_time_ms": 15.053}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "f1691_00000", "date": "2024-08-13_16-49-47", "timestamp": 1723582187, "time_this_iter_s": 12.30676007270813, "time_total_s": 680.6708641052246, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37771f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 680.6708641052246, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 69.82941176470588, "ram_util_percent": 83.78235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3666485286736614, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 9.168000846943528, "policy_loss": 0.0026888013834616654, "vf_loss": 9.1434922642178, "vf_explained_var": 0.008644169884383993, "kl": 0.02155039250259495, "entropy": 0.8585973248910652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3109587836439016, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 8.043342186408069, "policy_loss": 0.0019998817808098263, "vf_loss": 8.013615684408359, "vf_explained_var": -5.014359004913815e-09, "kl": 0.00811386894882802, "entropy": 0.5666490992856404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 1244.0, "episode_reward_min": -1193.0, "episode_reward_mean": 120.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1664.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 13.0, "predator_policy": 1596.0}, "policy_reward_mean": {"prey_policy": -678.34, "predator_policy": 738.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.0, -456.0, -323.0, 467.0, 22.0, 203.0, -167.0, 194.0, -211.0, 450.0, 242.0, -3.0, 304.0, 649.0, -369.0, 53.0, 208.0, 711.0, -55.0, 507.0, 268.0, -17.0, -551.0, 382.0, 0.0, 25.0, -58.0, -75.0, -3.0, 50.0, 476.0, 671.0, 94.0, 18.0, 379.0, 159.0, 628.0, 31.0, -124.0, -83.0, -58.0, 132.0, -570.0, -53.0, -103.0, 0.0, -135.0, 851.0, -1193.0, -113.0, 413.0, 239.0, -13.0, 17.0, 362.0, 31.0, -204.0, -33.0, -720.0, 649.0, 166.0, 1056.0, 306.0, 258.0, 307.0, -278.0, 20.0, -288.0, -8.0, -503.0, 117.0, -70.0, -47.0, 621.0, -231.0, 23.0, -99.0, 315.0, 955.0, 632.0, 931.0, -676.0, -226.0, 4.0, 420.0, -321.0, 719.0, 0.0, 393.0, -16.0, 32.0, 261.0, -52.0, 174.0, 254.0, 587.0, 804.0, 1244.0, 158.0, -43.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-98.0, -71.0, -1088.0, -1038.0, -474.0, -448.0, -606.0, -1510.0, -154.0, 0.0, -123.0, -1240.0, -212.0, -219.0, -534.0, -77.0, -763.0, -1178.0, 0.0, -646.0, -129.0, -1356.0, -696.0, -414.0, -17.0, -558.0, -70.0, -1056.0, -900.0, -379.0, 3.0, -162.0, -493.0, -1054.0, -144.0, -1386.0, 0.0, -610.0, -1232.0, -508.0, -351.0, -908.0, -26.0, -38.0, -567.0, -1126.0, -166.0, -1314.0, 0.0, -56.0, -1462.0, -1568.0, -1302.0, -1365.0, -44.0, -74.0, -1300.0, -1520.0, -610.0, -710.0, -50.0, -910.0, -422.0, -1360.0, -481.0, -651.0, 0.0, 6.0, -810.0, -1276.0, -1330.0, -1346.0, -126.0, -1091.0, -1312.0, -1009.0, -688.0, -318.0, 0.0, -746.0, -578.0, -24.0, -1006.0, -494.0, -1572.0, -1364.0, -1020.0, -869.0, -342.0, -329.0, -610.0, -723.0, -809.0, -1018.0, -60.0, -1396.0, -1418.0, -1290.0, -919.0, -56.0, -905.0, -1664.0, -447.0, -964.0, -312.0, -224.0, -3.0, 13.0, -1360.0, -733.0, -931.0, -1354.0, -611.0, -1376.0, -956.0, -683.0, -1112.0, -1046.0, -879.0, 0.0, -1255.0, -935.0, -48.0, -1350.0, -884.0, -1352.0, -1366.0, -788.0, -382.0, -849.0, -1264.0, -406.0, -117.0, -246.0, -865.0, -304.0, -110.0, -165.0, -519.0, -1078.0, -1322.0, -373.0, -86.0, -1430.0, -562.0, -588.0, -1021.0, -4.0, -247.0, -542.0, -804.0, -646.0, -118.0, -566.0, -1334.0, -791.0, -1466.0, 0.0, -134.0, -1614.0, -1395.0, -14.0, -750.0, -934.0, -514.0, -1388.0, -42.0, 0.0, 0.0, -720.0, -1318.0, -1270.0, -1460.0, -263.0, 0.0, 0.0, -1076.0, -95.0, -12.0, -102.0, -916.0, -709.0, -486.0, -112.0, -381.0, -1152.0, -1360.0, -560.0, -698.0, -1006.0, -176.0, -1020.0, -1040.0, 0.0, -90.0, -1640.0, -1130.0, 0.0, -1002.0, -1395.0], "policy_predator_policy_reward": [77.0, 21.0, 349.0, 1321.0, 280.0, 319.0, 1411.0, 1172.0, 97.0, 79.0, 1207.0, 359.0, 253.0, 11.0, 409.0, 396.0, 674.0, 1056.0, 530.0, 566.0, 1235.0, 492.0, 600.0, 507.0, 428.0, 451.0, 901.0, 874.0, 903.0, 7.0, 106.0, 106.0, 946.0, 809.0, 960.0, 1281.0, 0.0, 555.0, 1128.0, 1119.0, 757.0, 770.0, 25.0, 22.0, 17.0, 1125.0, 709.0, 1153.0, 28.0, 28.0, 1595.0, 1460.0, 1197.0, 1412.0, 1.0, 42.0, 1424.0, 1393.0, 790.0, 580.0, 744.0, 692.0, 1182.0, 1271.0, 604.0, 622.0, 6.0, 6.0, 1301.0, 1164.0, 1418.0, 1417.0, 947.0, 898.0, 1306.0, 1046.0, 190.0, 692.0, 663.0, 0.0, 2.0, 542.0, 839.0, 793.0, 1566.0, 800.0, 815.0, 1021.0, 215.0, 353.0, 671.0, 662.0, 1003.0, 689.0, 1232.0, 1075.0, 1452.0, 63.0, 857.0, 5.0, 1459.0, 1523.0, 829.0, 821.0, 252.0, 271.0, 7.0, 0.0, 1284.0, 1171.0, 1092.0, 1224.0, 361.0, 1422.0, 871.0, 735.0, 304.0, 1134.0, 770.0, 758.0, 1187.0, 1169.0, 1308.0, 1146.0, 1277.0, 1265.0, 1285.0, 1127.0, 736.0, 802.0, 185.0, 1207.0, 195.0, 188.0, 86.0, 795.0, 148.0, 119.0, 2.0, 1092.0, 600.0, 1212.0, 71.0, 1375.0, 532.0, 571.0, 854.0, 792.0, 27.0, 531.0, 716.0, 757.0, 525.0, 60.0, 1202.0, 1238.0, 1329.0, 1092.0, 856.0, 1524.0, 1261.0, 1079.0, 958.0, 50.0, 355.0, 1321.0, 23.0, 23.0, 649.0, 491.0, 1240.0, 1027.0, 1060.0, 1382.0, 0.0, 0.0, 573.0, 991.0, 47.0, 51.0, 856.0, 801.0, 434.0, 425.0, 321.0, 1160.0, 782.0, 1312.0, 976.0, 982.0, 932.0, 851.0, 934.0, 910.0, 1442.0, 1532.0, 1057.0, 231.0, 1596.0, 758.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0361304420477524, "mean_inference_ms": 2.7195846477288876, "mean_action_processing_ms": 0.5139139750652677, "mean_env_wait_ms": 0.3725704183819306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005204677581787109, "StateBufferConnector_ms": 0.007184267044067383, "ViewRequirementAgentConnector_ms": 0.151228666305542}, "num_episodes": 18, "episode_return_max": 1244.0, "episode_return_min": -1193.0, "episode_return_mean": 120.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.3857340523022, "num_env_steps_trained_throughput_per_sec": 333.3857340523022, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 14016.081, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14016.005, "sample_time_ms": 2093.955, "learn_time_ms": 11902.885, "learn_throughput": 336.053, "synch_weights_time_ms": 15.142}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "f1691_00000", "date": "2024-08-13_16-49-59", "timestamp": 1723582199, "time_this_iter_s": 12.054817914962769, "time_total_s": 692.7256820201874, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c49d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 692.7256820201874, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 67.9, "ram_util_percent": 83.68235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8711742158131626, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 8.956393742435193, "policy_loss": 0.0022031462793213824, "vf_loss": 8.927139571860984, "vf_explained_var": -0.0011841612518149079, "kl": 0.0178113946025925, "entropy": 0.9265154446558977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2000093547597763, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.674120532141791, "policy_loss": 0.002793711988826987, "vf_loss": 6.645569721857707, "vf_explained_var": -6.8119594029017855e-09, "kl": 0.007537510201987152, "entropy": 0.5844116114119373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 1244.0, "episode_reward_min": -1193.0, "episode_reward_mean": 133.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1664.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 13.0, "predator_policy": 1596.0}, "policy_reward_mean": {"prey_policy": -664.42, "predator_policy": 731.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.0, 507.0, 268.0, -17.0, -551.0, 382.0, 0.0, 25.0, -58.0, -75.0, -3.0, 50.0, 476.0, 671.0, 94.0, 18.0, 379.0, 159.0, 628.0, 31.0, -124.0, -83.0, -58.0, 132.0, -570.0, -53.0, -103.0, 0.0, -135.0, 851.0, -1193.0, -113.0, 413.0, 239.0, -13.0, 17.0, 362.0, 31.0, -204.0, -33.0, -720.0, 649.0, 166.0, 1056.0, 306.0, 258.0, 307.0, -278.0, 20.0, -288.0, -8.0, -503.0, 117.0, -70.0, -47.0, 621.0, -231.0, 23.0, -99.0, 315.0, 955.0, 632.0, 931.0, -676.0, -226.0, 4.0, 420.0, -321.0, 719.0, 0.0, 393.0, -16.0, 32.0, 261.0, -52.0, 174.0, 254.0, 587.0, 804.0, 1244.0, 158.0, -43.0, -261.0, -25.0, 346.0, 177.0, 660.0, 224.0, -170.0, 260.0, -113.0, -48.0, -61.0, 229.0, 9.0, 577.0, 1148.0, 0.0, -49.0, 323.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -610.0, -1232.0, -508.0, -351.0, -908.0, -26.0, -38.0, -567.0, -1126.0, -166.0, -1314.0, 0.0, -56.0, -1462.0, -1568.0, -1302.0, -1365.0, -44.0, -74.0, -1300.0, -1520.0, -610.0, -710.0, -50.0, -910.0, -422.0, -1360.0, -481.0, -651.0, 0.0, 6.0, -810.0, -1276.0, -1330.0, -1346.0, -126.0, -1091.0, -1312.0, -1009.0, -688.0, -318.0, 0.0, -746.0, -578.0, -24.0, -1006.0, -494.0, -1572.0, -1364.0, -1020.0, -869.0, -342.0, -329.0, -610.0, -723.0, -809.0, -1018.0, -60.0, -1396.0, -1418.0, -1290.0, -919.0, -56.0, -905.0, -1664.0, -447.0, -964.0, -312.0, -224.0, -3.0, 13.0, -1360.0, -733.0, -931.0, -1354.0, -611.0, -1376.0, -956.0, -683.0, -1112.0, -1046.0, -879.0, 0.0, -1255.0, -935.0, -48.0, -1350.0, -884.0, -1352.0, -1366.0, -788.0, -382.0, -849.0, -1264.0, -406.0, -117.0, -246.0, -865.0, -304.0, -110.0, -165.0, -519.0, -1078.0, -1322.0, -373.0, -86.0, -1430.0, -562.0, -588.0, -1021.0, -4.0, -247.0, -542.0, -804.0, -646.0, -118.0, -566.0, -1334.0, -791.0, -1466.0, 0.0, -134.0, -1614.0, -1395.0, -14.0, -750.0, -934.0, -514.0, -1388.0, -42.0, 0.0, 0.0, -720.0, -1318.0, -1270.0, -1460.0, -263.0, 0.0, 0.0, -1076.0, -95.0, -12.0, -102.0, -916.0, -709.0, -486.0, -112.0, -381.0, -1152.0, -1360.0, -560.0, -698.0, -1006.0, -176.0, -1020.0, -1040.0, 0.0, -90.0, -1640.0, -1130.0, 0.0, -1002.0, -1395.0, -1218.0, -551.0, -31.0, -29.0, -10.0, -575.0, -389.0, -43.0, -570.0, -1238.0, 0.0, -1494.0, -1375.0, -1336.0, -1126.0, -776.0, -106.0, -96.0, -38.0, -122.0, -500.0, -344.0, -792.0, -485.0, -147.0, -286.0, 0.0, -813.0, -1540.0, 0.0, 0.0, 0.0, -36.0, -38.0, 0.0, -402.0], "policy_predator_policy_reward": [0.0, 555.0, 1128.0, 1119.0, 757.0, 770.0, 25.0, 22.0, 17.0, 1125.0, 709.0, 1153.0, 28.0, 28.0, 1595.0, 1460.0, 1197.0, 1412.0, 1.0, 42.0, 1424.0, 1393.0, 790.0, 580.0, 744.0, 692.0, 1182.0, 1271.0, 604.0, 622.0, 6.0, 6.0, 1301.0, 1164.0, 1418.0, 1417.0, 947.0, 898.0, 1306.0, 1046.0, 190.0, 692.0, 663.0, 0.0, 2.0, 542.0, 839.0, 793.0, 1566.0, 800.0, 815.0, 1021.0, 215.0, 353.0, 671.0, 662.0, 1003.0, 689.0, 1232.0, 1075.0, 1452.0, 63.0, 857.0, 5.0, 1459.0, 1523.0, 829.0, 821.0, 252.0, 271.0, 7.0, 0.0, 1284.0, 1171.0, 1092.0, 1224.0, 361.0, 1422.0, 871.0, 735.0, 304.0, 1134.0, 770.0, 758.0, 1187.0, 1169.0, 1308.0, 1146.0, 1277.0, 1265.0, 1285.0, 1127.0, 736.0, 802.0, 185.0, 1207.0, 195.0, 188.0, 86.0, 795.0, 148.0, 119.0, 2.0, 1092.0, 600.0, 1212.0, 71.0, 1375.0, 532.0, 571.0, 854.0, 792.0, 27.0, 531.0, 716.0, 757.0, 525.0, 60.0, 1202.0, 1238.0, 1329.0, 1092.0, 856.0, 1524.0, 1261.0, 1079.0, 958.0, 50.0, 355.0, 1321.0, 23.0, 23.0, 649.0, 491.0, 1240.0, 1027.0, 1060.0, 1382.0, 0.0, 0.0, 573.0, 991.0, 47.0, 51.0, 856.0, 801.0, 434.0, 425.0, 321.0, 1160.0, 782.0, 1312.0, 976.0, 982.0, 932.0, 851.0, 934.0, 910.0, 1442.0, 1532.0, 1057.0, 231.0, 1596.0, 758.0, 1153.0, 355.0, 32.0, 3.0, 443.0, 488.0, 309.0, 300.0, 1243.0, 1225.0, 286.0, 1432.0, 1212.0, 1329.0, 1083.0, 1079.0, 39.0, 50.0, 75.0, 37.0, 355.0, 428.0, 760.0, 746.0, 220.0, 222.0, 659.0, 731.0, 1382.0, 1306.0, 0.0, 0.0, 24.0, 1.0, 376.0, 349.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0295883111150088, "mean_inference_ms": 2.7007314055623315, "mean_action_processing_ms": 0.5094925898714218, "mean_env_wait_ms": 0.3698731153493483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006157636642456055, "StateBufferConnector_ms": 0.006829500198364258, "ViewRequirementAgentConnector_ms": 0.11867654323577881}, "num_episodes": 18, "episode_return_max": 1244.0, "episode_return_min": -1193.0, "episode_return_mean": 133.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.29894029209964, "num_env_steps_trained_throughput_per_sec": 321.29894029209964, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 13759.463, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13759.388, "sample_time_ms": 2011.855, "learn_time_ms": 11728.033, "learn_throughput": 341.063, "synch_weights_time_ms": 15.069}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "f1691_00000", "date": "2024-08-13_16-50-12", "timestamp": 1723582212, "time_this_iter_s": 12.470897912979126, "time_total_s": 705.1965799331665, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37db040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 705.1965799331665, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 70.23529411764707, "ram_util_percent": 83.59411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.464718236399706, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 9.36222359490773, "policy_loss": -0.0004280727211307123, "vf_loss": 9.34126148022041, "vf_explained_var": 0.006837984367653175, "kl": 0.014084078657467917, "entropy": 0.9927021588913347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.375548554475976, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 7.374169703135415, "policy_loss": 0.003476197077404885, "vf_loss": 7.337288372100345, "vf_explained_var": -8.136507064577132e-09, "kl": 0.009775623697980577, "entropy": 0.6937177538871765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 1244.0, "episode_reward_min": -1193.0, "episode_reward_mean": 158.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1664.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 13.0, "predator_policy": 1596.0}, "policy_reward_mean": {"prey_policy": -600.215, "predator_policy": 679.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.0, 132.0, -570.0, -53.0, -103.0, 0.0, -135.0, 851.0, -1193.0, -113.0, 413.0, 239.0, -13.0, 17.0, 362.0, 31.0, -204.0, -33.0, -720.0, 649.0, 166.0, 1056.0, 306.0, 258.0, 307.0, -278.0, 20.0, -288.0, -8.0, -503.0, 117.0, -70.0, -47.0, 621.0, -231.0, 23.0, -99.0, 315.0, 955.0, 632.0, 931.0, -676.0, -226.0, 4.0, 420.0, -321.0, 719.0, 0.0, 393.0, -16.0, 32.0, 261.0, -52.0, 174.0, 254.0, 587.0, 804.0, 1244.0, 158.0, -43.0, -261.0, -25.0, 346.0, 177.0, 660.0, 224.0, -170.0, 260.0, -113.0, -48.0, -61.0, 229.0, 9.0, 577.0, 1148.0, 0.0, -49.0, 323.0, 347.0, 459.0, -129.0, -99.0, -17.0, 440.0, 0.0, 144.0, -150.0, -13.0, 457.0, 368.0, 883.0, 510.0, 13.0, 384.0, -33.0, 958.0, -28.0, 27.0, 240.0, 477.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-578.0, -24.0, -1006.0, -494.0, -1572.0, -1364.0, -1020.0, -869.0, -342.0, -329.0, -610.0, -723.0, -809.0, -1018.0, -60.0, -1396.0, -1418.0, -1290.0, -919.0, -56.0, -905.0, -1664.0, -447.0, -964.0, -312.0, -224.0, -3.0, 13.0, -1360.0, -733.0, -931.0, -1354.0, -611.0, -1376.0, -956.0, -683.0, -1112.0, -1046.0, -879.0, 0.0, -1255.0, -935.0, -48.0, -1350.0, -884.0, -1352.0, -1366.0, -788.0, -382.0, -849.0, -1264.0, -406.0, -117.0, -246.0, -865.0, -304.0, -110.0, -165.0, -519.0, -1078.0, -1322.0, -373.0, -86.0, -1430.0, -562.0, -588.0, -1021.0, -4.0, -247.0, -542.0, -804.0, -646.0, -118.0, -566.0, -1334.0, -791.0, -1466.0, 0.0, -134.0, -1614.0, -1395.0, -14.0, -750.0, -934.0, -514.0, -1388.0, -42.0, 0.0, 0.0, -720.0, -1318.0, -1270.0, -1460.0, -263.0, 0.0, 0.0, -1076.0, -95.0, -12.0, -102.0, -916.0, -709.0, -486.0, -112.0, -381.0, -1152.0, -1360.0, -560.0, -698.0, -1006.0, -176.0, -1020.0, -1040.0, 0.0, -90.0, -1640.0, -1130.0, 0.0, -1002.0, -1395.0, -1218.0, -551.0, -31.0, -29.0, -10.0, -575.0, -389.0, -43.0, -570.0, -1238.0, 0.0, -1494.0, -1375.0, -1336.0, -1126.0, -776.0, -106.0, -96.0, -38.0, -122.0, -500.0, -344.0, -792.0, -485.0, -147.0, -286.0, 0.0, -813.0, -1540.0, 0.0, 0.0, 0.0, -36.0, -38.0, 0.0, -402.0, -1069.0, -1328.0, -4.0, -1028.0, -56.0, -560.0, -1206.0, -918.0, -9.0, -184.0, -914.0, -14.0, -54.0, 0.0, -404.0, -44.0, -304.0, -208.0, -124.0, -26.0, -1224.0, -176.0, -1097.0, -166.0, -1344.0, -32.0, 0.0, -1104.0, 1.0, -25.0, -810.0, -146.0, -18.0, -36.0, -22.0, -1360.0, -167.0, -34.0, -106.0, 11.0, -26.0, -525.0, -156.0, -920.0], "policy_predator_policy_reward": [2.0, 542.0, 839.0, 793.0, 1566.0, 800.0, 815.0, 1021.0, 215.0, 353.0, 671.0, 662.0, 1003.0, 689.0, 1232.0, 1075.0, 1452.0, 63.0, 857.0, 5.0, 1459.0, 1523.0, 829.0, 821.0, 252.0, 271.0, 7.0, 0.0, 1284.0, 1171.0, 1092.0, 1224.0, 361.0, 1422.0, 871.0, 735.0, 304.0, 1134.0, 770.0, 758.0, 1187.0, 1169.0, 1308.0, 1146.0, 1277.0, 1265.0, 1285.0, 1127.0, 736.0, 802.0, 185.0, 1207.0, 195.0, 188.0, 86.0, 795.0, 148.0, 119.0, 2.0, 1092.0, 600.0, 1212.0, 71.0, 1375.0, 532.0, 571.0, 854.0, 792.0, 27.0, 531.0, 716.0, 757.0, 525.0, 60.0, 1202.0, 1238.0, 1329.0, 1092.0, 856.0, 1524.0, 1261.0, 1079.0, 958.0, 50.0, 355.0, 1321.0, 23.0, 23.0, 649.0, 491.0, 1240.0, 1027.0, 1060.0, 1382.0, 0.0, 0.0, 573.0, 991.0, 47.0, 51.0, 856.0, 801.0, 434.0, 425.0, 321.0, 1160.0, 782.0, 1312.0, 976.0, 982.0, 932.0, 851.0, 934.0, 910.0, 1442.0, 1532.0, 1057.0, 231.0, 1596.0, 758.0, 1153.0, 355.0, 32.0, 3.0, 443.0, 488.0, 309.0, 300.0, 1243.0, 1225.0, 286.0, 1432.0, 1212.0, 1329.0, 1083.0, 1079.0, 39.0, 50.0, 75.0, 37.0, 355.0, 428.0, 760.0, 746.0, 220.0, 222.0, 659.0, 731.0, 1382.0, 1306.0, 0.0, 0.0, 24.0, 1.0, 376.0, 349.0, 1293.0, 1451.0, 649.0, 842.0, 32.0, 455.0, 821.0, 1204.0, 95.0, 81.0, 664.0, 704.0, 27.0, 27.0, 335.0, 257.0, 340.0, 22.0, 62.0, 75.0, 793.0, 1064.0, 1042.0, 589.0, 1061.0, 1198.0, 900.0, 714.0, 22.0, 15.0, 593.0, 747.0, 0.0, 21.0, 1152.0, 1188.0, 107.0, 66.0, 61.0, 61.0, 438.0, 353.0, 791.0, 762.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0216536018431277, "mean_inference_ms": 2.6808682931964474, "mean_action_processing_ms": 0.5043713565266946, "mean_env_wait_ms": 0.3667352546082745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007936716079711914, "StateBufferConnector_ms": 0.006582498550415039, "ViewRequirementAgentConnector_ms": 0.11571049690246582}, "num_episodes": 22, "episode_return_max": 1244.0, "episode_return_min": -1193.0, "episode_return_mean": 158.62, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.50333621366593, "num_env_steps_trained_throughput_per_sec": 308.50333621366593, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 13674.914, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13674.84, "sample_time_ms": 1983.882, "learn_time_ms": 11672.757, "learn_throughput": 342.678, "synch_weights_time_ms": 13.806}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "f1691_00000", "date": "2024-08-13_16-50-25", "timestamp": 1723582225, "time_this_iter_s": 13.034358024597168, "time_total_s": 718.2309379577637, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 718.2309379577637, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 77.94736842105264, "ram_util_percent": 83.63684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9979341210196258, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 8.91667975874805, "policy_loss": 0.001510946016522154, "vf_loss": 8.881668758392333, "vf_explained_var": 0.0014298968214206595, "kl": 0.022057655528214617, "entropy": 1.0021013088642605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.321507065881182, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.973889905435068, "policy_loss": 0.0021102002070398714, "vf_loss": 6.9427671520798295, "vf_explained_var": -9.177223084464906e-09, "kl": 0.008490187553906698, "entropy": 0.6769606234850707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1244.0, "episode_reward_min": -676.0, "episode_reward_mean": 173.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 1596.0}, "policy_reward_mean": {"prey_policy": -532.055, "predator_policy": 618.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [258.0, 307.0, -278.0, 20.0, -288.0, -8.0, -503.0, 117.0, -70.0, -47.0, 621.0, -231.0, 23.0, -99.0, 315.0, 955.0, 632.0, 931.0, -676.0, -226.0, 4.0, 420.0, -321.0, 719.0, 0.0, 393.0, -16.0, 32.0, 261.0, -52.0, 174.0, 254.0, 587.0, 804.0, 1244.0, 158.0, -43.0, -261.0, -25.0, 346.0, 177.0, 660.0, 224.0, -170.0, 260.0, -113.0, -48.0, -61.0, 229.0, 9.0, 577.0, 1148.0, 0.0, -49.0, 323.0, 347.0, 459.0, -129.0, -99.0, -17.0, 440.0, 0.0, 144.0, -150.0, -13.0, 457.0, 368.0, 883.0, 510.0, 13.0, 384.0, -33.0, 958.0, -28.0, 27.0, 240.0, 477.0, -114.0, -146.0, 245.0, -8.0, 0.0, 199.0, -12.0, 456.0, 763.0, -55.0, -597.0, -1.0, 13.0, 75.0, 142.0, -71.0, -85.0, 755.0, 591.0, 39.0, 11.0, 280.0, 24.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1366.0, -788.0, -382.0, -849.0, -1264.0, -406.0, -117.0, -246.0, -865.0, -304.0, -110.0, -165.0, -519.0, -1078.0, -1322.0, -373.0, -86.0, -1430.0, -562.0, -588.0, -1021.0, -4.0, -247.0, -542.0, -804.0, -646.0, -118.0, -566.0, -1334.0, -791.0, -1466.0, 0.0, -134.0, -1614.0, -1395.0, -14.0, -750.0, -934.0, -514.0, -1388.0, -42.0, 0.0, 0.0, -720.0, -1318.0, -1270.0, -1460.0, -263.0, 0.0, 0.0, -1076.0, -95.0, -12.0, -102.0, -916.0, -709.0, -486.0, -112.0, -381.0, -1152.0, -1360.0, -560.0, -698.0, -1006.0, -176.0, -1020.0, -1040.0, 0.0, -90.0, -1640.0, -1130.0, 0.0, -1002.0, -1395.0, -1218.0, -551.0, -31.0, -29.0, -10.0, -575.0, -389.0, -43.0, -570.0, -1238.0, 0.0, -1494.0, -1375.0, -1336.0, -1126.0, -776.0, -106.0, -96.0, -38.0, -122.0, -500.0, -344.0, -792.0, -485.0, -147.0, -286.0, 0.0, -813.0, -1540.0, 0.0, 0.0, 0.0, -36.0, -38.0, 0.0, -402.0, -1069.0, -1328.0, -4.0, -1028.0, -56.0, -560.0, -1206.0, -918.0, -9.0, -184.0, -914.0, -14.0, -54.0, 0.0, -404.0, -44.0, -304.0, -208.0, -124.0, -26.0, -1224.0, -176.0, -1097.0, -166.0, -1344.0, -32.0, 0.0, -1104.0, 1.0, -25.0, -810.0, -146.0, -18.0, -36.0, -22.0, -1360.0, -167.0, -34.0, -106.0, 11.0, -26.0, -525.0, -156.0, -920.0, -256.0, -1236.0, -478.0, -114.0, -142.0, -662.0, -801.0, -629.0, 0.0, 0.0, -660.0, -161.0, -31.0, -79.0, -858.0, 19.0, -1324.0, -76.0, -46.0, -36.0, -720.0, -940.0, -1152.0, -1360.0, 0.0, 7.0, -694.0, -729.0, -818.0, -681.0, -678.0, -64.0, -906.0, -491.0, -1236.0, 3.0, 0.0, -1064.0, -1272.0, 0.0, -326.0, -850.0, -1031.0, -506.0, -389.0, -169.0], "policy_predator_policy_reward": [1285.0, 1127.0, 736.0, 802.0, 185.0, 1207.0, 195.0, 188.0, 86.0, 795.0, 148.0, 119.0, 2.0, 1092.0, 600.0, 1212.0, 71.0, 1375.0, 532.0, 571.0, 854.0, 792.0, 27.0, 531.0, 716.0, 757.0, 525.0, 60.0, 1202.0, 1238.0, 1329.0, 1092.0, 856.0, 1524.0, 1261.0, 1079.0, 958.0, 50.0, 355.0, 1321.0, 23.0, 23.0, 649.0, 491.0, 1240.0, 1027.0, 1060.0, 1382.0, 0.0, 0.0, 573.0, 991.0, 47.0, 51.0, 856.0, 801.0, 434.0, 425.0, 321.0, 1160.0, 782.0, 1312.0, 976.0, 982.0, 932.0, 851.0, 934.0, 910.0, 1442.0, 1532.0, 1057.0, 231.0, 1596.0, 758.0, 1153.0, 355.0, 32.0, 3.0, 443.0, 488.0, 309.0, 300.0, 1243.0, 1225.0, 286.0, 1432.0, 1212.0, 1329.0, 1083.0, 1079.0, 39.0, 50.0, 75.0, 37.0, 355.0, 428.0, 760.0, 746.0, 220.0, 222.0, 659.0, 731.0, 1382.0, 1306.0, 0.0, 0.0, 24.0, 1.0, 376.0, 349.0, 1293.0, 1451.0, 649.0, 842.0, 32.0, 455.0, 821.0, 1204.0, 95.0, 81.0, 664.0, 704.0, 27.0, 27.0, 335.0, 257.0, 340.0, 22.0, 62.0, 75.0, 793.0, 1064.0, 1042.0, 589.0, 1061.0, 1198.0, 900.0, 714.0, 22.0, 15.0, 593.0, 747.0, 0.0, 21.0, 1152.0, 1188.0, 107.0, 66.0, 61.0, 61.0, 438.0, 353.0, 791.0, 762.0, 1155.0, 223.0, 117.0, 329.0, 497.0, 552.0, 640.0, 782.0, 0.0, 0.0, 540.0, 480.0, 58.0, 40.0, 645.0, 650.0, 1208.0, 955.0, 4.0, 23.0, 1056.0, 7.0, 1011.0, 1500.0, 0.0, 6.0, 620.0, 878.0, 856.0, 785.0, 0.0, 671.0, 847.0, 465.0, 983.0, 1005.0, 803.0, 852.0, 95.0, 1216.0, 331.0, 856.0, 870.0, 947.0, 351.0, 231.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0138422141374752, "mean_inference_ms": 2.6624502226876157, "mean_action_processing_ms": 0.5014691746631541, "mean_env_wait_ms": 0.3640767988836866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008426189422607422, "StateBufferConnector_ms": 0.006677389144897461, "ViewRequirementAgentConnector_ms": 0.12207627296447754}, "num_episodes": 23, "episode_return_max": 1244.0, "episode_return_min": -676.0, "episode_return_mean": 173.39, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.6117971892931, "num_env_steps_trained_throughput_per_sec": 324.6117971892931, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 13469.044, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13468.97, "sample_time_ms": 1888.765, "learn_time_ms": 11562.11, "learn_throughput": 345.958, "synch_weights_time_ms": 13.796}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "f1691_00000", "date": "2024-08-13_16-50-37", "timestamp": 1723582237, "time_this_iter_s": 12.37024188041687, "time_total_s": 730.6011798381805, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c3e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 730.6011798381805, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 67.55882352941177, "ram_util_percent": 83.41764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5070769162089737, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 7.2326275028248945, "policy_loss": -0.0007171739376933565, "vf_loss": 7.203931127275739, "vf_explained_var": 0.0028730987241028477, "kl": 0.012911301129203641, "entropy": 1.075199609017246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7304127075684765, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 5.428321321931466, "policy_loss": 0.0018930420767338503, "vf_loss": 5.397915280306781, "vf_explained_var": -5.424338043051422e-09, "kl": 0.008343995672556856, "entropy": 0.6785786639603357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 1244.0, "episode_reward_min": -676.0, "episode_reward_mean": 161.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1640.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 1596.0}, "policy_reward_mean": {"prey_policy": -460.035, "predator_policy": 540.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-676.0, -226.0, 4.0, 420.0, -321.0, 719.0, 0.0, 393.0, -16.0, 32.0, 261.0, -52.0, 174.0, 254.0, 587.0, 804.0, 1244.0, 158.0, -43.0, -261.0, -25.0, 346.0, 177.0, 660.0, 224.0, -170.0, 260.0, -113.0, -48.0, -61.0, 229.0, 9.0, 577.0, 1148.0, 0.0, -49.0, 323.0, 347.0, 459.0, -129.0, -99.0, -17.0, 440.0, 0.0, 144.0, -150.0, -13.0, 457.0, 368.0, 883.0, 510.0, 13.0, 384.0, -33.0, 958.0, -28.0, 27.0, 240.0, 477.0, -114.0, -146.0, 245.0, -8.0, 0.0, 199.0, -12.0, 456.0, 763.0, -55.0, -597.0, -1.0, 13.0, 75.0, 142.0, -71.0, -85.0, 755.0, 591.0, 39.0, 11.0, 280.0, 24.0, 122.0, 912.0, 107.0, 0.0, 15.0, -90.0, -21.0, 33.0, 17.0, 529.0, 65.0, 77.0, -121.0, 230.0, -268.0, -145.0, 21.0, -63.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-750.0, -934.0, -514.0, -1388.0, -42.0, 0.0, 0.0, -720.0, -1318.0, -1270.0, -1460.0, -263.0, 0.0, 0.0, -1076.0, -95.0, -12.0, -102.0, -916.0, -709.0, -486.0, -112.0, -381.0, -1152.0, -1360.0, -560.0, -698.0, -1006.0, -176.0, -1020.0, -1040.0, 0.0, -90.0, -1640.0, -1130.0, 0.0, -1002.0, -1395.0, -1218.0, -551.0, -31.0, -29.0, -10.0, -575.0, -389.0, -43.0, -570.0, -1238.0, 0.0, -1494.0, -1375.0, -1336.0, -1126.0, -776.0, -106.0, -96.0, -38.0, -122.0, -500.0, -344.0, -792.0, -485.0, -147.0, -286.0, 0.0, -813.0, -1540.0, 0.0, 0.0, 0.0, -36.0, -38.0, 0.0, -402.0, -1069.0, -1328.0, -4.0, -1028.0, -56.0, -560.0, -1206.0, -918.0, -9.0, -184.0, -914.0, -14.0, -54.0, 0.0, -404.0, -44.0, -304.0, -208.0, -124.0, -26.0, -1224.0, -176.0, -1097.0, -166.0, -1344.0, -32.0, 0.0, -1104.0, 1.0, -25.0, -810.0, -146.0, -18.0, -36.0, -22.0, -1360.0, -167.0, -34.0, -106.0, 11.0, -26.0, -525.0, -156.0, -920.0, -256.0, -1236.0, -478.0, -114.0, -142.0, -662.0, -801.0, -629.0, 0.0, 0.0, -660.0, -161.0, -31.0, -79.0, -858.0, 19.0, -1324.0, -76.0, -46.0, -36.0, -720.0, -940.0, -1152.0, -1360.0, 0.0, 7.0, -694.0, -729.0, -818.0, -681.0, -678.0, -64.0, -906.0, -491.0, -1236.0, 3.0, 0.0, -1064.0, -1272.0, 0.0, -326.0, -850.0, -1031.0, -506.0, -389.0, -169.0, -188.0, -759.0, 0.0, -1576.0, -514.0, 0.0, 0.0, 0.0, 15.0, 0.0, -65.0, -870.0, -38.0, -115.0, 17.0, 16.0, 0.0, 17.0, -966.0, -60.0, -516.0, -86.0, -596.0, -42.0, -108.0, -141.0, -13.0, -686.0, -474.0, -218.0, -184.0, -212.0, 8.0, 13.0, -786.0, 15.0], "policy_predator_policy_reward": [958.0, 50.0, 355.0, 1321.0, 23.0, 23.0, 649.0, 491.0, 1240.0, 1027.0, 1060.0, 1382.0, 0.0, 0.0, 573.0, 991.0, 47.0, 51.0, 856.0, 801.0, 434.0, 425.0, 321.0, 1160.0, 782.0, 1312.0, 976.0, 982.0, 932.0, 851.0, 934.0, 910.0, 1442.0, 1532.0, 1057.0, 231.0, 1596.0, 758.0, 1153.0, 355.0, 32.0, 3.0, 443.0, 488.0, 309.0, 300.0, 1243.0, 1225.0, 286.0, 1432.0, 1212.0, 1329.0, 1083.0, 1079.0, 39.0, 50.0, 75.0, 37.0, 355.0, 428.0, 760.0, 746.0, 220.0, 222.0, 659.0, 731.0, 1382.0, 1306.0, 0.0, 0.0, 24.0, 1.0, 376.0, 349.0, 1293.0, 1451.0, 649.0, 842.0, 32.0, 455.0, 821.0, 1204.0, 95.0, 81.0, 664.0, 704.0, 27.0, 27.0, 335.0, 257.0, 340.0, 22.0, 62.0, 75.0, 793.0, 1064.0, 1042.0, 589.0, 1061.0, 1198.0, 900.0, 714.0, 22.0, 15.0, 593.0, 747.0, 0.0, 21.0, 1152.0, 1188.0, 107.0, 66.0, 61.0, 61.0, 438.0, 353.0, 791.0, 762.0, 1155.0, 223.0, 117.0, 329.0, 497.0, 552.0, 640.0, 782.0, 0.0, 0.0, 540.0, 480.0, 58.0, 40.0, 645.0, 650.0, 1208.0, 955.0, 4.0, 23.0, 1056.0, 7.0, 1011.0, 1500.0, 0.0, 6.0, 620.0, 878.0, 856.0, 785.0, 0.0, 671.0, 847.0, 465.0, 983.0, 1005.0, 803.0, 852.0, 95.0, 1216.0, 331.0, 856.0, 870.0, 947.0, 351.0, 231.0, 395.0, 674.0, 1084.0, 1404.0, 321.0, 300.0, 0.0, 0.0, 0.0, 0.0, 806.0, 39.0, 51.0, 81.0, 0.0, 0.0, 0.0, 0.0, 753.0, 802.0, 307.0, 360.0, 471.0, 244.0, 50.0, 78.0, 490.0, 439.0, 0.0, 424.0, 159.0, 92.0, 0.0, 0.0, 708.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0098131607995926, "mean_inference_ms": 2.64856257784213, "mean_action_processing_ms": 0.49653830892579975, "mean_env_wait_ms": 0.36243013946267794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008063793182373047, "StateBufferConnector_ms": 0.006796002388000488, "ViewRequirementAgentConnector_ms": 0.12494134902954102}, "num_episodes": 18, "episode_return_max": 1244.0, "episode_return_min": -676.0, "episode_return_mean": 161.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.23538864968833, "num_env_steps_trained_throughput_per_sec": 313.23538864968833, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 13303.831, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13303.765, "sample_time_ms": 1777.621, "learn_time_ms": 11507.596, "learn_throughput": 347.596, "synch_weights_time_ms": 14.45}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "f1691_00000", "date": "2024-08-13_16-50-50", "timestamp": 1723582250, "time_this_iter_s": 12.82408618927002, "time_total_s": 743.4252660274506, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37db040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 743.4252660274506, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 67.3388888888889, "ram_util_percent": 83.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.756712075721019, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 7.424299753784503, "policy_loss": -0.001749978743976465, "vf_loss": 7.403817434159536, "vf_explained_var": -0.0004809247753607533, "kl": 0.009759033834959206, "entropy": 0.9829794102560275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.142584826943105, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 5.282282781096362, "policy_loss": 0.002092935568061731, "vf_loss": 5.253656883592959, "vf_explained_var": -5.582022288488963e-09, "kl": 0.007764565016424014, "entropy": 0.6283956550889545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 1148.0, "episode_reward_min": -597.0, "episode_reward_mean": 139.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1576.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 1596.0}, "policy_reward_mean": {"prey_policy": -387.065, "predator_policy": 456.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.0, -261.0, -25.0, 346.0, 177.0, 660.0, 224.0, -170.0, 260.0, -113.0, -48.0, -61.0, 229.0, 9.0, 577.0, 1148.0, 0.0, -49.0, 323.0, 347.0, 459.0, -129.0, -99.0, -17.0, 440.0, 0.0, 144.0, -150.0, -13.0, 457.0, 368.0, 883.0, 510.0, 13.0, 384.0, -33.0, 958.0, -28.0, 27.0, 240.0, 477.0, -114.0, -146.0, 245.0, -8.0, 0.0, 199.0, -12.0, 456.0, 763.0, -55.0, -597.0, -1.0, 13.0, 75.0, 142.0, -71.0, -85.0, 755.0, 591.0, 39.0, 11.0, 280.0, 24.0, 122.0, 912.0, 107.0, 0.0, 15.0, -90.0, -21.0, 33.0, 17.0, 529.0, 65.0, 77.0, -121.0, 230.0, -268.0, -145.0, 21.0, -63.0, -106.0, 59.0, 0.0, 2.0, 777.0, -10.0, 404.0, -6.0, 67.0, -90.0, 641.0, 276.0, 3.0, -130.0, -247.0, -184.0, -68.0, 226.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1002.0, -1395.0, -1218.0, -551.0, -31.0, -29.0, -10.0, -575.0, -389.0, -43.0, -570.0, -1238.0, 0.0, -1494.0, -1375.0, -1336.0, -1126.0, -776.0, -106.0, -96.0, -38.0, -122.0, -500.0, -344.0, -792.0, -485.0, -147.0, -286.0, 0.0, -813.0, -1540.0, 0.0, 0.0, 0.0, -36.0, -38.0, 0.0, -402.0, -1069.0, -1328.0, -4.0, -1028.0, -56.0, -560.0, -1206.0, -918.0, -9.0, -184.0, -914.0, -14.0, -54.0, 0.0, -404.0, -44.0, -304.0, -208.0, -124.0, -26.0, -1224.0, -176.0, -1097.0, -166.0, -1344.0, -32.0, 0.0, -1104.0, 1.0, -25.0, -810.0, -146.0, -18.0, -36.0, -22.0, -1360.0, -167.0, -34.0, -106.0, 11.0, -26.0, -525.0, -156.0, -920.0, -256.0, -1236.0, -478.0, -114.0, -142.0, -662.0, -801.0, -629.0, 0.0, 0.0, -660.0, -161.0, -31.0, -79.0, -858.0, 19.0, -1324.0, -76.0, -46.0, -36.0, -720.0, -940.0, -1152.0, -1360.0, 0.0, 7.0, -694.0, -729.0, -818.0, -681.0, -678.0, -64.0, -906.0, -491.0, -1236.0, 3.0, 0.0, -1064.0, -1272.0, 0.0, -326.0, -850.0, -1031.0, -506.0, -389.0, -169.0, -188.0, -759.0, 0.0, -1576.0, -514.0, 0.0, 0.0, 0.0, 15.0, 0.0, -65.0, -870.0, -38.0, -115.0, 17.0, 16.0, 0.0, 17.0, -966.0, -60.0, -516.0, -86.0, -596.0, -42.0, -108.0, -141.0, -13.0, -686.0, -474.0, -218.0, -184.0, -212.0, 8.0, 13.0, -786.0, 15.0, -326.0, -74.0, 0.0, -265.0, 0.0, 0.0, 0.0, 2.0, -1200.0, 6.0, 0.0, -212.0, 0.0, -854.0, -24.0, 6.0, 11.0, -264.0, -726.0, 0.0, -975.0, 20.0, -652.0, 18.0, 4.0, -236.0, -90.0, -262.0, -181.0, -347.0, -132.0, -292.0, -57.0, -58.0, 0.0, -666.0], "policy_predator_policy_reward": [1596.0, 758.0, 1153.0, 355.0, 32.0, 3.0, 443.0, 488.0, 309.0, 300.0, 1243.0, 1225.0, 286.0, 1432.0, 1212.0, 1329.0, 1083.0, 1079.0, 39.0, 50.0, 75.0, 37.0, 355.0, 428.0, 760.0, 746.0, 220.0, 222.0, 659.0, 731.0, 1382.0, 1306.0, 0.0, 0.0, 24.0, 1.0, 376.0, 349.0, 1293.0, 1451.0, 649.0, 842.0, 32.0, 455.0, 821.0, 1204.0, 95.0, 81.0, 664.0, 704.0, 27.0, 27.0, 335.0, 257.0, 340.0, 22.0, 62.0, 75.0, 793.0, 1064.0, 1042.0, 589.0, 1061.0, 1198.0, 900.0, 714.0, 22.0, 15.0, 593.0, 747.0, 0.0, 21.0, 1152.0, 1188.0, 107.0, 66.0, 61.0, 61.0, 438.0, 353.0, 791.0, 762.0, 1155.0, 223.0, 117.0, 329.0, 497.0, 552.0, 640.0, 782.0, 0.0, 0.0, 540.0, 480.0, 58.0, 40.0, 645.0, 650.0, 1208.0, 955.0, 4.0, 23.0, 1056.0, 7.0, 1011.0, 1500.0, 0.0, 6.0, 620.0, 878.0, 856.0, 785.0, 0.0, 671.0, 847.0, 465.0, 983.0, 1005.0, 803.0, 852.0, 95.0, 1216.0, 331.0, 856.0, 870.0, 947.0, 351.0, 231.0, 395.0, 674.0, 1084.0, 1404.0, 321.0, 300.0, 0.0, 0.0, 0.0, 0.0, 806.0, 39.0, 51.0, 81.0, 0.0, 0.0, 0.0, 0.0, 753.0, 802.0, 307.0, 360.0, 471.0, 244.0, 50.0, 78.0, 490.0, 439.0, 0.0, 424.0, 159.0, 92.0, 0.0, 0.0, 708.0, 0.0, 125.0, 169.0, 174.0, 150.0, 0.0, 0.0, 0.0, 0.0, 1085.0, 886.0, 94.0, 108.0, 536.0, 722.0, 12.0, 0.0, 144.0, 176.0, 48.0, 588.0, 822.0, 774.0, 455.0, 455.0, 117.0, 118.0, 88.0, 134.0, 281.0, 0.0, 63.0, 177.0, 47.0, 0.0, 432.0, 460.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0056808599213676, "mean_inference_ms": 2.6372406278350655, "mean_action_processing_ms": 0.49329004237990676, "mean_env_wait_ms": 0.360850312037836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076531171798706055, "StateBufferConnector_ms": 0.0035887956619262695, "ViewRequirementAgentConnector_ms": 0.12394773960113525}, "num_episodes": 18, "episode_return_max": 1148.0, "episode_return_min": -597.0, "episode_return_mean": 139.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.93992285315187, "num_env_steps_trained_throughput_per_sec": 335.93992285315187, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 12692.165, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12692.09, "sample_time_ms": 1683.88, "learn_time_ms": 10988.485, "learn_throughput": 364.017, "synch_weights_time_ms": 15.776}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "f1691_00000", "date": "2024-08-13_16-51-02", "timestamp": 1723582262, "time_this_iter_s": 11.996454954147339, "time_total_s": 755.4217209815979, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 755.4217209815979, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 63.417647058823526, "ram_util_percent": 83.44705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8274085698304352, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 8.694244930226967, "policy_loss": -0.0021776222990993314, "vf_loss": 8.671051666976282, "vf_explained_var": 0.003527851899464925, "kl": 0.01113674062480785, "entropy": 0.9601989960544324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.287368474411901, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.768017475441019, "policy_loss": 0.0027386487137634682, "vf_loss": 6.735828068647435, "vf_explained_var": -5.014359004913815e-09, "kl": 0.008618422062038009, "entropy": 0.6900033137943379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 958.0, "episode_reward_min": -597.0, "episode_reward_mean": 117.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1576.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 1500.0}, "policy_reward_mean": {"prey_policy": -346.475, "predator_policy": 405.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.0, 347.0, 459.0, -129.0, -99.0, -17.0, 440.0, 0.0, 144.0, -150.0, -13.0, 457.0, 368.0, 883.0, 510.0, 13.0, 384.0, -33.0, 958.0, -28.0, 27.0, 240.0, 477.0, -114.0, -146.0, 245.0, -8.0, 0.0, 199.0, -12.0, 456.0, 763.0, -55.0, -597.0, -1.0, 13.0, 75.0, 142.0, -71.0, -85.0, 755.0, 591.0, 39.0, 11.0, 280.0, 24.0, 122.0, 912.0, 107.0, 0.0, 15.0, -90.0, -21.0, 33.0, 17.0, 529.0, 65.0, 77.0, -121.0, 230.0, -268.0, -145.0, 21.0, -63.0, -106.0, 59.0, 0.0, 2.0, 777.0, -10.0, 404.0, -6.0, 67.0, -90.0, 641.0, 276.0, 3.0, -130.0, -247.0, -184.0, -68.0, 226.0, -40.0, -101.0, 427.0, 0.0, -18.0, 0.0, -52.0, 140.0, 106.0, 73.0, -39.0, 250.0, -78.0, 232.0, -142.0, -4.0, -32.0, -60.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -402.0, -1069.0, -1328.0, -4.0, -1028.0, -56.0, -560.0, -1206.0, -918.0, -9.0, -184.0, -914.0, -14.0, -54.0, 0.0, -404.0, -44.0, -304.0, -208.0, -124.0, -26.0, -1224.0, -176.0, -1097.0, -166.0, -1344.0, -32.0, 0.0, -1104.0, 1.0, -25.0, -810.0, -146.0, -18.0, -36.0, -22.0, -1360.0, -167.0, -34.0, -106.0, 11.0, -26.0, -525.0, -156.0, -920.0, -256.0, -1236.0, -478.0, -114.0, -142.0, -662.0, -801.0, -629.0, 0.0, 0.0, -660.0, -161.0, -31.0, -79.0, -858.0, 19.0, -1324.0, -76.0, -46.0, -36.0, -720.0, -940.0, -1152.0, -1360.0, 0.0, 7.0, -694.0, -729.0, -818.0, -681.0, -678.0, -64.0, -906.0, -491.0, -1236.0, 3.0, 0.0, -1064.0, -1272.0, 0.0, -326.0, -850.0, -1031.0, -506.0, -389.0, -169.0, -188.0, -759.0, 0.0, -1576.0, -514.0, 0.0, 0.0, 0.0, 15.0, 0.0, -65.0, -870.0, -38.0, -115.0, 17.0, 16.0, 0.0, 17.0, -966.0, -60.0, -516.0, -86.0, -596.0, -42.0, -108.0, -141.0, -13.0, -686.0, -474.0, -218.0, -184.0, -212.0, 8.0, 13.0, -786.0, 15.0, -326.0, -74.0, 0.0, -265.0, 0.0, 0.0, 0.0, 2.0, -1200.0, 6.0, 0.0, -212.0, 0.0, -854.0, -24.0, 6.0, 11.0, -264.0, -726.0, 0.0, -975.0, 20.0, -652.0, 18.0, 4.0, -236.0, -90.0, -262.0, -181.0, -347.0, -132.0, -292.0, -57.0, -58.0, 0.0, -666.0, -89.0, -24.0, -368.0, -442.0, -798.0, 21.0, 0.0, -190.0, -108.0, -321.0, 0.0, 0.0, -108.0, -18.0, -1074.0, -375.0, -132.0, -451.0, -106.0, -343.0, -78.0, -838.0, -1086.0, -952.0, -88.0, -104.0, 1.0, -343.0, -394.0, -118.0, -151.0, 0.0, -290.0, -26.0, -12.0, -978.0], "policy_predator_policy_reward": [376.0, 349.0, 1293.0, 1451.0, 649.0, 842.0, 32.0, 455.0, 821.0, 1204.0, 95.0, 81.0, 664.0, 704.0, 27.0, 27.0, 335.0, 257.0, 340.0, 22.0, 62.0, 75.0, 793.0, 1064.0, 1042.0, 589.0, 1061.0, 1198.0, 900.0, 714.0, 22.0, 15.0, 593.0, 747.0, 0.0, 21.0, 1152.0, 1188.0, 107.0, 66.0, 61.0, 61.0, 438.0, 353.0, 791.0, 762.0, 1155.0, 223.0, 117.0, 329.0, 497.0, 552.0, 640.0, 782.0, 0.0, 0.0, 540.0, 480.0, 58.0, 40.0, 645.0, 650.0, 1208.0, 955.0, 4.0, 23.0, 1056.0, 7.0, 1011.0, 1500.0, 0.0, 6.0, 620.0, 878.0, 856.0, 785.0, 0.0, 671.0, 847.0, 465.0, 983.0, 1005.0, 803.0, 852.0, 95.0, 1216.0, 331.0, 856.0, 870.0, 947.0, 351.0, 231.0, 395.0, 674.0, 1084.0, 1404.0, 321.0, 300.0, 0.0, 0.0, 0.0, 0.0, 806.0, 39.0, 51.0, 81.0, 0.0, 0.0, 0.0, 0.0, 753.0, 802.0, 307.0, 360.0, 471.0, 244.0, 50.0, 78.0, 490.0, 439.0, 0.0, 424.0, 159.0, 92.0, 0.0, 0.0, 708.0, 0.0, 125.0, 169.0, 174.0, 150.0, 0.0, 0.0, 0.0, 0.0, 1085.0, 886.0, 94.0, 108.0, 536.0, 722.0, 12.0, 0.0, 144.0, 176.0, 48.0, 588.0, 822.0, 774.0, 455.0, 455.0, 117.0, 118.0, 88.0, 134.0, 281.0, 0.0, 63.0, 177.0, 47.0, 0.0, 432.0, 460.0, 63.0, 10.0, 273.0, 436.0, 626.0, 578.0, 95.0, 95.0, 129.0, 282.0, 0.0, 0.0, 9.0, 65.0, 552.0, 1037.0, 343.0, 346.0, 252.0, 270.0, 148.0, 729.0, 1244.0, 1044.0, 64.0, 50.0, 281.0, 293.0, 237.0, 133.0, 76.0, 71.0, 240.0, 44.0, 0.0, 930.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0025326656803397, "mean_inference_ms": 2.627656258555981, "mean_action_processing_ms": 0.4903602677692861, "mean_env_wait_ms": 0.35951124655953764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006212115287780762, "StateBufferConnector_ms": 0.0035239458084106445, "ViewRequirementAgentConnector_ms": 0.11839711666107178}, "num_episodes": 18, "episode_return_max": 958.0, "episode_return_min": -597.0, "episode_return_mean": 117.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.9580946365581, "num_env_steps_trained_throughput_per_sec": 332.9580946365581, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 12312.132, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12312.058, "sample_time_ms": 1528.785, "learn_time_ms": 10763.544, "learn_throughput": 371.625, "synch_weights_time_ms": 15.766}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "f1691_00000", "date": "2024-08-13_16-51-14", "timestamp": 1723582274, "time_this_iter_s": 12.082021713256836, "time_total_s": 767.5037426948547, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3777040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 767.5037426948547, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 64.58235294117647, "ram_util_percent": 83.38823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.953662081969478, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 6.701098412306851, "policy_loss": 0.0001973875899301477, "vf_loss": 6.676263125989803, "vf_explained_var": -0.0008331127898402946, "kl": 0.010814986866224733, "entropy": 0.8911869764643371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2231250599893944, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.0535539849094615, "policy_loss": 0.002186435718266737, "vf_loss": 6.027399561140272, "vf_explained_var": -4.068253532288566e-09, "kl": 0.0070139508570642725, "entropy": 0.5966577381053298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 912.0, "episode_reward_min": -597.0, "episode_reward_mean": 100.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1576.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 1500.0}, "policy_reward_mean": {"prey_policy": -335.955, "predator_policy": 386.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [477.0, -114.0, -146.0, 245.0, -8.0, 0.0, 199.0, -12.0, 456.0, 763.0, -55.0, -597.0, -1.0, 13.0, 75.0, 142.0, -71.0, -85.0, 755.0, 591.0, 39.0, 11.0, 280.0, 24.0, 122.0, 912.0, 107.0, 0.0, 15.0, -90.0, -21.0, 33.0, 17.0, 529.0, 65.0, 77.0, -121.0, 230.0, -268.0, -145.0, 21.0, -63.0, -106.0, 59.0, 0.0, 2.0, 777.0, -10.0, 404.0, -6.0, 67.0, -90.0, 641.0, 276.0, 3.0, -130.0, -247.0, -184.0, -68.0, 226.0, -40.0, -101.0, 427.0, 0.0, -18.0, 0.0, -52.0, 140.0, 106.0, 73.0, -39.0, 250.0, -78.0, 232.0, -142.0, -4.0, -32.0, -60.0, 264.0, -8.0, 0.0, 179.0, 16.0, 23.0, -15.0, 347.0, -23.0, 511.0, 157.0, -137.0, 314.0, -208.0, 508.0, 170.0, 265.0, 0.0, 2.0, 436.0, 587.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-156.0, -920.0, -256.0, -1236.0, -478.0, -114.0, -142.0, -662.0, -801.0, -629.0, 0.0, 0.0, -660.0, -161.0, -31.0, -79.0, -858.0, 19.0, -1324.0, -76.0, -46.0, -36.0, -720.0, -940.0, -1152.0, -1360.0, 0.0, 7.0, -694.0, -729.0, -818.0, -681.0, -678.0, -64.0, -906.0, -491.0, -1236.0, 3.0, 0.0, -1064.0, -1272.0, 0.0, -326.0, -850.0, -1031.0, -506.0, -389.0, -169.0, -188.0, -759.0, 0.0, -1576.0, -514.0, 0.0, 0.0, 0.0, 15.0, 0.0, -65.0, -870.0, -38.0, -115.0, 17.0, 16.0, 0.0, 17.0, -966.0, -60.0, -516.0, -86.0, -596.0, -42.0, -108.0, -141.0, -13.0, -686.0, -474.0, -218.0, -184.0, -212.0, 8.0, 13.0, -786.0, 15.0, -326.0, -74.0, 0.0, -265.0, 0.0, 0.0, 0.0, 2.0, -1200.0, 6.0, 0.0, -212.0, 0.0, -854.0, -24.0, 6.0, 11.0, -264.0, -726.0, 0.0, -975.0, 20.0, -652.0, 18.0, 4.0, -236.0, -90.0, -262.0, -181.0, -347.0, -132.0, -292.0, -57.0, -58.0, 0.0, -666.0, -89.0, -24.0, -368.0, -442.0, -798.0, 21.0, 0.0, -190.0, -108.0, -321.0, 0.0, 0.0, -108.0, -18.0, -1074.0, -375.0, -132.0, -451.0, -106.0, -343.0, -78.0, -838.0, -1086.0, -952.0, -88.0, -104.0, 1.0, -343.0, -394.0, -118.0, -151.0, 0.0, -290.0, -26.0, -12.0, -978.0, -1188.0, -357.0, -26.0, -13.0, 0.0, 0.0, -2.0, -892.0, 17.0, -135.0, -276.0, -494.0, 5.0, -114.0, -770.0, -1458.0, 0.0, -46.0, 19.0, -748.0, 0.0, -548.0, -11.0, -788.0, -47.0, -582.0, -159.0, -272.0, -505.0, -954.0, -50.0, -562.0, -403.0, -913.0, -22.0, 0.0, 2.0, 0.0, -558.0, -1464.0, -832.0, 0.0, 0.0, -12.0], "policy_predator_policy_reward": [791.0, 762.0, 1155.0, 223.0, 117.0, 329.0, 497.0, 552.0, 640.0, 782.0, 0.0, 0.0, 540.0, 480.0, 58.0, 40.0, 645.0, 650.0, 1208.0, 955.0, 4.0, 23.0, 1056.0, 7.0, 1011.0, 1500.0, 0.0, 6.0, 620.0, 878.0, 856.0, 785.0, 0.0, 671.0, 847.0, 465.0, 983.0, 1005.0, 803.0, 852.0, 95.0, 1216.0, 331.0, 856.0, 870.0, 947.0, 351.0, 231.0, 395.0, 674.0, 1084.0, 1404.0, 321.0, 300.0, 0.0, 0.0, 0.0, 0.0, 806.0, 39.0, 51.0, 81.0, 0.0, 0.0, 0.0, 0.0, 753.0, 802.0, 307.0, 360.0, 471.0, 244.0, 50.0, 78.0, 490.0, 439.0, 0.0, 424.0, 159.0, 92.0, 0.0, 0.0, 708.0, 0.0, 125.0, 169.0, 174.0, 150.0, 0.0, 0.0, 0.0, 0.0, 1085.0, 886.0, 94.0, 108.0, 536.0, 722.0, 12.0, 0.0, 144.0, 176.0, 48.0, 588.0, 822.0, 774.0, 455.0, 455.0, 117.0, 118.0, 88.0, 134.0, 281.0, 0.0, 63.0, 177.0, 47.0, 0.0, 432.0, 460.0, 63.0, 10.0, 273.0, 436.0, 626.0, 578.0, 95.0, 95.0, 129.0, 282.0, 0.0, 0.0, 9.0, 65.0, 552.0, 1037.0, 343.0, 346.0, 252.0, 270.0, 148.0, 729.0, 1244.0, 1044.0, 64.0, 50.0, 281.0, 293.0, 237.0, 133.0, 76.0, 71.0, 240.0, 44.0, 0.0, 930.0, 1108.0, 701.0, 0.0, 31.0, 0.0, 0.0, 320.0, 753.0, 71.0, 63.0, 427.0, 366.0, 57.0, 37.0, 1115.0, 1460.0, 0.0, 23.0, 624.0, 616.0, 301.0, 404.0, 659.0, 3.0, 484.0, 459.0, 206.0, 17.0, 912.0, 1055.0, 367.0, 415.0, 792.0, 789.0, 11.0, 11.0, 0.0, 0.0, 1316.0, 1142.0, 768.0, 651.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9999536352110059, "mean_inference_ms": 2.6203847510604974, "mean_action_processing_ms": 0.4875610175226205, "mean_env_wait_ms": 0.35871923581715137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004344344139099121, "StateBufferConnector_ms": 0.0034955739974975586, "ViewRequirementAgentConnector_ms": 0.13993895053863525}, "num_episodes": 22, "episode_return_max": 912.0, "episode_return_min": -597.0, "episode_return_mean": 100.65, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.31243970268247, "num_env_steps_trained_throughput_per_sec": 331.31243970268247, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 12305.034, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12304.97, "sample_time_ms": 1607.031, "learn_time_ms": 10678.436, "learn_throughput": 374.587, "synch_weights_time_ms": 15.814}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "f1691_00000", "date": "2024-08-13_16-51-27", "timestamp": 1723582287, "time_this_iter_s": 12.142810106277466, "time_total_s": 779.6465528011322, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3777e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 779.6465528011322, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 64.19444444444444, "ram_util_percent": 83.57777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.710886362084636, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 6.485581966430422, "policy_loss": -0.0013582700291875178, "vf_loss": 6.465973214497642, "vf_explained_var": -0.0002582661373905404, "kl": 0.009203635440675017, "entropy": 0.8385944184802827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0899831246919733, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.7604676852150565, "policy_loss": 0.0013674165331635367, "vf_loss": 4.737406486935086, "vf_explained_var": -5.5189485903139465e-09, "kl": 0.006348430340254689, "entropy": 0.5167025573118024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 912.0, "episode_reward_min": -268.0, "episode_reward_mean": 84.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1576.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 1460.0}, "policy_reward_mean": {"prey_policy": -256.05, "predator_policy": 298.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, 122.0, 912.0, 107.0, 0.0, 15.0, -90.0, -21.0, 33.0, 17.0, 529.0, 65.0, 77.0, -121.0, 230.0, -268.0, -145.0, 21.0, -63.0, -106.0, 59.0, 0.0, 2.0, 777.0, -10.0, 404.0, -6.0, 67.0, -90.0, 641.0, 276.0, 3.0, -130.0, -247.0, -184.0, -68.0, 226.0, -40.0, -101.0, 427.0, 0.0, -18.0, 0.0, -52.0, 140.0, 106.0, 73.0, -39.0, 250.0, -78.0, 232.0, -142.0, -4.0, -32.0, -60.0, 264.0, -8.0, 0.0, 179.0, 16.0, 23.0, -15.0, 347.0, -23.0, 511.0, 157.0, -137.0, 314.0, -208.0, 508.0, 170.0, 265.0, 0.0, 2.0, 436.0, 587.0, 0.0, -2.0, -60.0, 76.0, 317.0, 0.0, 1.0, -44.0, -14.0, -143.0, -117.0, -18.0, -207.0, -69.0, 781.0, 805.0, 6.0, 79.0, 18.0, 27.0, 19.0, -89.0, -81.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-389.0, -169.0, -188.0, -759.0, 0.0, -1576.0, -514.0, 0.0, 0.0, 0.0, 15.0, 0.0, -65.0, -870.0, -38.0, -115.0, 17.0, 16.0, 0.0, 17.0, -966.0, -60.0, -516.0, -86.0, -596.0, -42.0, -108.0, -141.0, -13.0, -686.0, -474.0, -218.0, -184.0, -212.0, 8.0, 13.0, -786.0, 15.0, -326.0, -74.0, 0.0, -265.0, 0.0, 0.0, 0.0, 2.0, -1200.0, 6.0, 0.0, -212.0, 0.0, -854.0, -24.0, 6.0, 11.0, -264.0, -726.0, 0.0, -975.0, 20.0, -652.0, 18.0, 4.0, -236.0, -90.0, -262.0, -181.0, -347.0, -132.0, -292.0, -57.0, -58.0, 0.0, -666.0, -89.0, -24.0, -368.0, -442.0, -798.0, 21.0, 0.0, -190.0, -108.0, -321.0, 0.0, 0.0, -108.0, -18.0, -1074.0, -375.0, -132.0, -451.0, -106.0, -343.0, -78.0, -838.0, -1086.0, -952.0, -88.0, -104.0, 1.0, -343.0, -394.0, -118.0, -151.0, 0.0, -290.0, -26.0, -12.0, -978.0, -1188.0, -357.0, -26.0, -13.0, 0.0, 0.0, -2.0, -892.0, 17.0, -135.0, -276.0, -494.0, 5.0, -114.0, -770.0, -1458.0, 0.0, -46.0, 19.0, -748.0, 0.0, -548.0, -11.0, -788.0, -47.0, -582.0, -159.0, -272.0, -505.0, -954.0, -50.0, -562.0, -403.0, -913.0, -22.0, 0.0, 2.0, 0.0, -558.0, -1464.0, -832.0, 0.0, 0.0, -12.0, -9.0, 0.0, -538.0, -116.0, -474.0, -104.0, -902.0, -998.0, 0.0, 0.0, -48.0, -24.0, -19.0, -132.0, 0.0, -28.0, -298.0, 4.0, -126.0, -107.0, -14.0, -118.0, -122.0, -184.0, -239.0, -92.0, 0.0, -1066.0, -1047.0, 2.0, -102.0, 16.0, -400.0, 6.0, 18.0, 0.0, 15.0, 12.0, -428.0, 0.0, -89.0, -290.0, -30.0, -112.0, 10.0, 0.0], "policy_predator_policy_reward": [351.0, 231.0, 395.0, 674.0, 1084.0, 1404.0, 321.0, 300.0, 0.0, 0.0, 0.0, 0.0, 806.0, 39.0, 51.0, 81.0, 0.0, 0.0, 0.0, 0.0, 753.0, 802.0, 307.0, 360.0, 471.0, 244.0, 50.0, 78.0, 490.0, 439.0, 0.0, 424.0, 159.0, 92.0, 0.0, 0.0, 708.0, 0.0, 125.0, 169.0, 174.0, 150.0, 0.0, 0.0, 0.0, 0.0, 1085.0, 886.0, 94.0, 108.0, 536.0, 722.0, 12.0, 0.0, 144.0, 176.0, 48.0, 588.0, 822.0, 774.0, 455.0, 455.0, 117.0, 118.0, 88.0, 134.0, 281.0, 0.0, 63.0, 177.0, 47.0, 0.0, 432.0, 460.0, 63.0, 10.0, 273.0, 436.0, 626.0, 578.0, 95.0, 95.0, 129.0, 282.0, 0.0, 0.0, 9.0, 65.0, 552.0, 1037.0, 343.0, 346.0, 252.0, 270.0, 148.0, 729.0, 1244.0, 1044.0, 64.0, 50.0, 281.0, 293.0, 237.0, 133.0, 76.0, 71.0, 240.0, 44.0, 0.0, 930.0, 1108.0, 701.0, 0.0, 31.0, 0.0, 0.0, 320.0, 753.0, 71.0, 63.0, 427.0, 366.0, 57.0, 37.0, 1115.0, 1460.0, 0.0, 23.0, 624.0, 616.0, 301.0, 404.0, 659.0, 3.0, 484.0, 459.0, 206.0, 17.0, 912.0, 1055.0, 367.0, 415.0, 792.0, 789.0, 11.0, 11.0, 0.0, 0.0, 1316.0, 1142.0, 768.0, 651.0, 0.0, 12.0, 7.0, 0.0, 396.0, 198.0, 319.0, 335.0, 1055.0, 1162.0, 0.0, 0.0, 44.0, 29.0, 41.0, 66.0, 0.0, 14.0, 0.0, 151.0, 26.0, 90.0, 51.0, 63.0, 8.0, 91.0, 97.0, 165.0, 922.0, 925.0, 946.0, 904.0, 41.0, 51.0, 248.0, 225.0, 0.0, 0.0, 0.0, 0.0, 289.0, 158.0, 134.0, 156.0, 0.0, 61.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9976224391909675, "mean_inference_ms": 2.6132047322667544, "mean_action_processing_ms": 0.48447335233378847, "mean_env_wait_ms": 0.35789730854432955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045359134674072266, "StateBufferConnector_ms": 0.003564596176147461, "ViewRequirementAgentConnector_ms": 0.1471792459487915}, "num_episodes": 23, "episode_return_max": 912.0, "episode_return_min": -268.0, "episode_return_mean": 84.03, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.20915812657114, "num_env_steps_trained_throughput_per_sec": 312.20915812657114, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 12354.681, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12354.617, "sample_time_ms": 1660.745, "learn_time_ms": 10671.575, "learn_throughput": 374.828, "synch_weights_time_ms": 16.941}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "f1691_00000", "date": "2024-08-13_16-51-40", "timestamp": 1723582300, "time_this_iter_s": 12.901701211929321, "time_total_s": 792.5482540130615, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 792.5482540130615, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 66.88888888888889, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9925280377032264, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 5.255489494308593, "policy_loss": -0.000768725534349128, "vf_loss": 5.235942989934689, "vf_explained_var": 0.002141334613164266, "kl": 0.00891752550817817, "entropy": 0.863771488489928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1393937735803545, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.003465956228751, "policy_loss": 0.0023084133936131677, "vf_loss": 3.9679075564026203, "vf_explained_var": -5.8658539302765375e-09, "kl": 0.00973022002233785, "entropy": 0.5656893180633978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 805.0, "episode_reward_min": -404.0, "episode_reward_mean": 71.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1464.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 1460.0}, "policy_reward_mean": {"prey_policy": -249.565, "predator_policy": 285.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.0, -106.0, 59.0, 0.0, 2.0, 777.0, -10.0, 404.0, -6.0, 67.0, -90.0, 641.0, 276.0, 3.0, -130.0, -247.0, -184.0, -68.0, 226.0, -40.0, -101.0, 427.0, 0.0, -18.0, 0.0, -52.0, 140.0, 106.0, 73.0, -39.0, 250.0, -78.0, 232.0, -142.0, -4.0, -32.0, -60.0, 264.0, -8.0, 0.0, 179.0, 16.0, 23.0, -15.0, 347.0, -23.0, 511.0, 157.0, -137.0, 314.0, -208.0, 508.0, 170.0, 265.0, 0.0, 2.0, 436.0, 587.0, 0.0, -2.0, -60.0, 76.0, 317.0, 0.0, 1.0, -44.0, -14.0, -143.0, -117.0, -18.0, -207.0, -69.0, 781.0, 805.0, 6.0, 79.0, 18.0, 27.0, 19.0, -89.0, -81.0, 10.0, -124.0, 15.0, -37.0, -7.0, -404.0, 0.0, -47.0, 484.0, 0.0, -31.0, -80.0, -76.0, -158.0, 362.0, 2.0, 213.0, 200.0, -28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-786.0, 15.0, -326.0, -74.0, 0.0, -265.0, 0.0, 0.0, 0.0, 2.0, -1200.0, 6.0, 0.0, -212.0, 0.0, -854.0, -24.0, 6.0, 11.0, -264.0, -726.0, 0.0, -975.0, 20.0, -652.0, 18.0, 4.0, -236.0, -90.0, -262.0, -181.0, -347.0, -132.0, -292.0, -57.0, -58.0, 0.0, -666.0, -89.0, -24.0, -368.0, -442.0, -798.0, 21.0, 0.0, -190.0, -108.0, -321.0, 0.0, 0.0, -108.0, -18.0, -1074.0, -375.0, -132.0, -451.0, -106.0, -343.0, -78.0, -838.0, -1086.0, -952.0, -88.0, -104.0, 1.0, -343.0, -394.0, -118.0, -151.0, 0.0, -290.0, -26.0, -12.0, -978.0, -1188.0, -357.0, -26.0, -13.0, 0.0, 0.0, -2.0, -892.0, 17.0, -135.0, -276.0, -494.0, 5.0, -114.0, -770.0, -1458.0, 0.0, -46.0, 19.0, -748.0, 0.0, -548.0, -11.0, -788.0, -47.0, -582.0, -159.0, -272.0, -505.0, -954.0, -50.0, -562.0, -403.0, -913.0, -22.0, 0.0, 2.0, 0.0, -558.0, -1464.0, -832.0, 0.0, 0.0, -12.0, -9.0, 0.0, -538.0, -116.0, -474.0, -104.0, -902.0, -998.0, 0.0, 0.0, -48.0, -24.0, -19.0, -132.0, 0.0, -28.0, -298.0, 4.0, -126.0, -107.0, -14.0, -118.0, -122.0, -184.0, -239.0, -92.0, 0.0, -1066.0, -1047.0, 2.0, -102.0, 16.0, -400.0, 6.0, 18.0, 0.0, 15.0, 12.0, -428.0, 0.0, -89.0, -290.0, -30.0, -112.0, 10.0, 0.0, -104.0, -252.0, 0.0, 15.0, -38.0, -43.0, -41.0, 9.0, -390.0, -294.0, 0.0, 0.0, -247.0, -25.0, -612.0, -1408.0, 0.0, 0.0, 0.0, -292.0, -100.0, -98.0, -1144.0, 1.0, -122.0, -138.0, -618.0, 0.0, 4.0, -19.0, -644.0, -60.0, 0.0, -636.0, -286.0, -20.0], "policy_predator_policy_reward": [708.0, 0.0, 125.0, 169.0, 174.0, 150.0, 0.0, 0.0, 0.0, 0.0, 1085.0, 886.0, 94.0, 108.0, 536.0, 722.0, 12.0, 0.0, 144.0, 176.0, 48.0, 588.0, 822.0, 774.0, 455.0, 455.0, 117.0, 118.0, 88.0, 134.0, 281.0, 0.0, 63.0, 177.0, 47.0, 0.0, 432.0, 460.0, 63.0, 10.0, 273.0, 436.0, 626.0, 578.0, 95.0, 95.0, 129.0, 282.0, 0.0, 0.0, 9.0, 65.0, 552.0, 1037.0, 343.0, 346.0, 252.0, 270.0, 148.0, 729.0, 1244.0, 1044.0, 64.0, 50.0, 281.0, 293.0, 237.0, 133.0, 76.0, 71.0, 240.0, 44.0, 0.0, 930.0, 1108.0, 701.0, 0.0, 31.0, 0.0, 0.0, 320.0, 753.0, 71.0, 63.0, 427.0, 366.0, 57.0, 37.0, 1115.0, 1460.0, 0.0, 23.0, 624.0, 616.0, 301.0, 404.0, 659.0, 3.0, 484.0, 459.0, 206.0, 17.0, 912.0, 1055.0, 367.0, 415.0, 792.0, 789.0, 11.0, 11.0, 0.0, 0.0, 1316.0, 1142.0, 768.0, 651.0, 0.0, 12.0, 7.0, 0.0, 396.0, 198.0, 319.0, 335.0, 1055.0, 1162.0, 0.0, 0.0, 44.0, 29.0, 41.0, 66.0, 0.0, 14.0, 0.0, 151.0, 26.0, 90.0, 51.0, 63.0, 8.0, 91.0, 97.0, 165.0, 922.0, 925.0, 946.0, 904.0, 41.0, 51.0, 248.0, 225.0, 0.0, 0.0, 0.0, 0.0, 289.0, 158.0, 134.0, 156.0, 0.0, 61.0, 0.0, 0.0, 85.0, 147.0, 0.0, 0.0, 30.0, 14.0, 21.0, 4.0, 126.0, 154.0, 0.0, 0.0, 94.0, 131.0, 1260.0, 1244.0, 0.0, 0.0, 115.0, 146.0, 52.0, 66.0, 1067.0, 0.0, 53.0, 49.0, 477.0, 503.0, 11.0, 6.0, 446.0, 471.0, 398.0, 438.0, 132.0, 146.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9958587868458513, "mean_inference_ms": 2.6065660997285547, "mean_action_processing_ms": 0.482100056235107, "mean_env_wait_ms": 0.3573114207122907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045539140701293945, "StateBufferConnector_ms": 0.0034493207931518555, "ViewRequirementAgentConnector_ms": 0.14417994022369385}, "num_episodes": 18, "episode_return_max": 805.0, "episode_return_min": -404.0, "episode_return_mean": 71.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.61605522803785, "num_env_steps_trained_throughput_per_sec": 338.61605522803785, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 12312.432, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12312.364, "sample_time_ms": 1697.197, "learn_time_ms": 10590.908, "learn_throughput": 377.682, "synch_weights_time_ms": 18.956}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "f1691_00000", "date": "2024-08-13_16-51-52", "timestamp": 1723582312, "time_this_iter_s": 11.89557409286499, "time_total_s": 804.4438281059265, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 804.4438281059265, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 63.547058823529426, "ram_util_percent": 83.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8746429806348508, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.817696067895839, "policy_loss": -0.003145886538550258, "vf_loss": 4.800925242333185, "vf_explained_var": 0.003741974710787415, "kl": 0.008742595306521049, "entropy": 0.7739318188851473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2065442286628896, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.9074463002896183, "policy_loss": 0.0019373736058475163, "vf_loss": 3.8849050413363826, "vf_explained_var": -5.077432703088831e-09, "kl": 0.006029483832261481, "entropy": 0.3968598915234445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 805.0, "episode_reward_min": -404.0, "episode_reward_mean": 55.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1464.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 1460.0}, "policy_reward_mean": {"prey_policy": -231.055, "predator_policy": 258.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, -40.0, -101.0, 427.0, 0.0, -18.0, 0.0, -52.0, 140.0, 106.0, 73.0, -39.0, 250.0, -78.0, 232.0, -142.0, -4.0, -32.0, -60.0, 264.0, -8.0, 0.0, 179.0, 16.0, 23.0, -15.0, 347.0, -23.0, 511.0, 157.0, -137.0, 314.0, -208.0, 508.0, 170.0, 265.0, 0.0, 2.0, 436.0, 587.0, 0.0, -2.0, -60.0, 76.0, 317.0, 0.0, 1.0, -44.0, -14.0, -143.0, -117.0, -18.0, -207.0, -69.0, 781.0, 805.0, 6.0, 79.0, 18.0, 27.0, 19.0, -89.0, -81.0, 10.0, -124.0, 15.0, -37.0, -7.0, -404.0, 0.0, -47.0, 484.0, 0.0, -31.0, -80.0, -76.0, -158.0, 362.0, 2.0, 213.0, 200.0, -28.0, -55.0, -33.0, -332.0, 193.0, -15.0, 177.0, -7.0, -34.0, -7.0, -44.0, 0.0, -101.0, 57.0, 17.0, 19.0, -54.0, -8.0, -41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -666.0, -89.0, -24.0, -368.0, -442.0, -798.0, 21.0, 0.0, -190.0, -108.0, -321.0, 0.0, 0.0, -108.0, -18.0, -1074.0, -375.0, -132.0, -451.0, -106.0, -343.0, -78.0, -838.0, -1086.0, -952.0, -88.0, -104.0, 1.0, -343.0, -394.0, -118.0, -151.0, 0.0, -290.0, -26.0, -12.0, -978.0, -1188.0, -357.0, -26.0, -13.0, 0.0, 0.0, -2.0, -892.0, 17.0, -135.0, -276.0, -494.0, 5.0, -114.0, -770.0, -1458.0, 0.0, -46.0, 19.0, -748.0, 0.0, -548.0, -11.0, -788.0, -47.0, -582.0, -159.0, -272.0, -505.0, -954.0, -50.0, -562.0, -403.0, -913.0, -22.0, 0.0, 2.0, 0.0, -558.0, -1464.0, -832.0, 0.0, 0.0, -12.0, -9.0, 0.0, -538.0, -116.0, -474.0, -104.0, -902.0, -998.0, 0.0, 0.0, -48.0, -24.0, -19.0, -132.0, 0.0, -28.0, -298.0, 4.0, -126.0, -107.0, -14.0, -118.0, -122.0, -184.0, -239.0, -92.0, 0.0, -1066.0, -1047.0, 2.0, -102.0, 16.0, -400.0, 6.0, 18.0, 0.0, 15.0, 12.0, -428.0, 0.0, -89.0, -290.0, -30.0, -112.0, 10.0, 0.0, -104.0, -252.0, 0.0, 15.0, -38.0, -43.0, -41.0, 9.0, -390.0, -294.0, 0.0, 0.0, -247.0, -25.0, -612.0, -1408.0, 0.0, 0.0, 0.0, -292.0, -100.0, -98.0, -1144.0, 1.0, -122.0, -138.0, -618.0, 0.0, 4.0, -19.0, -644.0, -60.0, 0.0, -636.0, -286.0, -20.0, -23.0, -227.0, -36.0, -35.0, -248.0, -242.0, -443.0, 7.0, 0.0, -30.0, -490.0, 13.0, -92.0, 0.0, -77.0, -8.0, -21.0, 0.0, -68.0, -31.0, 0.0, -56.0, -192.0, -428.0, -334.0, 0.0, -191.0, -758.0, 14.0, 5.0, -94.0, -54.0, -26.0, 0.0, -39.0, -25.0], "policy_predator_policy_reward": [432.0, 460.0, 63.0, 10.0, 273.0, 436.0, 626.0, 578.0, 95.0, 95.0, 129.0, 282.0, 0.0, 0.0, 9.0, 65.0, 552.0, 1037.0, 343.0, 346.0, 252.0, 270.0, 148.0, 729.0, 1244.0, 1044.0, 64.0, 50.0, 281.0, 293.0, 237.0, 133.0, 76.0, 71.0, 240.0, 44.0, 0.0, 930.0, 1108.0, 701.0, 0.0, 31.0, 0.0, 0.0, 320.0, 753.0, 71.0, 63.0, 427.0, 366.0, 57.0, 37.0, 1115.0, 1460.0, 0.0, 23.0, 624.0, 616.0, 301.0, 404.0, 659.0, 3.0, 484.0, 459.0, 206.0, 17.0, 912.0, 1055.0, 367.0, 415.0, 792.0, 789.0, 11.0, 11.0, 0.0, 0.0, 1316.0, 1142.0, 768.0, 651.0, 0.0, 12.0, 7.0, 0.0, 396.0, 198.0, 319.0, 335.0, 1055.0, 1162.0, 0.0, 0.0, 44.0, 29.0, 41.0, 66.0, 0.0, 14.0, 0.0, 151.0, 26.0, 90.0, 51.0, 63.0, 8.0, 91.0, 97.0, 165.0, 922.0, 925.0, 946.0, 904.0, 41.0, 51.0, 248.0, 225.0, 0.0, 0.0, 0.0, 0.0, 289.0, 158.0, 134.0, 156.0, 0.0, 61.0, 0.0, 0.0, 85.0, 147.0, 0.0, 0.0, 30.0, 14.0, 21.0, 4.0, 126.0, 154.0, 0.0, 0.0, 94.0, 131.0, 1260.0, 1244.0, 0.0, 0.0, 115.0, 146.0, 52.0, 66.0, 1067.0, 0.0, 53.0, 49.0, 477.0, 503.0, 11.0, 6.0, 446.0, 471.0, 398.0, 438.0, 132.0, 146.0, 66.0, 129.0, 38.0, 0.0, 135.0, 23.0, 318.0, 311.0, 0.0, 15.0, 299.0, 355.0, 33.0, 52.0, 0.0, 51.0, 14.0, 0.0, 55.0, 0.0, 28.0, 28.0, 204.0, 315.0, 184.0, 207.0, 316.0, 650.0, 0.0, 0.0, 74.0, 20.0, 6.0, 12.0, 0.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9950821490408527, "mean_inference_ms": 2.603889957568889, "mean_action_processing_ms": 0.4805453529152713, "mean_env_wait_ms": 0.3570878223496918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005648374557495117, "StateBufferConnector_ms": 0.003420710563659668, "ViewRequirementAgentConnector_ms": 0.17499017715454102}, "num_episodes": 18, "episode_return_max": 805.0, "episode_return_min": -404.0, "episode_return_mean": 55.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.9428779079823, "num_env_steps_trained_throughput_per_sec": 326.9428779079823, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 12336.076, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12336.008, "sample_time_ms": 1794.592, "learn_time_ms": 10517.292, "learn_throughput": 380.326, "synch_weights_time_ms": 19.095}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "f1691_00000", "date": "2024-08-13_16-52-04", "timestamp": 1723582324, "time_this_iter_s": 12.312523126602173, "time_total_s": 816.7563512325287, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 816.7563512325287, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 65.64117647058823, "ram_util_percent": 83.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0117850684141985, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.4622605584916615, "policy_loss": 0.00012421452036255566, "vf_loss": 4.440685475944842, "vf_explained_var": 0.003308200583886848, "kl": 0.009416015025024174, "entropy": 0.8091188783998843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3380412701891844, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.3035362140842217, "policy_loss": 0.0018969668095152844, "vf_loss": 3.2822012353195715, "vf_explained_var": -3.879032437763517e-09, "kl": 0.005688305843477272, "entropy": 0.3962461374897175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 805.0, "episode_reward_min": -404.0, "episode_reward_mean": 50.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1464.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 1460.0}, "policy_reward_mean": {"prey_policy": -195.24, "predator_policy": 220.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 16.0, 23.0, -15.0, 347.0, -23.0, 511.0, 157.0, -137.0, 314.0, -208.0, 508.0, 170.0, 265.0, 0.0, 2.0, 436.0, 587.0, 0.0, -2.0, -60.0, 76.0, 317.0, 0.0, 1.0, -44.0, -14.0, -143.0, -117.0, -18.0, -207.0, -69.0, 781.0, 805.0, 6.0, 79.0, 18.0, 27.0, 19.0, -89.0, -81.0, 10.0, -124.0, 15.0, -37.0, -7.0, -404.0, 0.0, -47.0, 484.0, 0.0, -31.0, -80.0, -76.0, -158.0, 362.0, 2.0, 213.0, 200.0, -28.0, -55.0, -33.0, -332.0, 193.0, -15.0, 177.0, -7.0, -34.0, -7.0, -44.0, 0.0, -101.0, 57.0, 17.0, 19.0, -54.0, -8.0, -41.0, -1.0, -62.0, 12.0, -42.0, 4.0, -41.0, 14.0, 330.0, 0.0, -12.0, -165.0, 17.0, 606.0, -36.0, 278.0, -73.0, -31.0, -26.0, 0.0, -63.0, -46.0, -44.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -892.0, 17.0, -135.0, -276.0, -494.0, 5.0, -114.0, -770.0, -1458.0, 0.0, -46.0, 19.0, -748.0, 0.0, -548.0, -11.0, -788.0, -47.0, -582.0, -159.0, -272.0, -505.0, -954.0, -50.0, -562.0, -403.0, -913.0, -22.0, 0.0, 2.0, 0.0, -558.0, -1464.0, -832.0, 0.0, 0.0, -12.0, -9.0, 0.0, -538.0, -116.0, -474.0, -104.0, -902.0, -998.0, 0.0, 0.0, -48.0, -24.0, -19.0, -132.0, 0.0, -28.0, -298.0, 4.0, -126.0, -107.0, -14.0, -118.0, -122.0, -184.0, -239.0, -92.0, 0.0, -1066.0, -1047.0, 2.0, -102.0, 16.0, -400.0, 6.0, 18.0, 0.0, 15.0, 12.0, -428.0, 0.0, -89.0, -290.0, -30.0, -112.0, 10.0, 0.0, -104.0, -252.0, 0.0, 15.0, -38.0, -43.0, -41.0, 9.0, -390.0, -294.0, 0.0, 0.0, -247.0, -25.0, -612.0, -1408.0, 0.0, 0.0, 0.0, -292.0, -100.0, -98.0, -1144.0, 1.0, -122.0, -138.0, -618.0, 0.0, 4.0, -19.0, -644.0, -60.0, 0.0, -636.0, -286.0, -20.0, -23.0, -227.0, -36.0, -35.0, -248.0, -242.0, -443.0, 7.0, 0.0, -30.0, -490.0, 13.0, -92.0, 0.0, -77.0, -8.0, -21.0, 0.0, -68.0, -31.0, 0.0, -56.0, -192.0, -428.0, -334.0, 0.0, -191.0, -758.0, 14.0, 5.0, -94.0, -54.0, -26.0, 0.0, -39.0, -25.0, -14.0, -5.0, -238.0, -104.0, 6.0, 0.0, -14.0, -56.0, 0.0, 0.0, -54.0, -34.0, -10.0, 15.0, -768.0, 0.0, 0.0, 0.0, -24.0, 0.0, -48.0, -332.0, 0.0, -488.0, 4.0, -978.0, -36.0, -30.0, -912.0, -222.0, -74.0, -43.0, -67.0, -10.0, 0.0, -68.0, 0.0, 0.0, -8.0, -298.0, 0.0, -380.0, -120.0, -60.0], "policy_predator_policy_reward": [320.0, 753.0, 71.0, 63.0, 427.0, 366.0, 57.0, 37.0, 1115.0, 1460.0, 0.0, 23.0, 624.0, 616.0, 301.0, 404.0, 659.0, 3.0, 484.0, 459.0, 206.0, 17.0, 912.0, 1055.0, 367.0, 415.0, 792.0, 789.0, 11.0, 11.0, 0.0, 0.0, 1316.0, 1142.0, 768.0, 651.0, 0.0, 12.0, 7.0, 0.0, 396.0, 198.0, 319.0, 335.0, 1055.0, 1162.0, 0.0, 0.0, 44.0, 29.0, 41.0, 66.0, 0.0, 14.0, 0.0, 151.0, 26.0, 90.0, 51.0, 63.0, 8.0, 91.0, 97.0, 165.0, 922.0, 925.0, 946.0, 904.0, 41.0, 51.0, 248.0, 225.0, 0.0, 0.0, 0.0, 0.0, 289.0, 158.0, 134.0, 156.0, 0.0, 61.0, 0.0, 0.0, 85.0, 147.0, 0.0, 0.0, 30.0, 14.0, 21.0, 4.0, 126.0, 154.0, 0.0, 0.0, 94.0, 131.0, 1260.0, 1244.0, 0.0, 0.0, 115.0, 146.0, 52.0, 66.0, 1067.0, 0.0, 53.0, 49.0, 477.0, 503.0, 11.0, 6.0, 446.0, 471.0, 398.0, 438.0, 132.0, 146.0, 66.0, 129.0, 38.0, 0.0, 135.0, 23.0, 318.0, 311.0, 0.0, 15.0, 299.0, 355.0, 33.0, 52.0, 0.0, 51.0, 14.0, 0.0, 55.0, 0.0, 28.0, 28.0, 204.0, 315.0, 184.0, 207.0, 316.0, 650.0, 0.0, 0.0, 74.0, 20.0, 6.0, 12.0, 0.0, 23.0, 7.0, 11.0, 165.0, 115.0, 6.0, 0.0, 0.0, 28.0, 0.0, 4.0, 47.0, 0.0, 4.0, 5.0, 499.0, 599.0, 0.0, 0.0, 12.0, 0.0, 166.0, 49.0, 374.0, 131.0, 754.0, 826.0, 0.0, 30.0, 605.0, 807.0, 30.0, 14.0, 28.0, 18.0, 42.0, 0.0, 0.0, 0.0, 149.0, 94.0, 155.0, 179.0, 88.0, 48.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9947620407701094, "mean_inference_ms": 2.604141579641056, "mean_action_processing_ms": 0.4790654876837221, "mean_env_wait_ms": 0.3570114270123591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005778074264526367, "StateBufferConnector_ms": 0.006164073944091797, "ViewRequirementAgentConnector_ms": 0.21029949188232422}, "num_episodes": 22, "episode_return_max": 805.0, "episode_return_min": -404.0, "episode_return_mean": 50.62, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.2313096316137, "num_env_steps_trained_throughput_per_sec": 327.2313096316137, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 12313.506, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12313.437, "sample_time_ms": 1865.044, "learn_time_ms": 10424.243, "learn_throughput": 383.721, "synch_weights_time_ms": 19.128}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "f1691_00000", "date": "2024-08-13_16-52-16", "timestamp": 1723582336, "time_this_iter_s": 12.278763055801392, "time_total_s": 829.0351142883301, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 829.0351142883301, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 66.20555555555558, "ram_util_percent": 83.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.333690552358274, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.0005483713730303, "policy_loss": -0.006643954394064923, "vf_loss": 1.9818600802825241, "vf_explained_var": 0.025536707784763718, "kl": 0.011119778497300897, "entropy": 0.8756305418001912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.02865756497812, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 1.6143682749498458, "policy_loss": 0.0020919419180789084, "vf_loss": 1.583288044084317, "vf_explained_var": -5.64509598666398e-09, "kl": 0.008483083409616319, "entropy": 0.5803473343451818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 805.0, "episode_reward_min": -404.0, "episode_reward_mean": 17.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1408.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 1260.0}, "policy_reward_mean": {"prey_policy": -132.455, "predator_policy": 141.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -2.0, -60.0, 76.0, 317.0, 0.0, 1.0, -44.0, -14.0, -143.0, -117.0, -18.0, -207.0, -69.0, 781.0, 805.0, 6.0, 79.0, 18.0, 27.0, 19.0, -89.0, -81.0, 10.0, -124.0, 15.0, -37.0, -7.0, -404.0, 0.0, -47.0, 484.0, 0.0, -31.0, -80.0, -76.0, -158.0, 362.0, 2.0, 213.0, 200.0, -28.0, -55.0, -33.0, -332.0, 193.0, -15.0, 177.0, -7.0, -34.0, -7.0, -44.0, 0.0, -101.0, 57.0, 17.0, 19.0, -54.0, -8.0, -41.0, -1.0, -62.0, 12.0, -42.0, 4.0, -41.0, 14.0, 330.0, 0.0, -12.0, -165.0, 17.0, 606.0, -36.0, 278.0, -73.0, -31.0, -26.0, 0.0, -63.0, -46.0, -44.0, -29.0, -15.0, -6.0, 15.0, 17.0, -37.0, -26.0, 20.0, 0.0, -86.0, 4.0, -4.0, 7.0, -30.0, -56.0, -1.0, 0.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -12.0, -9.0, 0.0, -538.0, -116.0, -474.0, -104.0, -902.0, -998.0, 0.0, 0.0, -48.0, -24.0, -19.0, -132.0, 0.0, -28.0, -298.0, 4.0, -126.0, -107.0, -14.0, -118.0, -122.0, -184.0, -239.0, -92.0, 0.0, -1066.0, -1047.0, 2.0, -102.0, 16.0, -400.0, 6.0, 18.0, 0.0, 15.0, 12.0, -428.0, 0.0, -89.0, -290.0, -30.0, -112.0, 10.0, 0.0, -104.0, -252.0, 0.0, 15.0, -38.0, -43.0, -41.0, 9.0, -390.0, -294.0, 0.0, 0.0, -247.0, -25.0, -612.0, -1408.0, 0.0, 0.0, 0.0, -292.0, -100.0, -98.0, -1144.0, 1.0, -122.0, -138.0, -618.0, 0.0, 4.0, -19.0, -644.0, -60.0, 0.0, -636.0, -286.0, -20.0, -23.0, -227.0, -36.0, -35.0, -248.0, -242.0, -443.0, 7.0, 0.0, -30.0, -490.0, 13.0, -92.0, 0.0, -77.0, -8.0, -21.0, 0.0, -68.0, -31.0, 0.0, -56.0, -192.0, -428.0, -334.0, 0.0, -191.0, -758.0, 14.0, 5.0, -94.0, -54.0, -26.0, 0.0, -39.0, -25.0, -14.0, -5.0, -238.0, -104.0, 6.0, 0.0, -14.0, -56.0, 0.0, 0.0, -54.0, -34.0, -10.0, 15.0, -768.0, 0.0, 0.0, 0.0, -24.0, 0.0, -48.0, -332.0, 0.0, -488.0, 4.0, -978.0, -36.0, -30.0, -912.0, -222.0, -74.0, -43.0, -67.0, -10.0, 0.0, -68.0, 0.0, 0.0, -8.0, -298.0, 0.0, -380.0, -120.0, -60.0, -58.0, 0.0, 0.0, -30.0, -74.0, 0.0, 0.0, 15.0, 17.0, 0.0, -50.0, -26.0, 0.0, -72.0, 1.0, 14.0, -30.0, 15.0, -54.0, -194.0, 0.0, 4.0, -14.0, -7.0, 3.0, 0.0, -39.0, -82.0, -304.0, -46.0, 0.0, -2.0, 0.0, 0.0, -2.0, 10.0], "policy_predator_policy_reward": [0.0, 12.0, 7.0, 0.0, 396.0, 198.0, 319.0, 335.0, 1055.0, 1162.0, 0.0, 0.0, 44.0, 29.0, 41.0, 66.0, 0.0, 14.0, 0.0, 151.0, 26.0, 90.0, 51.0, 63.0, 8.0, 91.0, 97.0, 165.0, 922.0, 925.0, 946.0, 904.0, 41.0, 51.0, 248.0, 225.0, 0.0, 0.0, 0.0, 0.0, 289.0, 158.0, 134.0, 156.0, 0.0, 61.0, 0.0, 0.0, 85.0, 147.0, 0.0, 0.0, 30.0, 14.0, 21.0, 4.0, 126.0, 154.0, 0.0, 0.0, 94.0, 131.0, 1260.0, 1244.0, 0.0, 0.0, 115.0, 146.0, 52.0, 66.0, 1067.0, 0.0, 53.0, 49.0, 477.0, 503.0, 11.0, 6.0, 446.0, 471.0, 398.0, 438.0, 132.0, 146.0, 66.0, 129.0, 38.0, 0.0, 135.0, 23.0, 318.0, 311.0, 0.0, 15.0, 299.0, 355.0, 33.0, 52.0, 0.0, 51.0, 14.0, 0.0, 55.0, 0.0, 28.0, 28.0, 204.0, 315.0, 184.0, 207.0, 316.0, 650.0, 0.0, 0.0, 74.0, 20.0, 6.0, 12.0, 0.0, 23.0, 7.0, 11.0, 165.0, 115.0, 6.0, 0.0, 0.0, 28.0, 0.0, 4.0, 47.0, 0.0, 4.0, 5.0, 499.0, 599.0, 0.0, 0.0, 12.0, 0.0, 166.0, 49.0, 374.0, 131.0, 754.0, 826.0, 0.0, 30.0, 605.0, 807.0, 30.0, 14.0, 28.0, 18.0, 42.0, 0.0, 0.0, 0.0, 149.0, 94.0, 155.0, 179.0, 88.0, 48.0, 29.0, 0.0, 15.0, 0.0, 37.0, 31.0, 0.0, 0.0, 0.0, 0.0, 1.0, 38.0, 10.0, 36.0, 5.0, 0.0, 15.0, 0.0, 113.0, 49.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 50.0, 41.0, 152.0, 142.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.994105795206859, "mean_inference_ms": 2.5983414238231948, "mean_action_processing_ms": 0.47762764876938063, "mean_env_wait_ms": 0.3561827873735794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005663633346557617, "StateBufferConnector_ms": 0.006106019020080566, "ViewRequirementAgentConnector_ms": 0.20292437076568604}, "num_episodes": 18, "episode_return_max": 805.0, "episode_return_min": -404.0, "episode_return_mean": 17.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.9578008887869, "num_env_steps_trained_throughput_per_sec": 330.9578008887869, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 12225.537, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12225.466, "sample_time_ms": 1865.155, "learn_time_ms": 10336.381, "learn_throughput": 386.983, "synch_weights_time_ms": 18.929}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "f1691_00000", "date": "2024-08-13_16-52-28", "timestamp": 1723582348, "time_this_iter_s": 12.135492086410522, "time_total_s": 841.1706063747406, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c499d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 841.1706063747406, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 69.7764705882353, "ram_util_percent": 83.22941176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.603811739046107, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.743448725957719, "policy_loss": -0.0008723826736468013, "vf_loss": 3.722457773597152, "vf_explained_var": 0.006339064508518844, "kl": 0.009597076540176313, "entropy": 0.9163618581635612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7556312154998226, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.9441578895326646, "policy_loss": 0.0011059950081207764, "vf_loss": 2.9170513409786123, "vf_explained_var": -7.852675422789559e-09, "kl": 0.0076087594842396715, "entropy": 0.5950657695847213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -404.0, "episode_reward_mean": 4.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1408.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 1260.0}, "policy_reward_mean": {"prey_policy": -101.42, "predator_policy": 103.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -124.0, 15.0, -37.0, -7.0, -404.0, 0.0, -47.0, 484.0, 0.0, -31.0, -80.0, -76.0, -158.0, 362.0, 2.0, 213.0, 200.0, -28.0, -55.0, -33.0, -332.0, 193.0, -15.0, 177.0, -7.0, -34.0, -7.0, -44.0, 0.0, -101.0, 57.0, 17.0, 19.0, -54.0, -8.0, -41.0, -1.0, -62.0, 12.0, -42.0, 4.0, -41.0, 14.0, 330.0, 0.0, -12.0, -165.0, 17.0, 606.0, -36.0, 278.0, -73.0, -31.0, -26.0, 0.0, -63.0, -46.0, -44.0, -29.0, -15.0, -6.0, 15.0, 17.0, -37.0, -26.0, 20.0, 0.0, -86.0, 4.0, -4.0, 7.0, -30.0, -56.0, -1.0, 0.0, 11.0, 2.0, -30.0, -7.0, -36.0, 0.0, -7.0, -31.0, 14.0, 0.0, 21.0, 0.0, -3.0, 7.0, 308.0, -123.0, -19.0, -8.0, 30.0, -8.0, -56.0, -27.0, 6.0, -21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.0, 0.0, -104.0, -252.0, 0.0, 15.0, -38.0, -43.0, -41.0, 9.0, -390.0, -294.0, 0.0, 0.0, -247.0, -25.0, -612.0, -1408.0, 0.0, 0.0, 0.0, -292.0, -100.0, -98.0, -1144.0, 1.0, -122.0, -138.0, -618.0, 0.0, 4.0, -19.0, -644.0, -60.0, 0.0, -636.0, -286.0, -20.0, -23.0, -227.0, -36.0, -35.0, -248.0, -242.0, -443.0, 7.0, 0.0, -30.0, -490.0, 13.0, -92.0, 0.0, -77.0, -8.0, -21.0, 0.0, -68.0, -31.0, 0.0, -56.0, -192.0, -428.0, -334.0, 0.0, -191.0, -758.0, 14.0, 5.0, -94.0, -54.0, -26.0, 0.0, -39.0, -25.0, -14.0, -5.0, -238.0, -104.0, 6.0, 0.0, -14.0, -56.0, 0.0, 0.0, -54.0, -34.0, -10.0, 15.0, -768.0, 0.0, 0.0, 0.0, -24.0, 0.0, -48.0, -332.0, 0.0, -488.0, 4.0, -978.0, -36.0, -30.0, -912.0, -222.0, -74.0, -43.0, -67.0, -10.0, 0.0, -68.0, 0.0, 0.0, -8.0, -298.0, 0.0, -380.0, -120.0, -60.0, -58.0, 0.0, 0.0, -30.0, -74.0, 0.0, 0.0, 15.0, 17.0, 0.0, -50.0, -26.0, 0.0, -72.0, 1.0, 14.0, -30.0, 15.0, -54.0, -194.0, 0.0, 4.0, -14.0, -7.0, 3.0, 0.0, -39.0, -82.0, -304.0, -46.0, 0.0, -2.0, 0.0, 0.0, -2.0, 10.0, 8.0, -12.0, -40.0, -20.0, 0.0, -14.0, -48.0, -25.0, 0.0, 0.0, -304.0, -1.0, 0.0, -62.0, 18.0, -8.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, -2.0, -24.0, -16.0, 15.0, 0.0, -694.0, -19.0, -246.0, -78.0, 0.0, -8.0, -23.0, 19.0, 11.0, -14.0, -87.0, -68.0, -43.0, -16.0, -28.0, 6.0, 0.0, -25.0, -161.0], "policy_predator_policy_reward": [0.0, 0.0, 85.0, 147.0, 0.0, 0.0, 30.0, 14.0, 21.0, 4.0, 126.0, 154.0, 0.0, 0.0, 94.0, 131.0, 1260.0, 1244.0, 0.0, 0.0, 115.0, 146.0, 52.0, 66.0, 1067.0, 0.0, 53.0, 49.0, 477.0, 503.0, 11.0, 6.0, 446.0, 471.0, 398.0, 438.0, 132.0, 146.0, 66.0, 129.0, 38.0, 0.0, 135.0, 23.0, 318.0, 311.0, 0.0, 15.0, 299.0, 355.0, 33.0, 52.0, 0.0, 51.0, 14.0, 0.0, 55.0, 0.0, 28.0, 28.0, 204.0, 315.0, 184.0, 207.0, 316.0, 650.0, 0.0, 0.0, 74.0, 20.0, 6.0, 12.0, 0.0, 23.0, 7.0, 11.0, 165.0, 115.0, 6.0, 0.0, 0.0, 28.0, 0.0, 4.0, 47.0, 0.0, 4.0, 5.0, 499.0, 599.0, 0.0, 0.0, 12.0, 0.0, 166.0, 49.0, 374.0, 131.0, 754.0, 826.0, 0.0, 30.0, 605.0, 807.0, 30.0, 14.0, 28.0, 18.0, 42.0, 0.0, 0.0, 0.0, 149.0, 94.0, 155.0, 179.0, 88.0, 48.0, 29.0, 0.0, 15.0, 0.0, 37.0, 31.0, 0.0, 0.0, 0.0, 0.0, 1.0, 38.0, 10.0, 36.0, 5.0, 0.0, 15.0, 0.0, 113.0, 49.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 50.0, 41.0, 152.0, 142.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 20.0, 10.0, 0.0, 7.0, 9.0, 28.0, 0.0, 0.0, 141.0, 157.0, 21.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 0.0, 450.0, 552.0, 42.0, 100.0, 29.0, 30.0, 23.0, 0.0, 0.0, 0.0, 35.0, 58.0, 33.0, 22.0, 0.0, 17.0, 0.0, 0.0, 100.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9925289279984776, "mean_inference_ms": 2.5915515086450567, "mean_action_processing_ms": 0.47545670880438257, "mean_env_wait_ms": 0.3550681095841683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007692217826843262, "StateBufferConnector_ms": 0.007041335105895996, "ViewRequirementAgentConnector_ms": 0.2068312168121338}, "num_episodes": 23, "episode_return_max": 606.0, "episode_return_min": -404.0, "episode_return_mean": 4.41, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.61076431721256, "num_env_steps_trained_throughput_per_sec": 328.61076431721256, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 12210.542, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12210.471, "sample_time_ms": 1833.493, "learn_time_ms": 10353.224, "learn_throughput": 386.353, "synch_weights_time_ms": 18.815}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "f1691_00000", "date": "2024-08-13_16-52-41", "timestamp": 1723582361, "time_this_iter_s": 12.232176780700684, "time_total_s": 853.4027831554413, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c49c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 853.4027831554413, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 67.4764705882353, "ram_util_percent": 83.1470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8285853260408635, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.875827668962025, "policy_loss": -0.0015468385389626577, "vf_loss": 4.851196150426511, "vf_explained_var": 0.009069212214656609, "kl": 0.011491181025562998, "entropy": 0.863967951201888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.617200617184715, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.820823059384785, "policy_loss": 0.002435998912043278, "vf_loss": 3.790834595412804, "vf_explained_var": -6.18122242115162e-09, "kl": 0.008062908577341736, "entropy": 0.5065872321368525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -332.0, "episode_reward_mean": -0.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -978.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 826.0}, "policy_reward_mean": {"prey_policy": -86.215, "predator_policy": 85.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.0, -55.0, -33.0, -332.0, 193.0, -15.0, 177.0, -7.0, -34.0, -7.0, -44.0, 0.0, -101.0, 57.0, 17.0, 19.0, -54.0, -8.0, -41.0, -1.0, -62.0, 12.0, -42.0, 4.0, -41.0, 14.0, 330.0, 0.0, -12.0, -165.0, 17.0, 606.0, -36.0, 278.0, -73.0, -31.0, -26.0, 0.0, -63.0, -46.0, -44.0, -29.0, -15.0, -6.0, 15.0, 17.0, -37.0, -26.0, 20.0, 0.0, -86.0, 4.0, -4.0, 7.0, -30.0, -56.0, -1.0, 0.0, 11.0, 2.0, -30.0, -7.0, -36.0, 0.0, -7.0, -31.0, 14.0, 0.0, 21.0, 0.0, -3.0, 7.0, 308.0, -123.0, -19.0, -8.0, 30.0, -8.0, -56.0, -27.0, 6.0, -21.0, -80.0, 0.0, -21.0, -33.0, 56.0, -30.0, -43.0, 285.0, -90.0, 47.0, -66.0, -50.0, -24.0, 6.0, -92.0, -11.0, -11.0, -55.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-286.0, -20.0, -23.0, -227.0, -36.0, -35.0, -248.0, -242.0, -443.0, 7.0, 0.0, -30.0, -490.0, 13.0, -92.0, 0.0, -77.0, -8.0, -21.0, 0.0, -68.0, -31.0, 0.0, -56.0, -192.0, -428.0, -334.0, 0.0, -191.0, -758.0, 14.0, 5.0, -94.0, -54.0, -26.0, 0.0, -39.0, -25.0, -14.0, -5.0, -238.0, -104.0, 6.0, 0.0, -14.0, -56.0, 0.0, 0.0, -54.0, -34.0, -10.0, 15.0, -768.0, 0.0, 0.0, 0.0, -24.0, 0.0, -48.0, -332.0, 0.0, -488.0, 4.0, -978.0, -36.0, -30.0, -912.0, -222.0, -74.0, -43.0, -67.0, -10.0, 0.0, -68.0, 0.0, 0.0, -8.0, -298.0, 0.0, -380.0, -120.0, -60.0, -58.0, 0.0, 0.0, -30.0, -74.0, 0.0, 0.0, 15.0, 17.0, 0.0, -50.0, -26.0, 0.0, -72.0, 1.0, 14.0, -30.0, 15.0, -54.0, -194.0, 0.0, 4.0, -14.0, -7.0, 3.0, 0.0, -39.0, -82.0, -304.0, -46.0, 0.0, -2.0, 0.0, 0.0, -2.0, 10.0, 8.0, -12.0, -40.0, -20.0, 0.0, -14.0, -48.0, -25.0, 0.0, 0.0, -304.0, -1.0, 0.0, -62.0, 18.0, -8.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, -2.0, -24.0, -16.0, 15.0, 0.0, -694.0, -19.0, -246.0, -78.0, 0.0, -8.0, -23.0, 19.0, 11.0, -14.0, -87.0, -68.0, -43.0, -16.0, -28.0, 6.0, 0.0, -25.0, -161.0, -84.0, -134.0, 0.0, 0.0, -44.0, -268.0, -70.0, -436.0, 0.0, -432.0, -24.0, -20.0, -26.0, -67.0, -650.0, -12.0, -64.0, -116.0, -834.0, -72.0, -53.0, -54.0, -10.0, -100.0, -48.0, 0.0, 0.0, -3.0, -76.0, -244.0, -24.0, 0.0, -48.0, -28.0, -200.0, -4.0], "policy_predator_policy_reward": [132.0, 146.0, 66.0, 129.0, 38.0, 0.0, 135.0, 23.0, 318.0, 311.0, 0.0, 15.0, 299.0, 355.0, 33.0, 52.0, 0.0, 51.0, 14.0, 0.0, 55.0, 0.0, 28.0, 28.0, 204.0, 315.0, 184.0, 207.0, 316.0, 650.0, 0.0, 0.0, 74.0, 20.0, 6.0, 12.0, 0.0, 23.0, 7.0, 11.0, 165.0, 115.0, 6.0, 0.0, 0.0, 28.0, 0.0, 4.0, 47.0, 0.0, 4.0, 5.0, 499.0, 599.0, 0.0, 0.0, 12.0, 0.0, 166.0, 49.0, 374.0, 131.0, 754.0, 826.0, 0.0, 30.0, 605.0, 807.0, 30.0, 14.0, 28.0, 18.0, 42.0, 0.0, 0.0, 0.0, 149.0, 94.0, 155.0, 179.0, 88.0, 48.0, 29.0, 0.0, 15.0, 0.0, 37.0, 31.0, 0.0, 0.0, 0.0, 0.0, 1.0, 38.0, 10.0, 36.0, 5.0, 0.0, 15.0, 0.0, 113.0, 49.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 50.0, 41.0, 152.0, 142.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 20.0, 10.0, 0.0, 7.0, 9.0, 28.0, 0.0, 0.0, 141.0, 157.0, 21.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 0.0, 450.0, 552.0, 42.0, 100.0, 29.0, 30.0, 23.0, 0.0, 0.0, 0.0, 35.0, 58.0, 33.0, 22.0, 0.0, 17.0, 0.0, 0.0, 100.0, 65.0, 65.0, 73.0, 0.0, 0.0, 160.0, 131.0, 160.0, 313.0, 216.0, 272.0, 8.0, 6.0, 7.0, 43.0, 411.0, 536.0, 0.0, 90.0, 719.0, 234.0, 39.0, 2.0, 10.0, 50.0, 4.0, 20.0, 6.0, 3.0, 122.0, 106.0, 13.0, 0.0, 43.0, 22.0, 88.0, 61.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9908864606431235, "mean_inference_ms": 2.5856425017445535, "mean_action_processing_ms": 0.47370513207878034, "mean_env_wait_ms": 0.3540055470649777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007852792739868164, "StateBufferConnector_ms": 0.0074274539947509766, "ViewRequirementAgentConnector_ms": 0.2072303295135498}, "num_episodes": 18, "episode_return_max": 606.0, "episode_return_min": -332.0, "episode_return_mean": -0.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.6301636915954, "num_env_steps_trained_throughput_per_sec": 322.6301636915954, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 12173.356, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12173.286, "sample_time_ms": 1796.578, "learn_time_ms": 10353.985, "learn_throughput": 386.325, "synch_weights_time_ms": 17.899}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "f1691_00000", "date": "2024-08-13_16-52-53", "timestamp": 1723582373, "time_this_iter_s": 12.451655149459839, "time_total_s": 865.8544383049011, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3742820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 865.8544383049011, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 69.34444444444446, "ram_util_percent": 83.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.440319947448988, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.069741924477633, "policy_loss": -0.0020256837869368533, "vf_loss": 4.045691926264889, "vf_explained_var": 0.0036745742199912903, "kl": 0.01144611705638209, "entropy": 0.8717294199126108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8294046811483526, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.1258746922331513, "policy_loss": 0.0015415452775501069, "vf_loss": 3.1005274202457813, "vf_explained_var": -7.915749120964576e-09, "kl": 0.006966466951483551, "entropy": 0.4965940314941305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -501.0, "episode_reward_mean": -9.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -978.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 832.0}, "policy_reward_mean": {"prey_policy": -82.78, "predator_policy": 77.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.0, -1.0, -62.0, 12.0, -42.0, 4.0, -41.0, 14.0, 330.0, 0.0, -12.0, -165.0, 17.0, 606.0, -36.0, 278.0, -73.0, -31.0, -26.0, 0.0, -63.0, -46.0, -44.0, -29.0, -15.0, -6.0, 15.0, 17.0, -37.0, -26.0, 20.0, 0.0, -86.0, 4.0, -4.0, 7.0, -30.0, -56.0, -1.0, 0.0, 11.0, 2.0, -30.0, -7.0, -36.0, 0.0, -7.0, -31.0, 14.0, 0.0, 21.0, 0.0, -3.0, 7.0, 308.0, -123.0, -19.0, -8.0, 30.0, -8.0, -56.0, -27.0, 6.0, -21.0, -80.0, 0.0, -21.0, -33.0, 56.0, -30.0, -43.0, 285.0, -90.0, 47.0, -66.0, -50.0, -24.0, 6.0, -92.0, -11.0, -11.0, -55.0, -41.0, 28.0, -47.0, 14.0, -64.0, -3.0, 0.0, -61.0, -108.0, -10.0, 5.0, 2.0, -194.0, -14.0, 10.0, -118.0, -47.0, -501.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.0, -25.0, -14.0, -5.0, -238.0, -104.0, 6.0, 0.0, -14.0, -56.0, 0.0, 0.0, -54.0, -34.0, -10.0, 15.0, -768.0, 0.0, 0.0, 0.0, -24.0, 0.0, -48.0, -332.0, 0.0, -488.0, 4.0, -978.0, -36.0, -30.0, -912.0, -222.0, -74.0, -43.0, -67.0, -10.0, 0.0, -68.0, 0.0, 0.0, -8.0, -298.0, 0.0, -380.0, -120.0, -60.0, -58.0, 0.0, 0.0, -30.0, -74.0, 0.0, 0.0, 15.0, 17.0, 0.0, -50.0, -26.0, 0.0, -72.0, 1.0, 14.0, -30.0, 15.0, -54.0, -194.0, 0.0, 4.0, -14.0, -7.0, 3.0, 0.0, -39.0, -82.0, -304.0, -46.0, 0.0, -2.0, 0.0, 0.0, -2.0, 10.0, 8.0, -12.0, -40.0, -20.0, 0.0, -14.0, -48.0, -25.0, 0.0, 0.0, -304.0, -1.0, 0.0, -62.0, 18.0, -8.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, -2.0, -24.0, -16.0, 15.0, 0.0, -694.0, -19.0, -246.0, -78.0, 0.0, -8.0, -23.0, 19.0, 11.0, -14.0, -87.0, -68.0, -43.0, -16.0, -28.0, 6.0, 0.0, -25.0, -161.0, -84.0, -134.0, 0.0, 0.0, -44.0, -268.0, -70.0, -436.0, 0.0, -432.0, -24.0, -20.0, -26.0, -67.0, -650.0, -12.0, -64.0, -116.0, -834.0, -72.0, -53.0, -54.0, -10.0, -100.0, -48.0, 0.0, 0.0, -3.0, -76.0, -244.0, -24.0, 0.0, -48.0, -28.0, -200.0, -4.0, -41.0, -94.0, 20.0, 8.0, -358.0, -42.0, 9.0, 0.0, -40.0, -85.0, -6.0, 0.0, 0.0, 0.0, -122.0, -81.0, -306.0, -98.0, -36.0, 0.0, 0.0, -7.0, -8.0, 0.0, -274.0, -304.0, -24.0, -4.0, 0.0, -10.0, -298.0, -10.0, -178.0, -7.0, -580.0, -808.0], "policy_predator_policy_reward": [0.0, 23.0, 7.0, 11.0, 165.0, 115.0, 6.0, 0.0, 0.0, 28.0, 0.0, 4.0, 47.0, 0.0, 4.0, 5.0, 499.0, 599.0, 0.0, 0.0, 12.0, 0.0, 166.0, 49.0, 374.0, 131.0, 754.0, 826.0, 0.0, 30.0, 605.0, 807.0, 30.0, 14.0, 28.0, 18.0, 42.0, 0.0, 0.0, 0.0, 149.0, 94.0, 155.0, 179.0, 88.0, 48.0, 29.0, 0.0, 15.0, 0.0, 37.0, 31.0, 0.0, 0.0, 0.0, 0.0, 1.0, 38.0, 10.0, 36.0, 5.0, 0.0, 15.0, 0.0, 113.0, 49.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 50.0, 41.0, 152.0, 142.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 20.0, 10.0, 0.0, 7.0, 9.0, 28.0, 0.0, 0.0, 141.0, 157.0, 21.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 0.0, 450.0, 552.0, 42.0, 100.0, 29.0, 30.0, 23.0, 0.0, 0.0, 0.0, 35.0, 58.0, 33.0, 22.0, 0.0, 17.0, 0.0, 0.0, 100.0, 65.0, 65.0, 73.0, 0.0, 0.0, 160.0, 131.0, 160.0, 313.0, 216.0, 272.0, 8.0, 6.0, 7.0, 43.0, 411.0, 536.0, 0.0, 90.0, 719.0, 234.0, 39.0, 2.0, 10.0, 50.0, 4.0, 20.0, 6.0, 3.0, 122.0, 106.0, 13.0, 0.0, 43.0, 22.0, 88.0, 61.0, 63.0, 31.0, 0.0, 0.0, 149.0, 204.0, 0.0, 5.0, 23.0, 38.0, 0.0, 3.0, 0.0, 0.0, 37.0, 105.0, 154.0, 142.0, 8.0, 18.0, 0.0, 12.0, 10.0, 0.0, 139.0, 245.0, 8.0, 6.0, 11.0, 9.0, 149.0, 41.0, 129.0, 9.0, 55.0, 832.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9876915402159931, "mean_inference_ms": 2.5759277382729477, "mean_action_processing_ms": 0.471241565339881, "mean_env_wait_ms": 0.35252802835566555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006706595420837402, "StateBufferConnector_ms": 0.007318615913391113, "ViewRequirementAgentConnector_ms": 0.173750638961792}, "num_episodes": 18, "episode_return_max": 606.0, "episode_return_min": -501.0, "episode_return_mean": -9.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.55237587164635, "num_env_steps_trained_throughput_per_sec": 339.55237587164635, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 12160.677, "restore_workers_time_ms": 0.019, "training_step_time_ms": 12160.619, "sample_time_ms": 1770.503, "learn_time_ms": 10369.821, "learn_throughput": 385.735, "synch_weights_time_ms": 15.874}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "f1691_00000", "date": "2024-08-13_16-53-05", "timestamp": 1723582385, "time_this_iter_s": 11.824554204940796, "time_total_s": 877.6789925098419, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3742f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 877.6789925098419, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 66.64375, "ram_util_percent": 83.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5169666452224924, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.058706479223948, "policy_loss": -0.0017228701243068648, "vf_loss": 4.038919954325157, "vf_explained_var": 0.002023126523961466, "kl": 0.009441707737034837, "entropy": 0.8278290571674468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3272331693342756, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.779646416315957, "policy_loss": 0.0019425612533090528, "vf_loss": 2.752899781736747, "vf_explained_var": -9.303370480814938e-09, "kl": 0.0072586261881182, "entropy": 0.4830726122887677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 599.0, "episode_reward_min": -501.0, "episode_reward_mean": -2.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 857.0}, "policy_reward_mean": {"prey_policy": -77.635, "predator_policy": 76.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.0, -29.0, -15.0, -6.0, 15.0, 17.0, -37.0, -26.0, 20.0, 0.0, -86.0, 4.0, -4.0, 7.0, -30.0, -56.0, -1.0, 0.0, 11.0, 2.0, -30.0, -7.0, -36.0, 0.0, -7.0, -31.0, 14.0, 0.0, 21.0, 0.0, -3.0, 7.0, 308.0, -123.0, -19.0, -8.0, 30.0, -8.0, -56.0, -27.0, 6.0, -21.0, -80.0, 0.0, -21.0, -33.0, 56.0, -30.0, -43.0, 285.0, -90.0, 47.0, -66.0, -50.0, -24.0, 6.0, -92.0, -11.0, -11.0, -55.0, -41.0, 28.0, -47.0, 14.0, -64.0, -3.0, 0.0, -61.0, -108.0, -10.0, 5.0, 2.0, -194.0, -14.0, 10.0, -118.0, -47.0, -501.0, 17.0, -56.0, 4.0, 17.0, -40.0, -12.0, -23.0, -4.0, 13.0, 2.0, 554.0, -16.0, -22.0, 288.0, -12.0, -3.0, -15.0, 10.0, 119.0, 11.0, -57.0, 599.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-120.0, -60.0, -58.0, 0.0, 0.0, -30.0, -74.0, 0.0, 0.0, 15.0, 17.0, 0.0, -50.0, -26.0, 0.0, -72.0, 1.0, 14.0, -30.0, 15.0, -54.0, -194.0, 0.0, 4.0, -14.0, -7.0, 3.0, 0.0, -39.0, -82.0, -304.0, -46.0, 0.0, -2.0, 0.0, 0.0, -2.0, 10.0, 8.0, -12.0, -40.0, -20.0, 0.0, -14.0, -48.0, -25.0, 0.0, 0.0, -304.0, -1.0, 0.0, -62.0, 18.0, -8.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, -2.0, -24.0, -16.0, 15.0, 0.0, -694.0, -19.0, -246.0, -78.0, 0.0, -8.0, -23.0, 19.0, 11.0, -14.0, -87.0, -68.0, -43.0, -16.0, -28.0, 6.0, 0.0, -25.0, -161.0, -84.0, -134.0, 0.0, 0.0, -44.0, -268.0, -70.0, -436.0, 0.0, -432.0, -24.0, -20.0, -26.0, -67.0, -650.0, -12.0, -64.0, -116.0, -834.0, -72.0, -53.0, -54.0, -10.0, -100.0, -48.0, 0.0, 0.0, -3.0, -76.0, -244.0, -24.0, 0.0, -48.0, -28.0, -200.0, -4.0, -41.0, -94.0, 20.0, 8.0, -358.0, -42.0, 9.0, 0.0, -40.0, -85.0, -6.0, 0.0, 0.0, 0.0, -122.0, -81.0, -306.0, -98.0, -36.0, 0.0, 0.0, -7.0, -8.0, 0.0, -274.0, -304.0, -24.0, -4.0, 0.0, -10.0, -298.0, -10.0, -178.0, -7.0, -580.0, -808.0, 16.0, 0.0, 0.0, -146.0, 4.0, 0.0, 0.0, 17.0, 0.0, -92.0, -40.0, 0.0, -15.0, -81.0, -20.0, 6.0, 15.0, -4.0, -8.0, -6.0, -11.0, -840.0, -39.0, 0.0, -27.0, -34.0, -642.0, 0.0, -380.0, 0.0, -13.0, 0.0, -6.0, -338.0, 0.0, 10.0, -52.0, -492.0, 11.0, 0.0, -80.0, -34.0, -950.0, -54.0], "policy_predator_policy_reward": [88.0, 48.0, 29.0, 0.0, 15.0, 0.0, 37.0, 31.0, 0.0, 0.0, 0.0, 0.0, 1.0, 38.0, 10.0, 36.0, 5.0, 0.0, 15.0, 0.0, 113.0, 49.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 50.0, 41.0, 152.0, 142.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 20.0, 10.0, 0.0, 7.0, 9.0, 28.0, 0.0, 0.0, 141.0, 157.0, 21.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 0.0, 450.0, 552.0, 42.0, 100.0, 29.0, 30.0, 23.0, 0.0, 0.0, 0.0, 35.0, 58.0, 33.0, 22.0, 0.0, 17.0, 0.0, 0.0, 100.0, 65.0, 65.0, 73.0, 0.0, 0.0, 160.0, 131.0, 160.0, 313.0, 216.0, 272.0, 8.0, 6.0, 7.0, 43.0, 411.0, 536.0, 0.0, 90.0, 719.0, 234.0, 39.0, 2.0, 10.0, 50.0, 4.0, 20.0, 6.0, 3.0, 122.0, 106.0, 13.0, 0.0, 43.0, 22.0, 88.0, 61.0, 63.0, 31.0, 0.0, 0.0, 149.0, 204.0, 0.0, 5.0, 23.0, 38.0, 0.0, 3.0, 0.0, 0.0, 37.0, 105.0, 154.0, 142.0, 8.0, 18.0, 0.0, 12.0, 10.0, 0.0, 139.0, 245.0, 8.0, 6.0, 11.0, 9.0, 149.0, 41.0, 129.0, 9.0, 55.0, 832.0, 0.0, 1.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 41.0, 11.0, 28.0, 0.0, 37.0, 36.0, 10.0, 0.0, 2.0, 0.0, 7.0, 9.0, 725.0, 680.0, 13.0, 10.0, 39.0, 0.0, 457.0, 473.0, 178.0, 190.0, 10.0, 0.0, 292.0, 37.0, 0.0, 0.0, 336.0, 327.0, 0.0, 0.0, 0.0, 57.0, 746.0, 857.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9823058627306233, "mean_inference_ms": 2.5605925036511, "mean_action_processing_ms": 0.4676562325220584, "mean_env_wait_ms": 0.3504042188196671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006994843482971191, "StateBufferConnector_ms": 0.004890799522399902, "ViewRequirementAgentConnector_ms": 0.13950347900390625}, "num_episodes": 22, "episode_return_max": 599.0, "episode_return_min": -501.0, "episode_return_mean": -2.35, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.24970256138903, "num_env_steps_trained_throughput_per_sec": 335.24970256138903, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 12152.465, "restore_workers_time_ms": 0.019, "training_step_time_ms": 12152.405, "sample_time_ms": 1727.687, "learn_time_ms": 10404.544, "learn_throughput": 384.447, "synch_weights_time_ms": 15.831}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "f1691_00000", "date": "2024-08-13_16-53-17", "timestamp": 1723582397, "time_this_iter_s": 11.961364030838013, "time_total_s": 889.6403565406799, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 889.6403565406799, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 67.4764705882353, "ram_util_percent": 83.38235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4203596417866056, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.6880653310389746, "policy_loss": -0.004778761012607781, "vf_loss": 1.6701333300461845, "vf_explained_var": 0.07764851372077983, "kl": 0.009969060053202267, "entropy": 0.8522084013810234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.572767036893065, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 1.5256408972714943, "policy_loss": 0.0014470371368424917, "vf_loss": 1.501359908369483, "vf_explained_var": -4.762064212213748e-09, "kl": 0.006682088375364932, "entropy": 0.454373294280635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 599.0, "episode_reward_min": -501.0, "episode_reward_mean": -4.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 857.0}, "policy_reward_mean": {"prey_policy": -80.785, "predator_policy": 78.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -7.0, -31.0, 14.0, 0.0, 21.0, 0.0, -3.0, 7.0, 308.0, -123.0, -19.0, -8.0, 30.0, -8.0, -56.0, -27.0, 6.0, -21.0, -80.0, 0.0, -21.0, -33.0, 56.0, -30.0, -43.0, 285.0, -90.0, 47.0, -66.0, -50.0, -24.0, 6.0, -92.0, -11.0, -11.0, -55.0, -41.0, 28.0, -47.0, 14.0, -64.0, -3.0, 0.0, -61.0, -108.0, -10.0, 5.0, 2.0, -194.0, -14.0, 10.0, -118.0, -47.0, -501.0, 17.0, -56.0, 4.0, 17.0, -40.0, -12.0, -23.0, -4.0, 13.0, 2.0, 554.0, -16.0, -22.0, 288.0, -12.0, -3.0, -15.0, 10.0, 119.0, 11.0, -57.0, 599.0, -24.0, -9.0, -44.0, -10.0, 6.0, -39.0, -8.0, -135.0, -45.0, 0.0, -53.0, -68.0, -2.0, 0.0, 11.0, -17.0, -82.0, -74.0, -5.0, 2.0, 12.0, 16.0, -27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -304.0, -1.0, 0.0, -62.0, 18.0, -8.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, -2.0, -24.0, -16.0, 15.0, 0.0, -694.0, -19.0, -246.0, -78.0, 0.0, -8.0, -23.0, 19.0, 11.0, -14.0, -87.0, -68.0, -43.0, -16.0, -28.0, 6.0, 0.0, -25.0, -161.0, -84.0, -134.0, 0.0, 0.0, -44.0, -268.0, -70.0, -436.0, 0.0, -432.0, -24.0, -20.0, -26.0, -67.0, -650.0, -12.0, -64.0, -116.0, -834.0, -72.0, -53.0, -54.0, -10.0, -100.0, -48.0, 0.0, 0.0, -3.0, -76.0, -244.0, -24.0, 0.0, -48.0, -28.0, -200.0, -4.0, -41.0, -94.0, 20.0, 8.0, -358.0, -42.0, 9.0, 0.0, -40.0, -85.0, -6.0, 0.0, 0.0, 0.0, -122.0, -81.0, -306.0, -98.0, -36.0, 0.0, 0.0, -7.0, -8.0, 0.0, -274.0, -304.0, -24.0, -4.0, 0.0, -10.0, -298.0, -10.0, -178.0, -7.0, -580.0, -808.0, 16.0, 0.0, 0.0, -146.0, 4.0, 0.0, 0.0, 17.0, 0.0, -92.0, -40.0, 0.0, -15.0, -81.0, -20.0, 6.0, 15.0, -4.0, -8.0, -6.0, -11.0, -840.0, -39.0, 0.0, -27.0, -34.0, -642.0, 0.0, -380.0, 0.0, -13.0, 0.0, -6.0, -338.0, 0.0, 10.0, -52.0, -492.0, 11.0, 0.0, -80.0, -34.0, -950.0, -54.0, -18.0, -30.0, 4.0, -34.0, -32.0, -28.0, 0.0, -20.0, 19.0, -26.0, -22.0, -48.0, 7.0, -30.0, -92.0, -124.0, -34.0, -56.0, 6.0, -12.0, 0.0, -134.0, 0.0, -136.0, -13.0, 0.0, 0.0, 0.0, -8.0, 5.0, -126.0, 5.0, -62.0, -69.0, -56.0, -282.0, -22.0, 1.0, 0.0, 2.0, 16.0, -334.0, 3.0, 11.0, -202.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 141.0, 157.0, 21.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 8.0, 0.0, 450.0, 552.0, 42.0, 100.0, 29.0, 30.0, 23.0, 0.0, 0.0, 0.0, 35.0, 58.0, 33.0, 22.0, 0.0, 17.0, 0.0, 0.0, 100.0, 65.0, 65.0, 73.0, 0.0, 0.0, 160.0, 131.0, 160.0, 313.0, 216.0, 272.0, 8.0, 6.0, 7.0, 43.0, 411.0, 536.0, 0.0, 90.0, 719.0, 234.0, 39.0, 2.0, 10.0, 50.0, 4.0, 20.0, 6.0, 3.0, 122.0, 106.0, 13.0, 0.0, 43.0, 22.0, 88.0, 61.0, 63.0, 31.0, 0.0, 0.0, 149.0, 204.0, 0.0, 5.0, 23.0, 38.0, 0.0, 3.0, 0.0, 0.0, 37.0, 105.0, 154.0, 142.0, 8.0, 18.0, 0.0, 12.0, 10.0, 0.0, 139.0, 245.0, 8.0, 6.0, 11.0, 9.0, 149.0, 41.0, 129.0, 9.0, 55.0, 832.0, 0.0, 1.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 41.0, 11.0, 28.0, 0.0, 37.0, 36.0, 10.0, 0.0, 2.0, 0.0, 7.0, 9.0, 725.0, 680.0, 13.0, 10.0, 39.0, 0.0, 457.0, 473.0, 178.0, 190.0, 10.0, 0.0, 292.0, 37.0, 0.0, 0.0, 336.0, 327.0, 0.0, 0.0, 0.0, 57.0, 746.0, 857.0, 0.0, 24.0, 9.0, 12.0, 0.0, 16.0, 10.0, 0.0, 13.0, 0.0, 31.0, 0.0, 15.0, 0.0, 33.0, 48.0, 45.0, 0.0, 6.0, 0.0, 14.0, 67.0, 67.0, 1.0, 11.0, 0.0, 0.0, 0.0, 10.0, 4.0, 41.0, 63.0, 0.0, 49.0, 114.0, 150.0, 5.0, 11.0, 0.0, 0.0, 163.0, 167.0, 0.0, 2.0, 67.0, 103.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9764002290421587, "mean_inference_ms": 2.5478635474887623, "mean_action_processing_ms": 0.4656180638088712, "mean_env_wait_ms": 0.3482398580948945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007064700126647949, "StateBufferConnector_ms": 0.0049593448638916016, "ViewRequirementAgentConnector_ms": 0.14327120780944824}, "num_episodes": 23, "episode_return_max": 599.0, "episode_return_min": -501.0, "episode_return_mean": -4.99, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.4432710690232, "num_env_steps_trained_throughput_per_sec": 335.4432710690232, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 12137.597, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12137.538, "sample_time_ms": 1654.666, "learn_time_ms": 10463.16, "learn_throughput": 382.294, "synch_weights_time_ms": 15.612}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "f1691_00000", "date": "2024-08-13_16-53-29", "timestamp": 1723582409, "time_this_iter_s": 11.995975017547607, "time_total_s": 901.6363315582275, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3be0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 901.6363315582275, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 65.83529411764707, "ram_util_percent": 83.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8881966574955238, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.9254493295515656, "policy_loss": -0.008068402426652414, "vf_loss": 0.9122019592179823, "vf_explained_var": 0.16256241867781948, "kl": 0.00935671698783034, "entropy": 0.8280588731563912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.811852814146766, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 1.170222530817544, "policy_loss": 0.0017128552280602947, "vf_loss": 1.1442046231851375, "vf_explained_var": -5.960464477539063e-09, "kl": 0.00711258922579845, "entropy": 0.4483190076218711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 599.0, "episode_reward_min": -501.0, "episode_reward_mean": -9.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 857.0}, "policy_reward_mean": {"prey_policy": -76.36, "predator_policy": 71.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.0, -80.0, 0.0, -21.0, -33.0, 56.0, -30.0, -43.0, 285.0, -90.0, 47.0, -66.0, -50.0, -24.0, 6.0, -92.0, -11.0, -11.0, -55.0, -41.0, 28.0, -47.0, 14.0, -64.0, -3.0, 0.0, -61.0, -108.0, -10.0, 5.0, 2.0, -194.0, -14.0, 10.0, -118.0, -47.0, -501.0, 17.0, -56.0, 4.0, 17.0, -40.0, -12.0, -23.0, -4.0, 13.0, 2.0, 554.0, -16.0, -22.0, 288.0, -12.0, -3.0, -15.0, 10.0, 119.0, 11.0, -57.0, 599.0, -24.0, -9.0, -44.0, -10.0, 6.0, -39.0, -8.0, -135.0, -45.0, 0.0, -53.0, -68.0, -2.0, 0.0, 11.0, -17.0, -82.0, -74.0, -5.0, 2.0, 12.0, 16.0, -27.0, 23.0, 1.0, -28.0, -33.0, -43.0, 0.0, 0.0, -7.0, -43.0, -59.0, -6.0, -24.0, 1.0, 13.0, 1.0, -39.0, -83.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.0, -161.0, -84.0, -134.0, 0.0, 0.0, -44.0, -268.0, -70.0, -436.0, 0.0, -432.0, -24.0, -20.0, -26.0, -67.0, -650.0, -12.0, -64.0, -116.0, -834.0, -72.0, -53.0, -54.0, -10.0, -100.0, -48.0, 0.0, 0.0, -3.0, -76.0, -244.0, -24.0, 0.0, -48.0, -28.0, -200.0, -4.0, -41.0, -94.0, 20.0, 8.0, -358.0, -42.0, 9.0, 0.0, -40.0, -85.0, -6.0, 0.0, 0.0, 0.0, -122.0, -81.0, -306.0, -98.0, -36.0, 0.0, 0.0, -7.0, -8.0, 0.0, -274.0, -304.0, -24.0, -4.0, 0.0, -10.0, -298.0, -10.0, -178.0, -7.0, -580.0, -808.0, 16.0, 0.0, 0.0, -146.0, 4.0, 0.0, 0.0, 17.0, 0.0, -92.0, -40.0, 0.0, -15.0, -81.0, -20.0, 6.0, 15.0, -4.0, -8.0, -6.0, -11.0, -840.0, -39.0, 0.0, -27.0, -34.0, -642.0, 0.0, -380.0, 0.0, -13.0, 0.0, -6.0, -338.0, 0.0, 10.0, -52.0, -492.0, 11.0, 0.0, -80.0, -34.0, -950.0, -54.0, -18.0, -30.0, 4.0, -34.0, -32.0, -28.0, 0.0, -20.0, 19.0, -26.0, -22.0, -48.0, 7.0, -30.0, -92.0, -124.0, -34.0, -56.0, 6.0, -12.0, 0.0, -134.0, 0.0, -136.0, -13.0, 0.0, 0.0, 0.0, -8.0, 5.0, -126.0, 5.0, -62.0, -69.0, -56.0, -282.0, -22.0, 1.0, 0.0, 2.0, 16.0, -334.0, 3.0, 11.0, -202.0, 5.0, 15.0, 8.0, 0.0, 1.0, -20.0, -36.0, -11.0, -44.0, -178.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -74.0, -12.0, -64.0, -69.0, 0.0, -19.0, 4.0, -58.0, 0.0, 1.0, 13.0, 0.0, -9.0, 0.0, -72.0, -6.0, -52.0, -64.0, -6.0, 0.0], "policy_predator_policy_reward": [100.0, 65.0, 65.0, 73.0, 0.0, 0.0, 160.0, 131.0, 160.0, 313.0, 216.0, 272.0, 8.0, 6.0, 7.0, 43.0, 411.0, 536.0, 0.0, 90.0, 719.0, 234.0, 39.0, 2.0, 10.0, 50.0, 4.0, 20.0, 6.0, 3.0, 122.0, 106.0, 13.0, 0.0, 43.0, 22.0, 88.0, 61.0, 63.0, 31.0, 0.0, 0.0, 149.0, 204.0, 0.0, 5.0, 23.0, 38.0, 0.0, 3.0, 0.0, 0.0, 37.0, 105.0, 154.0, 142.0, 8.0, 18.0, 0.0, 12.0, 10.0, 0.0, 139.0, 245.0, 8.0, 6.0, 11.0, 9.0, 149.0, 41.0, 129.0, 9.0, 55.0, 832.0, 0.0, 1.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 41.0, 11.0, 28.0, 0.0, 37.0, 36.0, 10.0, 0.0, 2.0, 0.0, 7.0, 9.0, 725.0, 680.0, 13.0, 10.0, 39.0, 0.0, 457.0, 473.0, 178.0, 190.0, 10.0, 0.0, 292.0, 37.0, 0.0, 0.0, 336.0, 327.0, 0.0, 0.0, 0.0, 57.0, 746.0, 857.0, 0.0, 24.0, 9.0, 12.0, 0.0, 16.0, 10.0, 0.0, 13.0, 0.0, 31.0, 0.0, 15.0, 0.0, 33.0, 48.0, 45.0, 0.0, 6.0, 0.0, 14.0, 67.0, 67.0, 1.0, 11.0, 0.0, 0.0, 0.0, 10.0, 4.0, 41.0, 63.0, 0.0, 49.0, 114.0, 150.0, 5.0, 11.0, 0.0, 0.0, 163.0, 167.0, 0.0, 2.0, 67.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 21.0, 1.0, 46.0, 89.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 37.0, 45.0, 29.0, 13.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 34.0, 5.0, 33.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9729254477057626, "mean_inference_ms": 2.5351087087960695, "mean_action_processing_ms": 0.4615759300516644, "mean_env_wait_ms": 0.3467865438585596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004255056381225586, "StateBufferConnector_ms": 0.004052519798278809, "ViewRequirementAgentConnector_ms": 0.1116185188293457}, "num_episodes": 18, "episode_return_max": 599.0, "episode_return_min": -501.0, "episode_return_mean": -9.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.8410030188022, "num_env_steps_trained_throughput_per_sec": 325.8410030188022, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 12083.997, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12083.939, "sample_time_ms": 1618.915, "learn_time_ms": 10447.895, "learn_throughput": 382.852, "synch_weights_time_ms": 14.611}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "f1691_00000", "date": "2024-08-13_16-53-41", "timestamp": 1723582421, "time_this_iter_s": 12.321187973022461, "time_total_s": 913.95751953125, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3be0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 913.95751953125, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 64.9888888888889, "ram_util_percent": 83.5888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0569186269290864, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.42773565197432484, "policy_loss": -0.007362223621556368, "vf_loss": 0.4122115252184726, "vf_explained_var": 0.15900325472392732, "kl": 0.010046134766190104, "entropy": 0.8315111258988658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.720695131630809, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 0.7231273115435172, "policy_loss": 0.0010051124731679916, "vf_loss": 0.7014975056446419, "vf_explained_var": 2.675807034527814e-06, "kl": 0.006035575779866944, "entropy": 0.4742615030871497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 599.0, "episode_reward_min": -501.0, "episode_reward_mean": -8.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 857.0}, "policy_reward_mean": {"prey_policy": -56.675, "predator_policy": 52.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.0, -41.0, 28.0, -47.0, 14.0, -64.0, -3.0, 0.0, -61.0, -108.0, -10.0, 5.0, 2.0, -194.0, -14.0, 10.0, -118.0, -47.0, -501.0, 17.0, -56.0, 4.0, 17.0, -40.0, -12.0, -23.0, -4.0, 13.0, 2.0, 554.0, -16.0, -22.0, 288.0, -12.0, -3.0, -15.0, 10.0, 119.0, 11.0, -57.0, 599.0, -24.0, -9.0, -44.0, -10.0, 6.0, -39.0, -8.0, -135.0, -45.0, 0.0, -53.0, -68.0, -2.0, 0.0, 11.0, -17.0, -82.0, -74.0, -5.0, 2.0, 12.0, 16.0, -27.0, 23.0, 1.0, -28.0, -33.0, -43.0, 0.0, 0.0, -7.0, -43.0, -59.0, -6.0, -24.0, 1.0, 13.0, 1.0, -39.0, -83.0, 4.0, 5.0, -4.0, 6.0, -13.0, -2.0, -7.0, -14.0, 6.0, 7.0, 0.0, 0.0, -27.0, -19.0, 0.0, -40.0, -11.0, 0.0, 13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-200.0, -4.0, -41.0, -94.0, 20.0, 8.0, -358.0, -42.0, 9.0, 0.0, -40.0, -85.0, -6.0, 0.0, 0.0, 0.0, -122.0, -81.0, -306.0, -98.0, -36.0, 0.0, 0.0, -7.0, -8.0, 0.0, -274.0, -304.0, -24.0, -4.0, 0.0, -10.0, -298.0, -10.0, -178.0, -7.0, -580.0, -808.0, 16.0, 0.0, 0.0, -146.0, 4.0, 0.0, 0.0, 17.0, 0.0, -92.0, -40.0, 0.0, -15.0, -81.0, -20.0, 6.0, 15.0, -4.0, -8.0, -6.0, -11.0, -840.0, -39.0, 0.0, -27.0, -34.0, -642.0, 0.0, -380.0, 0.0, -13.0, 0.0, -6.0, -338.0, 0.0, 10.0, -52.0, -492.0, 11.0, 0.0, -80.0, -34.0, -950.0, -54.0, -18.0, -30.0, 4.0, -34.0, -32.0, -28.0, 0.0, -20.0, 19.0, -26.0, -22.0, -48.0, 7.0, -30.0, -92.0, -124.0, -34.0, -56.0, 6.0, -12.0, 0.0, -134.0, 0.0, -136.0, -13.0, 0.0, 0.0, 0.0, -8.0, 5.0, -126.0, 5.0, -62.0, -69.0, -56.0, -282.0, -22.0, 1.0, 0.0, 2.0, 16.0, -334.0, 3.0, 11.0, -202.0, 5.0, 15.0, 8.0, 0.0, 1.0, -20.0, -36.0, -11.0, -44.0, -178.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -74.0, -12.0, -64.0, -69.0, 0.0, -19.0, 4.0, -58.0, 0.0, 1.0, 13.0, 0.0, -9.0, 0.0, -72.0, -6.0, -52.0, -64.0, -6.0, 0.0, 0.0, -2.0, -25.0, 0.0, 7.0, -14.0, -6.0, -20.0, -10.0, 3.0, -12.0, -6.0, -28.0, 0.0, -13.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -22.0, -26.0, -14.0, -24.0, 0.0, 0.0, -64.0, -16.0, -22.0, 0.0, 0.0, 0.0, 13.0, 0.0], "policy_predator_policy_reward": [88.0, 61.0, 63.0, 31.0, 0.0, 0.0, 149.0, 204.0, 0.0, 5.0, 23.0, 38.0, 0.0, 3.0, 0.0, 0.0, 37.0, 105.0, 154.0, 142.0, 8.0, 18.0, 0.0, 12.0, 10.0, 0.0, 139.0, 245.0, 8.0, 6.0, 11.0, 9.0, 149.0, 41.0, 129.0, 9.0, 55.0, 832.0, 0.0, 1.0, 40.0, 50.0, 0.0, 0.0, 0.0, 0.0, 41.0, 11.0, 28.0, 0.0, 37.0, 36.0, 10.0, 0.0, 2.0, 0.0, 7.0, 9.0, 725.0, 680.0, 13.0, 10.0, 39.0, 0.0, 457.0, 473.0, 178.0, 190.0, 10.0, 0.0, 292.0, 37.0, 0.0, 0.0, 336.0, 327.0, 0.0, 0.0, 0.0, 57.0, 746.0, 857.0, 0.0, 24.0, 9.0, 12.0, 0.0, 16.0, 10.0, 0.0, 13.0, 0.0, 31.0, 0.0, 15.0, 0.0, 33.0, 48.0, 45.0, 0.0, 6.0, 0.0, 14.0, 67.0, 67.0, 1.0, 11.0, 0.0, 0.0, 0.0, 10.0, 4.0, 41.0, 63.0, 0.0, 49.0, 114.0, 150.0, 5.0, 11.0, 0.0, 0.0, 163.0, 167.0, 0.0, 2.0, 67.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 21.0, 1.0, 46.0, 89.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 37.0, 45.0, 29.0, 13.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 34.0, 5.0, 33.0, 0.0, 10.0, 0.0, 0.0, 7.0, 9.0, 12.0, 7.0, 6.0, 0.0, 13.0, 0.0, 5.0, 0.0, 11.0, 14.0, 0.0, 5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 14.0, 12.0, 7.0, 0.0, 0.0, 32.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9690341595671776, "mean_inference_ms": 2.5245099155751705, "mean_action_processing_ms": 0.4591452189312691, "mean_env_wait_ms": 0.34539892154544255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004039168357849121, "StateBufferConnector_ms": 0.0038564205169677734, "ViewRequirementAgentConnector_ms": 0.10880327224731445}, "num_episodes": 18, "episode_return_max": 599.0, "episode_return_min": -501.0, "episode_return_mean": -8.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.8117899191162, "num_env_steps_trained_throughput_per_sec": 336.8117899191162, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 12090.325, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12090.269, "sample_time_ms": 1596.855, "learn_time_ms": 10476.655, "learn_throughput": 381.801, "synch_weights_time_ms": 13.907}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "f1691_00000", "date": "2024-08-13_16-53-53", "timestamp": 1723582433, "time_this_iter_s": 11.941594123840332, "time_total_s": 925.8991136550903, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37770d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 925.8991136550903, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 64.99411764705883, "ram_util_percent": 83.6058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0445305854397477, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.8603227130004338, "policy_loss": -0.003183013845294241, "vf_loss": 0.8399333297417908, "vf_explained_var": 0.05544855496870778, "kl": 0.010347281638004696, "entropy": 0.8175900068547991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9452046455687317, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 1.1122837423016785, "policy_loss": 0.0007453042274666211, "vf_loss": 1.0957737135193335, "vf_explained_var": -1.892210945250496e-10, "kl": 0.004613363372493675, "entropy": 0.3197047862426314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 599.0, "episode_reward_min": -135.0, "episode_reward_mean": 0.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 857.0}, "policy_reward_mean": {"prey_policy": -39.675, "predator_policy": 39.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, -40.0, -12.0, -23.0, -4.0, 13.0, 2.0, 554.0, -16.0, -22.0, 288.0, -12.0, -3.0, -15.0, 10.0, 119.0, 11.0, -57.0, 599.0, -24.0, -9.0, -44.0, -10.0, 6.0, -39.0, -8.0, -135.0, -45.0, 0.0, -53.0, -68.0, -2.0, 0.0, 11.0, -17.0, -82.0, -74.0, -5.0, 2.0, 12.0, 16.0, -27.0, 23.0, 1.0, -28.0, -33.0, -43.0, 0.0, 0.0, -7.0, -43.0, -59.0, -6.0, -24.0, 1.0, 13.0, 1.0, -39.0, -83.0, 4.0, 5.0, -4.0, 6.0, -13.0, -2.0, -7.0, -14.0, 6.0, 7.0, 0.0, 0.0, -27.0, -19.0, 0.0, -40.0, -11.0, 0.0, 13.0, -12.0, -11.0, -25.0, 11.0, 8.0, 14.0, 0.0, -1.0, -6.0, 0.0, 0.0, -60.0, 0.0, -4.0, 0.0, -1.0, -56.0, -16.0, -45.0, -14.0, -72.0, -78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 17.0, 0.0, -92.0, -40.0, 0.0, -15.0, -81.0, -20.0, 6.0, 15.0, -4.0, -8.0, -6.0, -11.0, -840.0, -39.0, 0.0, -27.0, -34.0, -642.0, 0.0, -380.0, 0.0, -13.0, 0.0, -6.0, -338.0, 0.0, 10.0, -52.0, -492.0, 11.0, 0.0, -80.0, -34.0, -950.0, -54.0, -18.0, -30.0, 4.0, -34.0, -32.0, -28.0, 0.0, -20.0, 19.0, -26.0, -22.0, -48.0, 7.0, -30.0, -92.0, -124.0, -34.0, -56.0, 6.0, -12.0, 0.0, -134.0, 0.0, -136.0, -13.0, 0.0, 0.0, 0.0, -8.0, 5.0, -126.0, 5.0, -62.0, -69.0, -56.0, -282.0, -22.0, 1.0, 0.0, 2.0, 16.0, -334.0, 3.0, 11.0, -202.0, 5.0, 15.0, 8.0, 0.0, 1.0, -20.0, -36.0, -11.0, -44.0, -178.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -74.0, -12.0, -64.0, -69.0, 0.0, -19.0, 4.0, -58.0, 0.0, 1.0, 13.0, 0.0, -9.0, 0.0, -72.0, -6.0, -52.0, -64.0, -6.0, 0.0, 0.0, -2.0, -25.0, 0.0, 7.0, -14.0, -6.0, -20.0, -10.0, 3.0, -12.0, -6.0, -28.0, 0.0, -13.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -22.0, -26.0, -14.0, -24.0, 0.0, 0.0, -64.0, -16.0, -22.0, 0.0, 0.0, 0.0, 13.0, 0.0, -24.0, 0.0, 0.0, -24.0, -14.0, -36.0, 0.0, 11.0, -16.0, 16.0, 14.0, 0.0, 0.0, 0.0, 0.0, -16.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -56.0, 0.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 0.0, -30.0, -54.0, 0.0, -43.0, -90.0, 0.0, 0.0, -28.0, -46.0, -59.0, -51.0, -54.0], "policy_predator_policy_reward": [0.0, 0.0, 41.0, 11.0, 28.0, 0.0, 37.0, 36.0, 10.0, 0.0, 2.0, 0.0, 7.0, 9.0, 725.0, 680.0, 13.0, 10.0, 39.0, 0.0, 457.0, 473.0, 178.0, 190.0, 10.0, 0.0, 292.0, 37.0, 0.0, 0.0, 336.0, 327.0, 0.0, 0.0, 0.0, 57.0, 746.0, 857.0, 0.0, 24.0, 9.0, 12.0, 0.0, 16.0, 10.0, 0.0, 13.0, 0.0, 31.0, 0.0, 15.0, 0.0, 33.0, 48.0, 45.0, 0.0, 6.0, 0.0, 14.0, 67.0, 67.0, 1.0, 11.0, 0.0, 0.0, 0.0, 10.0, 4.0, 41.0, 63.0, 0.0, 49.0, 114.0, 150.0, 5.0, 11.0, 0.0, 0.0, 163.0, 167.0, 0.0, 2.0, 67.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 21.0, 1.0, 46.0, 89.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 37.0, 45.0, 29.0, 13.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 34.0, 5.0, 33.0, 0.0, 10.0, 0.0, 0.0, 7.0, 9.0, 12.0, 7.0, 6.0, 0.0, 13.0, 0.0, 5.0, 0.0, 11.0, 14.0, 0.0, 5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 14.0, 12.0, 7.0, 0.0, 0.0, 32.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 5.0, 8.0, 7.0, 18.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 14.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 28.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 1.0, 0.0, 28.0, 0.0, 27.0, 0.0, 4.0, 41.0, 0.0, 14.0, 0.0, 33.0, 27.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9650732166961956, "mean_inference_ms": 2.516068019523161, "mean_action_processing_ms": 0.4566877308744145, "mean_env_wait_ms": 0.3443195804535679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004157304763793945, "StateBufferConnector_ms": 0.004665017127990723, "ViewRequirementAgentConnector_ms": 0.11430799961090088}, "num_episodes": 22, "episode_return_max": 599.0, "episode_return_min": -135.0, "episode_return_mean": 0.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.40652338489866, "num_env_steps_trained_throughput_per_sec": 340.40652338489866, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 12041.935, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12041.879, "sample_time_ms": 1535.829, "learn_time_ms": 10488.129, "learn_throughput": 381.384, "synch_weights_time_ms": 13.915}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "f1691_00000", "date": "2024-08-13_16-54-05", "timestamp": 1723582445, "time_this_iter_s": 11.834152936935425, "time_total_s": 937.7332665920258, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3777280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 937.7332665920258, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 62.55, "ram_util_percent": 83.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.16246741075049, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.2566073607830774, "policy_loss": -0.0014073870795231964, "vf_loss": 1.2346348034484045, "vf_explained_var": 0.043482355402890964, "kl": 0.010262802338461566, "entropy": 0.799704639116923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.613662407870488, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.408978120391331, "policy_loss": 0.001584563977528541, "vf_loss": 1.3933782368267655, "vf_explained_var": -5.897390779364046e-09, "kl": 0.008202840920448243, "entropy": 0.2272158565009555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 599.0, "episode_reward_min": -135.0, "episode_reward_mean": -10.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -950.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 857.0}, "policy_reward_mean": {"prey_policy": -27.465, "predator_policy": 22.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [599.0, -24.0, -9.0, -44.0, -10.0, 6.0, -39.0, -8.0, -135.0, -45.0, 0.0, -53.0, -68.0, -2.0, 0.0, 11.0, -17.0, -82.0, -74.0, -5.0, 2.0, 12.0, 16.0, -27.0, 23.0, 1.0, -28.0, -33.0, -43.0, 0.0, 0.0, -7.0, -43.0, -59.0, -6.0, -24.0, 1.0, 13.0, 1.0, -39.0, -83.0, 4.0, 5.0, -4.0, 6.0, -13.0, -2.0, -7.0, -14.0, 6.0, 7.0, 0.0, 0.0, -27.0, -19.0, 0.0, -40.0, -11.0, 0.0, 13.0, -12.0, -11.0, -25.0, 11.0, 8.0, 14.0, 0.0, -1.0, -6.0, 0.0, 0.0, -60.0, 0.0, -4.0, 0.0, -1.0, -56.0, -16.0, -45.0, -14.0, -72.0, -78.0, 5.0, -23.0, -10.0, -40.0, -12.0, -5.0, 24.0, -28.0, 11.0, 2.0, 12.0, -68.0, -56.0, -27.0, -14.0, -13.0, 15.0, -34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-950.0, -54.0, -18.0, -30.0, 4.0, -34.0, -32.0, -28.0, 0.0, -20.0, 19.0, -26.0, -22.0, -48.0, 7.0, -30.0, -92.0, -124.0, -34.0, -56.0, 6.0, -12.0, 0.0, -134.0, 0.0, -136.0, -13.0, 0.0, 0.0, 0.0, -8.0, 5.0, -126.0, 5.0, -62.0, -69.0, -56.0, -282.0, -22.0, 1.0, 0.0, 2.0, 16.0, -334.0, 3.0, 11.0, -202.0, 5.0, 15.0, 8.0, 0.0, 1.0, -20.0, -36.0, -11.0, -44.0, -178.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -74.0, -12.0, -64.0, -69.0, 0.0, -19.0, 4.0, -58.0, 0.0, 1.0, 13.0, 0.0, -9.0, 0.0, -72.0, -6.0, -52.0, -64.0, -6.0, 0.0, 0.0, -2.0, -25.0, 0.0, 7.0, -14.0, -6.0, -20.0, -10.0, 3.0, -12.0, -6.0, -28.0, 0.0, -13.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -22.0, -26.0, -14.0, -24.0, 0.0, 0.0, -64.0, -16.0, -22.0, 0.0, 0.0, 0.0, 13.0, 0.0, -24.0, 0.0, 0.0, -24.0, -14.0, -36.0, 0.0, 11.0, -16.0, 16.0, 14.0, 0.0, 0.0, 0.0, 0.0, -16.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -56.0, 0.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 0.0, -30.0, -54.0, 0.0, -43.0, -90.0, 0.0, 0.0, -28.0, -46.0, -59.0, -51.0, -54.0, 2.0, 0.0, -18.0, -28.0, -22.0, 0.0, -38.0, -158.0, 0.0, -24.0, 0.0, -15.0, 4.0, 17.0, -22.0, -34.0, 0.0, 7.0, 2.0, 0.0, 16.0, -9.0, -64.0, -75.0, -28.0, -75.0, -54.0, -7.0, -28.0, 0.0, 2.0, -42.0, -9.0, 15.0, -56.0, -12.0], "policy_predator_policy_reward": [746.0, 857.0, 0.0, 24.0, 9.0, 12.0, 0.0, 16.0, 10.0, 0.0, 13.0, 0.0, 31.0, 0.0, 15.0, 0.0, 33.0, 48.0, 45.0, 0.0, 6.0, 0.0, 14.0, 67.0, 67.0, 1.0, 11.0, 0.0, 0.0, 0.0, 10.0, 4.0, 41.0, 63.0, 0.0, 49.0, 114.0, 150.0, 5.0, 11.0, 0.0, 0.0, 163.0, 167.0, 0.0, 2.0, 67.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 21.0, 1.0, 46.0, 89.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 37.0, 45.0, 29.0, 13.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 34.0, 5.0, 33.0, 0.0, 10.0, 0.0, 0.0, 7.0, 9.0, 12.0, 7.0, 6.0, 0.0, 13.0, 0.0, 5.0, 0.0, 11.0, 14.0, 0.0, 5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 14.0, 12.0, 7.0, 0.0, 0.0, 32.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 5.0, 8.0, 7.0, 18.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 14.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 28.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 1.0, 0.0, 28.0, 0.0, 27.0, 0.0, 4.0, 41.0, 0.0, 14.0, 0.0, 33.0, 27.0, 0.0, 0.0, 3.0, 9.0, 14.0, 12.0, 0.0, 77.0, 79.0, 12.0, 0.0, 0.0, 10.0, 0.0, 3.0, 17.0, 11.0, 0.0, 4.0, 0.0, 0.0, 5.0, 0.0, 15.0, 56.0, 24.0, 23.0, 28.0, 6.0, 14.0, 0.0, 27.0, 0.0, 9.0, 0.0, 14.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9639130478949827, "mean_inference_ms": 2.509788329721519, "mean_action_processing_ms": 0.4551043764555942, "mean_env_wait_ms": 0.3434921938061653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003980398178100586, "StateBufferConnector_ms": 0.004369974136352539, "ViewRequirementAgentConnector_ms": 0.13778090476989746}, "num_episodes": 18, "episode_return_max": 599.0, "episode_return_min": -135.0, "episode_return_mean": -10.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.7146926436535, "num_env_steps_trained_throughput_per_sec": 318.7146926436535, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 12074.599, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12074.544, "sample_time_ms": 1550.533, "learn_time_ms": 10506.655, "learn_throughput": 380.711, "synch_weights_time_ms": 13.836}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "f1691_00000", "date": "2024-08-13_16-54-18", "timestamp": 1723582458, "time_this_iter_s": 12.591166973114014, "time_total_s": 950.3244335651398, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 950.3244335651398, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 67.00555555555555, "ram_util_percent": 83.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.50425164363687, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.3813880584858083, "policy_loss": -0.0022506963294097984, "vf_loss": 1.3674553031328494, "vf_explained_var": 0.03720701642768093, "kl": 0.00710384680297615, "entropy": 0.684620331582569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1124860472011346, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.9978434045163411, "policy_loss": 0.003368443330730159, "vf_loss": 1.9740523078138865, "vf_explained_var": -5.550485439401455e-09, "kl": 0.011952906482959774, "entropy": 0.25558598617279027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -167.0, "episode_reward_mean": -15.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -202.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 111.0}, "policy_reward_mean": {"prey_policy": -19.065, "predator_policy": 11.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.0, 23.0, 1.0, -28.0, -33.0, -43.0, 0.0, 0.0, -7.0, -43.0, -59.0, -6.0, -24.0, 1.0, 13.0, 1.0, -39.0, -83.0, 4.0, 5.0, -4.0, 6.0, -13.0, -2.0, -7.0, -14.0, 6.0, 7.0, 0.0, 0.0, -27.0, -19.0, 0.0, -40.0, -11.0, 0.0, 13.0, -12.0, -11.0, -25.0, 11.0, 8.0, 14.0, 0.0, -1.0, -6.0, 0.0, 0.0, -60.0, 0.0, -4.0, 0.0, -1.0, -56.0, -16.0, -45.0, -14.0, -72.0, -78.0, 5.0, -23.0, -10.0, -40.0, -12.0, -5.0, 24.0, -28.0, 11.0, 2.0, 12.0, -68.0, -56.0, -27.0, -14.0, -13.0, 15.0, -34.0, -13.0, -16.0, 0.0, 28.0, -97.0, -48.0, 0.0, -38.0, 0.0, -71.0, -3.0, -35.0, 9.0, -167.0, -17.0, 9.0, 0.0, 0.0, -11.0, 15.0, -21.0, -11.0, -17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-202.0, 5.0, 15.0, 8.0, 0.0, 1.0, -20.0, -36.0, -11.0, -44.0, -178.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -74.0, -12.0, -64.0, -69.0, 0.0, -19.0, 4.0, -58.0, 0.0, 1.0, 13.0, 0.0, -9.0, 0.0, -72.0, -6.0, -52.0, -64.0, -6.0, 0.0, 0.0, -2.0, -25.0, 0.0, 7.0, -14.0, -6.0, -20.0, -10.0, 3.0, -12.0, -6.0, -28.0, 0.0, -13.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -22.0, -26.0, -14.0, -24.0, 0.0, 0.0, -64.0, -16.0, -22.0, 0.0, 0.0, 0.0, 13.0, 0.0, -24.0, 0.0, 0.0, -24.0, -14.0, -36.0, 0.0, 11.0, -16.0, 16.0, 14.0, 0.0, 0.0, 0.0, 0.0, -16.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -56.0, 0.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 0.0, -30.0, -54.0, 0.0, -43.0, -90.0, 0.0, 0.0, -28.0, -46.0, -59.0, -51.0, -54.0, 2.0, 0.0, -18.0, -28.0, -22.0, 0.0, -38.0, -158.0, 0.0, -24.0, 0.0, -15.0, 4.0, 17.0, -22.0, -34.0, 0.0, 7.0, 2.0, 0.0, 16.0, -9.0, -64.0, -75.0, -28.0, -75.0, -54.0, -7.0, -28.0, 0.0, 2.0, -42.0, -9.0, 15.0, -56.0, -12.0, -22.0, -10.0, -34.0, -3.0, 0.0, 0.0, 11.0, 17.0, -92.0, -116.0, -15.0, -82.0, 0.0, 0.0, -98.0, -8.0, 0.0, 0.0, -22.0, -130.0, -11.0, 0.0, -68.0, -2.0, -7.0, 6.0, -126.0, -114.0, 0.0, -34.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, -13.0, 18.0, -54.0, 6.0, -58.0, 18.0, -40.0, 3.0], "policy_predator_policy_reward": [67.0, 103.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 21.0, 1.0, 46.0, 89.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 6.0, 37.0, 45.0, 29.0, 13.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 34.0, 5.0, 33.0, 0.0, 10.0, 0.0, 0.0, 7.0, 9.0, 12.0, 7.0, 6.0, 0.0, 13.0, 0.0, 5.0, 0.0, 11.0, 14.0, 0.0, 5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 14.0, 12.0, 7.0, 0.0, 0.0, 32.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 5.0, 8.0, 7.0, 18.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 14.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 28.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 1.0, 0.0, 28.0, 0.0, 27.0, 0.0, 4.0, 41.0, 0.0, 14.0, 0.0, 33.0, 27.0, 0.0, 0.0, 3.0, 9.0, 14.0, 12.0, 0.0, 77.0, 79.0, 12.0, 0.0, 0.0, 10.0, 0.0, 3.0, 17.0, 11.0, 0.0, 4.0, 0.0, 0.0, 5.0, 0.0, 15.0, 56.0, 24.0, 23.0, 28.0, 6.0, 14.0, 0.0, 27.0, 0.0, 9.0, 0.0, 14.0, 20.0, 4.0, 15.0, 17.0, 4.0, 0.0, 0.0, 0.0, 0.0, 111.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 68.0, 0.0, 0.0, 0.0, 81.0, 0.0, 8.0, 35.0, 0.0, 0.0, 10.0, 45.0, 28.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 10.0, 17.0, 0.0, 29.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9621649800031803, "mean_inference_ms": 2.503454753159641, "mean_action_processing_ms": 0.4530239950583164, "mean_env_wait_ms": 0.3426628377684741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054280757904052734, "StateBufferConnector_ms": 0.004581332206726074, "ViewRequirementAgentConnector_ms": 0.1373577117919922}, "num_episodes": 23, "episode_return_max": 28.0, "episode_return_min": -167.0, "episode_return_mean": -15.82, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.2904839282643, "num_env_steps_trained_throughput_per_sec": 331.2904839282643, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 12073.385, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12073.331, "sample_time_ms": 1563.937, "learn_time_ms": 10492.401, "learn_throughput": 381.228, "synch_weights_time_ms": 13.636}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "f1691_00000", "date": "2024-08-13_16-54-30", "timestamp": 1723582470, "time_this_iter_s": 12.141979217529297, "time_total_s": 962.4664127826691, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d0f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 962.4664127826691, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 65.17777777777776, "ram_util_percent": 83.3277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2053481359330434, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.2682413847988876, "policy_loss": -0.002438442151816118, "vf_loss": 2.247385805119913, "vf_explained_var": 0.052395326908303314, "kl": 0.010225084416060563, "entropy": 0.7389710454398362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.522186736135729, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.331709735718354, "policy_loss": 0.0015354132972086076, "vf_loss": 2.317761421487445, "vf_explained_var": -8.3888018572772e-09, "kl": 0.007264978318495862, "entropy": 0.10114546260234737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -290.0, "episode_reward_mean": -20.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -239.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 135.0}, "policy_reward_mean": {"prey_policy": -22.235, "predator_policy": 11.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 5.0, -4.0, 6.0, -13.0, -2.0, -7.0, -14.0, 6.0, 7.0, 0.0, 0.0, -27.0, -19.0, 0.0, -40.0, -11.0, 0.0, 13.0, -12.0, -11.0, -25.0, 11.0, 8.0, 14.0, 0.0, -1.0, -6.0, 0.0, 0.0, -60.0, 0.0, -4.0, 0.0, -1.0, -56.0, -16.0, -45.0, -14.0, -72.0, -78.0, 5.0, -23.0, -10.0, -40.0, -12.0, -5.0, 24.0, -28.0, 11.0, 2.0, 12.0, -68.0, -56.0, -27.0, -14.0, -13.0, 15.0, -34.0, -13.0, -16.0, 0.0, 28.0, -97.0, -48.0, 0.0, -38.0, 0.0, -71.0, -3.0, -35.0, 9.0, -167.0, -17.0, 9.0, 0.0, 0.0, -11.0, 15.0, -21.0, -11.0, -17.0, 3.0, 10.0, -3.0, 0.0, -18.0, -127.0, -46.0, -78.0, -8.0, 0.0, 5.0, -55.0, 16.0, 0.0, 6.0, -157.0, -290.0, -97.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, 0.0, -2.0, -25.0, 0.0, 7.0, -14.0, -6.0, -20.0, -10.0, 3.0, -12.0, -6.0, -28.0, 0.0, -13.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -22.0, -26.0, -14.0, -24.0, 0.0, 0.0, -64.0, -16.0, -22.0, 0.0, 0.0, 0.0, 13.0, 0.0, -24.0, 0.0, 0.0, -24.0, -14.0, -36.0, 0.0, 11.0, -16.0, 16.0, 14.0, 0.0, 0.0, 0.0, 0.0, -16.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -56.0, 0.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 0.0, -30.0, -54.0, 0.0, -43.0, -90.0, 0.0, 0.0, -28.0, -46.0, -59.0, -51.0, -54.0, 2.0, 0.0, -18.0, -28.0, -22.0, 0.0, -38.0, -158.0, 0.0, -24.0, 0.0, -15.0, 4.0, 17.0, -22.0, -34.0, 0.0, 7.0, 2.0, 0.0, 16.0, -9.0, -64.0, -75.0, -28.0, -75.0, -54.0, -7.0, -28.0, 0.0, 2.0, -42.0, -9.0, 15.0, -56.0, -12.0, -22.0, -10.0, -34.0, -3.0, 0.0, 0.0, 11.0, 17.0, -92.0, -116.0, -15.0, -82.0, 0.0, 0.0, -98.0, -8.0, 0.0, 0.0, -22.0, -130.0, -11.0, 0.0, -68.0, -2.0, -7.0, 6.0, -126.0, -114.0, 0.0, -34.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, -13.0, 18.0, -54.0, 6.0, -58.0, 18.0, -40.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, -6.0, 0.0, 0.0, -38.0, -2.0, -34.0, -235.0, -38.0, -68.0, 0.0, -156.0, -18.0, 1.0, 0.0, 0.0, 0.0, -4.0, -146.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 6.0, -124.0, -192.0, -186.0, -239.0, -80.0, -64.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 7.0, 9.0, 12.0, 7.0, 6.0, 0.0, 13.0, 0.0, 5.0, 0.0, 11.0, 14.0, 0.0, 5.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 14.0, 12.0, 7.0, 0.0, 0.0, 32.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 5.0, 8.0, 7.0, 18.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 14.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 28.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 1.0, 0.0, 28.0, 0.0, 27.0, 0.0, 4.0, 41.0, 0.0, 14.0, 0.0, 33.0, 27.0, 0.0, 0.0, 3.0, 9.0, 14.0, 12.0, 0.0, 77.0, 79.0, 12.0, 0.0, 0.0, 10.0, 0.0, 3.0, 17.0, 11.0, 0.0, 4.0, 0.0, 0.0, 5.0, 0.0, 15.0, 56.0, 24.0, 23.0, 28.0, 6.0, 14.0, 0.0, 27.0, 0.0, 9.0, 0.0, 14.0, 20.0, 4.0, 15.0, 17.0, 4.0, 0.0, 0.0, 0.0, 0.0, 111.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 68.0, 0.0, 0.0, 0.0, 81.0, 0.0, 8.0, 35.0, 0.0, 0.0, 10.0, 45.0, 28.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 10.0, 17.0, 0.0, 29.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 19.0, 3.0, 10.0, 132.0, 0.0, 60.0, 20.0, 58.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 73.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 44.0, 115.0, 0.0, 135.0, 2.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9605977949597059, "mean_inference_ms": 2.4981650120151557, "mean_action_processing_ms": 0.4514341904752646, "mean_env_wait_ms": 0.34205170065367446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005804538726806641, "StateBufferConnector_ms": 0.004393577575683594, "ViewRequirementAgentConnector_ms": 0.13595187664031982}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -290.0, "episode_return_mean": -20.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.4753215280426, "num_env_steps_trained_throughput_per_sec": 327.4753215280426, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 12077.606, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12077.549, "sample_time_ms": 1566.473, "learn_time_ms": 10493.305, "learn_throughput": 381.195, "synch_weights_time_ms": 13.923}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "f1691_00000", "date": "2024-08-13_16-54-42", "timestamp": 1723582482, "time_this_iter_s": 12.256927013397217, "time_total_s": 974.7233397960663, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3777280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 974.7233397960663, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 66.53529411764707, "ram_util_percent": 83.27058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.136630553101736, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.2287577364179825, "policy_loss": -0.0022396114038884954, "vf_loss": 2.2065152868391977, "vf_explained_var": 0.027262681817251538, "kl": 0.01074658274296368, "entropy": 0.8650207043640197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1763614403074065, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.1346235398262268, "policy_loss": 0.0016335725026678234, "vf_loss": 2.1195493126041676, "vf_explained_var": -7.694991177352017e-09, "kl": 0.007866505401095004, "entropy": 0.1189129201761846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -290.0, "episode_reward_mean": -27.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -324.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": -30.035, "predator_policy": 16.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, -12.0, -11.0, -25.0, 11.0, 8.0, 14.0, 0.0, -1.0, -6.0, 0.0, 0.0, -60.0, 0.0, -4.0, 0.0, -1.0, -56.0, -16.0, -45.0, -14.0, -72.0, -78.0, 5.0, -23.0, -10.0, -40.0, -12.0, -5.0, 24.0, -28.0, 11.0, 2.0, 12.0, -68.0, -56.0, -27.0, -14.0, -13.0, 15.0, -34.0, -13.0, -16.0, 0.0, 28.0, -97.0, -48.0, 0.0, -38.0, 0.0, -71.0, -3.0, -35.0, 9.0, -167.0, -17.0, 9.0, 0.0, 0.0, -11.0, 15.0, -21.0, -11.0, -17.0, 3.0, 10.0, -3.0, 0.0, -18.0, -127.0, -46.0, -78.0, -8.0, 0.0, 5.0, -55.0, 16.0, 0.0, 6.0, -157.0, -290.0, -97.0, -77.0, 12.0, 11.0, -3.0, -10.0, 10.0, -157.0, 0.0, -1.0, -6.0, -74.0, -16.0, 10.0, -214.0, -54.0, -128.0, -125.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 0.0, -24.0, 0.0, 0.0, -24.0, -14.0, -36.0, 0.0, 11.0, -16.0, 16.0, 14.0, 0.0, 0.0, 0.0, 0.0, -16.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -56.0, 0.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 0.0, -30.0, -54.0, 0.0, -43.0, -90.0, 0.0, 0.0, -28.0, -46.0, -59.0, -51.0, -54.0, 2.0, 0.0, -18.0, -28.0, -22.0, 0.0, -38.0, -158.0, 0.0, -24.0, 0.0, -15.0, 4.0, 17.0, -22.0, -34.0, 0.0, 7.0, 2.0, 0.0, 16.0, -9.0, -64.0, -75.0, -28.0, -75.0, -54.0, -7.0, -28.0, 0.0, 2.0, -42.0, -9.0, 15.0, -56.0, -12.0, -22.0, -10.0, -34.0, -3.0, 0.0, 0.0, 11.0, 17.0, -92.0, -116.0, -15.0, -82.0, 0.0, 0.0, -98.0, -8.0, 0.0, 0.0, -22.0, -130.0, -11.0, 0.0, -68.0, -2.0, -7.0, 6.0, -126.0, -114.0, 0.0, -34.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, -13.0, 18.0, -54.0, 6.0, -58.0, 18.0, -40.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, -6.0, 0.0, 0.0, -38.0, -2.0, -34.0, -235.0, -38.0, -68.0, 0.0, -156.0, -18.0, 1.0, 0.0, 0.0, 0.0, -4.0, -146.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 6.0, -124.0, -192.0, -186.0, -239.0, -80.0, -64.0, -154.0, 0.0, 4.0, 8.0, 15.0, -102.0, 0.0, -18.0, 0.0, -20.0, 0.0, 10.0, -324.0, -34.0, 0.0, 0.0, -2.0, 0.0, 0.0, -17.0, -148.0, 0.0, -32.0, -7.0, 10.0, 0.0, -168.0, -184.0, -12.0, -164.0, -96.0, -175.0, -60.0, -199.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 12.0, 0.0, 5.0, 8.0, 7.0, 18.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 14.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 28.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 1.0, 0.0, 28.0, 0.0, 27.0, 0.0, 4.0, 41.0, 0.0, 14.0, 0.0, 33.0, 27.0, 0.0, 0.0, 3.0, 9.0, 14.0, 12.0, 0.0, 77.0, 79.0, 12.0, 0.0, 0.0, 10.0, 0.0, 3.0, 17.0, 11.0, 0.0, 4.0, 0.0, 0.0, 5.0, 0.0, 15.0, 56.0, 24.0, 23.0, 28.0, 6.0, 14.0, 0.0, 27.0, 0.0, 9.0, 0.0, 14.0, 20.0, 4.0, 15.0, 17.0, 4.0, 0.0, 0.0, 0.0, 0.0, 111.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 68.0, 0.0, 0.0, 0.0, 81.0, 0.0, 8.0, 35.0, 0.0, 0.0, 10.0, 45.0, 28.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 10.0, 17.0, 0.0, 29.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 19.0, 3.0, 10.0, 132.0, 0.0, 60.0, 20.0, 58.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 73.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 44.0, 115.0, 0.0, 135.0, 2.0, 45.0, 0.0, 77.0, 0.0, 0.0, 49.0, 49.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 33.0, 168.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 74.0, 0.0, 23.0, 0.0, 0.0, 0.0, 138.0, 82.0, 40.0, 95.0, 48.0, 46.0, 88.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.959250484068326, "mean_inference_ms": 2.493504583049348, "mean_action_processing_ms": 0.4498599505207044, "mean_env_wait_ms": 0.34153965574714445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006530165672302246, "StateBufferConnector_ms": 0.004305839538574219, "ViewRequirementAgentConnector_ms": 0.13850295543670654}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -290.0, "episode_return_mean": -27.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.6203874516365, "num_env_steps_trained_throughput_per_sec": 325.6203874516365, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 12066.22, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12066.164, "sample_time_ms": 1577.485, "learn_time_ms": 10471.093, "learn_throughput": 382.004, "synch_weights_time_ms": 13.951}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "f1691_00000", "date": "2024-08-13_16-54-55", "timestamp": 1723582495, "time_this_iter_s": 12.34969186782837, "time_total_s": 987.0730316638947, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b376d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 987.0730316638947, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 67.46111111111111, "ram_util_percent": 83.65555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.816603119710766, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.6634434462855103, "policy_loss": 0.0012128304460987686, "vf_loss": 2.6249098673068656, "vf_explained_var": 0.028694121326719012, "kl": 0.016382225140213893, "entropy": 0.8610818356117874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.776912728821238, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.5262743015768665, "policy_loss": 0.0026022829902580097, "vf_loss": 2.5022941874448583, "vf_explained_var": -6.717348855639261e-09, "kl": 0.012511946949166216, "entropy": 0.1581094875274517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -290.0, "episode_reward_mean": -31.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -36.81, "predator_policy": 21.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, 5.0, -23.0, -10.0, -40.0, -12.0, -5.0, 24.0, -28.0, 11.0, 2.0, 12.0, -68.0, -56.0, -27.0, -14.0, -13.0, 15.0, -34.0, -13.0, -16.0, 0.0, 28.0, -97.0, -48.0, 0.0, -38.0, 0.0, -71.0, -3.0, -35.0, 9.0, -167.0, -17.0, 9.0, 0.0, 0.0, -11.0, 15.0, -21.0, -11.0, -17.0, 3.0, 10.0, -3.0, 0.0, -18.0, -127.0, -46.0, -78.0, -8.0, 0.0, 5.0, -55.0, 16.0, 0.0, 6.0, -157.0, -290.0, -97.0, -77.0, 12.0, 11.0, -3.0, -10.0, 10.0, -157.0, 0.0, -1.0, -6.0, -74.0, -16.0, 10.0, -214.0, -54.0, -128.0, -125.0, 0.0, -29.0, -15.0, 0.0, -16.0, 15.0, 9.0, -48.0, -158.0, -18.0, -251.0, -29.0, -49.0, 14.0, -69.0, 7.0, -9.0, -11.0, -1.0, 16.0, 13.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-51.0, -54.0, 2.0, 0.0, -18.0, -28.0, -22.0, 0.0, -38.0, -158.0, 0.0, -24.0, 0.0, -15.0, 4.0, 17.0, -22.0, -34.0, 0.0, 7.0, 2.0, 0.0, 16.0, -9.0, -64.0, -75.0, -28.0, -75.0, -54.0, -7.0, -28.0, 0.0, 2.0, -42.0, -9.0, 15.0, -56.0, -12.0, -22.0, -10.0, -34.0, -3.0, 0.0, 0.0, 11.0, 17.0, -92.0, -116.0, -15.0, -82.0, 0.0, 0.0, -98.0, -8.0, 0.0, 0.0, -22.0, -130.0, -11.0, 0.0, -68.0, -2.0, -7.0, 6.0, -126.0, -114.0, 0.0, -34.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, -13.0, 18.0, -54.0, 6.0, -58.0, 18.0, -40.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, -6.0, 0.0, 0.0, -38.0, -2.0, -34.0, -235.0, -38.0, -68.0, 0.0, -156.0, -18.0, 1.0, 0.0, 0.0, 0.0, -4.0, -146.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 6.0, -124.0, -192.0, -186.0, -239.0, -80.0, -64.0, -154.0, 0.0, 4.0, 8.0, 15.0, -102.0, 0.0, -18.0, 0.0, -20.0, 0.0, 10.0, -324.0, -34.0, 0.0, 0.0, -2.0, 0.0, 0.0, -17.0, -148.0, 0.0, -32.0, -7.0, 10.0, 0.0, -168.0, -184.0, -12.0, -164.0, -96.0, -175.0, -60.0, -199.0, 0.0, 0.0, 0.0, -204.0, -11.0, -22.0, 0.0, 0.0, 0.0, -45.0, 15.0, 0.0, 9.0, 0.0, 0.0, -96.0, -76.0, -180.0, -62.0, 12.0, -261.0, -174.0, -60.0, 1.0, -372.0, 10.0, -9.0, 15.0, 0.0, -396.0, 1.0, -9.0, 1.0, -20.0, -20.0, -10.0, -2.0, 0.0, 0.0, 16.0, 13.0, 0.0, 0.0, 0.0, 0.0, -15.0], "policy_predator_policy_reward": [27.0, 0.0, 0.0, 3.0, 9.0, 14.0, 12.0, 0.0, 77.0, 79.0, 12.0, 0.0, 0.0, 10.0, 0.0, 3.0, 17.0, 11.0, 0.0, 4.0, 0.0, 0.0, 5.0, 0.0, 15.0, 56.0, 24.0, 23.0, 28.0, 6.0, 14.0, 0.0, 27.0, 0.0, 9.0, 0.0, 14.0, 20.0, 4.0, 15.0, 17.0, 4.0, 0.0, 0.0, 0.0, 0.0, 111.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 68.0, 0.0, 0.0, 0.0, 81.0, 0.0, 8.0, 35.0, 0.0, 0.0, 10.0, 45.0, 28.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 10.0, 17.0, 0.0, 29.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 19.0, 3.0, 10.0, 132.0, 0.0, 60.0, 20.0, 58.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 73.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 44.0, 115.0, 0.0, 135.0, 2.0, 45.0, 0.0, 77.0, 0.0, 0.0, 49.0, 49.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 33.0, 168.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 74.0, 0.0, 23.0, 0.0, 0.0, 0.0, 138.0, 82.0, 40.0, 95.0, 48.0, 46.0, 88.0, 0.0, 0.0, 102.0, 73.0, 7.0, 11.0, 0.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 98.0, 0.0, 1.0, 31.0, 177.0, 7.0, 0.0, 30.0, 127.0, 186.0, 8.0, 0.0, 198.0, 129.0, 6.0, 9.0, 0.0, 10.0, 19.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9572378370631879, "mean_inference_ms": 2.4864877416468283, "mean_action_processing_ms": 0.447783194477357, "mean_env_wait_ms": 0.340632625079864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072335004806518555, "StateBufferConnector_ms": 0.005037188529968262, "ViewRequirementAgentConnector_ms": 0.14382660388946533}, "num_episodes": 22, "episode_return_max": 28.0, "episode_return_min": -290.0, "episode_return_mean": -31.33, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.6839323122924, "num_env_steps_trained_throughput_per_sec": 340.6839323122924, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 12062.307, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12062.253, "sample_time_ms": 1590.761, "learn_time_ms": 10452.402, "learn_throughput": 382.687, "synch_weights_time_ms": 15.038}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "f1691_00000", "date": "2024-08-13_16-55-07", "timestamp": 1723582507, "time_this_iter_s": 11.82356595993042, "time_total_s": 998.8965976238251, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37dbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 998.8965976238251, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 62.6125, "ram_util_percent": 83.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3838537546219647, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.4856666939283805, "policy_loss": -0.0012930482832921877, "vf_loss": 1.4651729142539716, "vf_explained_var": 0.029069872634120718, "kl": 0.0095634912773214, "entropy": 0.8172396558933157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.748125003711887, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.5174453737086089, "policy_loss": 0.0030087873265738523, "vf_loss": 1.4891874957967688, "vf_explained_var": -5.582022288488963e-09, "kl": 0.014777705703068446, "entropy": 0.2601583063503895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -290.0, "episode_reward_mean": -38.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -44.215, "predator_policy": 25.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -48.0, 0.0, -38.0, 0.0, -71.0, -3.0, -35.0, 9.0, -167.0, -17.0, 9.0, 0.0, 0.0, -11.0, 15.0, -21.0, -11.0, -17.0, 3.0, 10.0, -3.0, 0.0, -18.0, -127.0, -46.0, -78.0, -8.0, 0.0, 5.0, -55.0, 16.0, 0.0, 6.0, -157.0, -290.0, -97.0, -77.0, 12.0, 11.0, -3.0, -10.0, 10.0, -157.0, 0.0, -1.0, -6.0, -74.0, -16.0, 10.0, -214.0, -54.0, -128.0, -125.0, 0.0, -29.0, -15.0, 0.0, -16.0, 15.0, 9.0, -48.0, -158.0, -18.0, -251.0, -29.0, -49.0, 14.0, -69.0, 7.0, -9.0, -11.0, -1.0, 16.0, 13.0, 0.0, 0.0, -43.0, 5.0, 11.0, -114.0, -22.0, 6.0, 0.0, -85.0, -254.0, -71.0, -18.0, -48.0, -8.0, -4.0, 12.0, -80.0, -2.0, -46.0, 17.0, -32.0, -280.0, 8.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.0, -116.0, -15.0, -82.0, 0.0, 0.0, -98.0, -8.0, 0.0, 0.0, -22.0, -130.0, -11.0, 0.0, -68.0, -2.0, -7.0, 6.0, -126.0, -114.0, 0.0, -34.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, -13.0, 18.0, -54.0, 6.0, -58.0, 18.0, -40.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, -6.0, 0.0, 0.0, -38.0, -2.0, -34.0, -235.0, -38.0, -68.0, 0.0, -156.0, -18.0, 1.0, 0.0, 0.0, 0.0, -4.0, -146.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 6.0, -124.0, -192.0, -186.0, -239.0, -80.0, -64.0, -154.0, 0.0, 4.0, 8.0, 15.0, -102.0, 0.0, -18.0, 0.0, -20.0, 0.0, 10.0, -324.0, -34.0, 0.0, 0.0, -2.0, 0.0, 0.0, -17.0, -148.0, 0.0, -32.0, -7.0, 10.0, 0.0, -168.0, -184.0, -12.0, -164.0, -96.0, -175.0, -60.0, -199.0, 0.0, 0.0, 0.0, -204.0, -11.0, -22.0, 0.0, 0.0, 0.0, -45.0, 15.0, 0.0, 9.0, 0.0, 0.0, -96.0, -76.0, -180.0, -62.0, 12.0, -261.0, -174.0, -60.0, 1.0, -372.0, 10.0, -9.0, 15.0, 0.0, -396.0, 1.0, -9.0, 1.0, -20.0, -20.0, -10.0, -2.0, 0.0, 0.0, 16.0, 13.0, 0.0, 0.0, 0.0, 0.0, -15.0, -26.0, -73.0, 5.0, 0.0, 0.0, 11.0, 0.0, -235.0, 6.0, -100.0, 9.0, -26.0, 0.0, 0.0, 0.0, -170.0, -214.0, -170.0, -56.0, -170.0, -39.0, 0.0, -310.0, -6.0, -16.0, 0.0, -20.0, 6.0, 12.0, 0.0, -122.0, -48.0, 0.0, -4.0, -110.0, 9.0, 17.0, 0.0, -31.0, -28.0, -140.0, -326.0, -26.0, 13.0, -2.0, 0.0], "policy_predator_policy_reward": [111.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 68.0, 0.0, 0.0, 0.0, 81.0, 0.0, 8.0, 35.0, 0.0, 0.0, 10.0, 45.0, 28.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 10.0, 17.0, 0.0, 29.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 19.0, 3.0, 10.0, 132.0, 0.0, 60.0, 20.0, 58.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 73.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 44.0, 115.0, 0.0, 135.0, 2.0, 45.0, 0.0, 77.0, 0.0, 0.0, 49.0, 49.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 33.0, 168.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 74.0, 0.0, 23.0, 0.0, 0.0, 0.0, 138.0, 82.0, 40.0, 95.0, 48.0, 46.0, 88.0, 0.0, 0.0, 102.0, 73.0, 7.0, 11.0, 0.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 98.0, 0.0, 1.0, 31.0, 177.0, 7.0, 0.0, 30.0, 127.0, 186.0, 8.0, 0.0, 198.0, 129.0, 6.0, 9.0, 0.0, 10.0, 19.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 35.0, 86.0, 50.0, 22.0, 10.0, 13.0, 0.0, 0.0, 0.0, 85.0, 120.0, 10.0, 88.0, 67.0, 11.0, 10.0, 113.0, 155.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 2.0, 28.0, 27.0, 0.0, 0.0, 13.0, 14.0, 14.0, 172.0, 11.0, 10.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9538617439561543, "mean_inference_ms": 2.4791948028707043, "mean_action_processing_ms": 0.4466838433548474, "mean_env_wait_ms": 0.3394479556271714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007107853889465332, "StateBufferConnector_ms": 0.0050089359283447266, "ViewRequirementAgentConnector_ms": 0.11695313453674316}, "num_episodes": 23, "episode_return_max": 17.0, "episode_return_min": -290.0, "episode_return_mean": -38.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.82083970922196, "num_env_steps_trained_throughput_per_sec": 351.82083970922196, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 12006.109, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12006.057, "sample_time_ms": 1632.257, "learn_time_ms": 10354.53, "learn_throughput": 386.304, "synch_weights_time_ms": 15.244}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "f1691_00000", "date": "2024-08-13_16-55-18", "timestamp": 1723582518, "time_this_iter_s": 11.416992902755737, "time_total_s": 1010.3135905265808, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3742820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1010.3135905265808, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 63.2625, "ram_util_percent": 83.38749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.131065361461942, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.8986727168951085, "policy_loss": -0.0010807473621474058, "vf_loss": 1.8732116265902443, "vf_explained_var": 0.0675663123685847, "kl": 0.011650735546015867, "entropy": 0.8537694410987632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4044245927658663, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.349971172607765, "policy_loss": 0.00188663906526195, "vf_loss": 2.3326852944162155, "vf_explained_var": -6.55966461020172e-09, "kl": 0.009012814577927103, "entropy": 0.19819840473472758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -290.0, "episode_reward_mean": -41.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -47.28, "predator_policy": 26.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, 3.0, 10.0, -3.0, 0.0, -18.0, -127.0, -46.0, -78.0, -8.0, 0.0, 5.0, -55.0, 16.0, 0.0, 6.0, -157.0, -290.0, -97.0, -77.0, 12.0, 11.0, -3.0, -10.0, 10.0, -157.0, 0.0, -1.0, -6.0, -74.0, -16.0, 10.0, -214.0, -54.0, -128.0, -125.0, 0.0, -29.0, -15.0, 0.0, -16.0, 15.0, 9.0, -48.0, -158.0, -18.0, -251.0, -29.0, -49.0, 14.0, -69.0, 7.0, -9.0, -11.0, -1.0, 16.0, 13.0, 0.0, 0.0, -43.0, 5.0, 11.0, -114.0, -22.0, 6.0, 0.0, -85.0, -254.0, -71.0, -18.0, -48.0, -8.0, -4.0, 12.0, -80.0, -2.0, -46.0, 17.0, -32.0, -280.0, 8.0, 7.0, 10.0, -1.0, 0.0, -117.0, 7.0, -1.0, 19.0, -30.0, -56.0, -112.0, -1.0, 16.0, -26.0, -5.0, -49.0, -179.0, -1.0, -286.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, -6.0, 0.0, 0.0, -38.0, -2.0, -34.0, -235.0, -38.0, -68.0, 0.0, -156.0, -18.0, 1.0, 0.0, 0.0, 0.0, -4.0, -146.0, 3.0, 16.0, 0.0, 0.0, 0.0, 0.0, 6.0, -124.0, -192.0, -186.0, -239.0, -80.0, -64.0, -154.0, 0.0, 4.0, 8.0, 15.0, -102.0, 0.0, -18.0, 0.0, -20.0, 0.0, 10.0, -324.0, -34.0, 0.0, 0.0, -2.0, 0.0, 0.0, -17.0, -148.0, 0.0, -32.0, -7.0, 10.0, 0.0, -168.0, -184.0, -12.0, -164.0, -96.0, -175.0, -60.0, -199.0, 0.0, 0.0, 0.0, -204.0, -11.0, -22.0, 0.0, 0.0, 0.0, -45.0, 15.0, 0.0, 9.0, 0.0, 0.0, -96.0, -76.0, -180.0, -62.0, 12.0, -261.0, -174.0, -60.0, 1.0, -372.0, 10.0, -9.0, 15.0, 0.0, -396.0, 1.0, -9.0, 1.0, -20.0, -20.0, -10.0, -2.0, 0.0, 0.0, 16.0, 13.0, 0.0, 0.0, 0.0, 0.0, -15.0, -26.0, -73.0, 5.0, 0.0, 0.0, 11.0, 0.0, -235.0, 6.0, -100.0, 9.0, -26.0, 0.0, 0.0, 0.0, -170.0, -214.0, -170.0, -56.0, -170.0, -39.0, 0.0, -310.0, -6.0, -16.0, 0.0, -20.0, 6.0, 12.0, 0.0, -122.0, -48.0, 0.0, -4.0, -110.0, 9.0, 17.0, 0.0, -31.0, -28.0, -140.0, -326.0, -26.0, 13.0, -2.0, 0.0, 0.0, 10.0, -22.0, 0.0, 0.0, 0.0, -68.0, -166.0, 0.0, 0.0, -9.0, 0.0, 11.0, 7.0, 12.0, -88.0, -69.0, -56.0, -224.0, 0.0, -11.0, 0.0, 0.0, 16.0, 0.0, -67.0, -10.0, 0.0, 0.0, -98.0, -125.0, -124.0, -3.0, 0.0, -374.0, -170.0], "policy_predator_policy_reward": [0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 19.0, 3.0, 10.0, 132.0, 0.0, 60.0, 20.0, 58.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 73.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 44.0, 115.0, 0.0, 135.0, 2.0, 45.0, 0.0, 77.0, 0.0, 0.0, 49.0, 49.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 33.0, 168.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 74.0, 0.0, 23.0, 0.0, 0.0, 0.0, 138.0, 82.0, 40.0, 95.0, 48.0, 46.0, 88.0, 0.0, 0.0, 102.0, 73.0, 7.0, 11.0, 0.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 98.0, 0.0, 1.0, 31.0, 177.0, 7.0, 0.0, 30.0, 127.0, 186.0, 8.0, 0.0, 198.0, 129.0, 6.0, 9.0, 0.0, 10.0, 19.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 35.0, 86.0, 50.0, 22.0, 10.0, 13.0, 0.0, 0.0, 0.0, 85.0, 120.0, 10.0, 88.0, 67.0, 11.0, 10.0, 113.0, 155.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 2.0, 28.0, 27.0, 0.0, 0.0, 13.0, 14.0, 14.0, 172.0, 11.0, 10.0, 9.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 69.0, 48.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 2.0, 44.0, 0.0, 69.0, 0.0, 112.0, 0.0, 10.0, 0.0, 0.0, 10.0, 31.0, 5.0, 0.0, 0.0, 49.0, 0.0, 70.0, 2.0, 0.0, 192.0, 66.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9531085929165036, "mean_inference_ms": 2.47343286830936, "mean_action_processing_ms": 0.44400243497960207, "mean_env_wait_ms": 0.33920090778154555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005975246429443359, "StateBufferConnector_ms": 0.006461977958679199, "ViewRequirementAgentConnector_ms": 0.12267756462097168}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -290.0, "episode_return_mean": -41.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8967718350083, "num_env_steps_trained_throughput_per_sec": 323.8967718350083, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 12048.618, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12048.562, "sample_time_ms": 1730.482, "learn_time_ms": 10298.501, "learn_throughput": 388.406, "synch_weights_time_ms": 15.246}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "f1691_00000", "date": "2024-08-13_16-55-31", "timestamp": 1723582531, "time_this_iter_s": 12.411157131195068, "time_total_s": 1022.7247476577759, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3be08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1022.7247476577759, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 63.538888888888906, "ram_util_percent": 83.37777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6627213947672064, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.9997349298189557, "policy_loss": -0.0021937354100700565, "vf_loss": 2.9827035263732626, "vf_explained_var": 0.1057325505390369, "kl": 0.008439015634797885, "entropy": 0.7148051032628963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.641297136460032, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.769303006091446, "policy_loss": 0.0035138337510741417, "vf_loss": 3.7488245252578976, "vf_explained_var": -6.149685572064112e-09, "kl": 0.00992901306442696, "entropy": 0.17810150125167437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -317.0, "episode_reward_mean": -46.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -51.755, "predator_policy": 28.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, -77.0, 12.0, 11.0, -3.0, -10.0, 10.0, -157.0, 0.0, -1.0, -6.0, -74.0, -16.0, 10.0, -214.0, -54.0, -128.0, -125.0, 0.0, -29.0, -15.0, 0.0, -16.0, 15.0, 9.0, -48.0, -158.0, -18.0, -251.0, -29.0, -49.0, 14.0, -69.0, 7.0, -9.0, -11.0, -1.0, 16.0, 13.0, 0.0, 0.0, -43.0, 5.0, 11.0, -114.0, -22.0, 6.0, 0.0, -85.0, -254.0, -71.0, -18.0, -48.0, -8.0, -4.0, 12.0, -80.0, -2.0, -46.0, 17.0, -32.0, -280.0, 8.0, 7.0, 10.0, -1.0, 0.0, -117.0, 7.0, -1.0, 19.0, -30.0, -56.0, -112.0, -1.0, 16.0, -26.0, -5.0, -49.0, -179.0, -1.0, -286.0, -9.0, -176.0, 18.0, 16.0, 16.0, -317.0, -7.0, 7.0, -88.0, -93.0, 0.0, 3.0, -185.0, -274.0, -33.0, 9.0, -10.0, -152.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-80.0, -64.0, -154.0, 0.0, 4.0, 8.0, 15.0, -102.0, 0.0, -18.0, 0.0, -20.0, 0.0, 10.0, -324.0, -34.0, 0.0, 0.0, -2.0, 0.0, 0.0, -17.0, -148.0, 0.0, -32.0, -7.0, 10.0, 0.0, -168.0, -184.0, -12.0, -164.0, -96.0, -175.0, -60.0, -199.0, 0.0, 0.0, 0.0, -204.0, -11.0, -22.0, 0.0, 0.0, 0.0, -45.0, 15.0, 0.0, 9.0, 0.0, 0.0, -96.0, -76.0, -180.0, -62.0, 12.0, -261.0, -174.0, -60.0, 1.0, -372.0, 10.0, -9.0, 15.0, 0.0, -396.0, 1.0, -9.0, 1.0, -20.0, -20.0, -10.0, -2.0, 0.0, 0.0, 16.0, 13.0, 0.0, 0.0, 0.0, 0.0, -15.0, -26.0, -73.0, 5.0, 0.0, 0.0, 11.0, 0.0, -235.0, 6.0, -100.0, 9.0, -26.0, 0.0, 0.0, 0.0, -170.0, -214.0, -170.0, -56.0, -170.0, -39.0, 0.0, -310.0, -6.0, -16.0, 0.0, -20.0, 6.0, 12.0, 0.0, -122.0, -48.0, 0.0, -4.0, -110.0, 9.0, 17.0, 0.0, -31.0, -28.0, -140.0, -326.0, -26.0, 13.0, -2.0, 0.0, 0.0, 10.0, -22.0, 0.0, 0.0, 0.0, -68.0, -166.0, 0.0, 0.0, -9.0, 0.0, 11.0, 7.0, 12.0, -88.0, -69.0, -56.0, -224.0, 0.0, -11.0, 0.0, 0.0, 16.0, 0.0, -67.0, -10.0, 0.0, 0.0, -98.0, -125.0, -124.0, -3.0, 0.0, -374.0, -170.0, -18.0, 0.0, -94.0, -310.0, 14.0, -3.0, 15.0, 1.0, -6.0, 15.0, -240.0, -204.0, -3.0, -18.0, 7.0, 0.0, -60.0, -86.0, 0.0, -186.0, 0.0, 0.0, 3.0, 0.0, -161.0, -107.0, -186.0, -268.0, 0.0, -81.0, 7.0, 0.0, -24.0, 0.0, -126.0, -260.0], "policy_predator_policy_reward": [2.0, 45.0, 0.0, 77.0, 0.0, 0.0, 49.0, 49.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 33.0, 168.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 0.0, 74.0, 0.0, 23.0, 0.0, 0.0, 0.0, 138.0, 82.0, 40.0, 95.0, 48.0, 46.0, 88.0, 0.0, 0.0, 102.0, 73.0, 7.0, 11.0, 0.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 98.0, 0.0, 1.0, 31.0, 177.0, 7.0, 0.0, 30.0, 127.0, 186.0, 8.0, 0.0, 198.0, 129.0, 6.0, 9.0, 0.0, 10.0, 19.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 35.0, 86.0, 50.0, 22.0, 10.0, 13.0, 0.0, 0.0, 0.0, 85.0, 120.0, 10.0, 88.0, 67.0, 11.0, 10.0, 113.0, 155.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 2.0, 28.0, 27.0, 0.0, 0.0, 13.0, 14.0, 14.0, 172.0, 11.0, 10.0, 9.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 69.0, 48.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 2.0, 44.0, 0.0, 69.0, 0.0, 112.0, 0.0, 10.0, 0.0, 0.0, 10.0, 31.0, 5.0, 0.0, 0.0, 49.0, 0.0, 70.0, 2.0, 0.0, 192.0, 66.0, 0.0, 9.0, 133.0, 95.0, 7.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 121.0, 0.0, 14.0, 0.0, 0.0, 11.0, 47.0, 67.0, 26.0, 0.0, 0.0, 0.0, 0.0, 74.0, 9.0, 178.0, 2.0, 48.0, 0.0, 0.0, 2.0, 14.0, 0.0, 41.0, 193.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.951994514388064, "mean_inference_ms": 2.4697500819697846, "mean_action_processing_ms": 0.44268149684109176, "mean_env_wait_ms": 0.33880488495428507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005568504333496094, "StateBufferConnector_ms": 0.006449341773986816, "ViewRequirementAgentConnector_ms": 0.12449121475219727}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -317.0, "episode_return_mean": -46.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.3135793429495, "num_env_steps_trained_throughput_per_sec": 321.3135793429495, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 12065.916, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12065.86, "sample_time_ms": 1732.354, "learn_time_ms": 10314.167, "learn_throughput": 387.816, "synch_weights_time_ms": 15.185}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "f1691_00000", "date": "2024-08-13_16-55-43", "timestamp": 1723582543, "time_this_iter_s": 12.494609355926514, "time_total_s": 1035.2193570137024, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d584c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1035.2193570137024, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 66.53333333333333, "ram_util_percent": 83.40555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9039129987753256, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.065593737899942, "policy_loss": -0.000932947718094857, "vf_loss": 2.0444779820227748, "vf_explained_var": 0.07395123003651856, "kl": 0.009678441655624839, "entropy": 0.6973171849099417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.22460964946914, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.336717723223267, "policy_loss": 0.0022819433281217856, "vf_loss": 2.322420067383499, "vf_explained_var": -9.492591575339989e-09, "kl": 0.007032511449094866, "entropy": 0.22756808693249705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -317.0, "episode_reward_mean": -54.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -55.505, "predator_policy": 28.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, 15.0, 9.0, -48.0, -158.0, -18.0, -251.0, -29.0, -49.0, 14.0, -69.0, 7.0, -9.0, -11.0, -1.0, 16.0, 13.0, 0.0, 0.0, -43.0, 5.0, 11.0, -114.0, -22.0, 6.0, 0.0, -85.0, -254.0, -71.0, -18.0, -48.0, -8.0, -4.0, 12.0, -80.0, -2.0, -46.0, 17.0, -32.0, -280.0, 8.0, 7.0, 10.0, -1.0, 0.0, -117.0, 7.0, -1.0, 19.0, -30.0, -56.0, -112.0, -1.0, 16.0, -26.0, -5.0, -49.0, -179.0, -1.0, -286.0, -9.0, -176.0, 18.0, 16.0, 16.0, -317.0, -7.0, 7.0, -88.0, -93.0, 0.0, 3.0, -185.0, -274.0, -33.0, 9.0, -10.0, -152.0, -58.0, 2.0, 2.0, -248.0, -10.0, 9.0, 1.0, -76.0, -123.0, -1.0, 0.0, -203.0, -41.0, -186.0, -168.0, -98.0, 2.0, 1.0, -97.0, -5.0, -298.0, -96.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -45.0, 15.0, 0.0, 9.0, 0.0, 0.0, -96.0, -76.0, -180.0, -62.0, 12.0, -261.0, -174.0, -60.0, 1.0, -372.0, 10.0, -9.0, 15.0, 0.0, -396.0, 1.0, -9.0, 1.0, -20.0, -20.0, -10.0, -2.0, 0.0, 0.0, 16.0, 13.0, 0.0, 0.0, 0.0, 0.0, -15.0, -26.0, -73.0, 5.0, 0.0, 0.0, 11.0, 0.0, -235.0, 6.0, -100.0, 9.0, -26.0, 0.0, 0.0, 0.0, -170.0, -214.0, -170.0, -56.0, -170.0, -39.0, 0.0, -310.0, -6.0, -16.0, 0.0, -20.0, 6.0, 12.0, 0.0, -122.0, -48.0, 0.0, -4.0, -110.0, 9.0, 17.0, 0.0, -31.0, -28.0, -140.0, -326.0, -26.0, 13.0, -2.0, 0.0, 0.0, 10.0, -22.0, 0.0, 0.0, 0.0, -68.0, -166.0, 0.0, 0.0, -9.0, 0.0, 11.0, 7.0, 12.0, -88.0, -69.0, -56.0, -224.0, 0.0, -11.0, 0.0, 0.0, 16.0, 0.0, -67.0, -10.0, 0.0, 0.0, -98.0, -125.0, -124.0, -3.0, 0.0, -374.0, -170.0, -18.0, 0.0, -94.0, -310.0, 14.0, -3.0, 15.0, 1.0, -6.0, 15.0, -240.0, -204.0, -3.0, -18.0, 7.0, 0.0, -60.0, -86.0, 0.0, -186.0, 0.0, 0.0, 3.0, 0.0, -161.0, -107.0, -186.0, -268.0, 0.0, -81.0, 7.0, 0.0, -24.0, 0.0, -126.0, -260.0, -100.0, -16.0, 0.0, 2.0, -2.0, 3.0, -167.0, -174.0, -12.0, -20.0, -12.0, 15.0, 0.0, 1.0, -14.0, -206.0, -136.0, -82.0, 3.0, -16.0, 0.0, 0.0, -170.0, -118.0, -82.0, 0.0, -122.0, -164.0, -249.0, -94.0, -204.0, 0.0, -1.0, 0.0, 11.0, -24.0, -38.0, -171.0, -2.0, -13.0, -172.0, -262.0, -188.0, -4.0], "policy_predator_policy_reward": [9.0, 20.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, 98.0, 0.0, 1.0, 31.0, 177.0, 7.0, 0.0, 30.0, 127.0, 186.0, 8.0, 0.0, 198.0, 129.0, 6.0, 9.0, 0.0, 10.0, 19.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 35.0, 86.0, 50.0, 22.0, 10.0, 13.0, 0.0, 0.0, 0.0, 85.0, 120.0, 10.0, 88.0, 67.0, 11.0, 10.0, 113.0, 155.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 2.0, 28.0, 27.0, 0.0, 0.0, 13.0, 14.0, 14.0, 172.0, 11.0, 10.0, 9.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 69.0, 48.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 2.0, 44.0, 0.0, 69.0, 0.0, 112.0, 0.0, 10.0, 0.0, 0.0, 10.0, 31.0, 5.0, 0.0, 0.0, 49.0, 0.0, 70.0, 2.0, 0.0, 192.0, 66.0, 0.0, 9.0, 133.0, 95.0, 7.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 121.0, 0.0, 14.0, 0.0, 0.0, 11.0, 47.0, 67.0, 26.0, 0.0, 0.0, 0.0, 0.0, 74.0, 9.0, 178.0, 2.0, 48.0, 0.0, 0.0, 2.0, 14.0, 0.0, 41.0, 193.0, 0.0, 58.0, 0.0, 0.0, 0.0, 1.0, 93.0, 0.0, 21.0, 1.0, 4.0, 2.0, 0.0, 0.0, 41.0, 103.0, 95.0, 0.0, 12.0, 0.0, 0.0, 0.0, 85.0, 0.0, 41.0, 0.0, 2.0, 98.0, 0.0, 175.0, 106.0, 0.0, 0.0, 3.0, 12.0, 2.0, 0.0, 112.0, 0.0, 10.0, 7.0, 129.0, 2.0, 94.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9505418099062493, "mean_inference_ms": 2.4666026000506354, "mean_action_processing_ms": 0.4412926215615747, "mean_env_wait_ms": 0.33835331003513036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00556635856628418, "StateBufferConnector_ms": 0.006371259689331055, "ViewRequirementAgentConnector_ms": 0.12149441242218018}, "num_episodes": 22, "episode_return_max": 19.0, "episode_return_min": -317.0, "episode_return_mean": -54.04, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.7933320865172, "num_env_steps_trained_throughput_per_sec": 325.7933320865172, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 12106.081, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12106.026, "sample_time_ms": 1737.866, "learn_time_ms": 10349.869, "learn_throughput": 386.478, "synch_weights_time_ms": 14.049}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "f1691_00000", "date": "2024-08-13_16-55-55", "timestamp": 1723582555, "time_this_iter_s": 12.311844825744629, "time_total_s": 1047.531201839447, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d58700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1047.531201839447, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 67.33529411764707, "ram_util_percent": 83.62352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.638893295580117, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.8957652151899995, "policy_loss": -0.002227739987663294, "vf_loss": 2.8747028364075553, "vf_explained_var": 0.05047285342342639, "kl": 0.010223371495704842, "entropy": 0.7091241990763043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.207634525635728, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.6264289355782604, "policy_loss": 0.0026926208621324606, "vf_loss": 2.6122603160994395, "vf_explained_var": -6.717348855639261e-09, "kl": 0.006716632347108616, "entropy": 0.21605132473090655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -317.0, "episode_reward_mean": -56.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": -56.84, "predator_policy": 28.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -43.0, 5.0, 11.0, -114.0, -22.0, 6.0, 0.0, -85.0, -254.0, -71.0, -18.0, -48.0, -8.0, -4.0, 12.0, -80.0, -2.0, -46.0, 17.0, -32.0, -280.0, 8.0, 7.0, 10.0, -1.0, 0.0, -117.0, 7.0, -1.0, 19.0, -30.0, -56.0, -112.0, -1.0, 16.0, -26.0, -5.0, -49.0, -179.0, -1.0, -286.0, -9.0, -176.0, 18.0, 16.0, 16.0, -317.0, -7.0, 7.0, -88.0, -93.0, 0.0, 3.0, -185.0, -274.0, -33.0, 9.0, -10.0, -152.0, -58.0, 2.0, 2.0, -248.0, -10.0, 9.0, 1.0, -76.0, -123.0, -1.0, 0.0, -203.0, -41.0, -186.0, -168.0, -98.0, 2.0, 1.0, -97.0, -5.0, -298.0, -96.0, 11.0, 0.0, -136.0, 17.0, -92.0, -85.0, -106.0, -44.0, 0.0, -31.0, -24.0, 6.0, -7.0, -29.0, -82.0, -222.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -15.0, -26.0, -73.0, 5.0, 0.0, 0.0, 11.0, 0.0, -235.0, 6.0, -100.0, 9.0, -26.0, 0.0, 0.0, 0.0, -170.0, -214.0, -170.0, -56.0, -170.0, -39.0, 0.0, -310.0, -6.0, -16.0, 0.0, -20.0, 6.0, 12.0, 0.0, -122.0, -48.0, 0.0, -4.0, -110.0, 9.0, 17.0, 0.0, -31.0, -28.0, -140.0, -326.0, -26.0, 13.0, -2.0, 0.0, 0.0, 10.0, -22.0, 0.0, 0.0, 0.0, -68.0, -166.0, 0.0, 0.0, -9.0, 0.0, 11.0, 7.0, 12.0, -88.0, -69.0, -56.0, -224.0, 0.0, -11.0, 0.0, 0.0, 16.0, 0.0, -67.0, -10.0, 0.0, 0.0, -98.0, -125.0, -124.0, -3.0, 0.0, -374.0, -170.0, -18.0, 0.0, -94.0, -310.0, 14.0, -3.0, 15.0, 1.0, -6.0, 15.0, -240.0, -204.0, -3.0, -18.0, 7.0, 0.0, -60.0, -86.0, 0.0, -186.0, 0.0, 0.0, 3.0, 0.0, -161.0, -107.0, -186.0, -268.0, 0.0, -81.0, 7.0, 0.0, -24.0, 0.0, -126.0, -260.0, -100.0, -16.0, 0.0, 2.0, -2.0, 3.0, -167.0, -174.0, -12.0, -20.0, -12.0, 15.0, 0.0, 1.0, -14.0, -206.0, -136.0, -82.0, 3.0, -16.0, 0.0, 0.0, -170.0, -118.0, -82.0, 0.0, -122.0, -164.0, -249.0, -94.0, -204.0, 0.0, -1.0, 0.0, 11.0, -24.0, -38.0, -171.0, -2.0, -13.0, -172.0, -262.0, -188.0, -4.0, 0.0, 10.0, 0.0, 0.0, -152.0, -124.0, 13.0, 3.0, -48.0, -206.0, -61.0, -175.0, -226.0, 0.0, -36.0, -36.0, 0.0, -8.0, -58.0, -4.0, -22.0, -14.0, 6.0, 0.0, -30.0, 7.0, -240.0, 6.0, -90.0, -99.0, -148.0, -214.0, 3.0, -23.0, 0.0, 0.0], "policy_predator_policy_reward": [14.0, 1.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 35.0, 86.0, 50.0, 22.0, 10.0, 13.0, 0.0, 0.0, 0.0, 85.0, 120.0, 10.0, 88.0, 67.0, 11.0, 10.0, 113.0, 155.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 2.0, 28.0, 27.0, 0.0, 0.0, 13.0, 14.0, 14.0, 172.0, 11.0, 10.0, 9.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 69.0, 48.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 2.0, 44.0, 0.0, 69.0, 0.0, 112.0, 0.0, 10.0, 0.0, 0.0, 10.0, 31.0, 5.0, 0.0, 0.0, 49.0, 0.0, 70.0, 2.0, 0.0, 192.0, 66.0, 0.0, 9.0, 133.0, 95.0, 7.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 121.0, 0.0, 14.0, 0.0, 0.0, 11.0, 47.0, 67.0, 26.0, 0.0, 0.0, 0.0, 0.0, 74.0, 9.0, 178.0, 2.0, 48.0, 0.0, 0.0, 2.0, 14.0, 0.0, 41.0, 193.0, 0.0, 58.0, 0.0, 0.0, 0.0, 1.0, 93.0, 0.0, 21.0, 1.0, 4.0, 2.0, 0.0, 0.0, 41.0, 103.0, 95.0, 0.0, 12.0, 0.0, 0.0, 0.0, 85.0, 0.0, 41.0, 0.0, 2.0, 98.0, 0.0, 175.0, 106.0, 0.0, 0.0, 3.0, 12.0, 2.0, 0.0, 112.0, 0.0, 10.0, 7.0, 129.0, 2.0, 94.0, 0.0, 1.0, 0.0, 0.0, 0.0, 140.0, 1.0, 0.0, 123.0, 39.0, 112.0, 39.0, 77.0, 43.0, 1.0, 27.0, 0.0, 8.0, 0.0, 31.0, 0.0, 12.0, 0.0, 0.0, 16.0, 0.0, 120.0, 85.0, 68.0, 39.0, 140.0, 0.0, 11.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9495754012312259, "mean_inference_ms": 2.461972566321731, "mean_action_processing_ms": 0.4400690259846764, "mean_env_wait_ms": 0.3378582561760659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004982113838195801, "StateBufferConnector_ms": 0.0049283504486083984, "ViewRequirementAgentConnector_ms": 0.1214590072631836}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -317.0, "episode_return_mean": -56.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.93420337055767, "num_env_steps_trained_throughput_per_sec": 340.93420337055767, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 12104.262, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12104.208, "sample_time_ms": 1704.547, "learn_time_ms": 10382.801, "learn_throughput": 385.253, "synch_weights_time_ms": 13.773}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "f1691_00000", "date": "2024-08-13_16-56-07", "timestamp": 1723582567, "time_this_iter_s": 11.79183292388916, "time_total_s": 1059.3230347633362, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37600d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1059.3230347633362, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 65.0235294117647, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.659569718156542, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.7673021305253896, "policy_loss": 0.00014134736130477259, "vf_loss": 0.748616769336775, "vf_explained_var": 0.06856286327044168, "kl": 0.00814003393215233, "entropy": 0.7967248021925568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0260989718257436, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.1463094616811427, "policy_loss": 0.002023755271657907, "vf_loss": 1.1284594215255566, "vf_explained_var": -5.9920013266265704e-09, "kl": 0.009262755465820859, "entropy": 0.19437425409212078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -317.0, "episode_reward_mean": -48.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": -48.13, "predator_policy": 24.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 10.0, -1.0, 0.0, -117.0, 7.0, -1.0, 19.0, -30.0, -56.0, -112.0, -1.0, 16.0, -26.0, -5.0, -49.0, -179.0, -1.0, -286.0, -9.0, -176.0, 18.0, 16.0, 16.0, -317.0, -7.0, 7.0, -88.0, -93.0, 0.0, 3.0, -185.0, -274.0, -33.0, 9.0, -10.0, -152.0, -58.0, 2.0, 2.0, -248.0, -10.0, 9.0, 1.0, -76.0, -123.0, -1.0, 0.0, -203.0, -41.0, -186.0, -168.0, -98.0, 2.0, 1.0, -97.0, -5.0, -298.0, -96.0, 11.0, 0.0, -136.0, 17.0, -92.0, -85.0, -106.0, -44.0, 0.0, -31.0, -24.0, 6.0, -7.0, -29.0, -82.0, -222.0, 0.0, 0.0, 14.0, 17.0, -20.0, 8.0, -30.0, 4.0, 0.0, 16.0, 16.0, 14.0, -2.0, -94.0, -18.0, 27.0, -64.0, -67.0, 15.0, -7.0, 0.0, -40.0, 0.0, 3.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 0.0, 0.0, 10.0, -22.0, 0.0, 0.0, 0.0, -68.0, -166.0, 0.0, 0.0, -9.0, 0.0, 11.0, 7.0, 12.0, -88.0, -69.0, -56.0, -224.0, 0.0, -11.0, 0.0, 0.0, 16.0, 0.0, -67.0, -10.0, 0.0, 0.0, -98.0, -125.0, -124.0, -3.0, 0.0, -374.0, -170.0, -18.0, 0.0, -94.0, -310.0, 14.0, -3.0, 15.0, 1.0, -6.0, 15.0, -240.0, -204.0, -3.0, -18.0, 7.0, 0.0, -60.0, -86.0, 0.0, -186.0, 0.0, 0.0, 3.0, 0.0, -161.0, -107.0, -186.0, -268.0, 0.0, -81.0, 7.0, 0.0, -24.0, 0.0, -126.0, -260.0, -100.0, -16.0, 0.0, 2.0, -2.0, 3.0, -167.0, -174.0, -12.0, -20.0, -12.0, 15.0, 0.0, 1.0, -14.0, -206.0, -136.0, -82.0, 3.0, -16.0, 0.0, 0.0, -170.0, -118.0, -82.0, 0.0, -122.0, -164.0, -249.0, -94.0, -204.0, 0.0, -1.0, 0.0, 11.0, -24.0, -38.0, -171.0, -2.0, -13.0, -172.0, -262.0, -188.0, -4.0, 0.0, 10.0, 0.0, 0.0, -152.0, -124.0, 13.0, 3.0, -48.0, -206.0, -61.0, -175.0, -226.0, 0.0, -36.0, -36.0, 0.0, -8.0, -58.0, -4.0, -22.0, -14.0, 6.0, 0.0, -30.0, 7.0, -240.0, 6.0, -90.0, -99.0, -148.0, -214.0, 3.0, -23.0, 0.0, 0.0, -21.0, 16.0, 0.0, 17.0, 0.0, -40.0, 2.0, 2.0, 0.0, -136.0, 0.0, 1.0, 0.0, 0.0, 16.0, 0.0, 0.0, 16.0, 0.0, 14.0, -4.0, 0.0, -168.0, -20.0, -36.0, -20.0, 12.0, 15.0, -43.0, -62.0, -47.0, -80.0, 10.0, 2.0, -2.0, -10.0, 0.0, 0.0, -32.0, -48.0, -10.0, 0.0, 1.0, 2.0, 2.0, 0.0], "policy_predator_policy_reward": [9.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 69.0, 48.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 2.0, 44.0, 0.0, 69.0, 0.0, 112.0, 0.0, 10.0, 0.0, 0.0, 10.0, 31.0, 5.0, 0.0, 0.0, 49.0, 0.0, 70.0, 2.0, 0.0, 192.0, 66.0, 0.0, 9.0, 133.0, 95.0, 7.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 121.0, 0.0, 14.0, 0.0, 0.0, 11.0, 47.0, 67.0, 26.0, 0.0, 0.0, 0.0, 0.0, 74.0, 9.0, 178.0, 2.0, 48.0, 0.0, 0.0, 2.0, 14.0, 0.0, 41.0, 193.0, 0.0, 58.0, 0.0, 0.0, 0.0, 1.0, 93.0, 0.0, 21.0, 1.0, 4.0, 2.0, 0.0, 0.0, 41.0, 103.0, 95.0, 0.0, 12.0, 0.0, 0.0, 0.0, 85.0, 0.0, 41.0, 0.0, 2.0, 98.0, 0.0, 175.0, 106.0, 0.0, 0.0, 3.0, 12.0, 2.0, 0.0, 112.0, 0.0, 10.0, 7.0, 129.0, 2.0, 94.0, 0.0, 1.0, 0.0, 0.0, 0.0, 140.0, 1.0, 0.0, 123.0, 39.0, 112.0, 39.0, 77.0, 43.0, 1.0, 27.0, 0.0, 8.0, 0.0, 31.0, 0.0, 12.0, 0.0, 0.0, 16.0, 0.0, 120.0, 85.0, 68.0, 39.0, 140.0, 0.0, 11.0, 9.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 20.0, 4.0, 0.0, 68.0, 38.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 55.0, 39.0, 10.0, 28.0, 0.0, 0.0, 41.0, 0.0, 57.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9476190746108761, "mean_inference_ms": 2.45660077462372, "mean_action_processing_ms": 0.43836690515650345, "mean_env_wait_ms": 0.33717439403331084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004730582237243652, "StateBufferConnector_ms": 0.004960894584655762, "ViewRequirementAgentConnector_ms": 0.12563812732696533}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -317.0, "episode_return_mean": -48.01, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.8375065551666, "num_env_steps_trained_throughput_per_sec": 336.8375065551666, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 12036.738, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12036.683, "sample_time_ms": 1613.867, "learn_time_ms": 10405.757, "learn_throughput": 384.403, "synch_weights_time_ms": 13.991}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "f1691_00000", "date": "2024-08-13_16-56-19", "timestamp": 1723582579, "time_this_iter_s": 11.926987171173096, "time_total_s": 1071.2500219345093, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37601f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1071.2500219345093, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 69.43529411764706, "ram_util_percent": 83.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6125321364434306, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.031638197387968, "policy_loss": -0.0011684895579323724, "vf_loss": 2.0087071695655743, "vf_explained_var": 0.033299642738211094, "kl": 0.010578663468900268, "entropy": 0.7250322772712304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.741991748625324, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.1602606213282023, "policy_loss": 0.001796633083737953, "vf_loss": 2.1414667476106573, "vf_explained_var": -4.951285306738798e-09, "kl": 0.00994808391266453, "entropy": 0.1845196158068363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -317.0, "episode_reward_mean": -52.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": -53.33, "predator_policy": 26.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.0, -9.0, -176.0, 18.0, 16.0, 16.0, -317.0, -7.0, 7.0, -88.0, -93.0, 0.0, 3.0, -185.0, -274.0, -33.0, 9.0, -10.0, -152.0, -58.0, 2.0, 2.0, -248.0, -10.0, 9.0, 1.0, -76.0, -123.0, -1.0, 0.0, -203.0, -41.0, -186.0, -168.0, -98.0, 2.0, 1.0, -97.0, -5.0, -298.0, -96.0, 11.0, 0.0, -136.0, 17.0, -92.0, -85.0, -106.0, -44.0, 0.0, -31.0, -24.0, 6.0, -7.0, -29.0, -82.0, -222.0, 0.0, 0.0, 14.0, 17.0, -20.0, 8.0, -30.0, 4.0, 0.0, 16.0, 16.0, 14.0, -2.0, -94.0, -18.0, 27.0, -64.0, -67.0, 15.0, -7.0, 0.0, -40.0, 0.0, 3.0, 2.0, -9.0, 3.0, -24.0, -166.0, -78.0, -101.0, -100.0, -10.0, -85.0, 0.0, -102.0, -3.0, -23.0, -99.0, -115.0, -92.0, 7.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-374.0, -170.0, -18.0, 0.0, -94.0, -310.0, 14.0, -3.0, 15.0, 1.0, -6.0, 15.0, -240.0, -204.0, -3.0, -18.0, 7.0, 0.0, -60.0, -86.0, 0.0, -186.0, 0.0, 0.0, 3.0, 0.0, -161.0, -107.0, -186.0, -268.0, 0.0, -81.0, 7.0, 0.0, -24.0, 0.0, -126.0, -260.0, -100.0, -16.0, 0.0, 2.0, -2.0, 3.0, -167.0, -174.0, -12.0, -20.0, -12.0, 15.0, 0.0, 1.0, -14.0, -206.0, -136.0, -82.0, 3.0, -16.0, 0.0, 0.0, -170.0, -118.0, -82.0, 0.0, -122.0, -164.0, -249.0, -94.0, -204.0, 0.0, -1.0, 0.0, 11.0, -24.0, -38.0, -171.0, -2.0, -13.0, -172.0, -262.0, -188.0, -4.0, 0.0, 10.0, 0.0, 0.0, -152.0, -124.0, 13.0, 3.0, -48.0, -206.0, -61.0, -175.0, -226.0, 0.0, -36.0, -36.0, 0.0, -8.0, -58.0, -4.0, -22.0, -14.0, 6.0, 0.0, -30.0, 7.0, -240.0, 6.0, -90.0, -99.0, -148.0, -214.0, 3.0, -23.0, 0.0, 0.0, -21.0, 16.0, 0.0, 17.0, 0.0, -40.0, 2.0, 2.0, 0.0, -136.0, 0.0, 1.0, 0.0, 0.0, 16.0, 0.0, 0.0, 16.0, 0.0, 14.0, -4.0, 0.0, -168.0, -20.0, -36.0, -20.0, 12.0, 15.0, -43.0, -62.0, -47.0, -80.0, 10.0, 2.0, -2.0, -10.0, 0.0, 0.0, -32.0, -48.0, -10.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, -18.0, 0.0, -1.0, -10.0, -72.0, -10.0, -328.0, -57.0, -66.0, -122.0, -80.0, -222.0, 11.0, -4.0, -16.0, -332.0, 0.0, 0.0, 0.0, -180.0, -12.0, 3.0, -17.0, 0.0, -54.0, -58.0, -90.0, -74.0, -82.0, -96.0, -154.0, 0.0, 7.0, 8.0, 0.0], "policy_predator_policy_reward": [192.0, 66.0, 0.0, 9.0, 133.0, 95.0, 7.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 121.0, 0.0, 14.0, 0.0, 0.0, 11.0, 47.0, 67.0, 26.0, 0.0, 0.0, 0.0, 0.0, 74.0, 9.0, 178.0, 2.0, 48.0, 0.0, 0.0, 2.0, 14.0, 0.0, 41.0, 193.0, 0.0, 58.0, 0.0, 0.0, 0.0, 1.0, 93.0, 0.0, 21.0, 1.0, 4.0, 2.0, 0.0, 0.0, 41.0, 103.0, 95.0, 0.0, 12.0, 0.0, 0.0, 0.0, 85.0, 0.0, 41.0, 0.0, 2.0, 98.0, 0.0, 175.0, 106.0, 0.0, 0.0, 3.0, 12.0, 2.0, 0.0, 112.0, 0.0, 10.0, 7.0, 129.0, 2.0, 94.0, 0.0, 1.0, 0.0, 0.0, 0.0, 140.0, 1.0, 0.0, 123.0, 39.0, 112.0, 39.0, 77.0, 43.0, 1.0, 27.0, 0.0, 8.0, 0.0, 31.0, 0.0, 12.0, 0.0, 0.0, 16.0, 0.0, 120.0, 85.0, 68.0, 39.0, 140.0, 0.0, 11.0, 9.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 20.0, 4.0, 0.0, 68.0, 38.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 55.0, 39.0, 10.0, 28.0, 0.0, 0.0, 41.0, 0.0, 57.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 4.0, 22.0, 36.0, 8.0, 164.0, 45.0, 0.0, 101.0, 0.0, 100.0, 11.0, 4.0, 6.0, 81.0, 166.0, 0.0, 0.0, 0.0, 90.0, 11.0, 0.0, 31.0, 0.0, 49.0, 0.0, 41.0, 0.0, 77.0, 81.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9451243221673807, "mean_inference_ms": 2.4509281280185315, "mean_action_processing_ms": 0.43684747165799087, "mean_env_wait_ms": 0.3364673774367401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004837632179260254, "StateBufferConnector_ms": 0.003235340118408203, "ViewRequirementAgentConnector_ms": 0.12355279922485352}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -317.0, "episode_return_mean": -52.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.20920119259216, "num_env_steps_trained_throughput_per_sec": 324.20920119259216, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 12063.11, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12063.055, "sample_time_ms": 1643.131, "learn_time_ms": 10402.856, "learn_throughput": 384.51, "synch_weights_time_ms": 13.999}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "f1691_00000", "date": "2024-08-13_16-56-32", "timestamp": 1723582592, "time_this_iter_s": 12.404194116592407, "time_total_s": 1083.6542160511017, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3be0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1083.6542160511017, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 68.51764705882353, "ram_util_percent": 83.45294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.773152850103126, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.00699608748552, "policy_loss": -0.0015848974202064769, "vf_loss": 1.9874904031476015, "vf_explained_var": 0.02349487823784036, "kl": 0.009257867543741204, "entropy": 0.7716522879070706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4075814651926515, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.165008065309474, "policy_loss": 0.0024956003898291518, "vf_loss": 3.1521759108891563, "vf_explained_var": -7.537306931914476e-09, "kl": 0.006049744065220003, "entropy": 0.1777668879209727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -298.0, "episode_reward_mean": -51.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -332.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": -51.855, "predator_policy": 25.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-248.0, -10.0, 9.0, 1.0, -76.0, -123.0, -1.0, 0.0, -203.0, -41.0, -186.0, -168.0, -98.0, 2.0, 1.0, -97.0, -5.0, -298.0, -96.0, 11.0, 0.0, -136.0, 17.0, -92.0, -85.0, -106.0, -44.0, 0.0, -31.0, -24.0, 6.0, -7.0, -29.0, -82.0, -222.0, 0.0, 0.0, 14.0, 17.0, -20.0, 8.0, -30.0, 4.0, 0.0, 16.0, 16.0, 14.0, -2.0, -94.0, -18.0, 27.0, -64.0, -67.0, 15.0, -7.0, 0.0, -40.0, 0.0, 3.0, 2.0, -9.0, 3.0, -24.0, -166.0, -78.0, -101.0, -100.0, -10.0, -85.0, 0.0, -102.0, -3.0, -23.0, -99.0, -115.0, -92.0, 7.0, 8.0, -179.0, 3.0, 1.0, 13.0, -11.0, -288.0, -12.0, -123.0, 7.0, -10.0, -20.0, -2.0, -62.0, -16.0, -1.0, -190.0, 15.0, -110.0, -12.0, -157.0, -209.0, -155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-167.0, -174.0, -12.0, -20.0, -12.0, 15.0, 0.0, 1.0, -14.0, -206.0, -136.0, -82.0, 3.0, -16.0, 0.0, 0.0, -170.0, -118.0, -82.0, 0.0, -122.0, -164.0, -249.0, -94.0, -204.0, 0.0, -1.0, 0.0, 11.0, -24.0, -38.0, -171.0, -2.0, -13.0, -172.0, -262.0, -188.0, -4.0, 0.0, 10.0, 0.0, 0.0, -152.0, -124.0, 13.0, 3.0, -48.0, -206.0, -61.0, -175.0, -226.0, 0.0, -36.0, -36.0, 0.0, -8.0, -58.0, -4.0, -22.0, -14.0, 6.0, 0.0, -30.0, 7.0, -240.0, 6.0, -90.0, -99.0, -148.0, -214.0, 3.0, -23.0, 0.0, 0.0, -21.0, 16.0, 0.0, 17.0, 0.0, -40.0, 2.0, 2.0, 0.0, -136.0, 0.0, 1.0, 0.0, 0.0, 16.0, 0.0, 0.0, 16.0, 0.0, 14.0, -4.0, 0.0, -168.0, -20.0, -36.0, -20.0, 12.0, 15.0, -43.0, -62.0, -47.0, -80.0, 10.0, 2.0, -2.0, -10.0, 0.0, 0.0, -32.0, -48.0, -10.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, -18.0, 0.0, -1.0, -10.0, -72.0, -10.0, -328.0, -57.0, -66.0, -122.0, -80.0, -222.0, 11.0, -4.0, -16.0, -332.0, 0.0, 0.0, 0.0, -180.0, -12.0, 3.0, -17.0, 0.0, -54.0, -58.0, -90.0, -74.0, -82.0, -96.0, -154.0, 0.0, 7.0, 8.0, 0.0, -274.0, -94.0, -8.0, 2.0, 0.0, 1.0, 13.0, 0.0, -21.0, -4.0, -216.0, -186.0, 0.0, -32.0, -148.0, -84.0, -5.0, 0.0, -20.0, 0.0, -49.0, 0.0, 1.0, -6.0, -22.0, -109.0, 0.0, -32.0, -2.0, 0.0, -164.0, -108.0, 15.0, 0.0, -100.0, -120.0, -20.0, -4.0, -150.0, -116.0, -172.0, -247.0, -176.0, -84.0], "policy_predator_policy_reward": [93.0, 0.0, 21.0, 1.0, 4.0, 2.0, 0.0, 0.0, 41.0, 103.0, 95.0, 0.0, 12.0, 0.0, 0.0, 0.0, 85.0, 0.0, 41.0, 0.0, 2.0, 98.0, 0.0, 175.0, 106.0, 0.0, 0.0, 3.0, 12.0, 2.0, 0.0, 112.0, 0.0, 10.0, 7.0, 129.0, 2.0, 94.0, 0.0, 1.0, 0.0, 0.0, 0.0, 140.0, 1.0, 0.0, 123.0, 39.0, 112.0, 39.0, 77.0, 43.0, 1.0, 27.0, 0.0, 8.0, 0.0, 31.0, 0.0, 12.0, 0.0, 0.0, 16.0, 0.0, 120.0, 85.0, 68.0, 39.0, 140.0, 0.0, 11.0, 9.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 20.0, 4.0, 0.0, 68.0, 38.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 55.0, 39.0, 10.0, 28.0, 0.0, 0.0, 41.0, 0.0, 57.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 4.0, 22.0, 36.0, 8.0, 164.0, 45.0, 0.0, 101.0, 0.0, 100.0, 11.0, 4.0, 6.0, 81.0, 166.0, 0.0, 0.0, 0.0, 90.0, 11.0, 0.0, 31.0, 0.0, 49.0, 0.0, 41.0, 0.0, 77.0, 81.0, 0.0, 0.0, 0.0, 0.0, 61.0, 128.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 110.0, 4.0, 0.0, 20.0, 0.0, 109.0, 0.0, 12.0, 10.0, 0.0, 0.0, 29.0, 3.0, 0.0, 69.0, 0.0, 16.0, 0.0, 1.0, 0.0, 0.0, 82.0, 0.0, 0.0, 0.0, 110.0, 12.0, 0.0, 0.0, 109.0, 124.0, 86.0, 0.0, 105.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9421244724371072, "mean_inference_ms": 2.445537443724008, "mean_action_processing_ms": 0.43519531327148897, "mean_env_wait_ms": 0.3356324776020256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047109127044677734, "StateBufferConnector_ms": 0.003264784812927246, "ViewRequirementAgentConnector_ms": 0.128196120262146}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -298.0, "episode_return_mean": -51.74, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.8852567275522, "num_env_steps_trained_throughput_per_sec": 318.8852567275522, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 12096.013, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12095.961, "sample_time_ms": 1649.181, "learn_time_ms": 10427.434, "learn_throughput": 383.603, "synch_weights_time_ms": 16.386}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "f1691_00000", "date": "2024-08-13_16-56-44", "timestamp": 1723582604, "time_this_iter_s": 12.622305154800415, "time_total_s": 1096.276521205902, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d0f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1096.276521205902, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 66.88333333333333, "ram_util_percent": 83.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9356893358722567, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.9681201367781906, "policy_loss": -0.0011503954299740375, "vf_loss": 1.950375111140902, "vf_explained_var": 0.0886684378303548, "kl": 0.008294286761590056, "entropy": 0.7276746076250833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5042130880176074, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.027442637700883, "policy_loss": 0.0039942784200387976, "vf_loss": 2.9999253210567294, "vf_explained_var": -5.613559137576472e-09, "kl": 0.013767488285795623, "entropy": 0.22650916096483353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -288.0, "episode_reward_mean": -42.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -332.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": -44.98, "predator_policy": 23.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.0, 11.0, 0.0, -136.0, 17.0, -92.0, -85.0, -106.0, -44.0, 0.0, -31.0, -24.0, 6.0, -7.0, -29.0, -82.0, -222.0, 0.0, 0.0, 14.0, 17.0, -20.0, 8.0, -30.0, 4.0, 0.0, 16.0, 16.0, 14.0, -2.0, -94.0, -18.0, 27.0, -64.0, -67.0, 15.0, -7.0, 0.0, -40.0, 0.0, 3.0, 2.0, -9.0, 3.0, -24.0, -166.0, -78.0, -101.0, -100.0, -10.0, -85.0, 0.0, -102.0, -3.0, -23.0, -99.0, -115.0, -92.0, 7.0, 8.0, -179.0, 3.0, 1.0, 13.0, -11.0, -288.0, -12.0, -123.0, 7.0, -10.0, -20.0, -2.0, -62.0, -16.0, -1.0, -190.0, 15.0, -110.0, -12.0, -157.0, -209.0, -155.0, -1.0, -124.0, -13.0, -141.0, 0.0, 2.0, -12.0, 3.0, -62.0, 17.0, 1.0, -166.0, 2.0, -10.0, -41.0, 18.0, -144.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-188.0, -4.0, 0.0, 10.0, 0.0, 0.0, -152.0, -124.0, 13.0, 3.0, -48.0, -206.0, -61.0, -175.0, -226.0, 0.0, -36.0, -36.0, 0.0, -8.0, -58.0, -4.0, -22.0, -14.0, 6.0, 0.0, -30.0, 7.0, -240.0, 6.0, -90.0, -99.0, -148.0, -214.0, 3.0, -23.0, 0.0, 0.0, -21.0, 16.0, 0.0, 17.0, 0.0, -40.0, 2.0, 2.0, 0.0, -136.0, 0.0, 1.0, 0.0, 0.0, 16.0, 0.0, 0.0, 16.0, 0.0, 14.0, -4.0, 0.0, -168.0, -20.0, -36.0, -20.0, 12.0, 15.0, -43.0, -62.0, -47.0, -80.0, 10.0, 2.0, -2.0, -10.0, 0.0, 0.0, -32.0, -48.0, -10.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, -18.0, 0.0, -1.0, -10.0, -72.0, -10.0, -328.0, -57.0, -66.0, -122.0, -80.0, -222.0, 11.0, -4.0, -16.0, -332.0, 0.0, 0.0, 0.0, -180.0, -12.0, 3.0, -17.0, 0.0, -54.0, -58.0, -90.0, -74.0, -82.0, -96.0, -154.0, 0.0, 7.0, 8.0, 0.0, -274.0, -94.0, -8.0, 2.0, 0.0, 1.0, 13.0, 0.0, -21.0, -4.0, -216.0, -186.0, 0.0, -32.0, -148.0, -84.0, -5.0, 0.0, -20.0, 0.0, -49.0, 0.0, 1.0, -6.0, -22.0, -109.0, 0.0, -32.0, -2.0, 0.0, -164.0, -108.0, 15.0, 0.0, -100.0, -120.0, -20.0, -4.0, -150.0, -116.0, -172.0, -247.0, -176.0, -84.0, -2.0, 0.0, -254.0, -2.0, -35.0, -3.0, -94.0, -94.0, 0.0, 0.0, 0.0, -5.0, -24.0, 0.0, 0.0, 3.0, 0.0, -126.0, 0.0, 17.0, 0.0, -8.0, -197.0, -114.0, -1.0, 0.0, -38.0, 9.0, -20.0, -69.0, 18.0, 0.0, -106.0, -182.0, 0.0, 7.0], "policy_predator_policy_reward": [2.0, 94.0, 0.0, 1.0, 0.0, 0.0, 0.0, 140.0, 1.0, 0.0, 123.0, 39.0, 112.0, 39.0, 77.0, 43.0, 1.0, 27.0, 0.0, 8.0, 0.0, 31.0, 0.0, 12.0, 0.0, 0.0, 16.0, 0.0, 120.0, 85.0, 68.0, 39.0, 140.0, 0.0, 11.0, 9.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 20.0, 4.0, 0.0, 68.0, 38.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 55.0, 39.0, 10.0, 28.0, 0.0, 0.0, 41.0, 0.0, 57.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 4.0, 22.0, 36.0, 8.0, 164.0, 45.0, 0.0, 101.0, 0.0, 100.0, 11.0, 4.0, 6.0, 81.0, 166.0, 0.0, 0.0, 0.0, 90.0, 11.0, 0.0, 31.0, 0.0, 49.0, 0.0, 41.0, 0.0, 77.0, 81.0, 0.0, 0.0, 0.0, 0.0, 61.0, 128.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 110.0, 4.0, 0.0, 20.0, 0.0, 109.0, 0.0, 12.0, 10.0, 0.0, 0.0, 29.0, 3.0, 0.0, 69.0, 0.0, 16.0, 0.0, 1.0, 0.0, 0.0, 82.0, 0.0, 0.0, 0.0, 110.0, 12.0, 0.0, 0.0, 109.0, 124.0, 86.0, 0.0, 105.0, 0.0, 1.0, 117.0, 15.0, 5.0, 20.0, 47.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 4.0, 0.0, 0.0, 59.0, 5.0, 0.0, 0.0, 9.0, 0.0, 142.0, 3.0, 0.0, 3.0, 6.0, 13.0, 0.0, 48.0, 0.0, 0.0, 142.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9399866094808962, "mean_inference_ms": 2.4400000358611726, "mean_action_processing_ms": 0.43378636934002884, "mean_env_wait_ms": 0.33484902589587284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004182338714599609, "StateBufferConnector_ms": 0.0032578706741333008, "ViewRequirementAgentConnector_ms": 0.14674460887908936}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -288.0, "episode_return_mean": -42.97, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.29672614867644, "num_env_steps_trained_throughput_per_sec": 341.29672614867644, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 12039.589, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12039.537, "sample_time_ms": 1670.91, "learn_time_ms": 10349.305, "learn_throughput": 386.499, "synch_weights_time_ms": 16.423}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "f1691_00000", "date": "2024-08-13_16-56-56", "timestamp": 1723582616, "time_this_iter_s": 11.771232843399048, "time_total_s": 1108.0477540493011, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfb040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1108.0477540493011, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 64.47058823529412, "ram_util_percent": 83.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8497498074063548, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.4544554331945996, "policy_loss": -0.0026832831762336863, "vf_loss": 2.4337306134284487, "vf_explained_var": 0.11947298097232031, "kl": 0.010275158859904448, "entropy": 0.6964750160931279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1681207579397967, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.9835962539627436, "policy_loss": 0.004480695008625468, "vf_loss": 2.9546120925555153, "vf_explained_var": -6.118148722976604e-09, "kl": 0.014341300387448047, "entropy": 0.19744385079574334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -321.0, "episode_reward_mean": -53.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -348.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 183.0}, "policy_reward_mean": {"prey_policy": -51.915, "predator_policy": 25.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 4.0, 0.0, 16.0, 16.0, 14.0, -2.0, -94.0, -18.0, 27.0, -64.0, -67.0, 15.0, -7.0, 0.0, -40.0, 0.0, 3.0, 2.0, -9.0, 3.0, -24.0, -166.0, -78.0, -101.0, -100.0, -10.0, -85.0, 0.0, -102.0, -3.0, -23.0, -99.0, -115.0, -92.0, 7.0, 8.0, -179.0, 3.0, 1.0, 13.0, -11.0, -288.0, -12.0, -123.0, 7.0, -10.0, -20.0, -2.0, -62.0, -16.0, -1.0, -190.0, 15.0, -110.0, -12.0, -157.0, -209.0, -155.0, -1.0, -124.0, -13.0, -141.0, 0.0, 2.0, -12.0, 3.0, -62.0, 17.0, 1.0, -166.0, 2.0, -10.0, -41.0, 18.0, -144.0, 7.0, -43.0, -125.0, -7.0, 18.0, -9.0, -75.0, 0.0, 4.0, -262.0, -112.0, -9.0, -273.0, -129.0, 15.0, -321.0, -213.0, 17.0, -143.0, -55.0, 4.0, -34.0, -174.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -136.0, 0.0, 1.0, 0.0, 0.0, 16.0, 0.0, 0.0, 16.0, 0.0, 14.0, -4.0, 0.0, -168.0, -20.0, -36.0, -20.0, 12.0, 15.0, -43.0, -62.0, -47.0, -80.0, 10.0, 2.0, -2.0, -10.0, 0.0, 0.0, -32.0, -48.0, -10.0, 0.0, 1.0, 2.0, 2.0, 0.0, 0.0, -18.0, 0.0, -1.0, -10.0, -72.0, -10.0, -328.0, -57.0, -66.0, -122.0, -80.0, -222.0, 11.0, -4.0, -16.0, -332.0, 0.0, 0.0, 0.0, -180.0, -12.0, 3.0, -17.0, 0.0, -54.0, -58.0, -90.0, -74.0, -82.0, -96.0, -154.0, 0.0, 7.0, 8.0, 0.0, -274.0, -94.0, -8.0, 2.0, 0.0, 1.0, 13.0, 0.0, -21.0, -4.0, -216.0, -186.0, 0.0, -32.0, -148.0, -84.0, -5.0, 0.0, -20.0, 0.0, -49.0, 0.0, 1.0, -6.0, -22.0, -109.0, 0.0, -32.0, -2.0, 0.0, -164.0, -108.0, 15.0, 0.0, -100.0, -120.0, -20.0, -4.0, -150.0, -116.0, -172.0, -247.0, -176.0, -84.0, -2.0, 0.0, -254.0, -2.0, -35.0, -3.0, -94.0, -94.0, 0.0, 0.0, 0.0, -5.0, -24.0, 0.0, 0.0, 3.0, 0.0, -126.0, 0.0, 17.0, 0.0, -8.0, -197.0, -114.0, -1.0, 0.0, -38.0, 9.0, -20.0, -69.0, 18.0, 0.0, -106.0, -182.0, 0.0, 7.0, 11.0, -110.0, -178.0, -122.0, -4.0, -20.0, 18.0, 0.0, 0.0, -21.0, -42.0, -108.0, 0.0, 0.0, 0.0, 4.0, -154.0, -235.0, -65.0, -94.0, -21.0, 0.0, -226.0, -176.0, -143.0, -120.0, 0.0, 15.0, -288.0, -216.0, -148.0, -149.0, 17.0, 0.0, -150.0, -80.0, -314.0, 0.0, 4.0, 0.0, -68.0, 0.0, -348.0, 0.0, -54.0, 16.0], "policy_predator_policy_reward": [68.0, 38.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 55.0, 39.0, 10.0, 28.0, 0.0, 0.0, 41.0, 0.0, 57.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 4.0, 22.0, 36.0, 8.0, 164.0, 45.0, 0.0, 101.0, 0.0, 100.0, 11.0, 4.0, 6.0, 81.0, 166.0, 0.0, 0.0, 0.0, 90.0, 11.0, 0.0, 31.0, 0.0, 49.0, 0.0, 41.0, 0.0, 77.0, 81.0, 0.0, 0.0, 0.0, 0.0, 61.0, 128.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 110.0, 4.0, 0.0, 20.0, 0.0, 109.0, 0.0, 12.0, 10.0, 0.0, 0.0, 29.0, 3.0, 0.0, 69.0, 0.0, 16.0, 0.0, 1.0, 0.0, 0.0, 82.0, 0.0, 0.0, 0.0, 110.0, 12.0, 0.0, 0.0, 109.0, 124.0, 86.0, 0.0, 105.0, 0.0, 1.0, 117.0, 15.0, 5.0, 20.0, 47.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 4.0, 0.0, 0.0, 59.0, 5.0, 0.0, 0.0, 9.0, 0.0, 142.0, 3.0, 0.0, 3.0, 6.0, 13.0, 0.0, 48.0, 0.0, 0.0, 142.0, 2.0, 0.0, 0.0, 0.0, 56.0, 99.0, 76.0, 5.0, 12.0, 0.0, 0.0, 12.0, 0.0, 21.0, 54.0, 0.0, 0.0, 0.0, 0.0, 117.0, 10.0, 0.0, 47.0, 12.0, 0.0, 7.0, 122.0, 134.0, 0.0, 0.0, 0.0, 183.0, 0.0, 74.0, 10.0, 0.0, 0.0, 11.0, 76.0, 102.0, 157.0, 0.0, 0.0, 34.0, 0.0, 0.0, 174.0, 27.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9385175716735182, "mean_inference_ms": 2.4412095875702597, "mean_action_processing_ms": 0.4339565779607208, "mean_env_wait_ms": 0.3344514376468981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041266679763793945, "StateBufferConnector_ms": 0.0031588077545166016, "ViewRequirementAgentConnector_ms": 0.15172171592712402}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -321.0, "episode_return_mean": -53.33, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.81787797879326, "num_env_steps_trained_throughput_per_sec": 318.81787797879326, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 12120.115, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12120.063, "sample_time_ms": 1792.501, "learn_time_ms": 10309.799, "learn_throughput": 387.98, "synch_weights_time_ms": 15.202}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "f1691_00000", "date": "2024-08-13_16-57-09", "timestamp": 1723582629, "time_this_iter_s": 12.59356689453125, "time_total_s": 1120.6413209438324, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfbaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1120.6413209438324, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 65.92941176470589, "ram_util_percent": 83.51764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1354163795867294, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.187890733486761, "policy_loss": -0.0018637094788361715, "vf_loss": 2.1659752207458336, "vf_explained_var": 0.08492531757506114, "kl": 0.010438068984916105, "entropy": 0.7169076149425809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.283748198407037, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.6396707357552947, "policy_loss": 0.002357090908600382, "vf_loss": 2.6217841626475096, "vf_explained_var": -5.897390779364046e-09, "kl": 0.009089043738972012, "entropy": 0.19245465499935327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -321.0, "episode_reward_mean": -59.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -354.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -56.255, "predator_policy": 26.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -9.0, 3.0, -24.0, -166.0, -78.0, -101.0, -100.0, -10.0, -85.0, 0.0, -102.0, -3.0, -23.0, -99.0, -115.0, -92.0, 7.0, 8.0, -179.0, 3.0, 1.0, 13.0, -11.0, -288.0, -12.0, -123.0, 7.0, -10.0, -20.0, -2.0, -62.0, -16.0, -1.0, -190.0, 15.0, -110.0, -12.0, -157.0, -209.0, -155.0, -1.0, -124.0, -13.0, -141.0, 0.0, 2.0, -12.0, 3.0, -62.0, 17.0, 1.0, -166.0, 2.0, -10.0, -41.0, 18.0, -144.0, 7.0, -43.0, -125.0, -7.0, 18.0, -9.0, -75.0, 0.0, 4.0, -262.0, -112.0, -9.0, -273.0, -129.0, 15.0, -321.0, -213.0, 17.0, -143.0, -55.0, 4.0, -34.0, -174.0, -11.0, -40.0, 2.0, 0.0, -89.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -112.0, -19.0, -12.0, -124.0, 8.0, 3.0, -91.0, -300.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, 0.0, -18.0, 0.0, -1.0, -10.0, -72.0, -10.0, -328.0, -57.0, -66.0, -122.0, -80.0, -222.0, 11.0, -4.0, -16.0, -332.0, 0.0, 0.0, 0.0, -180.0, -12.0, 3.0, -17.0, 0.0, -54.0, -58.0, -90.0, -74.0, -82.0, -96.0, -154.0, 0.0, 7.0, 8.0, 0.0, -274.0, -94.0, -8.0, 2.0, 0.0, 1.0, 13.0, 0.0, -21.0, -4.0, -216.0, -186.0, 0.0, -32.0, -148.0, -84.0, -5.0, 0.0, -20.0, 0.0, -49.0, 0.0, 1.0, -6.0, -22.0, -109.0, 0.0, -32.0, -2.0, 0.0, -164.0, -108.0, 15.0, 0.0, -100.0, -120.0, -20.0, -4.0, -150.0, -116.0, -172.0, -247.0, -176.0, -84.0, -2.0, 0.0, -254.0, -2.0, -35.0, -3.0, -94.0, -94.0, 0.0, 0.0, 0.0, -5.0, -24.0, 0.0, 0.0, 3.0, 0.0, -126.0, 0.0, 17.0, 0.0, -8.0, -197.0, -114.0, -1.0, 0.0, -38.0, 9.0, -20.0, -69.0, 18.0, 0.0, -106.0, -182.0, 0.0, 7.0, 11.0, -110.0, -178.0, -122.0, -4.0, -20.0, 18.0, 0.0, 0.0, -21.0, -42.0, -108.0, 0.0, 0.0, 0.0, 4.0, -154.0, -235.0, -65.0, -94.0, -21.0, 0.0, -226.0, -176.0, -143.0, -120.0, 0.0, 15.0, -288.0, -216.0, -148.0, -149.0, 17.0, 0.0, -150.0, -80.0, -314.0, 0.0, 4.0, 0.0, -68.0, 0.0, -348.0, 0.0, -54.0, 16.0, -52.0, -14.0, 1.0, 0.0, 0.0, 0.0, -30.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, -72.0, 0.0, 0.0, 0.0, 0.0, -141.0, -84.0, -19.0, -16.0, -30.0, 3.0, -248.0, 0.0, 8.0, 0.0, 0.0, 3.0, -96.0, -44.0, -354.0, -136.0], "policy_predator_policy_reward": [0.0, 0.0, 9.0, 0.0, 0.0, 4.0, 22.0, 36.0, 8.0, 164.0, 45.0, 0.0, 101.0, 0.0, 100.0, 11.0, 4.0, 6.0, 81.0, 166.0, 0.0, 0.0, 0.0, 90.0, 11.0, 0.0, 31.0, 0.0, 49.0, 0.0, 41.0, 0.0, 77.0, 81.0, 0.0, 0.0, 0.0, 0.0, 61.0, 128.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 110.0, 4.0, 0.0, 20.0, 0.0, 109.0, 0.0, 12.0, 10.0, 0.0, 0.0, 29.0, 3.0, 0.0, 69.0, 0.0, 16.0, 0.0, 1.0, 0.0, 0.0, 82.0, 0.0, 0.0, 0.0, 110.0, 12.0, 0.0, 0.0, 109.0, 124.0, 86.0, 0.0, 105.0, 0.0, 1.0, 117.0, 15.0, 5.0, 20.0, 47.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 4.0, 0.0, 0.0, 59.0, 5.0, 0.0, 0.0, 9.0, 0.0, 142.0, 3.0, 0.0, 3.0, 6.0, 13.0, 0.0, 48.0, 0.0, 0.0, 142.0, 2.0, 0.0, 0.0, 0.0, 56.0, 99.0, 76.0, 5.0, 12.0, 0.0, 0.0, 12.0, 0.0, 21.0, 54.0, 0.0, 0.0, 0.0, 0.0, 117.0, 10.0, 0.0, 47.0, 12.0, 0.0, 7.0, 122.0, 134.0, 0.0, 0.0, 0.0, 183.0, 0.0, 74.0, 10.0, 0.0, 0.0, 11.0, 76.0, 102.0, 157.0, 0.0, 0.0, 34.0, 0.0, 0.0, 174.0, 27.0, 0.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 3.0, 98.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 8.0, 0.0, 0.0, 0.0, 0.0, 110.0, 3.0, 16.0, 0.0, 15.0, 0.0, 117.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 48.0, 2.0, 188.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9388471482887876, "mean_inference_ms": 2.4395329532215873, "mean_action_processing_ms": 0.4324243227673065, "mean_env_wait_ms": 0.33451366908789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00410771369934082, "StateBufferConnector_ms": 0.0036734342575073242, "ViewRequirementAgentConnector_ms": 0.15031683444976807}, "num_episodes": 18, "episode_return_max": 18.0, "episode_return_min": -321.0, "episode_return_mean": -59.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.36038067244175, "num_env_steps_trained_throughput_per_sec": 332.36038067244175, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 12186.686, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12186.634, "sample_time_ms": 1807.298, "learn_time_ms": 10361.971, "learn_throughput": 386.027, "synch_weights_time_ms": 14.716}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "f1691_00000", "date": "2024-08-13_16-57-21", "timestamp": 1723582641, "time_this_iter_s": 12.077126026153564, "time_total_s": 1132.718446969986, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d0f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1132.718446969986, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 66.14444444444445, "ram_util_percent": 83.43888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7418252343380893, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.550989606077709, "policy_loss": -0.0010546441143132234, "vf_loss": 2.528314608367032, "vf_explained_var": 0.06954534583621555, "kl": 0.010416306047494, "entropy": 0.6966635674395889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.041953333230719, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.7650306624710246, "policy_loss": 0.0012100027420769923, "vf_loss": 2.756230673461995, "vf_explained_var": -8.136507064577132e-09, "kl": 0.004442240112899118, "entropy": 0.12631672443279987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -321.0, "episode_reward_mean": -60.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -57.615, "predator_policy": 27.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, -179.0, 3.0, 1.0, 13.0, -11.0, -288.0, -12.0, -123.0, 7.0, -10.0, -20.0, -2.0, -62.0, -16.0, -1.0, -190.0, 15.0, -110.0, -12.0, -157.0, -209.0, -155.0, -1.0, -124.0, -13.0, -141.0, 0.0, 2.0, -12.0, 3.0, -62.0, 17.0, 1.0, -166.0, 2.0, -10.0, -41.0, 18.0, -144.0, 7.0, -43.0, -125.0, -7.0, 18.0, -9.0, -75.0, 0.0, 4.0, -262.0, -112.0, -9.0, -273.0, -129.0, 15.0, -321.0, -213.0, 17.0, -143.0, -55.0, 4.0, -34.0, -174.0, -11.0, -40.0, 2.0, 0.0, -89.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -112.0, -19.0, -12.0, -124.0, 8.0, 3.0, -91.0, -300.0, -241.0, 13.0, -43.0, 14.0, -1.0, 15.0, -3.0, -196.0, -54.0, 17.0, 1.0, -47.0, -17.0, -182.0, -3.0, -86.0, 1.0, -261.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, 0.0, -274.0, -94.0, -8.0, 2.0, 0.0, 1.0, 13.0, 0.0, -21.0, -4.0, -216.0, -186.0, 0.0, -32.0, -148.0, -84.0, -5.0, 0.0, -20.0, 0.0, -49.0, 0.0, 1.0, -6.0, -22.0, -109.0, 0.0, -32.0, -2.0, 0.0, -164.0, -108.0, 15.0, 0.0, -100.0, -120.0, -20.0, -4.0, -150.0, -116.0, -172.0, -247.0, -176.0, -84.0, -2.0, 0.0, -254.0, -2.0, -35.0, -3.0, -94.0, -94.0, 0.0, 0.0, 0.0, -5.0, -24.0, 0.0, 0.0, 3.0, 0.0, -126.0, 0.0, 17.0, 0.0, -8.0, -197.0, -114.0, -1.0, 0.0, -38.0, 9.0, -20.0, -69.0, 18.0, 0.0, -106.0, -182.0, 0.0, 7.0, 11.0, -110.0, -178.0, -122.0, -4.0, -20.0, 18.0, 0.0, 0.0, -21.0, -42.0, -108.0, 0.0, 0.0, 0.0, 4.0, -154.0, -235.0, -65.0, -94.0, -21.0, 0.0, -226.0, -176.0, -143.0, -120.0, 0.0, 15.0, -288.0, -216.0, -148.0, -149.0, 17.0, 0.0, -150.0, -80.0, -314.0, 0.0, 4.0, 0.0, -68.0, 0.0, -348.0, 0.0, -54.0, 16.0, -52.0, -14.0, 1.0, 0.0, 0.0, 0.0, -30.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, -72.0, 0.0, 0.0, 0.0, 0.0, -141.0, -84.0, -19.0, -16.0, -30.0, 3.0, -248.0, 0.0, 8.0, 0.0, 0.0, 3.0, -96.0, -44.0, -354.0, -136.0, -364.0, -129.0, 0.0, 13.0, -260.0, 15.0, 4.0, 10.0, -5.0, 0.0, 0.0, 15.0, -20.0, 0.0, -8.0, -388.0, 17.0, -142.0, 2.0, 15.0, 1.0, 0.0, -94.0, 0.0, -62.0, 0.0, -184.0, -96.0, 0.0, -9.0, -358.0, 13.0, -26.0, 14.0, -197.0, -181.0], "policy_predator_policy_reward": [0.0, 0.0, 61.0, 128.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 110.0, 4.0, 0.0, 20.0, 0.0, 109.0, 0.0, 12.0, 10.0, 0.0, 0.0, 29.0, 3.0, 0.0, 69.0, 0.0, 16.0, 0.0, 1.0, 0.0, 0.0, 82.0, 0.0, 0.0, 0.0, 110.0, 12.0, 0.0, 0.0, 109.0, 124.0, 86.0, 0.0, 105.0, 0.0, 1.0, 117.0, 15.0, 5.0, 20.0, 47.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 4.0, 0.0, 0.0, 59.0, 5.0, 0.0, 0.0, 9.0, 0.0, 142.0, 3.0, 0.0, 3.0, 6.0, 13.0, 0.0, 48.0, 0.0, 0.0, 142.0, 2.0, 0.0, 0.0, 0.0, 56.0, 99.0, 76.0, 5.0, 12.0, 0.0, 0.0, 12.0, 0.0, 21.0, 54.0, 0.0, 0.0, 0.0, 0.0, 117.0, 10.0, 0.0, 47.0, 12.0, 0.0, 7.0, 122.0, 134.0, 0.0, 0.0, 0.0, 183.0, 0.0, 74.0, 10.0, 0.0, 0.0, 11.0, 76.0, 102.0, 157.0, 0.0, 0.0, 34.0, 0.0, 0.0, 174.0, 27.0, 0.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 3.0, 98.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 8.0, 0.0, 0.0, 0.0, 0.0, 110.0, 3.0, 16.0, 0.0, 15.0, 0.0, 117.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 48.0, 2.0, 188.0, 70.0, 182.0, 0.0, 0.0, 98.0, 104.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 17.0, 0.0, 194.0, 6.0, 0.0, 71.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 31.0, 14.0, 0.0, 98.0, 0.0, 6.0, 74.0, 185.0, 0.0, 13.0, 52.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.938339560280994, "mean_inference_ms": 2.4385159254389652, "mean_action_processing_ms": 0.4318540292965312, "mean_env_wait_ms": 0.33430430342559647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0038788318634033203, "ViewRequirementAgentConnector_ms": 0.1395660638809204}, "num_episodes": 18, "episode_return_max": 18.0, "episode_return_min": -321.0, "episode_return_mean": -60.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.1132358636706, "num_env_steps_trained_throughput_per_sec": 339.1132358636706, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 12131.271, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12131.223, "sample_time_ms": 1701.479, "learn_time_ms": 10412.661, "learn_throughput": 384.148, "synch_weights_time_ms": 14.828}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "f1691_00000", "date": "2024-08-13_16-57-33", "timestamp": 1723582653, "time_this_iter_s": 11.858297109603882, "time_total_s": 1144.5767440795898, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1144.5767440795898, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 66.725, "ram_util_percent": 83.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4688220197246187, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.074696958254254, "policy_loss": -0.001136863643485836, "vf_loss": 2.0586828496721057, "vf_explained_var": 0.053142006025112494, "kl": 0.007528545494582787, "entropy": 0.610007431803557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.178701909787204, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 2.5892220598049263, "policy_loss": 0.0024874577136148536, "vf_loss": 2.5794562458992005, "vf_explained_var": -6.212759270239129e-09, "kl": 0.00851970845838157, "entropy": 0.08821949075689421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -321.0, "episode_reward_mean": -63.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -61.58, "predator_policy": 29.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.0, -1.0, -124.0, -13.0, -141.0, 0.0, 2.0, -12.0, 3.0, -62.0, 17.0, 1.0, -166.0, 2.0, -10.0, -41.0, 18.0, -144.0, 7.0, -43.0, -125.0, -7.0, 18.0, -9.0, -75.0, 0.0, 4.0, -262.0, -112.0, -9.0, -273.0, -129.0, 15.0, -321.0, -213.0, 17.0, -143.0, -55.0, 4.0, -34.0, -174.0, -11.0, -40.0, 2.0, 0.0, -89.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -112.0, -19.0, -12.0, -124.0, 8.0, 3.0, -91.0, -300.0, -241.0, 13.0, -43.0, 14.0, -1.0, 15.0, -3.0, -196.0, -54.0, 17.0, 1.0, -47.0, -17.0, -182.0, -3.0, -86.0, 1.0, -261.0, -11.0, -194.0, -63.0, -151.0, -13.0, -13.0, -118.0, 8.0, 0.0, -25.0, 3.0, -134.0, -247.0, -70.0, -9.0, -219.0, -208.0, -186.0, -4.0, -20.0, -6.0, -22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-176.0, -84.0, -2.0, 0.0, -254.0, -2.0, -35.0, -3.0, -94.0, -94.0, 0.0, 0.0, 0.0, -5.0, -24.0, 0.0, 0.0, 3.0, 0.0, -126.0, 0.0, 17.0, 0.0, -8.0, -197.0, -114.0, -1.0, 0.0, -38.0, 9.0, -20.0, -69.0, 18.0, 0.0, -106.0, -182.0, 0.0, 7.0, 11.0, -110.0, -178.0, -122.0, -4.0, -20.0, 18.0, 0.0, 0.0, -21.0, -42.0, -108.0, 0.0, 0.0, 0.0, 4.0, -154.0, -235.0, -65.0, -94.0, -21.0, 0.0, -226.0, -176.0, -143.0, -120.0, 0.0, 15.0, -288.0, -216.0, -148.0, -149.0, 17.0, 0.0, -150.0, -80.0, -314.0, 0.0, 4.0, 0.0, -68.0, 0.0, -348.0, 0.0, -54.0, 16.0, -52.0, -14.0, 1.0, 0.0, 0.0, 0.0, -30.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, -72.0, 0.0, 0.0, 0.0, 0.0, -141.0, -84.0, -19.0, -16.0, -30.0, 3.0, -248.0, 0.0, 8.0, 0.0, 0.0, 3.0, -96.0, -44.0, -354.0, -136.0, -364.0, -129.0, 0.0, 13.0, -260.0, 15.0, 4.0, 10.0, -5.0, 0.0, 0.0, 15.0, -20.0, 0.0, -8.0, -388.0, 17.0, -142.0, 2.0, 15.0, 1.0, 0.0, -94.0, 0.0, -62.0, 0.0, -184.0, -96.0, 0.0, -9.0, -358.0, 13.0, -26.0, 14.0, -197.0, -181.0, 0.0, -22.0, -370.0, -22.0, -24.0, -93.0, 8.0, -318.0, -49.0, 4.0, 9.0, -44.0, -330.0, -46.0, 8.0, 0.0, 0.0, 0.0, -50.0, 0.0, 3.0, 0.0, -268.0, 0.0, -237.0, -204.0, -72.0, -58.0, -18.0, 0.0, -260.0, -107.0, -147.0, -142.0, -132.0, -120.0, -66.0, 0.0, -23.0, -15.0, -42.0, 15.0, -24.0, -10.0], "policy_predator_policy_reward": [0.0, 105.0, 0.0, 1.0, 117.0, 15.0, 5.0, 20.0, 47.0, 0.0, 0.0, 0.0, 5.0, 2.0, 8.0, 4.0, 0.0, 0.0, 59.0, 5.0, 0.0, 0.0, 9.0, 0.0, 142.0, 3.0, 0.0, 3.0, 6.0, 13.0, 0.0, 48.0, 0.0, 0.0, 142.0, 2.0, 0.0, 0.0, 0.0, 56.0, 99.0, 76.0, 5.0, 12.0, 0.0, 0.0, 12.0, 0.0, 21.0, 54.0, 0.0, 0.0, 0.0, 0.0, 117.0, 10.0, 0.0, 47.0, 12.0, 0.0, 7.0, 122.0, 134.0, 0.0, 0.0, 0.0, 183.0, 0.0, 74.0, 10.0, 0.0, 0.0, 11.0, 76.0, 102.0, 157.0, 0.0, 0.0, 34.0, 0.0, 0.0, 174.0, 27.0, 0.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 3.0, 98.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 8.0, 0.0, 0.0, 0.0, 0.0, 110.0, 3.0, 16.0, 0.0, 15.0, 0.0, 117.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 48.0, 2.0, 188.0, 70.0, 182.0, 0.0, 0.0, 98.0, 104.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 17.0, 0.0, 194.0, 6.0, 0.0, 71.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 31.0, 14.0, 0.0, 98.0, 0.0, 6.0, 74.0, 185.0, 0.0, 13.0, 52.0, 65.0, 0.0, 11.0, 0.0, 198.0, 54.0, 0.0, 159.0, 0.0, 32.0, 0.0, 22.0, 0.0, 102.0, 156.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 134.0, 0.0, 194.0, 0.0, 5.0, 55.0, 9.0, 0.0, 145.0, 3.0, 81.0, 0.0, 0.0, 66.0, 33.0, 29.0, 14.0, 4.0, 21.0, 0.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9378555648543415, "mean_inference_ms": 2.4372087770941935, "mean_action_processing_ms": 0.4311346263670665, "mean_env_wait_ms": 0.3339961760173199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037773847579956055, "StateBufferConnector_ms": 0.0038962364196777344, "ViewRequirementAgentConnector_ms": 0.1406799554824829}, "num_episodes": 22, "episode_return_max": 18.0, "episode_return_min": -321.0, "episode_return_mean": -63.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.54389572305047, "num_env_steps_trained_throughput_per_sec": 323.54389572305047, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 12122.69, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12122.64, "sample_time_ms": 1693.977, "learn_time_ms": 10410.455, "learn_throughput": 384.229, "synch_weights_time_ms": 15.626}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "f1691_00000", "date": "2024-08-13_16-57-45", "timestamp": 1723582665, "time_this_iter_s": 12.425953149795532, "time_total_s": 1157.0026972293854, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d58700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1157.0026972293854, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 70.88333333333334, "ram_util_percent": 83.56111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3104974633959867, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.9820283802728804, "policy_loss": 0.0007609551665299232, "vf_loss": 1.9495926877178211, "vf_explained_var": 0.03137720741292156, "kl": 0.0139038634003381, "entropy": 0.755726007525883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7348410794501583, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 1.62720545692734, "policy_loss": 0.0007123964919989544, "vf_loss": 1.6160114928212745, "vf_explained_var": -7.884212271877066e-09, "kl": 0.012269235752531521, "entropy": 0.043654767687843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -321.0, "episode_reward_mean": -59.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -58.035, "predator_policy": 28.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -43.0, -125.0, -7.0, 18.0, -9.0, -75.0, 0.0, 4.0, -262.0, -112.0, -9.0, -273.0, -129.0, 15.0, -321.0, -213.0, 17.0, -143.0, -55.0, 4.0, -34.0, -174.0, -11.0, -40.0, 2.0, 0.0, -89.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -112.0, -19.0, -12.0, -124.0, 8.0, 3.0, -91.0, -300.0, -241.0, 13.0, -43.0, 14.0, -1.0, 15.0, -3.0, -196.0, -54.0, 17.0, 1.0, -47.0, -17.0, -182.0, -3.0, -86.0, 1.0, -261.0, -11.0, -194.0, -63.0, -151.0, -13.0, -13.0, -118.0, 8.0, 0.0, -25.0, 3.0, -134.0, -247.0, -70.0, -9.0, -219.0, -208.0, -186.0, -4.0, -20.0, -6.0, -22.0, -170.0, 8.0, -7.0, 0.0, 0.0, 0.0, -170.0, 25.0, 0.0, 8.0, 11.0, -3.0, 2.0, -13.0, -25.0, -63.0, 0.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 7.0, 11.0, -110.0, -178.0, -122.0, -4.0, -20.0, 18.0, 0.0, 0.0, -21.0, -42.0, -108.0, 0.0, 0.0, 0.0, 4.0, -154.0, -235.0, -65.0, -94.0, -21.0, 0.0, -226.0, -176.0, -143.0, -120.0, 0.0, 15.0, -288.0, -216.0, -148.0, -149.0, 17.0, 0.0, -150.0, -80.0, -314.0, 0.0, 4.0, 0.0, -68.0, 0.0, -348.0, 0.0, -54.0, 16.0, -52.0, -14.0, 1.0, 0.0, 0.0, 0.0, -30.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, -72.0, 0.0, 0.0, 0.0, 0.0, -141.0, -84.0, -19.0, -16.0, -30.0, 3.0, -248.0, 0.0, 8.0, 0.0, 0.0, 3.0, -96.0, -44.0, -354.0, -136.0, -364.0, -129.0, 0.0, 13.0, -260.0, 15.0, 4.0, 10.0, -5.0, 0.0, 0.0, 15.0, -20.0, 0.0, -8.0, -388.0, 17.0, -142.0, 2.0, 15.0, 1.0, 0.0, -94.0, 0.0, -62.0, 0.0, -184.0, -96.0, 0.0, -9.0, -358.0, 13.0, -26.0, 14.0, -197.0, -181.0, 0.0, -22.0, -370.0, -22.0, -24.0, -93.0, 8.0, -318.0, -49.0, 4.0, 9.0, -44.0, -330.0, -46.0, 8.0, 0.0, 0.0, 0.0, -50.0, 0.0, 3.0, 0.0, -268.0, 0.0, -237.0, -204.0, -72.0, -58.0, -18.0, 0.0, -260.0, -107.0, -147.0, -142.0, -132.0, -120.0, -66.0, 0.0, -23.0, -15.0, -42.0, 15.0, -24.0, -10.0, -390.0, 9.0, 8.0, 0.0, -10.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -346.0, 0.0, 10.0, 15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, -6.0, 2.0, 0.0, 0.0, -26.0, -50.0, 0.0, -126.0, 0.0, 0.0, 0.0, 15.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 56.0, 99.0, 76.0, 5.0, 12.0, 0.0, 0.0, 12.0, 0.0, 21.0, 54.0, 0.0, 0.0, 0.0, 0.0, 117.0, 10.0, 0.0, 47.0, 12.0, 0.0, 7.0, 122.0, 134.0, 0.0, 0.0, 0.0, 183.0, 0.0, 74.0, 10.0, 0.0, 0.0, 11.0, 76.0, 102.0, 157.0, 0.0, 0.0, 34.0, 0.0, 0.0, 174.0, 27.0, 0.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 3.0, 98.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 8.0, 0.0, 0.0, 0.0, 0.0, 110.0, 3.0, 16.0, 0.0, 15.0, 0.0, 117.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 48.0, 2.0, 188.0, 70.0, 182.0, 0.0, 0.0, 98.0, 104.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 17.0, 0.0, 194.0, 6.0, 0.0, 71.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 31.0, 14.0, 0.0, 98.0, 0.0, 6.0, 74.0, 185.0, 0.0, 13.0, 52.0, 65.0, 0.0, 11.0, 0.0, 198.0, 54.0, 0.0, 159.0, 0.0, 32.0, 0.0, 22.0, 0.0, 102.0, 156.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 134.0, 0.0, 194.0, 0.0, 5.0, 55.0, 9.0, 0.0, 145.0, 3.0, 81.0, 0.0, 0.0, 66.0, 33.0, 29.0, 14.0, 4.0, 21.0, 0.0, 0.0, 12.0, 195.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 25.0, 2.0, 61.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9378268026151104, "mean_inference_ms": 2.4359932651969265, "mean_action_processing_ms": 0.4305795094766326, "mean_env_wait_ms": 0.33384964282046453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038404464721679688, "StateBufferConnector_ms": 0.003887176513671875, "ViewRequirementAgentConnector_ms": 0.13153958320617676}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -321.0, "episode_return_mean": -59.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.992430947806, "num_env_steps_trained_throughput_per_sec": 314.992430947806, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 12164.789, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12164.739, "sample_time_ms": 1726.56, "learn_time_ms": 10420.673, "learn_throughput": 383.852, "synch_weights_time_ms": 15.426}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "f1691_00000", "date": "2024-08-13_16-57-58", "timestamp": 1723582678, "time_this_iter_s": 12.741970300674438, "time_total_s": 1169.7446675300598, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d58790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1169.7446675300598, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 74.15555555555554, "ram_util_percent": 83.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3200835015723316, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.144099059432903, "policy_loss": -0.00014487180104922682, "vf_loss": 4.115581633426525, "vf_explained_var": 0.04284761831873939, "kl": 0.012581529259674923, "entropy": 0.6663647067925287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8201073743161504, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 3.661705673245526, "policy_loss": 6.719865446920118e-05, "vf_loss": 3.6581649741167745, "vf_explained_var": -2.1129688888630537e-09, "kl": 0.004065920428497074, "entropy": 0.007797373946058229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -300.0, "episode_reward_mean": -55.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -63.985, "predator_policy": 36.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -40.0, 2.0, 0.0, -89.0, 0.0, 0.0, 0.0, -44.0, 0.0, 0.0, -112.0, -19.0, -12.0, -124.0, 8.0, 3.0, -91.0, -300.0, -241.0, 13.0, -43.0, 14.0, -1.0, 15.0, -3.0, -196.0, -54.0, 17.0, 1.0, -47.0, -17.0, -182.0, -3.0, -86.0, 1.0, -261.0, -11.0, -194.0, -63.0, -151.0, -13.0, -13.0, -118.0, 8.0, 0.0, -25.0, 3.0, -134.0, -247.0, -70.0, -9.0, -219.0, -208.0, -186.0, -4.0, -20.0, -6.0, -22.0, -170.0, 8.0, -7.0, 0.0, 0.0, 0.0, -170.0, 25.0, 0.0, 8.0, 11.0, -3.0, 2.0, -13.0, -25.0, -63.0, 0.0, 15.0, 3.0, 0.0, 15.0, -136.0, -156.0, -267.0, -1.0, -67.0, -118.0, -56.0, -184.0, -58.0, -80.0, -187.0, 28.0, -100.0, 17.0, -76.0, -91.0, 5.0, -10.0, -24.0, -64.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, 16.0, -52.0, -14.0, 1.0, 0.0, 0.0, 0.0, -30.0, -160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, -72.0, 0.0, 0.0, 0.0, 0.0, -141.0, -84.0, -19.0, -16.0, -30.0, 3.0, -248.0, 0.0, 8.0, 0.0, 0.0, 3.0, -96.0, -44.0, -354.0, -136.0, -364.0, -129.0, 0.0, 13.0, -260.0, 15.0, 4.0, 10.0, -5.0, 0.0, 0.0, 15.0, -20.0, 0.0, -8.0, -388.0, 17.0, -142.0, 2.0, 15.0, 1.0, 0.0, -94.0, 0.0, -62.0, 0.0, -184.0, -96.0, 0.0, -9.0, -358.0, 13.0, -26.0, 14.0, -197.0, -181.0, 0.0, -22.0, -370.0, -22.0, -24.0, -93.0, 8.0, -318.0, -49.0, 4.0, 9.0, -44.0, -330.0, -46.0, 8.0, 0.0, 0.0, 0.0, -50.0, 0.0, 3.0, 0.0, -268.0, 0.0, -237.0, -204.0, -72.0, -58.0, -18.0, 0.0, -260.0, -107.0, -147.0, -142.0, -132.0, -120.0, -66.0, 0.0, -23.0, -15.0, -42.0, 15.0, -24.0, -10.0, -390.0, 9.0, 8.0, 0.0, -10.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -346.0, 0.0, 10.0, 15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, -6.0, 2.0, 0.0, 0.0, -26.0, -50.0, 0.0, -126.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -272.0, 0.0, -317.0, -256.0, -256.0, -11.0, 0.0, 0.0, -356.0, -228.0, -28.0, -66.0, -36.0, -237.0, -98.0, 0.0, -368.0, -107.0, -43.0, -374.0, 0.0, 13.0, 15.0, 0.0, -215.0, -2.0, 6.0, 0.0, -354.0, -366.0, 0.0, 0.0, 2.0, -24.0, 0.0, -372.0, -28.0, -354.0, 0.0], "policy_predator_policy_reward": [27.0, 0.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 3.0, 98.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 36.0, 8.0, 0.0, 0.0, 0.0, 0.0, 110.0, 3.0, 16.0, 0.0, 15.0, 0.0, 117.0, 7.0, 0.0, 0.0, 0.0, 0.0, 1.0, 48.0, 2.0, 188.0, 70.0, 182.0, 0.0, 0.0, 98.0, 104.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 17.0, 0.0, 194.0, 6.0, 0.0, 71.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 31.0, 14.0, 0.0, 98.0, 0.0, 6.0, 74.0, 185.0, 0.0, 13.0, 52.0, 65.0, 0.0, 11.0, 0.0, 198.0, 54.0, 0.0, 159.0, 0.0, 32.0, 0.0, 22.0, 0.0, 102.0, 156.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 134.0, 0.0, 194.0, 0.0, 5.0, 55.0, 9.0, 0.0, 145.0, 3.0, 81.0, 0.0, 0.0, 66.0, 33.0, 29.0, 14.0, 4.0, 21.0, 0.0, 0.0, 12.0, 195.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 25.0, 2.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 136.0, 0.0, 161.0, 0.0, 128.0, 117.0, 10.0, 0.0, 178.0, 111.0, 138.0, 0.0, 0.0, 46.0, 130.0, 21.0, 126.0, 184.0, 70.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 115.0, 8.0, 5.0, 177.0, 101.0, 160.0, 115.0, 3.0, 0.0, 14.0, 0.0, 177.0, 199.0, 113.0, 177.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9371012998249022, "mean_inference_ms": 2.4317953792987046, "mean_action_processing_ms": 0.4292312432098094, "mean_env_wait_ms": 0.3332099586357071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042563676834106445, "StateBufferConnector_ms": 0.003974199295043945, "ViewRequirementAgentConnector_ms": 0.15239226818084717}, "num_episodes": 23, "episode_return_max": 28.0, "episode_return_min": -300.0, "episode_return_mean": -55.93, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.4020517243301, "num_env_steps_trained_throughput_per_sec": 322.4020517243301, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 12232.23, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12232.179, "sample_time_ms": 1766.465, "learn_time_ms": 10448.264, "learn_throughput": 382.839, "synch_weights_time_ms": 15.371}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "f1691_00000", "date": "2024-08-13_16-58-11", "timestamp": 1723582691, "time_this_iter_s": 12.472874164581299, "time_total_s": 1182.217541694641, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d78820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1182.217541694641, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 72.12352941176471, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3126972103087358, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.646313603403707, "policy_loss": -0.0005188571634115996, "vf_loss": 2.6212819569956056, "vf_explained_var": 0.05429150610373765, "kl": 0.011215581367086901, "entropy": 0.6984938816103355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8128996506657344, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 0.009999999999999998, "total_loss": 2.135834382892286, "policy_loss": 2.2657490803529976e-05, "vf_loss": 2.1357110471952527, "vf_explained_var": -5.8027802321015215e-09, "kl": 0.0002357150448835155, "entropy": 0.00774316734082445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -490.0, "episode_reward_mean": -62.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -71.95, "predator_policy": 40.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-300.0, -241.0, 13.0, -43.0, 14.0, -1.0, 15.0, -3.0, -196.0, -54.0, 17.0, 1.0, -47.0, -17.0, -182.0, -3.0, -86.0, 1.0, -261.0, -11.0, -194.0, -63.0, -151.0, -13.0, -13.0, -118.0, 8.0, 0.0, -25.0, 3.0, -134.0, -247.0, -70.0, -9.0, -219.0, -208.0, -186.0, -4.0, -20.0, -6.0, -22.0, -170.0, 8.0, -7.0, 0.0, 0.0, 0.0, -170.0, 25.0, 0.0, 8.0, 11.0, -3.0, 2.0, -13.0, -25.0, -63.0, 0.0, 15.0, 3.0, 0.0, 15.0, -136.0, -156.0, -267.0, -1.0, -67.0, -118.0, -56.0, -184.0, -58.0, -80.0, -187.0, 28.0, -100.0, 17.0, -76.0, -91.0, 5.0, -10.0, -24.0, -64.0, 10.0, -11.0, 6.0, -310.0, -490.0, 0.0, -32.0, 0.0, -6.0, 0.0, 0.0, 15.0, -86.0, -22.0, -29.0, -124.0, -52.0, -41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-354.0, -136.0, -364.0, -129.0, 0.0, 13.0, -260.0, 15.0, 4.0, 10.0, -5.0, 0.0, 0.0, 15.0, -20.0, 0.0, -8.0, -388.0, 17.0, -142.0, 2.0, 15.0, 1.0, 0.0, -94.0, 0.0, -62.0, 0.0, -184.0, -96.0, 0.0, -9.0, -358.0, 13.0, -26.0, 14.0, -197.0, -181.0, 0.0, -22.0, -370.0, -22.0, -24.0, -93.0, 8.0, -318.0, -49.0, 4.0, 9.0, -44.0, -330.0, -46.0, 8.0, 0.0, 0.0, 0.0, -50.0, 0.0, 3.0, 0.0, -268.0, 0.0, -237.0, -204.0, -72.0, -58.0, -18.0, 0.0, -260.0, -107.0, -147.0, -142.0, -132.0, -120.0, -66.0, 0.0, -23.0, -15.0, -42.0, 15.0, -24.0, -10.0, -390.0, 9.0, 8.0, 0.0, -10.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -346.0, 0.0, 10.0, 15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, -6.0, 2.0, 0.0, 0.0, -26.0, -50.0, 0.0, -126.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -272.0, 0.0, -317.0, -256.0, -256.0, -11.0, 0.0, 0.0, -356.0, -228.0, -28.0, -66.0, -36.0, -237.0, -98.0, 0.0, -368.0, -107.0, -43.0, -374.0, 0.0, 13.0, 15.0, 0.0, -215.0, -2.0, 6.0, 0.0, -354.0, -366.0, 0.0, 0.0, 2.0, -24.0, 0.0, -372.0, -28.0, -354.0, 0.0, 0.0, 10.0, 0.0, -34.0, -4.0, 5.0, -396.0, -224.0, -385.0, -300.0, 0.0, 0.0, -164.0, 3.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -150.0, -22.0, 0.0, -120.0, -16.0, -32.0, -104.0, -250.0, 10.0, -386.0, 0.0, -82.0], "policy_predator_policy_reward": [2.0, 188.0, 70.0, 182.0, 0.0, 0.0, 98.0, 104.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 17.0, 0.0, 194.0, 6.0, 0.0, 71.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 31.0, 14.0, 0.0, 98.0, 0.0, 6.0, 74.0, 185.0, 0.0, 13.0, 52.0, 65.0, 0.0, 11.0, 0.0, 198.0, 54.0, 0.0, 159.0, 0.0, 32.0, 0.0, 22.0, 0.0, 102.0, 156.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 134.0, 0.0, 194.0, 0.0, 5.0, 55.0, 9.0, 0.0, 145.0, 3.0, 81.0, 0.0, 0.0, 66.0, 33.0, 29.0, 14.0, 4.0, 21.0, 0.0, 0.0, 12.0, 195.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 25.0, 2.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 136.0, 0.0, 161.0, 0.0, 128.0, 117.0, 10.0, 0.0, 178.0, 111.0, 138.0, 0.0, 0.0, 46.0, 130.0, 21.0, 126.0, 184.0, 70.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 115.0, 8.0, 5.0, 177.0, 101.0, 160.0, 115.0, 3.0, 0.0, 14.0, 0.0, 177.0, 199.0, 113.0, 177.0, 0.0, 0.0, 10.0, 13.0, 3.0, 2.0, 112.0, 198.0, 0.0, 195.0, 0.0, 0.0, 41.0, 88.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 11.0, 60.0, 38.0, 0.0, 19.0, 105.0, 125.0, 131.0, 193.0, 0.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9358866642243728, "mean_inference_ms": 2.4273652383873046, "mean_action_processing_ms": 0.4279853240806038, "mean_env_wait_ms": 0.3325747768889324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004197597503662109, "StateBufferConnector_ms": 0.0038765668869018555, "ViewRequirementAgentConnector_ms": 0.15335333347320557}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -490.0, "episode_return_mean": -62.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.2815180804084, "num_env_steps_trained_throughput_per_sec": 334.2815180804084, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 12241.31, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12241.259, "sample_time_ms": 1770.446, "learn_time_ms": 10453.087, "learn_throughput": 382.662, "synch_weights_time_ms": 15.265}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "f1691_00000", "date": "2024-08-13_16-58-23", "timestamp": 1723582703, "time_this_iter_s": 12.009896993637085, "time_total_s": 1194.2274386882782, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c15310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1194.2274386882782, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 69.8529411764706, "ram_util_percent": 83.31176470588237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.279357880369696, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.935452605870666, "policy_loss": -0.0006411060339785994, "vf_loss": 2.9084971410256846, "vf_explained_var": 0.02718534343457096, "kl": 0.012113719595939473, "entropy": 0.7113313782467413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9636589658468784, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 0.009999999999999998, "total_loss": 2.2747150279226758, "policy_loss": -0.00033892884606584196, "vf_loss": 2.2749970005302833, "vf_explained_var": -6.496590912026703e-09, "kl": 0.0002666726517254862, "entropy": 0.002470547233242397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -490.0, "episode_reward_mean": -56.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -68.005, "predator_policy": 39.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.0, -13.0, -13.0, -118.0, 8.0, 0.0, -25.0, 3.0, -134.0, -247.0, -70.0, -9.0, -219.0, -208.0, -186.0, -4.0, -20.0, -6.0, -22.0, -170.0, 8.0, -7.0, 0.0, 0.0, 0.0, -170.0, 25.0, 0.0, 8.0, 11.0, -3.0, 2.0, -13.0, -25.0, -63.0, 0.0, 15.0, 3.0, 0.0, 15.0, -136.0, -156.0, -267.0, -1.0, -67.0, -118.0, -56.0, -184.0, -58.0, -80.0, -187.0, 28.0, -100.0, 17.0, -76.0, -91.0, 5.0, -10.0, -24.0, -64.0, 10.0, -11.0, 6.0, -310.0, -490.0, 0.0, -32.0, 0.0, -6.0, 0.0, 0.0, 15.0, -86.0, -22.0, -29.0, -124.0, -52.0, -41.0, -2.0, -143.0, 0.0, 0.0, -3.0, -5.0, -96.0, 0.0, 2.0, -29.0, -121.0, 0.0, -33.0, -1.0, -137.0, -32.0, 5.0, -115.0, -45.0, -205.0, -68.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, -318.0, -49.0, 4.0, 9.0, -44.0, -330.0, -46.0, 8.0, 0.0, 0.0, 0.0, -50.0, 0.0, 3.0, 0.0, -268.0, 0.0, -237.0, -204.0, -72.0, -58.0, -18.0, 0.0, -260.0, -107.0, -147.0, -142.0, -132.0, -120.0, -66.0, 0.0, -23.0, -15.0, -42.0, 15.0, -24.0, -10.0, -390.0, 9.0, 8.0, 0.0, -10.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -346.0, 0.0, 10.0, 15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, -6.0, 2.0, 0.0, 0.0, -26.0, -50.0, 0.0, -126.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -272.0, 0.0, -317.0, -256.0, -256.0, -11.0, 0.0, 0.0, -356.0, -228.0, -28.0, -66.0, -36.0, -237.0, -98.0, 0.0, -368.0, -107.0, -43.0, -374.0, 0.0, 13.0, 15.0, 0.0, -215.0, -2.0, 6.0, 0.0, -354.0, -366.0, 0.0, 0.0, 2.0, -24.0, 0.0, -372.0, -28.0, -354.0, 0.0, 0.0, 10.0, 0.0, -34.0, -4.0, 5.0, -396.0, -224.0, -385.0, -300.0, 0.0, 0.0, -164.0, 3.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -150.0, -22.0, 0.0, -120.0, -16.0, -32.0, -104.0, -250.0, 10.0, -386.0, 0.0, -82.0, 0.0, -4.0, -288.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -31.0, -24.0, 0.0, -242.0, 0.0, 0.0, -66.0, 0.0, -362.0, 8.0, 0.0, -382.0, 0.0, -71.0, 5.0, 0.0, -188.0, -21.0, 3.0, -96.0, -354.0, -69.0, -240.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [159.0, 0.0, 32.0, 0.0, 22.0, 0.0, 102.0, 156.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 134.0, 0.0, 194.0, 0.0, 5.0, 55.0, 9.0, 0.0, 145.0, 3.0, 81.0, 0.0, 0.0, 66.0, 33.0, 29.0, 14.0, 4.0, 21.0, 0.0, 0.0, 12.0, 195.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 25.0, 2.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 136.0, 0.0, 161.0, 0.0, 128.0, 117.0, 10.0, 0.0, 178.0, 111.0, 138.0, 0.0, 0.0, 46.0, 130.0, 21.0, 126.0, 184.0, 70.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 115.0, 8.0, 5.0, 177.0, 101.0, 160.0, 115.0, 3.0, 0.0, 14.0, 0.0, 177.0, 199.0, 113.0, 177.0, 0.0, 0.0, 10.0, 13.0, 3.0, 2.0, 112.0, 198.0, 0.0, 195.0, 0.0, 0.0, 41.0, 88.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 11.0, 60.0, 38.0, 0.0, 19.0, 105.0, 125.0, 131.0, 193.0, 0.0, 41.0, 2.0, 0.0, 144.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 102.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 26.0, 121.0, 0.0, 0.0, 0.0, 33.0, 0.0, 181.0, 172.0, 191.0, 54.0, 0.0, 39.0, 0.0, 0.0, 0.0, 94.0, 48.0, 0.0, 177.0, 41.0, 120.0, 52.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9345301930199441, "mean_inference_ms": 2.423302926360998, "mean_action_processing_ms": 0.4265074225927535, "mean_env_wait_ms": 0.33184829898980545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00413823127746582, "StateBufferConnector_ms": 0.0031758546829223633, "ViewRequirementAgentConnector_ms": 0.14907371997833252}, "num_episodes": 22, "episode_return_max": 28.0, "episode_return_min": -490.0, "episode_return_mean": -56.23, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.19010351161427, "num_env_steps_trained_throughput_per_sec": 332.19010351161427, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 12211.668, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12211.618, "sample_time_ms": 1719.756, "learn_time_ms": 10473.929, "learn_throughput": 381.901, "synch_weights_time_ms": 15.369}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "f1691_00000", "date": "2024-08-13_16-58-35", "timestamp": 1723582715, "time_this_iter_s": 12.106371879577637, "time_total_s": 1206.3338105678558, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d789d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1206.3338105678558, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 67.0764705882353, "ram_util_percent": 83.26470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4113887559169185, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.2761634600856318, "policy_loss": -0.0021166963662912763, "vf_loss": 3.251863173832969, "vf_explained_var": 0.02868841634225593, "kl": 0.011595933706919527, "entropy": 0.6433211300581221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2436600235501483, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.009999999999999998, "total_loss": 2.955960253622166, "policy_loss": -0.0001278698104359801, "vf_loss": 2.9560502220083165, "vf_explained_var": -5.266653797613881e-09, "kl": 0.00035494720187825444, "entropy": 0.0012795998584052071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -490.0, "episode_reward_mean": -47.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -63.725, "predator_policy": 39.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, -170.0, 8.0, -7.0, 0.0, 0.0, 0.0, -170.0, 25.0, 0.0, 8.0, 11.0, -3.0, 2.0, -13.0, -25.0, -63.0, 0.0, 15.0, 3.0, 0.0, 15.0, -136.0, -156.0, -267.0, -1.0, -67.0, -118.0, -56.0, -184.0, -58.0, -80.0, -187.0, 28.0, -100.0, 17.0, -76.0, -91.0, 5.0, -10.0, -24.0, -64.0, 10.0, -11.0, 6.0, -310.0, -490.0, 0.0, -32.0, 0.0, -6.0, 0.0, 0.0, 15.0, -86.0, -22.0, -29.0, -124.0, -52.0, -41.0, -2.0, -143.0, 0.0, 0.0, -3.0, -5.0, -96.0, 0.0, 2.0, -29.0, -121.0, 0.0, -33.0, -1.0, -137.0, -32.0, 5.0, -115.0, -45.0, -205.0, -68.0, 0.0, 0.0, 14.0, 0.0, 12.0, -35.0, 12.0, -70.0, 0.0, -36.0, -238.0, -13.0, -191.0, -27.0, 0.0, 20.0, 10.0, -1.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.0, -10.0, -390.0, 9.0, 8.0, 0.0, -10.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -346.0, 0.0, 10.0, 15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, -6.0, 2.0, 0.0, 0.0, -26.0, -50.0, 0.0, -126.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -272.0, 0.0, -317.0, -256.0, -256.0, -11.0, 0.0, 0.0, -356.0, -228.0, -28.0, -66.0, -36.0, -237.0, -98.0, 0.0, -368.0, -107.0, -43.0, -374.0, 0.0, 13.0, 15.0, 0.0, -215.0, -2.0, 6.0, 0.0, -354.0, -366.0, 0.0, 0.0, 2.0, -24.0, 0.0, -372.0, -28.0, -354.0, 0.0, 0.0, 10.0, 0.0, -34.0, -4.0, 5.0, -396.0, -224.0, -385.0, -300.0, 0.0, 0.0, -164.0, 3.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -150.0, -22.0, 0.0, -120.0, -16.0, -32.0, -104.0, -250.0, 10.0, -386.0, 0.0, -82.0, 0.0, -4.0, -288.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -31.0, -24.0, 0.0, -242.0, 0.0, 0.0, -66.0, 0.0, -362.0, 8.0, 0.0, -382.0, 0.0, -71.0, 5.0, 0.0, -188.0, -21.0, 3.0, -96.0, -354.0, -69.0, -240.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, -9.0, 15.0, 0.0, -84.0, 4.0, 5.0, -312.0, -6.0, 0.0, 0.0, -295.0, 0.0, -278.0, -99.0, -24.0, -2.0, -202.0, -194.0, -10.0, -372.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 0.0, -5.0, -14.0, 1.0], "policy_predator_policy_reward": [0.0, 12.0, 195.0, 16.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 25.0, 2.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 136.0, 0.0, 161.0, 0.0, 128.0, 117.0, 10.0, 0.0, 178.0, 111.0, 138.0, 0.0, 0.0, 46.0, 130.0, 21.0, 126.0, 184.0, 70.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 115.0, 8.0, 5.0, 177.0, 101.0, 160.0, 115.0, 3.0, 0.0, 14.0, 0.0, 177.0, 199.0, 113.0, 177.0, 0.0, 0.0, 10.0, 13.0, 3.0, 2.0, 112.0, 198.0, 0.0, 195.0, 0.0, 0.0, 41.0, 88.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 11.0, 60.0, 38.0, 0.0, 19.0, 105.0, 125.0, 131.0, 193.0, 0.0, 41.0, 2.0, 0.0, 144.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 102.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 26.0, 121.0, 0.0, 0.0, 0.0, 33.0, 0.0, 181.0, 172.0, 191.0, 54.0, 0.0, 39.0, 0.0, 0.0, 0.0, 94.0, 48.0, 0.0, 177.0, 41.0, 120.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 49.0, 3.0, 0.0, 92.0, 156.0, 0.0, 0.0, 149.0, 110.0, 2.0, 137.0, 0.0, 13.0, 108.0, 97.0, 168.0, 187.0, 0.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.933301991213296, "mean_inference_ms": 2.4174530893927, "mean_action_processing_ms": 0.4251890999941488, "mean_env_wait_ms": 0.3310779545776716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005012869834899902, "StateBufferConnector_ms": 0.0032639503479003906, "ViewRequirementAgentConnector_ms": 0.1491318941116333}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -490.0, "episode_return_mean": -47.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.2492068554058, "num_env_steps_trained_throughput_per_sec": 325.2492068554058, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 12187.124, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12187.074, "sample_time_ms": 1704.476, "learn_time_ms": 10467.37, "learn_throughput": 382.14, "synch_weights_time_ms": 12.839}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "f1691_00000", "date": "2024-08-13_16-58-47", "timestamp": 1723582727, "time_this_iter_s": 12.34449315071106, "time_total_s": 1218.678303718567, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d784c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1218.678303718567, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 67.86111111111111, "ram_util_percent": 83.55555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.344819015753332, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 5.292688328626926, "policy_loss": -0.0004997498087249894, "vf_loss": 5.268774968984896, "vf_explained_var": 0.09192814893192715, "kl": 0.010716322327191176, "entropy": 0.5279814379713522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.788967355465034, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.009999999999999998, "total_loss": 4.422776784594097, "policy_loss": 0.0002194505936352822, "vf_loss": 4.422557293548786, "vf_explained_var": -2.4283373797381368e-09, "kl": 1.49762709662582e-06, "entropy": 0.0005248209401514263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -490.0, "episode_reward_mean": -65.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -87.235, "predator_policy": 54.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156.0, -267.0, -1.0, -67.0, -118.0, -56.0, -184.0, -58.0, -80.0, -187.0, 28.0, -100.0, 17.0, -76.0, -91.0, 5.0, -10.0, -24.0, -64.0, 10.0, -11.0, 6.0, -310.0, -490.0, 0.0, -32.0, 0.0, -6.0, 0.0, 0.0, 15.0, -86.0, -22.0, -29.0, -124.0, -52.0, -41.0, -2.0, -143.0, 0.0, 0.0, -3.0, -5.0, -96.0, 0.0, 2.0, -29.0, -121.0, 0.0, -33.0, -1.0, -137.0, -32.0, 5.0, -115.0, -45.0, -205.0, -68.0, 0.0, 0.0, 14.0, 0.0, 12.0, -35.0, 12.0, -70.0, 0.0, -36.0, -238.0, -13.0, -191.0, -27.0, 0.0, 20.0, 10.0, -1.0, -6.0, -57.0, -285.0, -167.0, -48.0, -394.0, -5.0, -394.0, -50.0, -38.0, 0.0, 3.0, -6.0, -175.0, -182.0, -75.0, -40.0, 7.0, -4.0, -110.0, -76.0, -49.0, -48.0, -78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -317.0, -256.0, -256.0, -11.0, 0.0, 0.0, -356.0, -228.0, -28.0, -66.0, -36.0, -237.0, -98.0, 0.0, -368.0, -107.0, -43.0, -374.0, 0.0, 13.0, 15.0, 0.0, -215.0, -2.0, 6.0, 0.0, -354.0, -366.0, 0.0, 0.0, 2.0, -24.0, 0.0, -372.0, -28.0, -354.0, 0.0, 0.0, 10.0, 0.0, -34.0, -4.0, 5.0, -396.0, -224.0, -385.0, -300.0, 0.0, 0.0, -164.0, 3.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -150.0, -22.0, 0.0, -120.0, -16.0, -32.0, -104.0, -250.0, 10.0, -386.0, 0.0, -82.0, 0.0, -4.0, -288.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -31.0, -24.0, 0.0, -242.0, 0.0, 0.0, -66.0, 0.0, -362.0, 8.0, 0.0, -382.0, 0.0, -71.0, 5.0, 0.0, -188.0, -21.0, 3.0, -96.0, -354.0, -69.0, -240.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, -9.0, 15.0, 0.0, -84.0, 4.0, 5.0, -312.0, -6.0, 0.0, 0.0, -295.0, 0.0, -278.0, -99.0, -24.0, -2.0, -202.0, -194.0, -10.0, -372.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 0.0, -5.0, -14.0, 1.0, 0.0, -366.0, -222.0, -174.0, -14.0, -320.0, -8.0, -228.0, -400.0, -394.0, -10.0, 0.0, -306.0, -294.0, -43.0, -50.0, -128.0, 15.0, 0.0, 0.0, -352.0, 15.0, 4.0, -20.0, -148.0, -217.0, 1.0, -366.0, -157.0, 0.0, 0.0, -330.0, 7.0, 0.0, -362.0, 0.0, -226.0, 3.0, 0.0, -220.0, -15.0, -276.0, -96.0, 0.0, -8.0, -163.0], "policy_predator_policy_reward": [161.0, 0.0, 128.0, 117.0, 10.0, 0.0, 178.0, 111.0, 138.0, 0.0, 0.0, 46.0, 130.0, 21.0, 126.0, 184.0, 70.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 115.0, 8.0, 5.0, 177.0, 101.0, 160.0, 115.0, 3.0, 0.0, 14.0, 0.0, 177.0, 199.0, 113.0, 177.0, 0.0, 0.0, 10.0, 13.0, 3.0, 2.0, 112.0, 198.0, 0.0, 195.0, 0.0, 0.0, 41.0, 88.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 11.0, 60.0, 38.0, 0.0, 19.0, 105.0, 125.0, 131.0, 193.0, 0.0, 41.0, 2.0, 0.0, 144.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 102.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 26.0, 121.0, 0.0, 0.0, 0.0, 33.0, 0.0, 181.0, 172.0, 191.0, 54.0, 0.0, 39.0, 0.0, 0.0, 0.0, 94.0, 48.0, 0.0, 177.0, 41.0, 120.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 49.0, 3.0, 0.0, 92.0, 156.0, 0.0, 0.0, 149.0, 110.0, 2.0, 137.0, 0.0, 13.0, 108.0, 97.0, 168.0, 187.0, 0.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 183.0, 126.0, 24.0, 87.0, 160.0, 7.0, 99.0, 89.0, 200.0, 200.0, 5.0, 0.0, 109.0, 97.0, 36.0, 7.0, 12.0, 63.0, 0.0, 0.0, 164.0, 176.0, 4.0, 6.0, 100.0, 90.0, 0.0, 183.0, 0.0, 82.0, 125.0, 165.0, 0.0, 0.0, 177.0, 181.0, 0.0, 113.0, 99.0, 45.0, 147.0, 95.0, 40.0, 8.0, 0.0, 93.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9305290313983928, "mean_inference_ms": 2.4127946198000974, "mean_action_processing_ms": 0.4243997700116401, "mean_env_wait_ms": 0.32999535250564205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005304694175720215, "StateBufferConnector_ms": 0.0031633377075195312, "ViewRequirementAgentConnector_ms": 0.12795233726501465}, "num_episodes": 23, "episode_return_max": 28.0, "episode_return_min": -490.0, "episode_return_mean": -65.09, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.0918479708674, "num_env_steps_trained_throughput_per_sec": 327.0918479708674, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 12238.022, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12237.972, "sample_time_ms": 1676.514, "learn_time_ms": 10546.155, "learn_throughput": 379.285, "synch_weights_time_ms": 12.901}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "f1691_00000", "date": "2024-08-13_16-59-00", "timestamp": 1723582740, "time_this_iter_s": 12.29374074935913, "time_total_s": 1230.972044467926, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3be09d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1230.972044467926, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 67.80588235294117, "ram_util_percent": 83.48823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5642050139487735, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.1724529212114043, "policy_loss": 0.0024547509236813145, "vf_loss": 3.1416887993535036, "vf_explained_var": 0.04612000262926495, "kl": 0.012426608948535997, "entropy": 0.4647828341476501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.020579465514261, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 0.009999999999999998, "total_loss": 2.4492974225175446, "policy_loss": -4.8641717337347844e-05, "vf_loss": 2.449346010205607, "vf_explained_var": -7.127327893776868e-09, "kl": 2.579451233553636e-06, "entropy": 0.00037689864021515294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -490.0, "episode_reward_mean": -62.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -82.26, "predator_policy": 51.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.0, 10.0, -11.0, 6.0, -310.0, -490.0, 0.0, -32.0, 0.0, -6.0, 0.0, 0.0, 15.0, -86.0, -22.0, -29.0, -124.0, -52.0, -41.0, -2.0, -143.0, 0.0, 0.0, -3.0, -5.0, -96.0, 0.0, 2.0, -29.0, -121.0, 0.0, -33.0, -1.0, -137.0, -32.0, 5.0, -115.0, -45.0, -205.0, -68.0, 0.0, 0.0, 14.0, 0.0, 12.0, -35.0, 12.0, -70.0, 0.0, -36.0, -238.0, -13.0, -191.0, -27.0, 0.0, 20.0, 10.0, -1.0, -6.0, -57.0, -285.0, -167.0, -48.0, -394.0, -5.0, -394.0, -50.0, -38.0, 0.0, 3.0, -6.0, -175.0, -182.0, -75.0, -40.0, 7.0, -4.0, -110.0, -76.0, -49.0, -48.0, -78.0, -64.0, 2.0, -187.0, -151.0, 3.0, -84.0, -25.0, -27.0, -172.0, 0.0, 15.0, -4.0, -10.0, -4.0, 5.0, -295.0, -134.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-354.0, 0.0, 0.0, 10.0, 0.0, -34.0, -4.0, 5.0, -396.0, -224.0, -385.0, -300.0, 0.0, 0.0, -164.0, 3.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -150.0, -22.0, 0.0, -120.0, -16.0, -32.0, -104.0, -250.0, 10.0, -386.0, 0.0, -82.0, 0.0, -4.0, -288.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -31.0, -24.0, 0.0, -242.0, 0.0, 0.0, -66.0, 0.0, -362.0, 8.0, 0.0, -382.0, 0.0, -71.0, 5.0, 0.0, -188.0, -21.0, 3.0, -96.0, -354.0, -69.0, -240.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, -9.0, 15.0, 0.0, -84.0, 4.0, 5.0, -312.0, -6.0, 0.0, 0.0, -295.0, 0.0, -278.0, -99.0, -24.0, -2.0, -202.0, -194.0, -10.0, -372.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 0.0, -5.0, -14.0, 1.0, 0.0, -366.0, -222.0, -174.0, -14.0, -320.0, -8.0, -228.0, -400.0, -394.0, -10.0, 0.0, -306.0, -294.0, -43.0, -50.0, -128.0, 15.0, 0.0, 0.0, -352.0, 15.0, 4.0, -20.0, -148.0, -217.0, 1.0, -366.0, -157.0, 0.0, 0.0, -330.0, 7.0, 0.0, -362.0, 0.0, -226.0, 3.0, 0.0, -220.0, -15.0, -276.0, -96.0, 0.0, -8.0, -163.0, -144.0, 4.0, 11.0, -18.0, -64.0, -246.0, -302.0, 0.0, 0.0, 3.0, -334.0, 0.0, -374.0, 4.0, -38.0, -16.0, -344.0, 0.0, 0.0, 0.0, 0.0, 15.0, -8.0, 0.0, -392.0, 0.0, 0.0, -8.0, 0.0, 5.0, -370.0, -222.0, 0.0, -278.0, 4.0, 1.0], "policy_predator_policy_reward": [113.0, 177.0, 0.0, 0.0, 10.0, 13.0, 3.0, 2.0, 112.0, 198.0, 0.0, 195.0, 0.0, 0.0, 41.0, 88.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 11.0, 60.0, 38.0, 0.0, 19.0, 105.0, 125.0, 131.0, 193.0, 0.0, 41.0, 2.0, 0.0, 144.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 102.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 26.0, 121.0, 0.0, 0.0, 0.0, 33.0, 0.0, 181.0, 172.0, 191.0, 54.0, 0.0, 39.0, 0.0, 0.0, 0.0, 94.0, 48.0, 0.0, 177.0, 41.0, 120.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 49.0, 3.0, 0.0, 92.0, 156.0, 0.0, 0.0, 149.0, 110.0, 2.0, 137.0, 0.0, 13.0, 108.0, 97.0, 168.0, 187.0, 0.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 183.0, 126.0, 24.0, 87.0, 160.0, 7.0, 99.0, 89.0, 200.0, 200.0, 5.0, 0.0, 109.0, 97.0, 36.0, 7.0, 12.0, 63.0, 0.0, 0.0, 164.0, 176.0, 4.0, 6.0, 100.0, 90.0, 0.0, 183.0, 0.0, 82.0, 125.0, 165.0, 0.0, 0.0, 177.0, 181.0, 0.0, 113.0, 99.0, 45.0, 147.0, 95.0, 40.0, 8.0, 0.0, 93.0, 76.0, 0.0, 5.0, 4.0, 123.0, 0.0, 151.0, 0.0, 0.0, 0.0, 83.0, 167.0, 185.0, 160.0, 8.0, 19.0, 172.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 196.0, 186.0, 0.0, 4.0, 0.0, 0.0, 185.0, 112.0, 0.0, 144.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9287073115932586, "mean_inference_ms": 2.404707676205773, "mean_action_processing_ms": 0.4221227950084598, "mean_env_wait_ms": 0.3291814802765564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008629202842712402, "StateBufferConnector_ms": 0.003163576126098633, "ViewRequirementAgentConnector_ms": 0.11402475833892822}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -490.0, "episode_return_mean": -62.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.16805217475195, "num_env_steps_trained_throughput_per_sec": 333.16805217475195, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 12183.982, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12183.933, "sample_time_ms": 1560.361, "learn_time_ms": 10607.388, "learn_throughput": 377.096, "synch_weights_time_ms": 13.837}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "f1691_00000", "date": "2024-08-13_16-59-12", "timestamp": 1723582752, "time_this_iter_s": 12.06371784210205, "time_total_s": 1243.035762310028, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1243.035762310028, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 67.08823529411767, "ram_util_percent": 83.48823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8875913870870753, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.835077953086328, "policy_loss": -0.00032300180730917465, "vf_loss": 3.816903680720657, "vf_explained_var": 0.021512123863533062, "kl": 0.00811951337455884, "entropy": 0.3687780379933655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8334292654142401, "cur_kl_coeff": 0.013348388671874996, "cur_lr": 0.009999999999999998, "total_loss": 4.34217509529578, "policy_loss": -3.358218412373274e-05, "vf_loss": 4.342208665767044, "vf_explained_var": -6.654275157464244e-09, "kl": 2.966680316404283e-06, "entropy": 0.00018638807364151856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -394.0, "episode_reward_mean": -64.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -85.415, "predator_policy": 52.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.0, -2.0, -143.0, 0.0, 0.0, -3.0, -5.0, -96.0, 0.0, 2.0, -29.0, -121.0, 0.0, -33.0, -1.0, -137.0, -32.0, 5.0, -115.0, -45.0, -205.0, -68.0, 0.0, 0.0, 14.0, 0.0, 12.0, -35.0, 12.0, -70.0, 0.0, -36.0, -238.0, -13.0, -191.0, -27.0, 0.0, 20.0, 10.0, -1.0, -6.0, -57.0, -285.0, -167.0, -48.0, -394.0, -5.0, -394.0, -50.0, -38.0, 0.0, 3.0, -6.0, -175.0, -182.0, -75.0, -40.0, 7.0, -4.0, -110.0, -76.0, -49.0, -48.0, -78.0, -64.0, 2.0, -187.0, -151.0, 3.0, -84.0, -25.0, -27.0, -172.0, 0.0, 15.0, -4.0, -10.0, -4.0, 5.0, -295.0, -134.0, 5.0, 0.0, -260.0, -3.0, -190.0, -75.0, -132.0, 0.0, -146.0, -157.0, 12.0, -154.0, -42.0, 18.0, -138.0, -72.0, -127.0, 2.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -82.0, 0.0, -4.0, -288.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -31.0, -24.0, 0.0, -242.0, 0.0, 0.0, -66.0, 0.0, -362.0, 8.0, 0.0, -382.0, 0.0, -71.0, 5.0, 0.0, -188.0, -21.0, 3.0, -96.0, -354.0, -69.0, -240.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, -9.0, 15.0, 0.0, -84.0, 4.0, 5.0, -312.0, -6.0, 0.0, 0.0, -295.0, 0.0, -278.0, -99.0, -24.0, -2.0, -202.0, -194.0, -10.0, -372.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 0.0, -5.0, -14.0, 1.0, 0.0, -366.0, -222.0, -174.0, -14.0, -320.0, -8.0, -228.0, -400.0, -394.0, -10.0, 0.0, -306.0, -294.0, -43.0, -50.0, -128.0, 15.0, 0.0, 0.0, -352.0, 15.0, 4.0, -20.0, -148.0, -217.0, 1.0, -366.0, -157.0, 0.0, 0.0, -330.0, 7.0, 0.0, -362.0, 0.0, -226.0, 3.0, 0.0, -220.0, -15.0, -276.0, -96.0, 0.0, -8.0, -163.0, -144.0, 4.0, 11.0, -18.0, -64.0, -246.0, -302.0, 0.0, 0.0, 3.0, -334.0, 0.0, -374.0, 4.0, -38.0, -16.0, -344.0, 0.0, 0.0, 0.0, 0.0, 15.0, -8.0, 0.0, -392.0, 0.0, 0.0, -8.0, 0.0, 5.0, -370.0, -222.0, 0.0, -278.0, 4.0, 1.0, 0.0, 0.0, -188.0, -166.0, -370.0, 0.0, -385.0, 0.0, 0.0, -150.0, 0.0, -396.0, 0.0, 0.0, -29.0, -268.0, -40.0, -316.0, 12.0, 0.0, -308.0, 0.0, -84.0, 0.0, 6.0, 10.0, -78.0, -392.0, -15.0, -116.0, -258.0, 0.0, 0.0, 2.0, 0.0, -12.0], "policy_predator_policy_reward": [0.0, 41.0, 2.0, 0.0, 144.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 102.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 26.0, 121.0, 0.0, 0.0, 0.0, 33.0, 0.0, 181.0, 172.0, 191.0, 54.0, 0.0, 39.0, 0.0, 0.0, 0.0, 94.0, 48.0, 0.0, 177.0, 41.0, 120.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 49.0, 3.0, 0.0, 92.0, 156.0, 0.0, 0.0, 149.0, 110.0, 2.0, 137.0, 0.0, 13.0, 108.0, 97.0, 168.0, 187.0, 0.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 183.0, 126.0, 24.0, 87.0, 160.0, 7.0, 99.0, 89.0, 200.0, 200.0, 5.0, 0.0, 109.0, 97.0, 36.0, 7.0, 12.0, 63.0, 0.0, 0.0, 164.0, 176.0, 4.0, 6.0, 100.0, 90.0, 0.0, 183.0, 0.0, 82.0, 125.0, 165.0, 0.0, 0.0, 177.0, 181.0, 0.0, 113.0, 99.0, 45.0, 147.0, 95.0, 40.0, 8.0, 0.0, 93.0, 76.0, 0.0, 5.0, 4.0, 123.0, 0.0, 151.0, 0.0, 0.0, 0.0, 83.0, 167.0, 185.0, 160.0, 8.0, 19.0, 172.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 196.0, 186.0, 0.0, 4.0, 0.0, 0.0, 185.0, 112.0, 0.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 94.0, 182.0, 185.0, 0.0, 195.0, 0.0, 75.0, 78.0, 186.0, 0.0, 0.0, 134.0, 17.0, 97.0, 102.0, 0.0, 0.0, 154.0, 0.0, 42.0, 0.0, 2.0, 0.0, 133.0, 199.0, 59.0, 0.0, 131.0, 0.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9263990793992556, "mean_inference_ms": 2.398824578330239, "mean_action_processing_ms": 0.42073195211504616, "mean_env_wait_ms": 0.3282683409621531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009230613708496094, "StateBufferConnector_ms": 0.0032584667205810547, "ViewRequirementAgentConnector_ms": 0.11820077896118164}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -394.0, "episode_return_mean": -64.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.95819224509574, "num_env_steps_trained_throughput_per_sec": 333.95819224509574, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 12178.224, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12178.175, "sample_time_ms": 1511.13, "learn_time_ms": 10650.635, "learn_throughput": 375.564, "synch_weights_time_ms": 13.854}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "f1691_00000", "date": "2024-08-13_16-59-24", "timestamp": 1723582764, "time_this_iter_s": 12.04993200302124, "time_total_s": 1255.0856943130493, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d0fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1255.0856943130493, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 64.77777777777777, "ram_util_percent": 83.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7323329991133756, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.377825203900615, "policy_loss": -3.9104309682019805e-05, "vf_loss": 4.357802102174708, "vf_explained_var": 0.01977985797735749, "kl": 0.008806452954588899, "entropy": 0.37900230100861304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.882407814914437, "cur_kl_coeff": 0.006674194335937498, "cur_lr": 0.009999999999999998, "total_loss": 4.68326503713295, "policy_loss": 0.0004980953200843442, "vf_loss": 4.682766947292146, "vf_explained_var": -4.1944009286386e-09, "kl": 1.4178547420952389e-06, "entropy": 5.866999243961699e-05, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -394.0, "episode_reward_mean": -81.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -100.28, "predator_policy": 59.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 14.0, 0.0, 12.0, -35.0, 12.0, -70.0, 0.0, -36.0, -238.0, -13.0, -191.0, -27.0, 0.0, 20.0, 10.0, -1.0, -6.0, -57.0, -285.0, -167.0, -48.0, -394.0, -5.0, -394.0, -50.0, -38.0, 0.0, 3.0, -6.0, -175.0, -182.0, -75.0, -40.0, 7.0, -4.0, -110.0, -76.0, -49.0, -48.0, -78.0, -64.0, 2.0, -187.0, -151.0, 3.0, -84.0, -25.0, -27.0, -172.0, 0.0, 15.0, -4.0, -10.0, -4.0, 5.0, -295.0, -134.0, 5.0, 0.0, -260.0, -3.0, -190.0, -75.0, -132.0, 0.0, -146.0, -157.0, 12.0, -154.0, -42.0, 18.0, -138.0, -72.0, -127.0, 2.0, -6.0, -181.0, -189.0, -174.0, -4.0, -191.0, -182.0, 17.0, 13.0, -55.0, -270.0, -80.0, -210.0, 0.0, 0.0, -225.0, -4.0, -8.0, -183.0, -326.0, -393.0, -101.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, -9.0, 15.0, 0.0, -84.0, 4.0, 5.0, -312.0, -6.0, 0.0, 0.0, -295.0, 0.0, -278.0, -99.0, -24.0, -2.0, -202.0, -194.0, -10.0, -372.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 0.0, -5.0, -14.0, 1.0, 0.0, -366.0, -222.0, -174.0, -14.0, -320.0, -8.0, -228.0, -400.0, -394.0, -10.0, 0.0, -306.0, -294.0, -43.0, -50.0, -128.0, 15.0, 0.0, 0.0, -352.0, 15.0, 4.0, -20.0, -148.0, -217.0, 1.0, -366.0, -157.0, 0.0, 0.0, -330.0, 7.0, 0.0, -362.0, 0.0, -226.0, 3.0, 0.0, -220.0, -15.0, -276.0, -96.0, 0.0, -8.0, -163.0, -144.0, 4.0, 11.0, -18.0, -64.0, -246.0, -302.0, 0.0, 0.0, 3.0, -334.0, 0.0, -374.0, 4.0, -38.0, -16.0, -344.0, 0.0, 0.0, 0.0, 0.0, 15.0, -8.0, 0.0, -392.0, 0.0, 0.0, -8.0, 0.0, 5.0, -370.0, -222.0, 0.0, -278.0, 4.0, 1.0, 0.0, 0.0, -188.0, -166.0, -370.0, 0.0, -385.0, 0.0, 0.0, -150.0, 0.0, -396.0, 0.0, 0.0, -29.0, -268.0, -40.0, -316.0, 12.0, 0.0, -308.0, 0.0, -84.0, 0.0, 6.0, 10.0, -78.0, -392.0, -15.0, -116.0, -258.0, 0.0, 0.0, 2.0, 0.0, -12.0, -147.0, -226.0, -168.0, -150.0, -117.0, -400.0, 2.0, -12.0, 0.0, -394.0, -373.0, 0.0, 2.0, 15.0, 11.0, 0.0, -88.0, -293.0, -70.0, -400.0, 0.0, -160.0, -132.0, -288.0, 0.0, 0.0, 0.0, 0.0, -212.0, -256.0, 0.0, -16.0, -4.0, -12.0, -260.0, -112.0, -400.0, -126.0, -348.0, -348.0, 0.0, -209.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 49.0, 3.0, 0.0, 92.0, 156.0, 0.0, 0.0, 149.0, 110.0, 2.0, 137.0, 0.0, 13.0, 108.0, 97.0, 168.0, 187.0, 0.0, 0.0, 2.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 183.0, 126.0, 24.0, 87.0, 160.0, 7.0, 99.0, 89.0, 200.0, 200.0, 5.0, 0.0, 109.0, 97.0, 36.0, 7.0, 12.0, 63.0, 0.0, 0.0, 164.0, 176.0, 4.0, 6.0, 100.0, 90.0, 0.0, 183.0, 0.0, 82.0, 125.0, 165.0, 0.0, 0.0, 177.0, 181.0, 0.0, 113.0, 99.0, 45.0, 147.0, 95.0, 40.0, 8.0, 0.0, 93.0, 76.0, 0.0, 5.0, 4.0, 123.0, 0.0, 151.0, 0.0, 0.0, 0.0, 83.0, 167.0, 185.0, 160.0, 8.0, 19.0, 172.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 196.0, 186.0, 0.0, 4.0, 0.0, 0.0, 185.0, 112.0, 0.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 94.0, 182.0, 185.0, 0.0, 195.0, 0.0, 75.0, 78.0, 186.0, 0.0, 0.0, 134.0, 17.0, 97.0, 102.0, 0.0, 0.0, 154.0, 0.0, 42.0, 0.0, 2.0, 0.0, 133.0, 199.0, 59.0, 0.0, 131.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 192.0, 26.0, 103.0, 154.0, 189.0, 0.0, 6.0, 9.0, 194.0, 191.0, 0.0, 0.0, 0.0, 0.0, 2.0, 172.0, 154.0, 0.0, 200.0, 78.0, 2.0, 66.0, 144.0, 0.0, 0.0, 0.0, 0.0, 110.0, 133.0, 12.0, 0.0, 8.0, 0.0, 133.0, 56.0, 0.0, 200.0, 129.0, 174.0, 0.0, 108.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.923685854835842, "mean_inference_ms": 2.391961071786698, "mean_action_processing_ms": 0.41915308667935874, "mean_env_wait_ms": 0.32719851429750924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017182588577270508, "StateBufferConnector_ms": 0.003279447555541992, "ViewRequirementAgentConnector_ms": 0.12091434001922607}, "num_episodes": 22, "episode_return_max": 20.0, "episode_return_min": -394.0, "episode_return_mean": -81.63, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.3560026999393, "num_env_steps_trained_throughput_per_sec": 337.3560026999393, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 12184.368, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12184.319, "sample_time_ms": 1512.891, "learn_time_ms": 10654.619, "learn_throughput": 375.424, "synch_weights_time_ms": 14.225}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "f1691_00000", "date": "2024-08-13_16-59-36", "timestamp": 1723582776, "time_this_iter_s": 11.908522844314575, "time_total_s": 1266.994217157364, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db65e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1266.994217157364, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 63.425000000000004, "ram_util_percent": 83.28750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.331966473375048, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.9878186449172004, "policy_loss": 0.0007861546807424732, "vf_loss": 3.9653726029017613, "vf_explained_var": 0.06288370515303637, "kl": 0.009507769016845094, "entropy": 0.34021383329201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8666277807778138, "cur_kl_coeff": 0.003337097167968749, "cur_lr": 0.009999999999999998, "total_loss": 4.481041608916389, "policy_loss": -1.8774071294400427e-05, "vf_loss": 4.4810603877223985, "vf_explained_var": -1.7029898507254464e-09, "kl": 1.030713160341961e-06, "entropy": 1.6020238543629246e-05, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -395.0, "episode_reward_mean": -95.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -109.65, "predator_policy": 62.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -57.0, -285.0, -167.0, -48.0, -394.0, -5.0, -394.0, -50.0, -38.0, 0.0, 3.0, -6.0, -175.0, -182.0, -75.0, -40.0, 7.0, -4.0, -110.0, -76.0, -49.0, -48.0, -78.0, -64.0, 2.0, -187.0, -151.0, 3.0, -84.0, -25.0, -27.0, -172.0, 0.0, 15.0, -4.0, -10.0, -4.0, 5.0, -295.0, -134.0, 5.0, 0.0, -260.0, -3.0, -190.0, -75.0, -132.0, 0.0, -146.0, -157.0, 12.0, -154.0, -42.0, 18.0, -138.0, -72.0, -127.0, 2.0, -6.0, -181.0, -189.0, -174.0, -4.0, -191.0, -182.0, 17.0, 13.0, -55.0, -270.0, -80.0, -210.0, 0.0, 0.0, -225.0, -4.0, -8.0, -183.0, -326.0, -393.0, -101.0, 0.0, 0.0, 0.0, -324.0, -388.0, -12.0, -3.0, -114.0, -116.0, -183.0, -11.0, -395.0, -217.0, 0.0, -119.0, 0.0, 15.0, 15.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 1.0, 0.0, -366.0, -222.0, -174.0, -14.0, -320.0, -8.0, -228.0, -400.0, -394.0, -10.0, 0.0, -306.0, -294.0, -43.0, -50.0, -128.0, 15.0, 0.0, 0.0, -352.0, 15.0, 4.0, -20.0, -148.0, -217.0, 1.0, -366.0, -157.0, 0.0, 0.0, -330.0, 7.0, 0.0, -362.0, 0.0, -226.0, 3.0, 0.0, -220.0, -15.0, -276.0, -96.0, 0.0, -8.0, -163.0, -144.0, 4.0, 11.0, -18.0, -64.0, -246.0, -302.0, 0.0, 0.0, 3.0, -334.0, 0.0, -374.0, 4.0, -38.0, -16.0, -344.0, 0.0, 0.0, 0.0, 0.0, 15.0, -8.0, 0.0, -392.0, 0.0, 0.0, -8.0, 0.0, 5.0, -370.0, -222.0, 0.0, -278.0, 4.0, 1.0, 0.0, 0.0, -188.0, -166.0, -370.0, 0.0, -385.0, 0.0, 0.0, -150.0, 0.0, -396.0, 0.0, 0.0, -29.0, -268.0, -40.0, -316.0, 12.0, 0.0, -308.0, 0.0, -84.0, 0.0, 6.0, 10.0, -78.0, -392.0, -15.0, -116.0, -258.0, 0.0, 0.0, 2.0, 0.0, -12.0, -147.0, -226.0, -168.0, -150.0, -117.0, -400.0, 2.0, -12.0, 0.0, -394.0, -373.0, 0.0, 2.0, 15.0, 11.0, 0.0, -88.0, -293.0, -70.0, -400.0, 0.0, -160.0, -132.0, -288.0, 0.0, 0.0, 0.0, 0.0, -212.0, -256.0, 0.0, -16.0, -4.0, -12.0, -260.0, -112.0, -400.0, -126.0, -348.0, -348.0, 0.0, -209.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -288.0, -288.0, -400.0, -372.0, -110.0, 0.0, 0.0, -19.0, -24.0, -204.0, -12.0, -208.0, 15.0, -396.0, -52.0, 15.0, -302.0, -372.0, -256.0, -124.0, 0.0, 0.0, -7.0, -234.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -98.0], "policy_predator_policy_reward": [0.0, 7.0, 183.0, 126.0, 24.0, 87.0, 160.0, 7.0, 99.0, 89.0, 200.0, 200.0, 5.0, 0.0, 109.0, 97.0, 36.0, 7.0, 12.0, 63.0, 0.0, 0.0, 164.0, 176.0, 4.0, 6.0, 100.0, 90.0, 0.0, 183.0, 0.0, 82.0, 125.0, 165.0, 0.0, 0.0, 177.0, 181.0, 0.0, 113.0, 99.0, 45.0, 147.0, 95.0, 40.0, 8.0, 0.0, 93.0, 76.0, 0.0, 5.0, 4.0, 123.0, 0.0, 151.0, 0.0, 0.0, 0.0, 83.0, 167.0, 185.0, 160.0, 8.0, 19.0, 172.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 196.0, 186.0, 0.0, 4.0, 0.0, 0.0, 185.0, 112.0, 0.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 94.0, 182.0, 185.0, 0.0, 195.0, 0.0, 75.0, 78.0, 186.0, 0.0, 0.0, 134.0, 17.0, 97.0, 102.0, 0.0, 0.0, 154.0, 0.0, 42.0, 0.0, 2.0, 0.0, 133.0, 199.0, 59.0, 0.0, 131.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 192.0, 26.0, 103.0, 154.0, 189.0, 0.0, 6.0, 9.0, 194.0, 191.0, 0.0, 0.0, 0.0, 0.0, 2.0, 172.0, 154.0, 0.0, 200.0, 78.0, 2.0, 66.0, 144.0, 0.0, 0.0, 0.0, 0.0, 110.0, 133.0, 12.0, 0.0, 8.0, 0.0, 133.0, 56.0, 0.0, 200.0, 129.0, 174.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 108.0, 200.0, 184.0, 54.0, 44.0, 16.0, 0.0, 12.0, 102.0, 0.0, 104.0, 198.0, 0.0, 26.0, 0.0, 79.0, 200.0, 0.0, 163.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 32.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.921593702629383, "mean_inference_ms": 2.3867048313492827, "mean_action_processing_ms": 0.4179002833476245, "mean_env_wait_ms": 0.3263748676295502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016673684120178223, "StateBufferConnector_ms": 0.0032323598861694336, "ViewRequirementAgentConnector_ms": 0.12967979907989502}, "num_episodes": 18, "episode_return_max": 18.0, "episode_return_min": -395.0, "episode_return_mean": -95.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.49137429463855, "num_env_steps_trained_throughput_per_sec": 323.49137429463855, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 12184.569, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12184.521, "sample_time_ms": 1509.164, "learn_time_ms": 10659.481, "learn_throughput": 375.253, "synch_weights_time_ms": 13.633}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "f1691_00000", "date": "2024-08-13_16-59-48", "timestamp": 1723582788, "time_this_iter_s": 12.471269130706787, "time_total_s": 1279.4654862880707, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfbdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1279.4654862880707, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 65.88888888888889, "ram_util_percent": 83.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.485582248811369, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.5489292883999135, "policy_loss": -0.0003468166211393302, "vf_loss": 2.5354792844050777, "vf_explained_var": 0.08214526526511662, "kl": 0.006056218225162217, "entropy": 0.3022406056365639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.386662264940053, "cur_kl_coeff": 0.0016685485839843745, "cur_lr": 0.009999999999999998, "total_loss": 3.549967442555402, "policy_loss": -8.936372644726246e-05, "vf_loss": 3.5500568003881545, "vf_explained_var": -5.613559137576472e-09, "kl": 3.4884264284775805e-07, "entropy": 6.758717944933023e-06, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -596.0, "episode_reward_mean": -104.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -107.855, "predator_policy": 55.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, -64.0, 2.0, -187.0, -151.0, 3.0, -84.0, -25.0, -27.0, -172.0, 0.0, 15.0, -4.0, -10.0, -4.0, 5.0, -295.0, -134.0, 5.0, 0.0, -260.0, -3.0, -190.0, -75.0, -132.0, 0.0, -146.0, -157.0, 12.0, -154.0, -42.0, 18.0, -138.0, -72.0, -127.0, 2.0, -6.0, -181.0, -189.0, -174.0, -4.0, -191.0, -182.0, 17.0, 13.0, -55.0, -270.0, -80.0, -210.0, 0.0, 0.0, -225.0, -4.0, -8.0, -183.0, -326.0, -393.0, -101.0, 0.0, 0.0, 0.0, -324.0, -388.0, -12.0, -3.0, -114.0, -116.0, -183.0, -11.0, -395.0, -217.0, 0.0, -119.0, 0.0, 15.0, 15.0, -49.0, 18.0, -418.0, -516.0, -582.0, -8.0, 29.0, 15.0, -273.0, -313.0, -45.0, -596.0, 0.0, 20.0, 9.0, 0.0, -13.0, -189.0, -91.0, 2.0, 9.0, -151.0, -22.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, -163.0, -144.0, 4.0, 11.0, -18.0, -64.0, -246.0, -302.0, 0.0, 0.0, 3.0, -334.0, 0.0, -374.0, 4.0, -38.0, -16.0, -344.0, 0.0, 0.0, 0.0, 0.0, 15.0, -8.0, 0.0, -392.0, 0.0, 0.0, -8.0, 0.0, 5.0, -370.0, -222.0, 0.0, -278.0, 4.0, 1.0, 0.0, 0.0, -188.0, -166.0, -370.0, 0.0, -385.0, 0.0, 0.0, -150.0, 0.0, -396.0, 0.0, 0.0, -29.0, -268.0, -40.0, -316.0, 12.0, 0.0, -308.0, 0.0, -84.0, 0.0, 6.0, 10.0, -78.0, -392.0, -15.0, -116.0, -258.0, 0.0, 0.0, 2.0, 0.0, -12.0, -147.0, -226.0, -168.0, -150.0, -117.0, -400.0, 2.0, -12.0, 0.0, -394.0, -373.0, 0.0, 2.0, 15.0, 11.0, 0.0, -88.0, -293.0, -70.0, -400.0, 0.0, -160.0, -132.0, -288.0, 0.0, 0.0, 0.0, 0.0, -212.0, -256.0, 0.0, -16.0, -4.0, -12.0, -260.0, -112.0, -400.0, -126.0, -348.0, -348.0, 0.0, -209.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -288.0, -288.0, -400.0, -372.0, -110.0, 0.0, 0.0, -19.0, -24.0, -204.0, -12.0, -208.0, 15.0, -396.0, -52.0, 15.0, -302.0, -372.0, -256.0, -124.0, 0.0, 0.0, -7.0, -234.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -98.0, 10.0, 4.0, -283.0, -292.0, -372.0, -372.0, -394.0, -386.0, 15.0, -400.0, 15.0, 14.0, 0.0, 15.0, -236.0, -210.0, -266.0, -364.0, -25.0, -40.0, -400.0, -396.0, 0.0, 0.0, 13.0, 7.0, 6.0, 3.0, 0.0, 0.0, 0.0, -29.0, -388.0, 3.0, 0.0, -188.0, -2.0, 0.0, 9.0, 0.0, 0.0, -384.0, 0.0, -44.0, 6.0, 0.0], "policy_predator_policy_reward": [0.0, 93.0, 76.0, 0.0, 5.0, 4.0, 123.0, 0.0, 151.0, 0.0, 0.0, 0.0, 83.0, 167.0, 185.0, 160.0, 8.0, 19.0, 172.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 196.0, 186.0, 0.0, 4.0, 0.0, 0.0, 185.0, 112.0, 0.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 94.0, 182.0, 185.0, 0.0, 195.0, 0.0, 75.0, 78.0, 186.0, 0.0, 0.0, 134.0, 17.0, 97.0, 102.0, 0.0, 0.0, 154.0, 0.0, 42.0, 0.0, 2.0, 0.0, 133.0, 199.0, 59.0, 0.0, 131.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 192.0, 26.0, 103.0, 154.0, 189.0, 0.0, 6.0, 9.0, 194.0, 191.0, 0.0, 0.0, 0.0, 0.0, 2.0, 172.0, 154.0, 0.0, 200.0, 78.0, 2.0, 66.0, 144.0, 0.0, 0.0, 0.0, 0.0, 110.0, 133.0, 12.0, 0.0, 8.0, 0.0, 133.0, 56.0, 0.0, 200.0, 129.0, 174.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 108.0, 200.0, 184.0, 54.0, 44.0, 16.0, 0.0, 12.0, 102.0, 0.0, 104.0, 198.0, 0.0, 26.0, 0.0, 79.0, 200.0, 0.0, 163.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 32.0, 0.0, 4.0, 13.0, 144.0, 42.0, 186.0, 0.0, 198.0, 177.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, 135.0, 182.0, 0.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 196.0, 0.0, 97.0, 0.0, 4.0, 0.0, 0.0, 0.0, 189.0, 44.0, 0.0, 22.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9191861438720375, "mean_inference_ms": 2.3805106387835147, "mean_action_processing_ms": 0.416337991471018, "mean_env_wait_ms": 0.32540245250896793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019399046897888184, "StateBufferConnector_ms": 0.0035250186920166016, "ViewRequirementAgentConnector_ms": 0.14353632926940918}, "num_episodes": 23, "episode_return_max": 29.0, "episode_return_min": -596.0, "episode_return_mean": -104.31, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.79468840944554, "num_env_steps_trained_throughput_per_sec": 333.79468840944554, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 12113.038, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12112.988, "sample_time_ms": 1485.317, "learn_time_ms": 10611.047, "learn_throughput": 376.966, "synch_weights_time_ms": 13.927}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "f1691_00000", "date": "2024-08-13_17-00-00", "timestamp": 1723582800, "time_this_iter_s": 12.080770015716553, "time_total_s": 1291.5462563037872, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3742820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1291.5462563037872, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 60.48823529411766, "ram_util_percent": 83.62352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1971209135951186, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.642780513864346, "policy_loss": 0.0004996302978643192, "vf_loss": 3.6176469300789806, "vf_explained_var": 0.04025790287704064, "kl": 0.01081325987287778, "entropy": 0.28353156288149495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7947814713967052, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.009999999999999998, "total_loss": 3.4725954179410583, "policy_loss": 2.4037936544686398e-05, "vf_loss": 3.472571370841334, "vf_explained_var": -5.613559137576472e-09, "kl": 2.4593927882336665e-07, "entropy": 3.073589675028733e-06, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -596.0, "episode_reward_mean": -101.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -105.755, "predator_policy": 55.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 0.0, -260.0, -3.0, -190.0, -75.0, -132.0, 0.0, -146.0, -157.0, 12.0, -154.0, -42.0, 18.0, -138.0, -72.0, -127.0, 2.0, -6.0, -181.0, -189.0, -174.0, -4.0, -191.0, -182.0, 17.0, 13.0, -55.0, -270.0, -80.0, -210.0, 0.0, 0.0, -225.0, -4.0, -8.0, -183.0, -326.0, -393.0, -101.0, 0.0, 0.0, 0.0, -324.0, -388.0, -12.0, -3.0, -114.0, -116.0, -183.0, -11.0, -395.0, -217.0, 0.0, -119.0, 0.0, 15.0, 15.0, -49.0, 18.0, -418.0, -516.0, -582.0, -8.0, 29.0, 15.0, -273.0, -313.0, -45.0, -596.0, 0.0, 20.0, 9.0, 0.0, -13.0, -189.0, -91.0, 2.0, 9.0, -151.0, -22.0, 6.0, -65.0, -63.0, 0.0, 0.0, 0.0, -11.0, 5.0, 16.0, -115.0, -119.0, 15.0, -115.0, -10.0, -265.0, 4.0, -126.0, 11.0, -65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, 1.0, 0.0, 0.0, -188.0, -166.0, -370.0, 0.0, -385.0, 0.0, 0.0, -150.0, 0.0, -396.0, 0.0, 0.0, -29.0, -268.0, -40.0, -316.0, 12.0, 0.0, -308.0, 0.0, -84.0, 0.0, 6.0, 10.0, -78.0, -392.0, -15.0, -116.0, -258.0, 0.0, 0.0, 2.0, 0.0, -12.0, -147.0, -226.0, -168.0, -150.0, -117.0, -400.0, 2.0, -12.0, 0.0, -394.0, -373.0, 0.0, 2.0, 15.0, 11.0, 0.0, -88.0, -293.0, -70.0, -400.0, 0.0, -160.0, -132.0, -288.0, 0.0, 0.0, 0.0, 0.0, -212.0, -256.0, 0.0, -16.0, -4.0, -12.0, -260.0, -112.0, -400.0, -126.0, -348.0, -348.0, 0.0, -209.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -288.0, -288.0, -400.0, -372.0, -110.0, 0.0, 0.0, -19.0, -24.0, -204.0, -12.0, -208.0, 15.0, -396.0, -52.0, 15.0, -302.0, -372.0, -256.0, -124.0, 0.0, 0.0, -7.0, -234.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -98.0, 10.0, 4.0, -283.0, -292.0, -372.0, -372.0, -394.0, -386.0, 15.0, -400.0, 15.0, 14.0, 0.0, 15.0, -236.0, -210.0, -266.0, -364.0, -25.0, -40.0, -400.0, -396.0, 0.0, 0.0, 13.0, 7.0, 6.0, 3.0, 0.0, 0.0, 0.0, -29.0, -388.0, 3.0, 0.0, -188.0, -2.0, 0.0, 9.0, 0.0, 0.0, -384.0, 0.0, -44.0, 6.0, 0.0, -400.0, 2.0, -28.0, -363.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 5.0, 0.0, 15.0, 1.0, -230.0, 0.0, 0.0, -238.0, 15.0, 0.0, -370.0, -117.0, -8.0, -19.0, -206.0, -162.0, -384.0, 15.0, -254.0, 0.0, 11.0, 0.0, 0.0, -130.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 94.0, 182.0, 185.0, 0.0, 195.0, 0.0, 75.0, 78.0, 186.0, 0.0, 0.0, 134.0, 17.0, 97.0, 102.0, 0.0, 0.0, 154.0, 0.0, 42.0, 0.0, 2.0, 0.0, 133.0, 199.0, 59.0, 0.0, 131.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 192.0, 26.0, 103.0, 154.0, 189.0, 0.0, 6.0, 9.0, 194.0, 191.0, 0.0, 0.0, 0.0, 0.0, 2.0, 172.0, 154.0, 0.0, 200.0, 78.0, 2.0, 66.0, 144.0, 0.0, 0.0, 0.0, 0.0, 110.0, 133.0, 12.0, 0.0, 8.0, 0.0, 133.0, 56.0, 0.0, 200.0, 129.0, 174.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 108.0, 200.0, 184.0, 54.0, 44.0, 16.0, 0.0, 12.0, 102.0, 0.0, 104.0, 198.0, 0.0, 26.0, 0.0, 79.0, 200.0, 0.0, 163.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 32.0, 0.0, 4.0, 13.0, 144.0, 42.0, 186.0, 0.0, 198.0, 177.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, 135.0, 182.0, 0.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 196.0, 0.0, 97.0, 0.0, 4.0, 0.0, 0.0, 0.0, 189.0, 44.0, 0.0, 22.0, 0.0, 0.0, 169.0, 164.0, 186.0, 142.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 119.0, 0.0, 0.0, 0.0, 185.0, 187.0, 17.0, 0.0, 103.0, 0.0, 181.0, 192.0, 128.0, 0.0, 0.0, 0.0, 64.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9179918543315833, "mean_inference_ms": 2.3777625929466, "mean_action_processing_ms": 0.4153541848152888, "mean_env_wait_ms": 0.3248534683617062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016347885131835938, "StateBufferConnector_ms": 0.0035605430603027344, "ViewRequirementAgentConnector_ms": 0.1656244993209839}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -596.0, "episode_return_mean": -101.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.6437336931295, "num_env_steps_trained_throughput_per_sec": 342.6437336931295, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 12039.745, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12039.696, "sample_time_ms": 1529.191, "learn_time_ms": 10492.615, "learn_throughput": 381.221, "synch_weights_time_ms": 14.638}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "f1691_00000", "date": "2024-08-13_17-00-12", "timestamp": 1723582812, "time_this_iter_s": 11.745134115219116, "time_total_s": 1303.2913904190063, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3760160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1303.2913904190063, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 59.67058823529412, "ram_util_percent": 83.66470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5275959905020144, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.6141565669781315, "policy_loss": 0.0017479160046648412, "vf_loss": 4.59090960770057, "vf_explained_var": 0.03705135965473438, "kl": 0.009437168751014463, "entropy": 0.30189217845441174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9393692760553214, "cur_kl_coeff": 0.0004171371459960936, "cur_lr": 0.009999999999999998, "total_loss": 4.60435622116876, "policy_loss": 0.0001942965123191397, "vf_loss": 4.604161928822754, "vf_explained_var": -3.2167586069258434e-09, "kl": 4.511591180874154e-08, "entropy": 1.2849400660504442e-06, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -596.0, "episode_reward_mean": -102.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -106.105, "predator_policy": 54.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -191.0, -182.0, 17.0, 13.0, -55.0, -270.0, -80.0, -210.0, 0.0, 0.0, -225.0, -4.0, -8.0, -183.0, -326.0, -393.0, -101.0, 0.0, 0.0, 0.0, -324.0, -388.0, -12.0, -3.0, -114.0, -116.0, -183.0, -11.0, -395.0, -217.0, 0.0, -119.0, 0.0, 15.0, 15.0, -49.0, 18.0, -418.0, -516.0, -582.0, -8.0, 29.0, 15.0, -273.0, -313.0, -45.0, -596.0, 0.0, 20.0, 9.0, 0.0, -13.0, -189.0, -91.0, 2.0, 9.0, -151.0, -22.0, 6.0, -65.0, -63.0, 0.0, 0.0, 0.0, -11.0, 5.0, 16.0, -115.0, -119.0, 15.0, -115.0, -10.0, -265.0, 4.0, -126.0, 11.0, -65.0, 9.0, -343.0, -109.0, -190.0, -180.0, -138.0, -304.0, 1.0, 0.0, 30.0, -27.0, -129.0, 10.0, -127.0, 9.0, -86.0, -104.0, -2.0, -167.0, -67.0, -109.0, -111.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, -12.0, 0.0, -394.0, -373.0, 0.0, 2.0, 15.0, 11.0, 0.0, -88.0, -293.0, -70.0, -400.0, 0.0, -160.0, -132.0, -288.0, 0.0, 0.0, 0.0, 0.0, -212.0, -256.0, 0.0, -16.0, -4.0, -12.0, -260.0, -112.0, -400.0, -126.0, -348.0, -348.0, 0.0, -209.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -288.0, -288.0, -400.0, -372.0, -110.0, 0.0, 0.0, -19.0, -24.0, -204.0, -12.0, -208.0, 15.0, -396.0, -52.0, 15.0, -302.0, -372.0, -256.0, -124.0, 0.0, 0.0, -7.0, -234.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -98.0, 10.0, 4.0, -283.0, -292.0, -372.0, -372.0, -394.0, -386.0, 15.0, -400.0, 15.0, 14.0, 0.0, 15.0, -236.0, -210.0, -266.0, -364.0, -25.0, -40.0, -400.0, -396.0, 0.0, 0.0, 13.0, 7.0, 6.0, 3.0, 0.0, 0.0, 0.0, -29.0, -388.0, 3.0, 0.0, -188.0, -2.0, 0.0, 9.0, 0.0, 0.0, -384.0, 0.0, -44.0, 6.0, 0.0, -400.0, 2.0, -28.0, -363.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 5.0, 0.0, 15.0, 1.0, -230.0, 0.0, 0.0, -238.0, 15.0, 0.0, -370.0, -117.0, -8.0, -19.0, -206.0, -162.0, -384.0, 15.0, -254.0, 0.0, 11.0, 0.0, 0.0, -130.0, 9.0, 0.0, -286.0, -400.0, -88.0, -335.0, -385.0, 0.0, -180.0, -185.0, -95.0, -105.0, -299.0, -300.0, 7.0, -25.0, 0.0, -10.0, 15.0, 15.0, -84.0, 15.0, -276.0, 9.0, 10.0, 0.0, -261.0, 0.0, 0.0, 8.0, -202.0, 15.0, -356.0, 0.0, -4.0, 0.0, -74.0, -300.0, 0.0, -134.0, -218.0, -3.0, -312.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 9.0, 194.0, 191.0, 0.0, 0.0, 0.0, 0.0, 2.0, 172.0, 154.0, 0.0, 200.0, 78.0, 2.0, 66.0, 144.0, 0.0, 0.0, 0.0, 0.0, 110.0, 133.0, 12.0, 0.0, 8.0, 0.0, 133.0, 56.0, 0.0, 200.0, 129.0, 174.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 108.0, 200.0, 184.0, 54.0, 44.0, 16.0, 0.0, 12.0, 102.0, 0.0, 104.0, 198.0, 0.0, 26.0, 0.0, 79.0, 200.0, 0.0, 163.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 32.0, 0.0, 4.0, 13.0, 144.0, 42.0, 186.0, 0.0, 198.0, 177.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, 135.0, 182.0, 0.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 196.0, 0.0, 97.0, 0.0, 4.0, 0.0, 0.0, 0.0, 189.0, 44.0, 0.0, 22.0, 0.0, 0.0, 169.0, 164.0, 186.0, 142.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 119.0, 0.0, 0.0, 0.0, 185.0, 187.0, 17.0, 0.0, 103.0, 0.0, 181.0, 192.0, 128.0, 0.0, 0.0, 0.0, 64.0, 1.0, 0.0, 0.0, 200.0, 143.0, 169.0, 145.0, 7.0, 188.0, 163.0, 22.0, 62.0, 0.0, 150.0, 145.0, 19.0, 0.0, 0.0, 10.0, 0.0, 0.0, 42.0, 0.0, 138.0, 0.0, 0.0, 0.0, 0.0, 134.0, 0.0, 1.0, 0.0, 101.0, 178.0, 74.0, 0.0, 2.0, 57.0, 150.0, 67.0, 0.0, 3.0, 109.0, 45.0, 156.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9188084991619343, "mean_inference_ms": 2.3819262513453556, "mean_action_processing_ms": 0.41504333669205096, "mean_env_wait_ms": 0.3251249045714723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564931869506836, "StateBufferConnector_ms": 0.003506183624267578, "ViewRequirementAgentConnector_ms": 0.19674766063690186}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -596.0, "episode_return_mean": -102.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.77555157761236, "num_env_steps_trained_throughput_per_sec": 315.77555157761236, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 12109.874, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12109.82, "sample_time_ms": 1742.254, "learn_time_ms": 10350.099, "learn_throughput": 386.47, "synch_weights_time_ms": 14.49}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "f1691_00000", "date": "2024-08-13_17-00-25", "timestamp": 1723582825, "time_this_iter_s": 12.710495948791504, "time_total_s": 1316.0018863677979, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db6670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1316.0018863677979, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 63.794444444444444, "ram_util_percent": 83.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8967691611991357, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.2276661356920915, "policy_loss": -0.00019748684748139962, "vf_loss": 4.2101413431621735, "vf_explained_var": 0.03581264542524146, "kl": 0.007779329030582299, "entropy": 0.2185900989742506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9110438228556954, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.009999999999999998, "total_loss": 4.697133881326706, "policy_loss": -3.966479365117651e-05, "vf_loss": 4.69717353714837, "vf_explained_var": -2.6490953233506945e-09, "kl": 1.880726043161765e-08, "entropy": 4.161028089077975e-07, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -596.0, "episode_reward_mean": -112.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -109.65, "predator_policy": 53.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -324.0, -388.0, -12.0, -3.0, -114.0, -116.0, -183.0, -11.0, -395.0, -217.0, 0.0, -119.0, 0.0, 15.0, 15.0, -49.0, 18.0, -418.0, -516.0, -582.0, -8.0, 29.0, 15.0, -273.0, -313.0, -45.0, -596.0, 0.0, 20.0, 9.0, 0.0, -13.0, -189.0, -91.0, 2.0, 9.0, -151.0, -22.0, 6.0, -65.0, -63.0, 0.0, 0.0, 0.0, -11.0, 5.0, 16.0, -115.0, -119.0, 15.0, -115.0, -10.0, -265.0, 4.0, -126.0, 11.0, -65.0, 9.0, -343.0, -109.0, -190.0, -180.0, -138.0, -304.0, 1.0, 0.0, 30.0, -27.0, -129.0, 10.0, -127.0, 9.0, -86.0, -104.0, -2.0, -167.0, -67.0, -109.0, -111.0, -133.0, 0.0, 0.0, 5.0, -297.0, -182.0, -83.0, -433.0, -576.0, -47.0, -564.0, -208.0, -63.0, -148.0, -279.0, 30.0, -159.0, -26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -288.0, -288.0, -400.0, -372.0, -110.0, 0.0, 0.0, -19.0, -24.0, -204.0, -12.0, -208.0, 15.0, -396.0, -52.0, 15.0, -302.0, -372.0, -256.0, -124.0, 0.0, 0.0, -7.0, -234.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -98.0, 10.0, 4.0, -283.0, -292.0, -372.0, -372.0, -394.0, -386.0, 15.0, -400.0, 15.0, 14.0, 0.0, 15.0, -236.0, -210.0, -266.0, -364.0, -25.0, -40.0, -400.0, -396.0, 0.0, 0.0, 13.0, 7.0, 6.0, 3.0, 0.0, 0.0, 0.0, -29.0, -388.0, 3.0, 0.0, -188.0, -2.0, 0.0, 9.0, 0.0, 0.0, -384.0, 0.0, -44.0, 6.0, 0.0, -400.0, 2.0, -28.0, -363.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 5.0, 0.0, 15.0, 1.0, -230.0, 0.0, 0.0, -238.0, 15.0, 0.0, -370.0, -117.0, -8.0, -19.0, -206.0, -162.0, -384.0, 15.0, -254.0, 0.0, 11.0, 0.0, 0.0, -130.0, 9.0, 0.0, -286.0, -400.0, -88.0, -335.0, -385.0, 0.0, -180.0, -185.0, -95.0, -105.0, -299.0, -300.0, 7.0, -25.0, 0.0, -10.0, 15.0, 15.0, -84.0, 15.0, -276.0, 9.0, 10.0, 0.0, -261.0, 0.0, 0.0, 8.0, -202.0, 15.0, -356.0, 0.0, -4.0, 0.0, -74.0, -300.0, 0.0, -134.0, -218.0, -3.0, -312.0, 0.0, 0.0, -266.0, 0.0, 0.0, 0.0, 0.0, -7.0, 1.0, -173.0, -260.0, 7.0, -378.0, 9.0, -184.0, -354.0, -338.0, -400.0, -376.0, -94.0, 0.0, -364.0, -400.0, -337.0, -92.0, -122.0, -4.0, 0.0, -296.0, -242.0, -158.0, 15.0, 15.0, -332.0, 0.0, -72.0, 10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 108.0, 200.0, 184.0, 54.0, 44.0, 16.0, 0.0, 12.0, 102.0, 0.0, 104.0, 198.0, 0.0, 26.0, 0.0, 79.0, 200.0, 0.0, 163.0, 0.0, 0.0, 0.0, 122.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 32.0, 0.0, 4.0, 13.0, 144.0, 42.0, 186.0, 0.0, 198.0, 177.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, 135.0, 182.0, 0.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 196.0, 0.0, 97.0, 0.0, 4.0, 0.0, 0.0, 0.0, 189.0, 44.0, 0.0, 22.0, 0.0, 0.0, 169.0, 164.0, 186.0, 142.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 119.0, 0.0, 0.0, 0.0, 185.0, 187.0, 17.0, 0.0, 103.0, 0.0, 181.0, 192.0, 128.0, 0.0, 0.0, 0.0, 64.0, 1.0, 0.0, 0.0, 200.0, 143.0, 169.0, 145.0, 7.0, 188.0, 163.0, 22.0, 62.0, 0.0, 150.0, 145.0, 19.0, 0.0, 0.0, 10.0, 0.0, 0.0, 42.0, 0.0, 138.0, 0.0, 0.0, 0.0, 0.0, 134.0, 0.0, 1.0, 0.0, 101.0, 178.0, 74.0, 0.0, 2.0, 57.0, 150.0, 67.0, 0.0, 3.0, 109.0, 45.0, 156.0, 94.0, 39.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 136.0, 0.0, 0.0, 189.0, 92.0, 0.0, 177.0, 82.0, 200.0, 0.0, 47.0, 0.0, 0.0, 200.0, 172.0, 49.0, 63.0, 0.0, 148.0, 0.0, 121.0, 0.0, 0.0, 0.0, 173.0, 0.0, 36.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9204466892212043, "mean_inference_ms": 2.385337958750741, "mean_action_processing_ms": 0.41523461864176964, "mean_env_wait_ms": 0.32550937571189975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007886052131652832, "StateBufferConnector_ms": 0.004912853240966797, "ViewRequirementAgentConnector_ms": 0.2506108283996582}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -596.0, "episode_return_mean": -112.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.80046122333624, "num_env_steps_trained_throughput_per_sec": 322.80046122333624, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 12144.9, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12144.844, "sample_time_ms": 1865.234, "learn_time_ms": 10261.614, "learn_throughput": 389.802, "synch_weights_time_ms": 14.514}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "f1691_00000", "date": "2024-08-13_17-00-38", "timestamp": 1723582838, "time_this_iter_s": 12.444637060165405, "time_total_s": 1328.4465234279633, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db64c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1328.4465234279633, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 62.550000000000004, "ram_util_percent": 83.1611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.318859888132287, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.697937294415065, "policy_loss": 0.0007312512352924656, "vf_loss": 4.6749549040718685, "vf_explained_var": 0.040389967122405925, "kl": 0.009767304018396854, "entropy": 0.24073361823798486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6643206289941206, "cur_kl_coeff": 0.0001042842864990234, "cur_lr": 0.009999999999999998, "total_loss": 4.684105741157733, "policy_loss": -7.725664705195755e-06, "vf_loss": 4.684113473866982, "vf_explained_var": -1.0249475953440186e-08, "kl": 4.258512922425803e-09, "entropy": 2.00295752803312e-07, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -596.0, "episode_reward_mean": -111.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -112.895, "predator_policy": 57.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 29.0, 15.0, -273.0, -313.0, -45.0, -596.0, 0.0, 20.0, 9.0, 0.0, -13.0, -189.0, -91.0, 2.0, 9.0, -151.0, -22.0, 6.0, -65.0, -63.0, 0.0, 0.0, 0.0, -11.0, 5.0, 16.0, -115.0, -119.0, 15.0, -115.0, -10.0, -265.0, 4.0, -126.0, 11.0, -65.0, 9.0, -343.0, -109.0, -190.0, -180.0, -138.0, -304.0, 1.0, 0.0, 30.0, -27.0, -129.0, 10.0, -127.0, 9.0, -86.0, -104.0, -2.0, -167.0, -67.0, -109.0, -111.0, -133.0, 0.0, 0.0, 5.0, -297.0, -182.0, -83.0, -433.0, -576.0, -47.0, -564.0, -208.0, -63.0, -148.0, -279.0, 30.0, -159.0, -26.0, -115.0, -52.0, -552.0, -22.0, -78.0, -290.0, 30.0, -66.0, -130.0, 7.0, -177.0, -49.0, -269.0, 25.0, -139.0, -123.0, 0.0, 0.0, -455.0, -539.0, -119.0, -84.0, -116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, -400.0, 15.0, 14.0, 0.0, 15.0, -236.0, -210.0, -266.0, -364.0, -25.0, -40.0, -400.0, -396.0, 0.0, 0.0, 13.0, 7.0, 6.0, 3.0, 0.0, 0.0, 0.0, -29.0, -388.0, 3.0, 0.0, -188.0, -2.0, 0.0, 9.0, 0.0, 0.0, -384.0, 0.0, -44.0, 6.0, 0.0, -400.0, 2.0, -28.0, -363.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 5.0, 0.0, 15.0, 1.0, -230.0, 0.0, 0.0, -238.0, 15.0, 0.0, -370.0, -117.0, -8.0, -19.0, -206.0, -162.0, -384.0, 15.0, -254.0, 0.0, 11.0, 0.0, 0.0, -130.0, 9.0, 0.0, -286.0, -400.0, -88.0, -335.0, -385.0, 0.0, -180.0, -185.0, -95.0, -105.0, -299.0, -300.0, 7.0, -25.0, 0.0, -10.0, 15.0, 15.0, -84.0, 15.0, -276.0, 9.0, 10.0, 0.0, -261.0, 0.0, 0.0, 8.0, -202.0, 15.0, -356.0, 0.0, -4.0, 0.0, -74.0, -300.0, 0.0, -134.0, -218.0, -3.0, -312.0, 0.0, 0.0, -266.0, 0.0, 0.0, 0.0, 0.0, -7.0, 1.0, -173.0, -260.0, 7.0, -378.0, 9.0, -184.0, -354.0, -338.0, -400.0, -376.0, -94.0, 0.0, -364.0, -400.0, -337.0, -92.0, -122.0, -4.0, 0.0, -296.0, -242.0, -158.0, 15.0, 15.0, -332.0, 0.0, -72.0, 10.0, 15.0, -336.0, 11.0, -280.0, -379.0, -366.0, -59.0, 0.0, 4.0, -164.0, -300.0, -280.0, 15.0, 15.0, -137.0, 0.0, -95.0, -180.0, 7.0, 0.0, -385.0, 15.0, -373.0, 0.0, -400.0, -138.0, 10.0, 15.0, 0.0, -278.0, -251.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, -374.0, -357.0, -373.0, -258.0, 8.0, -163.0, -20.0, 0.0, -237.0], "policy_predator_policy_reward": [177.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 173.0, 135.0, 182.0, 0.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 196.0, 0.0, 97.0, 0.0, 4.0, 0.0, 0.0, 0.0, 189.0, 44.0, 0.0, 22.0, 0.0, 0.0, 169.0, 164.0, 186.0, 142.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 119.0, 0.0, 0.0, 0.0, 185.0, 187.0, 17.0, 0.0, 103.0, 0.0, 181.0, 192.0, 128.0, 0.0, 0.0, 0.0, 64.0, 1.0, 0.0, 0.0, 200.0, 143.0, 169.0, 145.0, 7.0, 188.0, 163.0, 22.0, 62.0, 0.0, 150.0, 145.0, 19.0, 0.0, 0.0, 10.0, 0.0, 0.0, 42.0, 0.0, 138.0, 0.0, 0.0, 0.0, 0.0, 134.0, 0.0, 1.0, 0.0, 101.0, 178.0, 74.0, 0.0, 2.0, 57.0, 150.0, 67.0, 0.0, 3.0, 109.0, 45.0, 156.0, 94.0, 39.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 136.0, 0.0, 0.0, 189.0, 92.0, 0.0, 177.0, 82.0, 200.0, 0.0, 47.0, 0.0, 0.0, 200.0, 172.0, 49.0, 63.0, 0.0, 148.0, 0.0, 121.0, 0.0, 0.0, 0.0, 173.0, 0.0, 36.0, 0.0, 38.0, 168.0, 77.0, 140.0, 193.0, 0.0, 0.0, 37.0, 82.0, 0.0, 150.0, 140.0, 0.0, 0.0, 71.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, 193.0, 135.0, 189.0, 69.0, 200.0, 0.0, 0.0, 70.0, 69.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 112.0, 179.0, 0.0, 191.0, 131.0, 0.0, 89.0, 10.0, 9.0, 112.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.922417988956928, "mean_inference_ms": 2.3946890217106542, "mean_action_processing_ms": 0.41653594161884167, "mean_env_wait_ms": 0.32631984884516585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007554173469543457, "StateBufferConnector_ms": 0.004905343055725098, "ViewRequirementAgentConnector_ms": 0.24395990371704102}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -596.0, "episode_return_mean": -111.24, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.85170882028007, "num_env_steps_trained_throughput_per_sec": 310.85170882028007, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 12201.861, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12201.805, "sample_time_ms": 1919.993, "learn_time_ms": 10263.871, "learn_throughput": 389.717, "synch_weights_time_ms": 14.419}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "f1691_00000", "date": "2024-08-13_17-00-51", "timestamp": 1723582851, "time_this_iter_s": 12.925695180892944, "time_total_s": 1341.3722186088562, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1341.3722186088562, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 67.05000000000001, "ram_util_percent": 83.48333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1535810104280553, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.457149601991845, "policy_loss": 0.0013574235481283968, "vf_loss": 3.4399123738051722, "vf_explained_var": 0.09762818595719716, "kl": 0.0069705545495554, "entropy": 0.19953527264888324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.667582104950786, "cur_kl_coeff": 5.21421432495117e-05, "cur_lr": 0.009999999999999998, "total_loss": 4.157574704841331, "policy_loss": 5.551289333395226e-05, "vf_loss": 4.157519207681928, "vf_explained_var": -1.0880212935190352e-08, "kl": 1.5758443565844707e-09, "entropy": 1.0165174693663667e-07, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -576.0, "episode_reward_mean": -120.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -118.685, "predator_policy": 58.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, -65.0, -63.0, 0.0, 0.0, 0.0, -11.0, 5.0, 16.0, -115.0, -119.0, 15.0, -115.0, -10.0, -265.0, 4.0, -126.0, 11.0, -65.0, 9.0, -343.0, -109.0, -190.0, -180.0, -138.0, -304.0, 1.0, 0.0, 30.0, -27.0, -129.0, 10.0, -127.0, 9.0, -86.0, -104.0, -2.0, -167.0, -67.0, -109.0, -111.0, -133.0, 0.0, 0.0, 5.0, -297.0, -182.0, -83.0, -433.0, -576.0, -47.0, -564.0, -208.0, -63.0, -148.0, -279.0, 30.0, -159.0, -26.0, -115.0, -52.0, -552.0, -22.0, -78.0, -290.0, 30.0, -66.0, -130.0, 7.0, -177.0, -49.0, -269.0, 25.0, -139.0, -123.0, 0.0, 0.0, -455.0, -539.0, -119.0, -84.0, -116.0, -181.0, -152.0, -46.0, -200.0, 19.0, -3.0, -13.0, -356.0, 0.0, 5.0, 12.0, -191.0, -174.0, -566.0, -491.0, -26.0, -8.0, -147.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 0.0, -400.0, 2.0, -28.0, -363.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 5.0, 0.0, 15.0, 1.0, -230.0, 0.0, 0.0, -238.0, 15.0, 0.0, -370.0, -117.0, -8.0, -19.0, -206.0, -162.0, -384.0, 15.0, -254.0, 0.0, 11.0, 0.0, 0.0, -130.0, 9.0, 0.0, -286.0, -400.0, -88.0, -335.0, -385.0, 0.0, -180.0, -185.0, -95.0, -105.0, -299.0, -300.0, 7.0, -25.0, 0.0, -10.0, 15.0, 15.0, -84.0, 15.0, -276.0, 9.0, 10.0, 0.0, -261.0, 0.0, 0.0, 8.0, -202.0, 15.0, -356.0, 0.0, -4.0, 0.0, -74.0, -300.0, 0.0, -134.0, -218.0, -3.0, -312.0, 0.0, 0.0, -266.0, 0.0, 0.0, 0.0, 0.0, -7.0, 1.0, -173.0, -260.0, 7.0, -378.0, 9.0, -184.0, -354.0, -338.0, -400.0, -376.0, -94.0, 0.0, -364.0, -400.0, -337.0, -92.0, -122.0, -4.0, 0.0, -296.0, -242.0, -158.0, 15.0, 15.0, -332.0, 0.0, -72.0, 10.0, 15.0, -336.0, 11.0, -280.0, -379.0, -366.0, -59.0, 0.0, 4.0, -164.0, -300.0, -280.0, 15.0, 15.0, -137.0, 0.0, -95.0, -180.0, 7.0, 0.0, -385.0, 15.0, -373.0, 0.0, -400.0, -138.0, 10.0, 15.0, 0.0, -278.0, -251.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, -374.0, -357.0, -373.0, -258.0, 8.0, -163.0, -20.0, 0.0, -237.0, -362.0, 0.0, 2.0, -308.0, -104.0, 0.0, -400.0, 0.0, -7.0, 15.0, 0.0, -6.0, -27.0, 0.0, -347.0, -366.0, -9.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -382.0, 0.0, -348.0, -366.0, -400.0, -334.0, -332.0, -52.0, 0.0, -16.0, 0.0, -282.0, -6.0], "policy_predator_policy_reward": [0.0, 0.0, 169.0, 164.0, 186.0, 142.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 119.0, 0.0, 0.0, 0.0, 185.0, 187.0, 17.0, 0.0, 103.0, 0.0, 181.0, 192.0, 128.0, 0.0, 0.0, 0.0, 64.0, 1.0, 0.0, 0.0, 200.0, 143.0, 169.0, 145.0, 7.0, 188.0, 163.0, 22.0, 62.0, 0.0, 150.0, 145.0, 19.0, 0.0, 0.0, 10.0, 0.0, 0.0, 42.0, 0.0, 138.0, 0.0, 0.0, 0.0, 0.0, 134.0, 0.0, 1.0, 0.0, 101.0, 178.0, 74.0, 0.0, 2.0, 57.0, 150.0, 67.0, 0.0, 3.0, 109.0, 45.0, 156.0, 94.0, 39.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 136.0, 0.0, 0.0, 189.0, 92.0, 0.0, 177.0, 82.0, 200.0, 0.0, 47.0, 0.0, 0.0, 200.0, 172.0, 49.0, 63.0, 0.0, 148.0, 0.0, 121.0, 0.0, 0.0, 0.0, 173.0, 0.0, 36.0, 0.0, 38.0, 168.0, 77.0, 140.0, 193.0, 0.0, 0.0, 37.0, 82.0, 0.0, 150.0, 140.0, 0.0, 0.0, 71.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, 193.0, 135.0, 189.0, 69.0, 200.0, 0.0, 0.0, 70.0, 69.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 112.0, 179.0, 0.0, 191.0, 131.0, 0.0, 89.0, 10.0, 9.0, 112.0, 162.0, 19.0, 0.0, 154.0, 0.0, 58.0, 200.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 14.0, 183.0, 174.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 191.0, 0.0, 174.0, 0.0, 0.0, 200.0, 0.0, 175.0, 26.0, 0.0, 0.0, 8.0, 141.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9248200787997434, "mean_inference_ms": 2.3981978781105315, "mean_action_processing_ms": 0.4161603643519182, "mean_env_wait_ms": 0.3270503888314383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005162835121154785, "StateBufferConnector_ms": 0.0046923160552978516, "ViewRequirementAgentConnector_ms": 0.2379465103149414}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -576.0, "episode_return_mean": -120.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.8556935904844, "num_env_steps_trained_throughput_per_sec": 318.8556935904844, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 12233.449, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12233.393, "sample_time_ms": 1931.135, "learn_time_ms": 10284.478, "learn_throughput": 388.936, "synch_weights_time_ms": 14.253}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "f1691_00000", "date": "2024-08-13_17-01-03", "timestamp": 1723582863, "time_this_iter_s": 12.59118103981018, "time_total_s": 1353.9633996486664, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dceee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1353.9633996486664, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 65.14117647058822, "ram_util_percent": 83.12352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3557981012990235, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.034010357705373, "policy_loss": -0.00026659078418065317, "vf_loss": 4.021446985164016, "vf_explained_var": 0.08649613478827098, "kl": 0.005631808854877436, "entropy": 0.13168220362729496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6683616889128214, "cur_kl_coeff": 2.607107162475585e-05, "cur_lr": 0.009999999999999998, "total_loss": 4.981936510403951, "policy_loss": -5.996762232845107e-05, "vf_loss": 4.981996486426661, "vf_explained_var": -6.37044351567667e-09, "kl": 8.075932251165251e-10, "entropy": 5.8776337778736146e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -576.0, "episode_reward_mean": -139.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -129.395, "predator_policy": 59.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.0, 9.0, -343.0, -109.0, -190.0, -180.0, -138.0, -304.0, 1.0, 0.0, 30.0, -27.0, -129.0, 10.0, -127.0, 9.0, -86.0, -104.0, -2.0, -167.0, -67.0, -109.0, -111.0, -133.0, 0.0, 0.0, 5.0, -297.0, -182.0, -83.0, -433.0, -576.0, -47.0, -564.0, -208.0, -63.0, -148.0, -279.0, 30.0, -159.0, -26.0, -115.0, -52.0, -552.0, -22.0, -78.0, -290.0, 30.0, -66.0, -130.0, 7.0, -177.0, -49.0, -269.0, 25.0, -139.0, -123.0, 0.0, 0.0, -455.0, -539.0, -119.0, -84.0, -116.0, -181.0, -152.0, -46.0, -200.0, 19.0, -3.0, -13.0, -356.0, 0.0, 5.0, 12.0, -191.0, -174.0, -566.0, -491.0, -26.0, -8.0, -147.0, -178.0, -167.0, 20.0, -534.0, 11.0, -168.0, -193.0, -41.0, -264.0, 0.0, -7.0, -298.0, -196.0, -2.0, -268.0, 14.0, -472.0, -28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -130.0, 9.0, 0.0, -286.0, -400.0, -88.0, -335.0, -385.0, 0.0, -180.0, -185.0, -95.0, -105.0, -299.0, -300.0, 7.0, -25.0, 0.0, -10.0, 15.0, 15.0, -84.0, 15.0, -276.0, 9.0, 10.0, 0.0, -261.0, 0.0, 0.0, 8.0, -202.0, 15.0, -356.0, 0.0, -4.0, 0.0, -74.0, -300.0, 0.0, -134.0, -218.0, -3.0, -312.0, 0.0, 0.0, -266.0, 0.0, 0.0, 0.0, 0.0, -7.0, 1.0, -173.0, -260.0, 7.0, -378.0, 9.0, -184.0, -354.0, -338.0, -400.0, -376.0, -94.0, 0.0, -364.0, -400.0, -337.0, -92.0, -122.0, -4.0, 0.0, -296.0, -242.0, -158.0, 15.0, 15.0, -332.0, 0.0, -72.0, 10.0, 15.0, -336.0, 11.0, -280.0, -379.0, -366.0, -59.0, 0.0, 4.0, -164.0, -300.0, -280.0, 15.0, 15.0, -137.0, 0.0, -95.0, -180.0, 7.0, 0.0, -385.0, 15.0, -373.0, 0.0, -400.0, -138.0, 10.0, 15.0, 0.0, -278.0, -251.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, -374.0, -357.0, -373.0, -258.0, 8.0, -163.0, -20.0, 0.0, -237.0, -362.0, 0.0, 2.0, -308.0, -104.0, 0.0, -400.0, 0.0, -7.0, 15.0, 0.0, -6.0, -27.0, 0.0, -347.0, -366.0, -9.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -382.0, 0.0, -348.0, -366.0, -400.0, -334.0, -332.0, -52.0, 0.0, -16.0, 0.0, -282.0, -6.0, -356.0, 0.0, 0.0, -334.0, 10.0, 10.0, -364.0, -352.0, -10.0, 15.0, 0.0, -345.0, -386.0, 0.0, -94.0, 6.0, -197.0, -223.0, 0.0, 0.0, -4.0, -11.0, -400.0, -196.0, 4.0, -400.0, -4.0, 0.0, -186.0, -340.0, 14.0, 0.0, -284.0, -376.0, -82.0, 12.0], "policy_predator_policy_reward": [64.0, 1.0, 0.0, 0.0, 200.0, 143.0, 169.0, 145.0, 7.0, 188.0, 163.0, 22.0, 62.0, 0.0, 150.0, 145.0, 19.0, 0.0, 0.0, 10.0, 0.0, 0.0, 42.0, 0.0, 138.0, 0.0, 0.0, 0.0, 0.0, 134.0, 0.0, 1.0, 0.0, 101.0, 178.0, 74.0, 0.0, 2.0, 57.0, 150.0, 67.0, 0.0, 3.0, 109.0, 45.0, 156.0, 94.0, 39.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 136.0, 0.0, 0.0, 189.0, 92.0, 0.0, 177.0, 82.0, 200.0, 0.0, 47.0, 0.0, 0.0, 200.0, 172.0, 49.0, 63.0, 0.0, 148.0, 0.0, 121.0, 0.0, 0.0, 0.0, 173.0, 0.0, 36.0, 0.0, 38.0, 168.0, 77.0, 140.0, 193.0, 0.0, 0.0, 37.0, 82.0, 0.0, 150.0, 140.0, 0.0, 0.0, 71.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, 193.0, 135.0, 189.0, 69.0, 200.0, 0.0, 0.0, 70.0, 69.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 112.0, 179.0, 0.0, 191.0, 131.0, 0.0, 89.0, 10.0, 9.0, 112.0, 162.0, 19.0, 0.0, 154.0, 0.0, 58.0, 200.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 14.0, 183.0, 174.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 191.0, 0.0, 174.0, 0.0, 0.0, 200.0, 0.0, 175.0, 26.0, 0.0, 0.0, 8.0, 141.0, 0.0, 0.0, 178.0, 167.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 6.0, 0.0, 177.0, 0.0, 193.0, 0.0, 47.0, 109.0, 47.0, 0.0, 0.0, 0.0, 8.0, 98.0, 200.0, 0.0, 200.0, 0.0, 2.0, 97.0, 161.0, 0.0, 0.0, 188.0, 0.0, 42.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9259684408721509, "mean_inference_ms": 2.4013577910588224, "mean_action_processing_ms": 0.41629813201387705, "mean_env_wait_ms": 0.3274599145370933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00458073616027832, "StateBufferConnector_ms": 0.004872798919677734, "ViewRequirementAgentConnector_ms": 0.22011446952819824}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -576.0, "episode_return_mean": -139.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.5001691454032, "num_env_steps_trained_throughput_per_sec": 327.5001691454032, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 12254.227, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12254.171, "sample_time_ms": 1913.892, "learn_time_ms": 10322.284, "learn_throughput": 387.511, "synch_weights_time_ms": 14.114}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "f1691_00000", "date": "2024-08-13_17-01-16", "timestamp": 1723582876, "time_this_iter_s": 12.273452043533325, "time_total_s": 1366.2368516921997, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d78af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1366.2368516921997, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 66.06111111111112, "ram_util_percent": 83.11111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.410345349819572, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.6860044404943153, "policy_loss": 0.0012271061564288128, "vf_loss": 3.6710202185565204, "vf_explained_var": 0.045433443437808405, "kl": 0.006038792048750445, "entropy": 0.13889635818660576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.61710500355752, "cur_kl_coeff": 1.3035535812377926e-05, "cur_lr": 0.009999999999999998, "total_loss": 3.6940264911878677, "policy_loss": 4.7855219857954476e-05, "vf_loss": 3.6939786287842606, "vf_explained_var": -8.041896517314608e-09, "kl": 3.5041690969196285e-10, "entropy": 3.665517079941319e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -576.0, "episode_reward_mean": -144.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -132.365, "predator_policy": 59.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.0, -133.0, 0.0, 0.0, 5.0, -297.0, -182.0, -83.0, -433.0, -576.0, -47.0, -564.0, -208.0, -63.0, -148.0, -279.0, 30.0, -159.0, -26.0, -115.0, -52.0, -552.0, -22.0, -78.0, -290.0, 30.0, -66.0, -130.0, 7.0, -177.0, -49.0, -269.0, 25.0, -139.0, -123.0, 0.0, 0.0, -455.0, -539.0, -119.0, -84.0, -116.0, -181.0, -152.0, -46.0, -200.0, 19.0, -3.0, -13.0, -356.0, 0.0, 5.0, 12.0, -191.0, -174.0, -566.0, -491.0, -26.0, -8.0, -147.0, -178.0, -167.0, 20.0, -534.0, 11.0, -168.0, -193.0, -41.0, -264.0, 0.0, -7.0, -298.0, -196.0, -2.0, -268.0, 14.0, -472.0, -28.0, 0.0, -212.0, -185.0, -113.0, 0.0, -5.0, -153.0, 0.0, 7.0, -422.0, 13.0, -206.0, -182.0, -145.0, 1.0, -194.0, -124.0, -316.0, 8.0, -377.0, -1.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-312.0, 0.0, 0.0, -266.0, 0.0, 0.0, 0.0, 0.0, -7.0, 1.0, -173.0, -260.0, 7.0, -378.0, 9.0, -184.0, -354.0, -338.0, -400.0, -376.0, -94.0, 0.0, -364.0, -400.0, -337.0, -92.0, -122.0, -4.0, 0.0, -296.0, -242.0, -158.0, 15.0, 15.0, -332.0, 0.0, -72.0, 10.0, 15.0, -336.0, 11.0, -280.0, -379.0, -366.0, -59.0, 0.0, 4.0, -164.0, -300.0, -280.0, 15.0, 15.0, -137.0, 0.0, -95.0, -180.0, 7.0, 0.0, -385.0, 15.0, -373.0, 0.0, -400.0, -138.0, 10.0, 15.0, 0.0, -278.0, -251.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, -374.0, -357.0, -373.0, -258.0, 8.0, -163.0, -20.0, 0.0, -237.0, -362.0, 0.0, 2.0, -308.0, -104.0, 0.0, -400.0, 0.0, -7.0, 15.0, 0.0, -6.0, -27.0, 0.0, -347.0, -366.0, -9.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -382.0, 0.0, -348.0, -366.0, -400.0, -334.0, -332.0, -52.0, 0.0, -16.0, 0.0, -282.0, -6.0, -356.0, 0.0, 0.0, -334.0, 10.0, 10.0, -364.0, -352.0, -10.0, 15.0, 0.0, -345.0, -386.0, 0.0, -94.0, 6.0, -197.0, -223.0, 0.0, 0.0, -4.0, -11.0, -400.0, -196.0, 4.0, -400.0, -4.0, 0.0, -186.0, -340.0, 14.0, 0.0, -284.0, -376.0, -82.0, 12.0, 0.0, 0.0, -394.0, -32.0, -377.0, 0.0, -70.0, -88.0, 0.0, 0.0, 0.0, -10.0, 0.0, -311.0, -374.0, 0.0, 0.0, 7.0, -284.0, -280.0, 15.0, -4.0, -202.0, -213.0, 0.0, -364.0, -290.0, 0.0, 0.0, -1.0, 0.0, -391.0, -364.0, 0.0, -215.0, -209.0, 8.0, 0.0, -376.0, -386.0, -26.0, 3.0, 2.0, 0.0], "policy_predator_policy_reward": [45.0, 156.0, 94.0, 39.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 136.0, 0.0, 0.0, 189.0, 92.0, 0.0, 177.0, 82.0, 200.0, 0.0, 47.0, 0.0, 0.0, 200.0, 172.0, 49.0, 63.0, 0.0, 148.0, 0.0, 121.0, 0.0, 0.0, 0.0, 173.0, 0.0, 36.0, 0.0, 38.0, 168.0, 77.0, 140.0, 193.0, 0.0, 0.0, 37.0, 82.0, 0.0, 150.0, 140.0, 0.0, 0.0, 71.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, 193.0, 135.0, 189.0, 69.0, 200.0, 0.0, 0.0, 70.0, 69.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 112.0, 179.0, 0.0, 191.0, 131.0, 0.0, 89.0, 10.0, 9.0, 112.0, 162.0, 19.0, 0.0, 154.0, 0.0, 58.0, 200.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 14.0, 183.0, 174.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 191.0, 0.0, 174.0, 0.0, 0.0, 200.0, 0.0, 175.0, 26.0, 0.0, 0.0, 8.0, 141.0, 0.0, 0.0, 178.0, 167.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 6.0, 0.0, 177.0, 0.0, 193.0, 0.0, 47.0, 109.0, 47.0, 0.0, 0.0, 0.0, 8.0, 98.0, 200.0, 0.0, 200.0, 0.0, 2.0, 97.0, 161.0, 0.0, 0.0, 188.0, 0.0, 42.0, 0.0, 0.0, 0.0, 198.0, 16.0, 192.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 158.0, 187.0, 187.0, 0.0, 0.0, 0.0, 142.0, 0.0, 2.0, 108.0, 101.0, 182.0, 0.0, 145.0, 0.0, 0.0, 2.0, 0.0, 197.0, 188.0, 52.0, 0.0, 108.0, 0.0, 0.0, 193.0, 192.0, 10.0, 12.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9252047148333057, "mean_inference_ms": 2.399213634931447, "mean_action_processing_ms": 0.41572934936365735, "mean_env_wait_ms": 0.32711804391007054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004912257194519043, "StateBufferConnector_ms": 0.005275607109069824, "ViewRequirementAgentConnector_ms": 0.18778109550476074}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -576.0, "episode_return_mean": -144.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.9884104391357, "num_env_steps_trained_throughput_per_sec": 324.9884104391357, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 12287.285, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12287.229, "sample_time_ms": 1910.544, "learn_time_ms": 10358.88, "learn_throughput": 386.142, "synch_weights_time_ms": 14.244}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "f1691_00000", "date": "2024-08-13_17-01-28", "timestamp": 1723582888, "time_this_iter_s": 12.35168170928955, "time_total_s": 1378.5885334014893, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d58550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1378.5885334014893, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 64.90588235294118, "ram_util_percent": 83.68235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9198942509120105, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.8635318994522097, "policy_loss": 0.0011478918895283074, "vf_loss": 2.8448749298771854, "vf_explained_var": 0.08448823999475549, "kl": 0.00768573979575045, "entropy": 0.17670149218941492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8611237563375167, "cur_kl_coeff": 6.517767906188963e-06, "cur_lr": 0.009999999999999998, "total_loss": 3.4930548137457915, "policy_loss": 6.0418049100214844e-05, "vf_loss": 3.49299440585747, "vf_explained_var": -4.225937777726107e-09, "kl": 2.0429348146745037e-10, "entropy": 2.9513846032369794e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -566.0, "episode_reward_mean": -129.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -121.505, "predator_policy": 56.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0, -115.0, -52.0, -552.0, -22.0, -78.0, -290.0, 30.0, -66.0, -130.0, 7.0, -177.0, -49.0, -269.0, 25.0, -139.0, -123.0, 0.0, 0.0, -455.0, -539.0, -119.0, -84.0, -116.0, -181.0, -152.0, -46.0, -200.0, 19.0, -3.0, -13.0, -356.0, 0.0, 5.0, 12.0, -191.0, -174.0, -566.0, -491.0, -26.0, -8.0, -147.0, -178.0, -167.0, 20.0, -534.0, 11.0, -168.0, -193.0, -41.0, -264.0, 0.0, -7.0, -298.0, -196.0, -2.0, -268.0, 14.0, -472.0, -28.0, 0.0, -212.0, -185.0, -113.0, 0.0, -5.0, -153.0, 0.0, 7.0, -422.0, 13.0, -206.0, -182.0, -145.0, 1.0, -194.0, -124.0, -316.0, 8.0, -377.0, -1.0, 2.0, -61.0, -204.0, 0.0, -165.0, 14.0, -11.0, 11.0, -200.0, -157.0, 17.0, -193.0, -514.0, -10.0, -61.0, 2.0, -186.0, -35.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.0, 10.0, 15.0, -336.0, 11.0, -280.0, -379.0, -366.0, -59.0, 0.0, 4.0, -164.0, -300.0, -280.0, 15.0, 15.0, -137.0, 0.0, -95.0, -180.0, 7.0, 0.0, -385.0, 15.0, -373.0, 0.0, -400.0, -138.0, 10.0, 15.0, 0.0, -278.0, -251.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, -374.0, -357.0, -373.0, -258.0, 8.0, -163.0, -20.0, 0.0, -237.0, -362.0, 0.0, 2.0, -308.0, -104.0, 0.0, -400.0, 0.0, -7.0, 15.0, 0.0, -6.0, -27.0, 0.0, -347.0, -366.0, -9.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -382.0, 0.0, -348.0, -366.0, -400.0, -334.0, -332.0, -52.0, 0.0, -16.0, 0.0, -282.0, -6.0, -356.0, 0.0, 0.0, -334.0, 10.0, 10.0, -364.0, -352.0, -10.0, 15.0, 0.0, -345.0, -386.0, 0.0, -94.0, 6.0, -197.0, -223.0, 0.0, 0.0, -4.0, -11.0, -400.0, -196.0, 4.0, -400.0, -4.0, 0.0, -186.0, -340.0, 14.0, 0.0, -284.0, -376.0, -82.0, 12.0, 0.0, 0.0, -394.0, -32.0, -377.0, 0.0, -70.0, -88.0, 0.0, 0.0, 0.0, -10.0, 0.0, -311.0, -374.0, 0.0, 0.0, 7.0, -284.0, -280.0, 15.0, -4.0, -202.0, -213.0, 0.0, -364.0, -290.0, 0.0, 0.0, -1.0, 0.0, -391.0, -364.0, 0.0, -215.0, -209.0, 8.0, 0.0, -376.0, -386.0, -26.0, 3.0, 2.0, 0.0, 7.0, -136.0, -310.0, -100.0, 0.0, 0.0, 0.0, -345.0, 10.0, 4.0, -32.0, 5.0, 0.0, 11.0, -400.0, 0.0, -298.0, -8.0, 7.0, 10.0, -386.0, 0.0, -341.0, -365.0, -20.0, 0.0, -150.0, 14.0, 2.0, 0.0, 0.0, -372.0, -70.0, -7.0, 0.0, 0.0], "policy_predator_policy_reward": [36.0, 0.0, 38.0, 168.0, 77.0, 140.0, 193.0, 0.0, 0.0, 37.0, 82.0, 0.0, 150.0, 140.0, 0.0, 0.0, 71.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, 193.0, 135.0, 189.0, 69.0, 200.0, 0.0, 0.0, 70.0, 69.0, 128.0, 0.0, 0.0, 0.0, 0.0, 0.0, 112.0, 179.0, 0.0, 191.0, 131.0, 0.0, 89.0, 10.0, 9.0, 112.0, 162.0, 19.0, 0.0, 154.0, 0.0, 58.0, 200.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 14.0, 183.0, 174.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 191.0, 0.0, 174.0, 0.0, 0.0, 200.0, 0.0, 175.0, 26.0, 0.0, 0.0, 8.0, 141.0, 0.0, 0.0, 178.0, 167.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 6.0, 0.0, 177.0, 0.0, 193.0, 0.0, 47.0, 109.0, 47.0, 0.0, 0.0, 0.0, 8.0, 98.0, 200.0, 0.0, 200.0, 0.0, 2.0, 97.0, 161.0, 0.0, 0.0, 188.0, 0.0, 42.0, 0.0, 0.0, 0.0, 198.0, 16.0, 192.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 158.0, 187.0, 187.0, 0.0, 0.0, 0.0, 142.0, 0.0, 2.0, 108.0, 101.0, 182.0, 0.0, 145.0, 0.0, 0.0, 2.0, 0.0, 197.0, 188.0, 52.0, 0.0, 108.0, 0.0, 0.0, 193.0, 192.0, 10.0, 12.0, 0.0, 0.0, 0.0, 68.0, 13.0, 193.0, 0.0, 0.0, 0.0, 180.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 200.0, 149.0, 0.0, 0.0, 0.0, 193.0, 0.0, 181.0, 11.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 186.0, 7.0, 35.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9235597426716481, "mean_inference_ms": 2.394928725264162, "mean_action_processing_ms": 0.41476355134088827, "mean_env_wait_ms": 0.3265888035540749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004865884780883789, "StateBufferConnector_ms": 0.0038329362869262695, "ViewRequirementAgentConnector_ms": 0.13303124904632568}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -566.0, "episode_return_mean": -129.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0128101590216, "num_env_steps_trained_throughput_per_sec": 303.0128101590216, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 12421.671, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12421.614, "sample_time_ms": 1898.022, "learn_time_ms": 10506.24, "learn_throughput": 380.726, "synch_weights_time_ms": 13.715}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "f1691_00000", "date": "2024-08-13_17-01-41", "timestamp": 1723582901, "time_this_iter_s": 13.261425971984863, "time_total_s": 1391.8499593734741, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1391.8499593734741, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 67.53684210526316, "ram_util_percent": 83.51052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7763568061369437, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.6254842915862957, "policy_loss": -0.0002830299947943006, "vf_loss": 1.6137971604627277, "vf_explained_var": 0.09351129181801326, "kl": 0.005254391215655434, "entropy": 0.15270281223550675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.408596430437685, "cur_kl_coeff": 3.2588839530944814e-06, "cur_lr": 0.009999999999999998, "total_loss": 2.0416633549506074, "policy_loss": -7.440942147421459e-05, "vf_loss": 2.04173776914203, "vf_explained_var": -3.7528850414134834e-09, "kl": 1.3833165501143508e-10, "entropy": 2.404075802158731e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -584.0, "episode_reward_mean": -113.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -105.76, "predator_policy": 48.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.0, -181.0, -152.0, -46.0, -200.0, 19.0, -3.0, -13.0, -356.0, 0.0, 5.0, 12.0, -191.0, -174.0, -566.0, -491.0, -26.0, -8.0, -147.0, -178.0, -167.0, 20.0, -534.0, 11.0, -168.0, -193.0, -41.0, -264.0, 0.0, -7.0, -298.0, -196.0, -2.0, -268.0, 14.0, -472.0, -28.0, 0.0, -212.0, -185.0, -113.0, 0.0, -5.0, -153.0, 0.0, 7.0, -422.0, 13.0, -206.0, -182.0, -145.0, 1.0, -194.0, -124.0, -316.0, 8.0, -377.0, -1.0, 2.0, -61.0, -204.0, 0.0, -165.0, 14.0, -11.0, 11.0, -200.0, -157.0, 17.0, -193.0, -514.0, -10.0, -61.0, 2.0, -186.0, -35.0, 0.0, -197.0, 6.0, -140.0, 0.0, -190.0, -181.0, 9.0, 0.0, 12.0, 6.0, 15.0, -584.0, 0.0, 6.0, -6.0, -1.0, 0.0, -378.0, 2.0, 0.0, -6.0, -6.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -237.0, -362.0, 0.0, 2.0, -308.0, -104.0, 0.0, -400.0, 0.0, -7.0, 15.0, 0.0, -6.0, -27.0, 0.0, -347.0, -366.0, -9.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -382.0, 0.0, -348.0, -366.0, -400.0, -334.0, -332.0, -52.0, 0.0, -16.0, 0.0, -282.0, -6.0, -356.0, 0.0, 0.0, -334.0, 10.0, 10.0, -364.0, -352.0, -10.0, 15.0, 0.0, -345.0, -386.0, 0.0, -94.0, 6.0, -197.0, -223.0, 0.0, 0.0, -4.0, -11.0, -400.0, -196.0, 4.0, -400.0, -4.0, 0.0, -186.0, -340.0, 14.0, 0.0, -284.0, -376.0, -82.0, 12.0, 0.0, 0.0, -394.0, -32.0, -377.0, 0.0, -70.0, -88.0, 0.0, 0.0, 0.0, -10.0, 0.0, -311.0, -374.0, 0.0, 0.0, 7.0, -284.0, -280.0, 15.0, -4.0, -202.0, -213.0, 0.0, -364.0, -290.0, 0.0, 0.0, -1.0, 0.0, -391.0, -364.0, 0.0, -215.0, -209.0, 8.0, 0.0, -376.0, -386.0, -26.0, 3.0, 2.0, 0.0, 7.0, -136.0, -310.0, -100.0, 0.0, 0.0, 0.0, -345.0, 10.0, 4.0, -32.0, 5.0, 0.0, 11.0, -400.0, 0.0, -298.0, -8.0, 7.0, 10.0, -386.0, 0.0, -341.0, -365.0, -20.0, 0.0, -150.0, 14.0, 2.0, 0.0, 0.0, -372.0, -70.0, -7.0, 0.0, 0.0, -152.0, -242.0, 0.0, 6.0, -272.0, -13.0, 0.0, 0.0, -400.0, 0.0, -20.0, -355.0, 9.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 15.0, -388.0, -394.0, 0.0, 0.0, 0.0, 6.0, -18.0, 3.0, -107.0, 0.0, 0.0, 0.0, -378.0, -400.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, -20.0, 4.0, -15.0, 14.0], "policy_predator_policy_reward": [9.0, 112.0, 162.0, 19.0, 0.0, 154.0, 0.0, 58.0, 200.0, 0.0, 11.0, 0.0, 0.0, 3.0, 0.0, 14.0, 183.0, 174.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 191.0, 0.0, 174.0, 0.0, 0.0, 200.0, 0.0, 175.0, 26.0, 0.0, 0.0, 8.0, 141.0, 0.0, 0.0, 178.0, 167.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 6.0, 0.0, 177.0, 0.0, 193.0, 0.0, 47.0, 109.0, 47.0, 0.0, 0.0, 0.0, 8.0, 98.0, 200.0, 0.0, 200.0, 0.0, 2.0, 97.0, 161.0, 0.0, 0.0, 188.0, 0.0, 42.0, 0.0, 0.0, 0.0, 198.0, 16.0, 192.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 158.0, 187.0, 187.0, 0.0, 0.0, 0.0, 142.0, 0.0, 2.0, 108.0, 101.0, 182.0, 0.0, 145.0, 0.0, 0.0, 2.0, 0.0, 197.0, 188.0, 52.0, 0.0, 108.0, 0.0, 0.0, 193.0, 192.0, 10.0, 12.0, 0.0, 0.0, 0.0, 68.0, 13.0, 193.0, 0.0, 0.0, 0.0, 180.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 200.0, 149.0, 0.0, 0.0, 0.0, 193.0, 0.0, 181.0, 11.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 186.0, 7.0, 35.0, 0.0, 0.0, 76.0, 121.0, 0.0, 0.0, 96.0, 49.0, 0.0, 0.0, 200.0, 10.0, 184.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 49.0, 57.0, 0.0, 0.0, 200.0, 200.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9213346105010881, "mean_inference_ms": 2.388639042954766, "mean_action_processing_ms": 0.41331237680477684, "mean_env_wait_ms": 0.325781851094099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004791378974914551, "StateBufferConnector_ms": 0.006079554557800293, "ViewRequirementAgentConnector_ms": 0.123573899269104}, "num_episodes": 23, "episode_return_max": 20.0, "episode_return_min": -584.0, "episode_return_mean": -113.88, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.48417694284797, "num_env_steps_trained_throughput_per_sec": 325.48417694284797, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 12414.1, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12414.044, "sample_time_ms": 1915.211, "learn_time_ms": 10481.746, "learn_throughput": 381.616, "synch_weights_time_ms": 13.447}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "f1691_00000", "date": "2024-08-13_17-01-54", "timestamp": 1723582914, "time_this_iter_s": 12.328196287155151, "time_total_s": 1404.1781556606293, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d24160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1404.1781556606293, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 67.32352941176471, "ram_util_percent": 83.45294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1918929648777796, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 3.153694807158576, "policy_loss": 0.0011281663665262164, "vf_loss": 3.1388438620895305, "vf_explained_var": 0.07038261887257692, "kl": 0.006023717313469069, "entropy": 0.11179793588718567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.855110158028744, "cur_kl_coeff": 1.6294419765472407e-06, "cur_lr": 0.009999999999999998, "total_loss": 3.2985423515713403, "policy_loss": 0.0002885995871293797, "vf_loss": 3.298253754585508, "vf_explained_var": -5.361264344876405e-09, "kl": 3.300295230896711e-11, "entropy": 2.1665763074730316e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -584.0, "episode_reward_mean": -117.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -109.825, "predator_policy": 50.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-147.0, -178.0, -167.0, 20.0, -534.0, 11.0, -168.0, -193.0, -41.0, -264.0, 0.0, -7.0, -298.0, -196.0, -2.0, -268.0, 14.0, -472.0, -28.0, 0.0, -212.0, -185.0, -113.0, 0.0, -5.0, -153.0, 0.0, 7.0, -422.0, 13.0, -206.0, -182.0, -145.0, 1.0, -194.0, -124.0, -316.0, 8.0, -377.0, -1.0, 2.0, -61.0, -204.0, 0.0, -165.0, 14.0, -11.0, 11.0, -200.0, -157.0, 17.0, -193.0, -514.0, -10.0, -61.0, 2.0, -186.0, -35.0, 0.0, -197.0, 6.0, -140.0, 0.0, -190.0, -181.0, 9.0, 0.0, 12.0, 6.0, 15.0, -584.0, 0.0, 6.0, -6.0, -1.0, 0.0, -378.0, 2.0, 0.0, -6.0, -6.0, 7.0, -240.0, -212.0, -200.0, 0.0, -132.0, -71.0, -545.0, -400.0, 4.0, -3.0, 6.0, -200.0, -185.0, -316.0, 0.0, -177.0, -192.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-282.0, -6.0, -356.0, 0.0, 0.0, -334.0, 10.0, 10.0, -364.0, -352.0, -10.0, 15.0, 0.0, -345.0, -386.0, 0.0, -94.0, 6.0, -197.0, -223.0, 0.0, 0.0, -4.0, -11.0, -400.0, -196.0, 4.0, -400.0, -4.0, 0.0, -186.0, -340.0, 14.0, 0.0, -284.0, -376.0, -82.0, 12.0, 0.0, 0.0, -394.0, -32.0, -377.0, 0.0, -70.0, -88.0, 0.0, 0.0, 0.0, -10.0, 0.0, -311.0, -374.0, 0.0, 0.0, 7.0, -284.0, -280.0, 15.0, -4.0, -202.0, -213.0, 0.0, -364.0, -290.0, 0.0, 0.0, -1.0, 0.0, -391.0, -364.0, 0.0, -215.0, -209.0, 8.0, 0.0, -376.0, -386.0, -26.0, 3.0, 2.0, 0.0, 7.0, -136.0, -310.0, -100.0, 0.0, 0.0, 0.0, -345.0, 10.0, 4.0, -32.0, 5.0, 0.0, 11.0, -400.0, 0.0, -298.0, -8.0, 7.0, 10.0, -386.0, 0.0, -341.0, -365.0, -20.0, 0.0, -150.0, 14.0, 2.0, 0.0, 0.0, -372.0, -70.0, -7.0, 0.0, 0.0, -152.0, -242.0, 0.0, 6.0, -272.0, -13.0, 0.0, 0.0, -400.0, 0.0, -20.0, -355.0, 9.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 15.0, -388.0, -394.0, 0.0, 0.0, 0.0, 6.0, -18.0, 3.0, -107.0, 0.0, 0.0, 0.0, -378.0, -400.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, -20.0, 4.0, -15.0, 14.0, -159.0, -164.0, -338.0, -91.0, -400.0, 0.0, 0.0, 0.0, -88.0, -88.0, 0.0, -142.0, -345.0, -400.0, -400.0, -400.0, 2.0, 0.0, 0.0, -13.0, 6.0, 0.0, -400.0, 0.0, 15.0, -400.0, -284.0, -348.0, 0.0, 0.0, -354.0, 0.0, 8.0, -400.0, -9.0, 0.0], "policy_predator_policy_reward": [141.0, 0.0, 0.0, 178.0, 167.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 6.0, 0.0, 177.0, 0.0, 193.0, 0.0, 47.0, 109.0, 47.0, 0.0, 0.0, 0.0, 8.0, 98.0, 200.0, 0.0, 200.0, 0.0, 2.0, 97.0, 161.0, 0.0, 0.0, 188.0, 0.0, 42.0, 0.0, 0.0, 0.0, 198.0, 16.0, 192.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 158.0, 187.0, 187.0, 0.0, 0.0, 0.0, 142.0, 0.0, 2.0, 108.0, 101.0, 182.0, 0.0, 145.0, 0.0, 0.0, 2.0, 0.0, 197.0, 188.0, 52.0, 0.0, 108.0, 0.0, 0.0, 193.0, 192.0, 10.0, 12.0, 0.0, 0.0, 0.0, 68.0, 13.0, 193.0, 0.0, 0.0, 0.0, 180.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 200.0, 149.0, 0.0, 0.0, 0.0, 193.0, 0.0, 181.0, 11.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 186.0, 7.0, 35.0, 0.0, 0.0, 76.0, 121.0, 0.0, 0.0, 96.0, 49.0, 0.0, 0.0, 200.0, 10.0, 184.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 49.0, 57.0, 0.0, 0.0, 200.0, 200.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 8.0, 83.0, 0.0, 169.0, 48.0, 200.0, 0.0, 0.0, 0.0, 0.0, 44.0, 0.0, 71.0, 0.0, 200.0, 200.0, 200.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 174.0, 142.0, 0.0, 0.0, 177.0, 0.0, 200.0, 0.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9194871365226993, "mean_inference_ms": 2.3840121604035307, "mean_action_processing_ms": 0.41861402357467625, "mean_env_wait_ms": 0.32518600483697335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040482282638549805, "StateBufferConnector_ms": 0.0060100555419921875, "ViewRequirementAgentConnector_ms": 0.11543858051300049}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -584.0, "episode_return_mean": -117.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.1577893761931, "num_env_steps_trained_throughput_per_sec": 269.1577893761931, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 12701.875, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12701.822, "sample_time_ms": 2095.509, "learn_time_ms": 10589.928, "learn_throughput": 377.717, "synch_weights_time_ms": 13.199}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "f1691_00000", "date": "2024-08-13_17-02-09", "timestamp": 1723582929, "time_this_iter_s": 14.90490198135376, "time_total_s": 1419.083057641983, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d0d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1419.083057641983, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 67.4, "ram_util_percent": 83.81904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2647199435997263, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.5069980744331604, "policy_loss": 0.0007672777595294137, "vf_loss": 2.4963432052148082, "vf_explained_var": 0.08926625791050138, "kl": 0.004340231266130427, "entropy": 0.0984390191319916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.041545167012419, "cur_kl_coeff": 8.147209882736204e-07, "cur_lr": 0.009999999999999998, "total_loss": 2.8165983505349943, "policy_loss": -8.189915198951014e-05, "vf_loss": 2.8166802587332547, "vf_explained_var": -7.915749120964576e-09, "kl": 3.25611964560356e-11, "entropy": 2.1036006064874497e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -584.0, "episode_reward_mean": -100.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -94.875, "predator_policy": 44.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113.0, 0.0, -5.0, -153.0, 0.0, 7.0, -422.0, 13.0, -206.0, -182.0, -145.0, 1.0, -194.0, -124.0, -316.0, 8.0, -377.0, -1.0, 2.0, -61.0, -204.0, 0.0, -165.0, 14.0, -11.0, 11.0, -200.0, -157.0, 17.0, -193.0, -514.0, -10.0, -61.0, 2.0, -186.0, -35.0, 0.0, -197.0, 6.0, -140.0, 0.0, -190.0, -181.0, 9.0, 0.0, 12.0, 6.0, 15.0, -584.0, 0.0, 6.0, -6.0, -1.0, 0.0, -378.0, 2.0, 0.0, -6.0, -6.0, 7.0, -240.0, -212.0, -200.0, 0.0, -132.0, -71.0, -545.0, -400.0, 4.0, -3.0, 6.0, -200.0, -185.0, -316.0, 0.0, -177.0, -192.0, -2.0, 7.0, 0.0, -198.0, 0.0, -6.0, -195.0, 0.0, 0.0, -175.0, 0.0, 15.0, -57.0, 5.0, -415.0, 15.0, -357.0, -3.0, -27.0, 6.0, -182.0, 0.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.0, -88.0, 0.0, 0.0, 0.0, -10.0, 0.0, -311.0, -374.0, 0.0, 0.0, 7.0, -284.0, -280.0, 15.0, -4.0, -202.0, -213.0, 0.0, -364.0, -290.0, 0.0, 0.0, -1.0, 0.0, -391.0, -364.0, 0.0, -215.0, -209.0, 8.0, 0.0, -376.0, -386.0, -26.0, 3.0, 2.0, 0.0, 7.0, -136.0, -310.0, -100.0, 0.0, 0.0, 0.0, -345.0, 10.0, 4.0, -32.0, 5.0, 0.0, 11.0, -400.0, 0.0, -298.0, -8.0, 7.0, 10.0, -386.0, 0.0, -341.0, -365.0, -20.0, 0.0, -150.0, 14.0, 2.0, 0.0, 0.0, -372.0, -70.0, -7.0, 0.0, 0.0, -152.0, -242.0, 0.0, 6.0, -272.0, -13.0, 0.0, 0.0, -400.0, 0.0, -20.0, -355.0, 9.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 15.0, -388.0, -394.0, 0.0, 0.0, 0.0, 6.0, -18.0, 3.0, -107.0, 0.0, 0.0, 0.0, -378.0, -400.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, -20.0, 4.0, -15.0, 14.0, -159.0, -164.0, -338.0, -91.0, -400.0, 0.0, 0.0, 0.0, -88.0, -88.0, 0.0, -142.0, -345.0, -400.0, -400.0, -400.0, 2.0, 0.0, 0.0, -13.0, 6.0, 0.0, -400.0, 0.0, 15.0, -400.0, -284.0, -348.0, 0.0, 0.0, -354.0, 0.0, 8.0, -400.0, -9.0, 0.0, 7.0, 0.0, 0.0, 0.0, -396.0, 0.0, 0.0, 0.0, -20.0, 4.0, -5.0, -380.0, 0.0, 0.0, 0.0, 0.0, -352.0, 1.0, 0.0, 0.0, 0.0, 15.0, 4.0, -122.0, 0.0, 5.0, -365.0, -238.0, 15.0, 0.0, -358.0, -360.0, 0.0, -13.0, 0.0, -59.0, 4.0, 0.0, 0.0, -364.0, 0.0, 0.0, 3.0, 0.0], "policy_predator_policy_reward": [0.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 158.0, 187.0, 187.0, 0.0, 0.0, 0.0, 142.0, 0.0, 2.0, 108.0, 101.0, 182.0, 0.0, 145.0, 0.0, 0.0, 2.0, 0.0, 197.0, 188.0, 52.0, 0.0, 108.0, 0.0, 0.0, 193.0, 192.0, 10.0, 12.0, 0.0, 0.0, 0.0, 68.0, 13.0, 193.0, 0.0, 0.0, 0.0, 180.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 200.0, 149.0, 0.0, 0.0, 0.0, 193.0, 0.0, 181.0, 11.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 186.0, 7.0, 35.0, 0.0, 0.0, 76.0, 121.0, 0.0, 0.0, 96.0, 49.0, 0.0, 0.0, 200.0, 10.0, 184.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 49.0, 57.0, 0.0, 0.0, 200.0, 200.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 8.0, 83.0, 0.0, 169.0, 48.0, 200.0, 0.0, 0.0, 0.0, 0.0, 44.0, 0.0, 71.0, 0.0, 200.0, 200.0, 200.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 174.0, 142.0, 0.0, 0.0, 177.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 181.0, 180.0, 0.0, 10.0, 32.0, 0.0, 0.0, 2.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9175563651171431, "mean_inference_ms": 2.3797648960305544, "mean_action_processing_ms": 0.4251180850076618, "mean_env_wait_ms": 0.3245367505592607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026174545288086, "StateBufferConnector_ms": 0.005766749382019043, "ViewRequirementAgentConnector_ms": 0.10857951641082764}, "num_episodes": 22, "episode_return_max": 17.0, "episode_return_min": -584.0, "episode_return_mean": -100.15, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.36952248594065, "num_env_steps_trained_throughput_per_sec": 322.36952248594065, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 12775.294, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12775.24, "sample_time_ms": 2000.005, "learn_time_ms": 10759.833, "learn_throughput": 371.753, "synch_weights_time_ms": 12.486}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "f1691_00000", "date": "2024-08-13_17-02-21", "timestamp": 1723582941, "time_this_iter_s": 12.443432092666626, "time_total_s": 1431.5264897346497, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3cde3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1431.5264897346497, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 66.05555555555556, "ram_util_percent": 83.41111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.104555006475045, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 0.009999999999999998, "total_loss": 2.1875129464442136, "policy_loss": 0.0016376869191252997, "vf_loss": 2.1764896307042036, "vf_explained_var": 0.06361878618361458, "kl": 0.00823978216344323, "entropy": 0.0994955842851331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9844998032360328, "cur_kl_coeff": 4.073604941368102e-07, "cur_lr": 0.009999999999999998, "total_loss": 2.3488577405296307, "policy_loss": 0.00011820596736417246, "vf_loss": 2.3487395219071203, "vf_explained_var": -5.487411741226439e-09, "kl": 4.734806240386984e-11, "entropy": 1.864426449511663e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -584.0, "episode_reward_mean": -90.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -85.465, "predator_policy": 40.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -61.0, -204.0, 0.0, -165.0, 14.0, -11.0, 11.0, -200.0, -157.0, 17.0, -193.0, -514.0, -10.0, -61.0, 2.0, -186.0, -35.0, 0.0, -197.0, 6.0, -140.0, 0.0, -190.0, -181.0, 9.0, 0.0, 12.0, 6.0, 15.0, -584.0, 0.0, 6.0, -6.0, -1.0, 0.0, -378.0, 2.0, 0.0, -6.0, -6.0, 7.0, -240.0, -212.0, -200.0, 0.0, -132.0, -71.0, -545.0, -400.0, 4.0, -3.0, 6.0, -200.0, -185.0, -316.0, 0.0, -177.0, -192.0, -2.0, 7.0, 0.0, -198.0, 0.0, -6.0, -195.0, 0.0, 0.0, -175.0, 0.0, 15.0, -57.0, 5.0, -415.0, 15.0, -357.0, -3.0, -27.0, 6.0, -182.0, 0.0, 3.0, -210.0, -190.0, 30.0, -192.0, 2.0, 6.0, 8.0, 15.0, 15.0, -164.0, 20.0, 5.0, -21.0, 0.0, 11.0, -367.0, 9.0, -175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, 7.0, -136.0, -310.0, -100.0, 0.0, 0.0, 0.0, -345.0, 10.0, 4.0, -32.0, 5.0, 0.0, 11.0, -400.0, 0.0, -298.0, -8.0, 7.0, 10.0, -386.0, 0.0, -341.0, -365.0, -20.0, 0.0, -150.0, 14.0, 2.0, 0.0, 0.0, -372.0, -70.0, -7.0, 0.0, 0.0, -152.0, -242.0, 0.0, 6.0, -272.0, -13.0, 0.0, 0.0, -400.0, 0.0, -20.0, -355.0, 9.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 15.0, -388.0, -394.0, 0.0, 0.0, 0.0, 6.0, -18.0, 3.0, -107.0, 0.0, 0.0, 0.0, -378.0, -400.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, -20.0, 4.0, -15.0, 14.0, -159.0, -164.0, -338.0, -91.0, -400.0, 0.0, 0.0, 0.0, -88.0, -88.0, 0.0, -142.0, -345.0, -400.0, -400.0, -400.0, 2.0, 0.0, 0.0, -13.0, 6.0, 0.0, -400.0, 0.0, 15.0, -400.0, -284.0, -348.0, 0.0, 0.0, -354.0, 0.0, 8.0, -400.0, -9.0, 0.0, 7.0, 0.0, 0.0, 0.0, -396.0, 0.0, 0.0, 0.0, -20.0, 4.0, -5.0, -380.0, 0.0, 0.0, 0.0, 0.0, -352.0, 1.0, 0.0, 0.0, 0.0, 15.0, 4.0, -122.0, 0.0, 5.0, -365.0, -238.0, 15.0, 0.0, -358.0, -360.0, 0.0, -13.0, 0.0, -59.0, 4.0, 0.0, 0.0, -364.0, 0.0, 0.0, 3.0, 0.0, -20.0, -400.0, -4.0, -388.0, 15.0, 15.0, 0.0, -388.0, -1.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 15.0, 15.0, 0.0, -16.0, -312.0, 10.0, 10.0, 5.0, 0.0, -20.0, -14.0, 0.0, 0.0, 7.0, 0.0, -378.0, -367.0, 3.0, 0.0, -20.0, -324.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 68.0, 13.0, 193.0, 0.0, 0.0, 0.0, 180.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 200.0, 149.0, 0.0, 0.0, 0.0, 193.0, 0.0, 181.0, 11.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 186.0, 7.0, 35.0, 0.0, 0.0, 76.0, 121.0, 0.0, 0.0, 96.0, 49.0, 0.0, 0.0, 200.0, 10.0, 184.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 49.0, 57.0, 0.0, 0.0, 200.0, 200.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 8.0, 83.0, 0.0, 169.0, 48.0, 200.0, 0.0, 0.0, 0.0, 0.0, 44.0, 0.0, 71.0, 0.0, 200.0, 200.0, 200.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 174.0, 142.0, 0.0, 0.0, 177.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 181.0, 180.0, 0.0, 10.0, 32.0, 0.0, 0.0, 2.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 194.0, 8.0, 0.0, 0.0, 188.0, 8.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 189.0, 189.0, 6.0, 0.0, 169.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9158155262232134, "mean_inference_ms": 2.3748101252935183, "mean_action_processing_ms": 0.43041998466081965, "mean_env_wait_ms": 0.3240497101225811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769397735595703, "StateBufferConnector_ms": 0.005584716796875, "ViewRequirementAgentConnector_ms": 0.12419641017913818}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -584.0, "episode_return_mean": -90.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7558809538471, "num_env_steps_trained_throughput_per_sec": 319.7558809538471, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 12759.523, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12759.474, "sample_time_ms": 1813.222, "learn_time_ms": 10930.921, "learn_throughput": 365.934, "synch_weights_time_ms": 12.48}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "f1691_00000", "date": "2024-08-13_17-02-34", "timestamp": 1723582954, "time_this_iter_s": 12.555882930755615, "time_total_s": 1444.0823726654053, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3bfba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1444.0823726654053, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 66.27222222222223, "ram_util_percent": 83.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2735371662826136, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 0.009999999999999998, "total_loss": 1.2529488457573785, "policy_loss": 0.00035988507132050853, "vf_loss": 1.2392701972729314, "vf_explained_var": 0.055684097071804065, "kl": 0.011692740721455354, "entropy": 0.06935656829909594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9558525021244628, "cur_kl_coeff": 2.036802470684051e-07, "cur_lr": 0.009999999999999998, "total_loss": 1.6208011152252317, "policy_loss": 0.00013195156925431792, "vf_loss": 1.6206691665939552, "vf_explained_var": -4.635916815863715e-09, "kl": 2.5725007875980544e-11, "entropy": 1.7658654445104278e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -584.0, "episode_reward_mean": -85.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -80.075, "predator_policy": 37.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -197.0, 6.0, -140.0, 0.0, -190.0, -181.0, 9.0, 0.0, 12.0, 6.0, 15.0, -584.0, 0.0, 6.0, -6.0, -1.0, 0.0, -378.0, 2.0, 0.0, -6.0, -6.0, 7.0, -240.0, -212.0, -200.0, 0.0, -132.0, -71.0, -545.0, -400.0, 4.0, -3.0, 6.0, -200.0, -185.0, -316.0, 0.0, -177.0, -192.0, -2.0, 7.0, 0.0, -198.0, 0.0, -6.0, -195.0, 0.0, 0.0, -175.0, 0.0, 15.0, -57.0, 5.0, -415.0, 15.0, -357.0, -3.0, -27.0, 6.0, -182.0, 0.0, 3.0, -210.0, -190.0, 30.0, -192.0, 2.0, 6.0, 8.0, 15.0, 15.0, -164.0, 20.0, 5.0, -21.0, 0.0, 11.0, -367.0, 9.0, -175.0, -570.0, 16.0, -200.0, 1.0, -172.0, -250.0, 2.0, 0.0, 0.0, 0.0, -174.0, 0.0, 0.0, 0.0, 12.0, 15.0, -7.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -152.0, -242.0, 0.0, 6.0, -272.0, -13.0, 0.0, 0.0, -400.0, 0.0, -20.0, -355.0, 9.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 15.0, -388.0, -394.0, 0.0, 0.0, 0.0, 6.0, -18.0, 3.0, -107.0, 0.0, 0.0, 0.0, -378.0, -400.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, -20.0, 4.0, -15.0, 14.0, -159.0, -164.0, -338.0, -91.0, -400.0, 0.0, 0.0, 0.0, -88.0, -88.0, 0.0, -142.0, -345.0, -400.0, -400.0, -400.0, 2.0, 0.0, 0.0, -13.0, 6.0, 0.0, -400.0, 0.0, 15.0, -400.0, -284.0, -348.0, 0.0, 0.0, -354.0, 0.0, 8.0, -400.0, -9.0, 0.0, 7.0, 0.0, 0.0, 0.0, -396.0, 0.0, 0.0, 0.0, -20.0, 4.0, -5.0, -380.0, 0.0, 0.0, 0.0, 0.0, -352.0, 1.0, 0.0, 0.0, 0.0, 15.0, 4.0, -122.0, 0.0, 5.0, -365.0, -238.0, 15.0, 0.0, -358.0, -360.0, 0.0, -13.0, 0.0, -59.0, 4.0, 0.0, 0.0, -364.0, 0.0, 0.0, 3.0, 0.0, -20.0, -400.0, -4.0, -388.0, 15.0, 15.0, 0.0, -388.0, -1.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 15.0, 15.0, 0.0, -16.0, -312.0, 10.0, 10.0, 5.0, 0.0, -20.0, -14.0, 0.0, 0.0, 7.0, 0.0, -378.0, -367.0, 3.0, 0.0, -20.0, -324.0, -384.0, -379.0, 6.0, 10.0, 0.0, -400.0, 8.0, -17.0, 0.0, -358.0, -162.0, -176.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -378.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, -14.0, 0.0, 0.0, 10.0], "policy_predator_policy_reward": [0.0, 0.0, 76.0, 121.0, 0.0, 0.0, 96.0, 49.0, 0.0, 0.0, 200.0, 10.0, 184.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 49.0, 57.0, 0.0, 0.0, 200.0, 200.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 8.0, 83.0, 0.0, 169.0, 48.0, 200.0, 0.0, 0.0, 0.0, 0.0, 44.0, 0.0, 71.0, 0.0, 200.0, 200.0, 200.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 174.0, 142.0, 0.0, 0.0, 177.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 181.0, 180.0, 0.0, 10.0, 32.0, 0.0, 0.0, 2.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 194.0, 8.0, 0.0, 0.0, 188.0, 8.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 189.0, 189.0, 6.0, 0.0, 169.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 186.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9143089367223678, "mean_inference_ms": 2.370983942938843, "mean_action_processing_ms": 0.43574500704205577, "mean_env_wait_ms": 0.3235717119788776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003797292709350586, "StateBufferConnector_ms": 0.006366610527038574, "ViewRequirementAgentConnector_ms": 0.12830829620361328}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -584.0, "episode_return_mean": -85.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.6514837065575, "num_env_steps_trained_throughput_per_sec": 315.6514837065575, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 12787.588, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12787.54, "sample_time_ms": 1689.246, "learn_time_ms": 11083.667, "learn_throughput": 360.891, "synch_weights_time_ms": 12.316}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "f1691_00000", "date": "2024-08-13_17-02-46", "timestamp": 1723582966, "time_this_iter_s": 12.723021745681763, "time_total_s": 1456.805394411087, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1456.805394411087, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 68.28888888888888, "ram_util_percent": 83.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.642808002848474, "cur_kl_coeff": 1.1390624999999994, "cur_lr": 0.009999999999999998, "total_loss": 0.8315598464201367, "policy_loss": 0.01347359216515783, "vf_loss": 0.7819858043203278, "vf_explained_var": 0.008989129148463093, "kl": 0.03169312415747687, "entropy": 0.09189864670286181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5017413320837827, "cur_kl_coeff": 1.0184012353420254e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.987974770645064, "policy_loss": -0.00012103002345948308, "vf_loss": 0.9880958009333838, "vf_explained_var": -7.694991177352017e-09, "kl": 4.5766727600720305e-11, "entropy": 1.682245469368728e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -570.0, "episode_reward_mean": -72.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -68.8, "predator_policy": 32.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -240.0, -212.0, -200.0, 0.0, -132.0, -71.0, -545.0, -400.0, 4.0, -3.0, 6.0, -200.0, -185.0, -316.0, 0.0, -177.0, -192.0, -2.0, 7.0, 0.0, -198.0, 0.0, -6.0, -195.0, 0.0, 0.0, -175.0, 0.0, 15.0, -57.0, 5.0, -415.0, 15.0, -357.0, -3.0, -27.0, 6.0, -182.0, 0.0, 3.0, -210.0, -190.0, 30.0, -192.0, 2.0, 6.0, 8.0, 15.0, 15.0, -164.0, 20.0, 5.0, -21.0, 0.0, 11.0, -367.0, 9.0, -175.0, -570.0, 16.0, -200.0, 1.0, -172.0, -250.0, 2.0, 0.0, 0.0, 0.0, -174.0, 0.0, 0.0, 0.0, 12.0, 15.0, -7.0, 10.0, -13.0, -9.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -38.0, 14.0, -171.0, 11.0, 19.0, 14.0, 6.0, 4.0, 0.0, -185.0, 0.0, -8.0, 6.0, -25.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, 14.0, -159.0, -164.0, -338.0, -91.0, -400.0, 0.0, 0.0, 0.0, -88.0, -88.0, 0.0, -142.0, -345.0, -400.0, -400.0, -400.0, 2.0, 0.0, 0.0, -13.0, 6.0, 0.0, -400.0, 0.0, 15.0, -400.0, -284.0, -348.0, 0.0, 0.0, -354.0, 0.0, 8.0, -400.0, -9.0, 0.0, 7.0, 0.0, 0.0, 0.0, -396.0, 0.0, 0.0, 0.0, -20.0, 4.0, -5.0, -380.0, 0.0, 0.0, 0.0, 0.0, -352.0, 1.0, 0.0, 0.0, 0.0, 15.0, 4.0, -122.0, 0.0, 5.0, -365.0, -238.0, 15.0, 0.0, -358.0, -360.0, 0.0, -13.0, 0.0, -59.0, 4.0, 0.0, 0.0, -364.0, 0.0, 0.0, 3.0, 0.0, -20.0, -400.0, -4.0, -388.0, 15.0, 15.0, 0.0, -388.0, -1.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 15.0, 15.0, 0.0, -16.0, -312.0, 10.0, 10.0, 5.0, 0.0, -20.0, -14.0, 0.0, 0.0, 7.0, 0.0, -378.0, -367.0, 3.0, 0.0, -20.0, -324.0, -384.0, -379.0, 6.0, 10.0, 0.0, -400.0, 8.0, -17.0, 0.0, -358.0, -162.0, -176.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -378.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, -14.0, 0.0, 0.0, 10.0, -6.0, -20.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -76.0, 10.0, 0.0, 0.0, -354.0, -8.0, 15.0, 13.0, 6.0, 0.0, 14.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, -16.0, 0.0, -1.0, 0.0, 15.0, -80.0], "policy_predator_policy_reward": [0.0, 8.0, 83.0, 0.0, 169.0, 48.0, 200.0, 0.0, 0.0, 0.0, 0.0, 44.0, 0.0, 71.0, 0.0, 200.0, 200.0, 200.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 174.0, 142.0, 0.0, 0.0, 177.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 181.0, 180.0, 0.0, 10.0, 32.0, 0.0, 0.0, 2.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 194.0, 8.0, 0.0, 0.0, 188.0, 8.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 189.0, 189.0, 6.0, 0.0, 169.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 186.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 2.0, 2.0, 0.0, 183.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.912561352137365, "mean_inference_ms": 2.366152596166624, "mean_action_processing_ms": 0.4425262508199538, "mean_env_wait_ms": 0.32297206901969366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00454103946685791, "StateBufferConnector_ms": 0.0051348209381103516, "ViewRequirementAgentConnector_ms": 0.13736224174499512}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -570.0, "episode_return_mean": -72.98, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.9458427509731, "num_env_steps_trained_throughput_per_sec": 290.9458427509731, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 12875.627, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12875.579, "sample_time_ms": 1660.781, "learn_time_ms": 11200.124, "learn_throughput": 357.139, "synch_weights_time_ms": 12.393}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "f1691_00000", "date": "2024-08-13_17-03-00", "timestamp": 1723582980, "time_this_iter_s": 13.828566074371338, "time_total_s": 1470.6339604854584, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1470.6339604854584, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 75.64736842105265, "ram_util_percent": 83.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3411707346322674, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.607906763515775, "policy_loss": 0.0029718735661830695, "vf_loss": 1.5855041807290737, "vf_explained_var": 0.01531822854879672, "kl": 0.011372340723603706, "entropy": 0.06921471358134003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1741634803022367, "cur_kl_coeff": 5.092006176710127e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.6899158155476606, "policy_loss": 0.00023069557063675746, "vf_loss": 1.6896851181983947, "vf_explained_var": -6.717348855639261e-09, "kl": 8.609276838045328e-12, "entropy": 1.620589977087409e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -570.0, "episode_reward_mean": -53.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -51.285, "predator_policy": 24.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 7.0, 0.0, -198.0, 0.0, -6.0, -195.0, 0.0, 0.0, -175.0, 0.0, 15.0, -57.0, 5.0, -415.0, 15.0, -357.0, -3.0, -27.0, 6.0, -182.0, 0.0, 3.0, -210.0, -190.0, 30.0, -192.0, 2.0, 6.0, 8.0, 15.0, 15.0, -164.0, 20.0, 5.0, -21.0, 0.0, 11.0, -367.0, 9.0, -175.0, -570.0, 16.0, -200.0, 1.0, -172.0, -250.0, 2.0, 0.0, 0.0, 0.0, -174.0, 0.0, 0.0, 0.0, 12.0, 15.0, -7.0, 10.0, -13.0, -9.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -38.0, 14.0, -171.0, 11.0, 19.0, 14.0, 6.0, 4.0, 0.0, -185.0, 0.0, -8.0, 6.0, -25.0, -286.0, 0.0, 4.0, -168.0, 0.0, 0.0, -8.0, -200.0, 4.0, 15.0, -27.0, 10.0, -191.0, -12.0, 11.0, -12.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, 0.0, 7.0, 0.0, 0.0, 0.0, -396.0, 0.0, 0.0, 0.0, -20.0, 4.0, -5.0, -380.0, 0.0, 0.0, 0.0, 0.0, -352.0, 1.0, 0.0, 0.0, 0.0, 15.0, 4.0, -122.0, 0.0, 5.0, -365.0, -238.0, 15.0, 0.0, -358.0, -360.0, 0.0, -13.0, 0.0, -59.0, 4.0, 0.0, 0.0, -364.0, 0.0, 0.0, 3.0, 0.0, -20.0, -400.0, -4.0, -388.0, 15.0, 15.0, 0.0, -388.0, -1.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 15.0, 15.0, 0.0, -16.0, -312.0, 10.0, 10.0, 5.0, 0.0, -20.0, -14.0, 0.0, 0.0, 7.0, 0.0, -378.0, -367.0, 3.0, 0.0, -20.0, -324.0, -384.0, -379.0, 6.0, 10.0, 0.0, -400.0, 8.0, -17.0, 0.0, -358.0, -162.0, -176.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -378.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, -14.0, 0.0, 0.0, 10.0, -6.0, -20.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -76.0, 10.0, 0.0, 0.0, -354.0, -8.0, 15.0, 13.0, 6.0, 0.0, 14.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, -16.0, 0.0, -1.0, 0.0, 15.0, -80.0, -310.0, -138.0, 0.0, 0.0, 4.0, 0.0, 0.0, -350.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, -20.0, -380.0, 4.0, 0.0, 0.0, 15.0, -78.0, 12.0, 8.0, 0.0, -385.0, 0.0, -11.0, -11.0, 11.0, 0.0, -4.0, -30.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 176.0, 0.0, 0.0, 0.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 181.0, 180.0, 0.0, 10.0, 32.0, 0.0, 0.0, 2.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 194.0, 8.0, 0.0, 0.0, 188.0, 8.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 189.0, 189.0, 6.0, 0.0, 169.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 186.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 2.0, 2.0, 0.0, 183.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 40.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 39.0, 0.0, 2.0, 0.0, 184.0, 10.0, 0.0, 10.0, 0.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9113390663424648, "mean_inference_ms": 2.362264342700087, "mean_action_processing_ms": 0.4417706131984262, "mean_env_wait_ms": 0.32250604855683074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004532337188720703, "StateBufferConnector_ms": 0.005140781402587891, "ViewRequirementAgentConnector_ms": 0.13800597190856934}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -570.0, "episode_return_mean": -53.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.88112817563695, "num_env_steps_trained_throughput_per_sec": 327.88112817563695, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 12841.095, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12841.047, "sample_time_ms": 1663.13, "learn_time_ms": 11162.554, "learn_throughput": 358.341, "synch_weights_time_ms": 12.771}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "f1691_00000", "date": "2024-08-13_17-03-13", "timestamp": 1723582993, "time_this_iter_s": 12.256904125213623, "time_total_s": 1482.890864610672, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d0dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1482.890864610672, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 67.65555555555554, "ram_util_percent": 83.51111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2505014853345022, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.954063630072528, "policy_loss": 0.0013742381016965265, "vf_loss": 1.9378274369492101, "vf_explained_var": 0.03319327537975614, "kl": 0.008698353338002581, "entropy": 0.06793753502289296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0254449700125465, "cur_kl_coeff": 2.5460030883550636e-08, "cur_lr": 0.009999999999999998, "total_loss": 2.533555227045029, "policy_loss": 0.0003922198286831931, "vf_loss": 2.5331630062173915, "vf_explained_var": -5.298190646701389e-09, "kl": -1.7506239576760212e-11, "entropy": 1.6222999187641983e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -570.0, "episode_reward_mean": -57.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -54.88, "predator_policy": 26.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -210.0, -190.0, 30.0, -192.0, 2.0, 6.0, 8.0, 15.0, 15.0, -164.0, 20.0, 5.0, -21.0, 0.0, 11.0, -367.0, 9.0, -175.0, -570.0, 16.0, -200.0, 1.0, -172.0, -250.0, 2.0, 0.0, 0.0, 0.0, -174.0, 0.0, 0.0, 0.0, 12.0, 15.0, -7.0, 10.0, -13.0, -9.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -38.0, 14.0, -171.0, 11.0, 19.0, 14.0, 6.0, 4.0, 0.0, -185.0, 0.0, -8.0, 6.0, -25.0, -286.0, 0.0, 4.0, -168.0, 0.0, 0.0, -8.0, -200.0, 4.0, 15.0, -27.0, 10.0, -191.0, -12.0, 11.0, -12.0, 0.0, 0.0, -32.0, 0.0, 0.0, -3.0, -567.0, -166.0, -138.0, -5.0, -562.0, 28.0, 4.0, 12.0, -197.0, -183.0, 8.0, -174.0, -3.0, 25.0, -79.0, 13.0, -1.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 0.0, -20.0, -400.0, -4.0, -388.0, 15.0, 15.0, 0.0, -388.0, -1.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 15.0, 15.0, 0.0, -16.0, -312.0, 10.0, 10.0, 5.0, 0.0, -20.0, -14.0, 0.0, 0.0, 7.0, 0.0, -378.0, -367.0, 3.0, 0.0, -20.0, -324.0, -384.0, -379.0, 6.0, 10.0, 0.0, -400.0, 8.0, -17.0, 0.0, -358.0, -162.0, -176.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -378.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, -14.0, 0.0, 0.0, 10.0, -6.0, -20.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -76.0, 10.0, 0.0, 0.0, -354.0, -8.0, 15.0, 13.0, 6.0, 0.0, 14.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, -16.0, 0.0, -1.0, 0.0, 15.0, -80.0, -310.0, -138.0, 0.0, 0.0, 4.0, 0.0, 0.0, -350.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, -20.0, -380.0, 4.0, 0.0, 0.0, 15.0, -78.0, 12.0, 8.0, 0.0, -385.0, 0.0, -11.0, -11.0, 11.0, 0.0, -4.0, -30.0, 0.0, 0.0, 0.0, 0.0, -94.0, 15.0, 0.0, 0.0, 0.0, -7.0, -26.0, 10.0, -370.0, -400.0, 0.0, -347.0, -20.0, -270.0, -14.0, 0.0, -362.0, -400.0, 15.0, 13.0, 0.0, 4.0, 0.0, 12.0, -400.0, 3.0, -8.0, -358.0, 8.0, 0.0, -361.0, 0.0, 0.0, -6.0, 15.0, 10.0, 0.0, -372.0, 4.0, 9.0, -11.0, 0.0, 3.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 10.0, 194.0, 8.0, 0.0, 0.0, 188.0, 8.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 189.0, 189.0, 6.0, 0.0, 169.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 186.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 2.0, 2.0, 0.0, 183.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 40.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 39.0, 0.0, 2.0, 0.0, 184.0, 10.0, 0.0, 10.0, 0.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 10.0, 3.0, 200.0, 0.0, 181.0, 10.0, 142.0, 9.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 187.0, 3.0, 0.0, 0.0, 0.0, 179.0, 114.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.910258179294519, "mean_inference_ms": 2.3579762132853195, "mean_action_processing_ms": 0.4405194785290413, "mean_env_wait_ms": 0.3220092782348742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005369663238525391, "StateBufferConnector_ms": 0.006394624710083008, "ViewRequirementAgentConnector_ms": 0.15476155281066895}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -570.0, "episode_return_mean": -57.5, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.67812481073105, "num_env_steps_trained_throughput_per_sec": 327.67812481073105, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 12840.431, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12840.384, "sample_time_ms": 1687.989, "learn_time_ms": 11137.557, "learn_throughput": 359.145, "synch_weights_time_ms": 12.523}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "f1691_00000", "date": "2024-08-13_17-03-25", "timestamp": 1723583005, "time_this_iter_s": 12.272964715957642, "time_total_s": 1495.1638293266296, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1495.1638293266296, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 66.25294117647059, "ram_util_percent": 83.49411764705881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6929298546500307, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.0645576377709707, "policy_loss": 0.0015777366649773385, "vf_loss": 1.0478651326327098, "vf_explained_var": 0.013899879890774923, "kl": 0.00884632040393058, "entropy": 0.07305018123234351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.242207674038651, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.5682128585441402, "policy_loss": 1.1139602533408573e-05, "vf_loss": 1.5682017187277475, "vf_explained_var": -8.767244046327297e-09, "kl": 3.383997691415023e-11, "entropy": 1.5465276328229186e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -586.0, "episode_reward_mean": -59.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -53.515, "predator_policy": 23.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.0, -570.0, 16.0, -200.0, 1.0, -172.0, -250.0, 2.0, 0.0, 0.0, 0.0, -174.0, 0.0, 0.0, 0.0, 12.0, 15.0, -7.0, 10.0, -13.0, -9.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -38.0, 14.0, -171.0, 11.0, 19.0, 14.0, 6.0, 4.0, 0.0, -185.0, 0.0, -8.0, 6.0, -25.0, -286.0, 0.0, 4.0, -168.0, 0.0, 0.0, -8.0, -200.0, 4.0, 15.0, -27.0, 10.0, -191.0, -12.0, 11.0, -12.0, 0.0, 0.0, -32.0, 0.0, 0.0, -3.0, -567.0, -166.0, -138.0, -5.0, -562.0, 28.0, 4.0, 12.0, -197.0, -183.0, 8.0, -174.0, -3.0, 25.0, -79.0, 13.0, -1.0, 3.0, 11.0, 6.0, 0.0, 0.0, -74.0, -436.0, 0.0, 0.0, -586.0, 12.0, 6.0, 17.0, 0.0, -190.0, -7.0, 15.0, -16.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -324.0, -384.0, -379.0, 6.0, 10.0, 0.0, -400.0, 8.0, -17.0, 0.0, -358.0, -162.0, -176.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -378.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, -14.0, 0.0, 0.0, 10.0, -6.0, -20.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -76.0, 10.0, 0.0, 0.0, -354.0, -8.0, 15.0, 13.0, 6.0, 0.0, 14.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, -16.0, 0.0, -1.0, 0.0, 15.0, -80.0, -310.0, -138.0, 0.0, 0.0, 4.0, 0.0, 0.0, -350.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, -20.0, -380.0, 4.0, 0.0, 0.0, 15.0, -78.0, 12.0, 8.0, 0.0, -385.0, 0.0, -11.0, -11.0, 11.0, 0.0, -4.0, -30.0, 0.0, 0.0, 0.0, 0.0, -94.0, 15.0, 0.0, 0.0, 0.0, -7.0, -26.0, 10.0, -370.0, -400.0, 0.0, -347.0, -20.0, -270.0, -14.0, 0.0, -362.0, -400.0, 15.0, 13.0, 0.0, 4.0, 0.0, 12.0, -400.0, 3.0, -8.0, -358.0, 8.0, 0.0, -361.0, 0.0, 0.0, -6.0, 15.0, 10.0, 0.0, -372.0, 4.0, 9.0, -11.0, 0.0, 3.0, 0.0, 0.0, -6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, -288.0, -296.0, 0.0, 0.0, 0.0, 0.0, -400.0, -386.0, 12.0, 0.0, 6.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, -380.0, 0.0, -17.0, 15.0, 0.0, 10.0, -60.0, -6.0, 0.0], "policy_predator_policy_reward": [169.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 186.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 2.0, 2.0, 0.0, 183.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 40.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 39.0, 0.0, 2.0, 0.0, 184.0, 10.0, 0.0, 10.0, 0.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 10.0, 3.0, 200.0, 0.0, 181.0, 10.0, 142.0, 9.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 187.0, 3.0, 0.0, 0.0, 0.0, 179.0, 114.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 74.0, 148.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 190.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 24.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9092510910717264, "mean_inference_ms": 2.3541527179883337, "mean_action_processing_ms": 0.43947777599138727, "mean_env_wait_ms": 0.3215430427802144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005488872528076172, "StateBufferConnector_ms": 0.00626218318939209, "ViewRequirementAgentConnector_ms": 0.13979530334472656}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -586.0, "episode_return_mean": -59.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.9205668830604, "num_env_steps_trained_throughput_per_sec": 327.9205668830604, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 12829.426, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12829.378, "sample_time_ms": 1700.281, "learn_time_ms": 11113.731, "learn_throughput": 359.915, "synch_weights_time_ms": 12.688}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "f1691_00000", "date": "2024-08-13_17-03-37", "timestamp": 1723583017, "time_this_iter_s": 12.264843940734863, "time_total_s": 1507.4286732673645, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1507.4286732673645, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 66.52352941176471, "ram_util_percent": 83.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2787668856284604, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.2591470581513864, "policy_loss": 0.004157165153612378, "vf_loss": 2.2169407519083175, "vf_explained_var": 0.019900238797778174, "kl": 0.022269271971096682, "entropy": 0.10828891773979185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1419472362819034, "cur_kl_coeff": 6.365007720887659e-09, "cur_lr": 0.009999999999999998, "total_loss": 2.0218123025048977, "policy_loss": 0.00027514712000512097, "vf_loss": 2.021537152358464, "vf_explained_var": -5.8027802321015215e-09, "kl": -2.855559047291157e-12, "entropy": 1.5409297064206597e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -586.0, "episode_reward_mean": -56.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -51.79, "predator_policy": 23.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 14.0, 0.0, 0.0, 0.0, -38.0, 14.0, -171.0, 11.0, 19.0, 14.0, 6.0, 4.0, 0.0, -185.0, 0.0, -8.0, 6.0, -25.0, -286.0, 0.0, 4.0, -168.0, 0.0, 0.0, -8.0, -200.0, 4.0, 15.0, -27.0, 10.0, -191.0, -12.0, 11.0, -12.0, 0.0, 0.0, -32.0, 0.0, 0.0, -3.0, -567.0, -166.0, -138.0, -5.0, -562.0, 28.0, 4.0, 12.0, -197.0, -183.0, 8.0, -174.0, -3.0, 25.0, -79.0, 13.0, -1.0, 3.0, 11.0, 6.0, 0.0, 0.0, -74.0, -436.0, 0.0, 0.0, -586.0, 12.0, 6.0, 17.0, 0.0, -190.0, -7.0, 15.0, -16.0, -3.0, 5.0, -62.0, 2.0, -21.0, -575.0, 0.0, 7.0, -73.0, 10.0, 1.0, 10.0, 6.0, 0.0, -582.0, 7.0, 0.0, 12.0, 10.0, 3.0, 1.0, -2.0, 0.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -76.0, 10.0, 0.0, 0.0, -354.0, -8.0, 15.0, 13.0, 6.0, 0.0, 14.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, -16.0, 0.0, -1.0, 0.0, 15.0, -80.0, -310.0, -138.0, 0.0, 0.0, 4.0, 0.0, 0.0, -350.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, -20.0, -380.0, 4.0, 0.0, 0.0, 15.0, -78.0, 12.0, 8.0, 0.0, -385.0, 0.0, -11.0, -11.0, 11.0, 0.0, -4.0, -30.0, 0.0, 0.0, 0.0, 0.0, -94.0, 15.0, 0.0, 0.0, 0.0, -7.0, -26.0, 10.0, -370.0, -400.0, 0.0, -347.0, -20.0, -270.0, -14.0, 0.0, -362.0, -400.0, 15.0, 13.0, 0.0, 4.0, 0.0, 12.0, -400.0, 3.0, -8.0, -358.0, 8.0, 0.0, -361.0, 0.0, 0.0, -6.0, 15.0, 10.0, 0.0, -372.0, 4.0, 9.0, -11.0, 0.0, 3.0, 0.0, 0.0, -6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, -288.0, -296.0, 0.0, 0.0, 0.0, 0.0, -400.0, -386.0, 12.0, 0.0, 6.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, -380.0, 0.0, -17.0, 15.0, 0.0, 10.0, -60.0, -6.0, 0.0, 4.0, 1.0, -154.0, 15.0, 2.0, 0.0, -20.0, -20.0, -394.0, -394.0, -400.0, 0.0, 7.0, 0.0, -20.0, -141.0, 10.0, 0.0, 0.0, 1.0, 5.0, 0.0, 11.0, -10.0, 0.0, 0.0, -382.0, -400.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 0.0, 3.0, 0.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 15.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 2.0, 2.0, 0.0, 183.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 40.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 39.0, 0.0, 2.0, 0.0, 184.0, 10.0, 0.0, 10.0, 0.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 10.0, 3.0, 200.0, 0.0, 181.0, 10.0, 142.0, 9.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 187.0, 3.0, 0.0, 0.0, 0.0, 179.0, 114.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 74.0, 148.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 190.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 77.0, 0.0, 0.0, 19.0, 0.0, 197.0, 16.0, 200.0, 200.0, 0.0, 0.0, 10.0, 78.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 200.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9087812532496831, "mean_inference_ms": 2.354553635374421, "mean_action_processing_ms": 0.4392446884628429, "mean_env_wait_ms": 0.3212948740316547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009240150451660156, "StateBufferConnector_ms": 0.005538463592529297, "ViewRequirementAgentConnector_ms": 0.15218424797058105}, "num_episodes": 23, "episode_return_max": 28.0, "episode_return_min": -586.0, "episode_return_mean": -56.87, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.9390794436829, "num_env_steps_trained_throughput_per_sec": 283.9390794436829, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 12918.103, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12918.055, "sample_time_ms": 1808.696, "learn_time_ms": 11093.994, "learn_throughput": 360.555, "synch_weights_time_ms": 12.809}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "f1691_00000", "date": "2024-08-13_17-03-51", "timestamp": 1723583031, "time_this_iter_s": 14.139343023300171, "time_total_s": 1521.5680162906647, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1521.5680162906647, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 79.43999999999998, "ram_util_percent": 82.545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4853581250817687, "cur_kl_coeff": 2.5628906250000005, "cur_lr": 0.009999999999999998, "total_loss": 2.492314510181467, "policy_loss": 0.004200411180931109, "vf_loss": 2.460455942280078, "vf_explained_var": 0.05199201759837922, "kl": 0.010791781850302083, "entropy": 0.09567080786225027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.068892757385161, "cur_kl_coeff": 3.1825038604438295e-09, "cur_lr": 0.009999999999999998, "total_loss": 2.8917388499729215, "policy_loss": -0.0001653053851985427, "vf_loss": 2.8919041603961317, "vf_explained_var": -6.843496251989294e-09, "kl": 4.322962751730951e-11, "entropy": 1.4929983724570737e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -586.0, "episode_reward_mean": -65.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -63.095, "predator_policy": 30.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0, -286.0, 0.0, 4.0, -168.0, 0.0, 0.0, -8.0, -200.0, 4.0, 15.0, -27.0, 10.0, -191.0, -12.0, 11.0, -12.0, 0.0, 0.0, -32.0, 0.0, 0.0, -3.0, -567.0, -166.0, -138.0, -5.0, -562.0, 28.0, 4.0, 12.0, -197.0, -183.0, 8.0, -174.0, -3.0, 25.0, -79.0, 13.0, -1.0, 3.0, 11.0, 6.0, 0.0, 0.0, -74.0, -436.0, 0.0, 0.0, -586.0, 12.0, 6.0, 17.0, 0.0, -190.0, -7.0, 15.0, -16.0, -3.0, 5.0, -62.0, 2.0, -21.0, -575.0, 0.0, 7.0, -73.0, 10.0, 1.0, 10.0, 6.0, 0.0, -582.0, 7.0, 0.0, 12.0, 10.0, 3.0, 1.0, -2.0, 0.0, 15.0, 7.0, 12.0, 0.0, -151.0, 0.0, 27.0, 14.0, -10.0, -186.0, 8.0, -176.0, 0.0, -140.0, -3.0, 1.0, -94.0, -10.0, -428.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, -80.0, -310.0, -138.0, 0.0, 0.0, 4.0, 0.0, 0.0, -350.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, -20.0, -380.0, 4.0, 0.0, 0.0, 15.0, -78.0, 12.0, 8.0, 0.0, -385.0, 0.0, -11.0, -11.0, 11.0, 0.0, -4.0, -30.0, 0.0, 0.0, 0.0, 0.0, -94.0, 15.0, 0.0, 0.0, 0.0, -7.0, -26.0, 10.0, -370.0, -400.0, 0.0, -347.0, -20.0, -270.0, -14.0, 0.0, -362.0, -400.0, 15.0, 13.0, 0.0, 4.0, 0.0, 12.0, -400.0, 3.0, -8.0, -358.0, 8.0, 0.0, -361.0, 0.0, 0.0, -6.0, 15.0, 10.0, 0.0, -372.0, 4.0, 9.0, -11.0, 0.0, 3.0, 0.0, 0.0, -6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, -288.0, -296.0, 0.0, 0.0, 0.0, 0.0, -400.0, -386.0, 12.0, 0.0, 6.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, -380.0, 0.0, -17.0, 15.0, 0.0, 10.0, -60.0, -6.0, 0.0, 4.0, 1.0, -154.0, 15.0, 2.0, 0.0, -20.0, -20.0, -394.0, -394.0, -400.0, 0.0, 7.0, 0.0, -20.0, -141.0, 10.0, 0.0, 0.0, 1.0, 5.0, 0.0, 11.0, -10.0, 0.0, 0.0, -382.0, -400.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 0.0, 3.0, 0.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 15.0, -400.0, 7.0, 12.0, 0.0, 0.0, 0.0, -131.0, -322.0, 0.0, 0.0, 12.0, 15.0, -356.0, 14.0, -16.0, -12.0, -400.0, 14.0, 0.0, 8.0, 0.0, -364.0, 0.0, 0.0, -286.0, 0.0, 0.0, -13.0, -1.0, 0.0, -135.0, -50.0, -20.0, 0.0, -288.0, -292.0], "policy_predator_policy_reward": [40.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 190.0, 0.0, 0.0, 0.0, 0.0, 39.0, 0.0, 2.0, 0.0, 184.0, 10.0, 0.0, 10.0, 0.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 10.0, 3.0, 200.0, 0.0, 181.0, 10.0, 142.0, 9.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 187.0, 3.0, 0.0, 0.0, 0.0, 179.0, 114.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 74.0, 148.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 190.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 77.0, 0.0, 0.0, 19.0, 0.0, 197.0, 16.0, 200.0, 200.0, 0.0, 0.0, 10.0, 78.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 200.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 163.0, 139.0, 0.0, 0.0, 0.0, 0.0, 178.0, 178.0, 18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 3.0, 143.0, 10.0, 0.0, 2.0, 0.0, 10.0, 81.0, 0.0, 10.0, 141.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9096072555669005, "mean_inference_ms": 2.3532234578567626, "mean_action_processing_ms": 0.4379893262311819, "mean_env_wait_ms": 0.32131269907824006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009432196617126465, "StateBufferConnector_ms": 0.005964875221252441, "ViewRequirementAgentConnector_ms": 0.1557328701019287}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -586.0, "episode_return_mean": -65.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.57113274303003, "num_env_steps_trained_throughput_per_sec": 267.57113274303003, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 13184.094, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13184.046, "sample_time_ms": 1909.976, "learn_time_ms": 11254.217, "learn_throughput": 355.422, "synch_weights_time_ms": 16.702}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "f1691_00000", "date": "2024-08-13_17-04-06", "timestamp": 1723583046, "time_this_iter_s": 15.032629013061523, "time_total_s": 1536.6006453037262, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dce430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1536.6006453037262, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 82.73636363636365, "ram_util_percent": 83.12272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4660654077848427, "cur_kl_coeff": 2.5628906250000005, "cur_lr": 0.009999999999999998, "total_loss": 1.6935253946554094, "policy_loss": 0.001523915559753145, "vf_loss": 1.6762815580481574, "vf_explained_var": 0.04532912770907084, "kl": 0.006133667328119145, "entropy": 0.061710164300289264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3842402977750035, "cur_kl_coeff": 1.5912519302219147e-09, "cur_lr": 0.009999999999999998, "total_loss": 2.2827524875837657, "policy_loss": 0.00015753169726363564, "vf_loss": 2.282594956039752, "vf_explained_var": -6.591201459289228e-09, "kl": 5.5339036573545e-12, "entropy": 1.4228438983399917e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -586.0, "episode_reward_mean": -76.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -71.71, "predator_policy": 33.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -567.0, -166.0, -138.0, -5.0, -562.0, 28.0, 4.0, 12.0, -197.0, -183.0, 8.0, -174.0, -3.0, 25.0, -79.0, 13.0, -1.0, 3.0, 11.0, 6.0, 0.0, 0.0, -74.0, -436.0, 0.0, 0.0, -586.0, 12.0, 6.0, 17.0, 0.0, -190.0, -7.0, 15.0, -16.0, -3.0, 5.0, -62.0, 2.0, -21.0, -575.0, 0.0, 7.0, -73.0, 10.0, 1.0, 10.0, 6.0, 0.0, -582.0, 7.0, 0.0, 12.0, 10.0, 3.0, 1.0, -2.0, 0.0, 15.0, 7.0, 12.0, 0.0, -151.0, 0.0, 27.0, 14.0, -10.0, -186.0, 8.0, -176.0, 0.0, -140.0, -3.0, 1.0, -94.0, -10.0, -428.0, 20.0, 10.0, -52.0, -171.0, -7.0, -187.0, 4.0, -197.0, 27.0, 8.0, -566.0, 15.0, -574.0, 0.0, 11.0, 0.0, -43.0, -188.0, 10.0, -12.0, 4.0, -170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, 10.0, -370.0, -400.0, 0.0, -347.0, -20.0, -270.0, -14.0, 0.0, -362.0, -400.0, 15.0, 13.0, 0.0, 4.0, 0.0, 12.0, -400.0, 3.0, -8.0, -358.0, 8.0, 0.0, -361.0, 0.0, 0.0, -6.0, 15.0, 10.0, 0.0, -372.0, 4.0, 9.0, -11.0, 0.0, 3.0, 0.0, 0.0, -6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, -288.0, -296.0, 0.0, 0.0, 0.0, 0.0, -400.0, -386.0, 12.0, 0.0, 6.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, -380.0, 0.0, -17.0, 15.0, 0.0, 10.0, -60.0, -6.0, 0.0, 4.0, 1.0, -154.0, 15.0, 2.0, 0.0, -20.0, -20.0, -394.0, -394.0, -400.0, 0.0, 7.0, 0.0, -20.0, -141.0, 10.0, 0.0, 0.0, 1.0, 5.0, 0.0, 11.0, -10.0, 0.0, 0.0, -382.0, -400.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 0.0, 3.0, 0.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 15.0, -400.0, 7.0, 12.0, 0.0, 0.0, 0.0, -131.0, -322.0, 0.0, 0.0, 12.0, 15.0, -356.0, 14.0, -16.0, -12.0, -400.0, 14.0, 0.0, 8.0, 0.0, -364.0, 0.0, 0.0, -286.0, 0.0, 0.0, -13.0, -1.0, 0.0, -135.0, -50.0, -20.0, 0.0, -288.0, -292.0, 5.0, 15.0, 0.0, 9.0, -58.0, -55.0, -352.0, 5.0, -12.0, -8.0, 13.0, -400.0, -1.0, 0.0, -394.0, 0.0, 15.0, 12.0, 8.0, 0.0, -373.0, -394.0, 0.0, 15.0, -400.0, -374.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -86.0, 0.0, -8.0, -376.0, 0.0, 10.0, -6.0, -19.0, 11.0, -14.0, -4.0, -350.0], "policy_predator_policy_reward": [3.0, 10.0, 3.0, 200.0, 0.0, 181.0, 10.0, 142.0, 9.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 187.0, 3.0, 0.0, 0.0, 0.0, 179.0, 114.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 74.0, 148.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 190.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 77.0, 0.0, 0.0, 19.0, 0.0, 197.0, 16.0, 200.0, 200.0, 0.0, 0.0, 10.0, 78.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 200.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 163.0, 139.0, 0.0, 0.0, 0.0, 0.0, 178.0, 178.0, 18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 3.0, 143.0, 10.0, 0.0, 2.0, 0.0, 10.0, 81.0, 0.0, 10.0, 141.0, 11.0, 0.0, 0.0, 1.0, 0.0, 59.0, 2.0, 176.0, 0.0, 0.0, 13.0, 0.0, 200.0, 5.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 192.0, 0.0, 0.0, 3.0, 10.0, 0.0, 7.0, 184.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9103246624929122, "mean_inference_ms": 2.3551145100753916, "mean_action_processing_ms": 0.43748600955381833, "mean_env_wait_ms": 0.3213555962040736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009790778160095215, "StateBufferConnector_ms": 0.006231904029846191, "ViewRequirementAgentConnector_ms": 0.15678274631500244}, "num_episodes": 22, "episode_return_max": 28.0, "episode_return_min": -586.0, "episode_return_mean": -76.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.2816536971201, "num_env_steps_trained_throughput_per_sec": 326.2816536971201, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 12923.912, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12923.863, "sample_time_ms": 1721.222, "learn_time_ms": 11180.139, "learn_throughput": 357.777, "synch_weights_time_ms": 19.093}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "f1691_00000", "date": "2024-08-13_17-04-19", "timestamp": 1723583059, "time_this_iter_s": 12.354177713394165, "time_total_s": 1548.9548230171204, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e074c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1548.9548230171204, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 68.8529411764706, "ram_util_percent": 83.56470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5651928451247317, "cur_kl_coeff": 2.5628906250000005, "cur_lr": 0.009999999999999998, "total_loss": 2.5085454254554063, "policy_loss": 0.0025503880787818203, "vf_loss": 2.4914184429027415, "vf_explained_var": 0.06742383418259797, "kl": 0.005687557804672405, "entropy": 0.050663177405912724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.071900357832398, "cur_kl_coeff": 7.956259651109574e-10, "cur_lr": 0.009999999999999998, "total_loss": 2.724133777429187, "policy_loss": -0.0002632142655630276, "vf_loss": 2.724396979871881, "vf_explained_var": -5.235116948526372e-09, "kl": 2.4293199085969397e-11, "entropy": 1.3725885432832578e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -586.0, "episode_reward_mean": -67.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -65.385, "predator_policy": 31.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 11.0, 6.0, 0.0, 0.0, -74.0, -436.0, 0.0, 0.0, -586.0, 12.0, 6.0, 17.0, 0.0, -190.0, -7.0, 15.0, -16.0, -3.0, 5.0, -62.0, 2.0, -21.0, -575.0, 0.0, 7.0, -73.0, 10.0, 1.0, 10.0, 6.0, 0.0, -582.0, 7.0, 0.0, 12.0, 10.0, 3.0, 1.0, -2.0, 0.0, 15.0, 7.0, 12.0, 0.0, -151.0, 0.0, 27.0, 14.0, -10.0, -186.0, 8.0, -176.0, 0.0, -140.0, -3.0, 1.0, -94.0, -10.0, -428.0, 20.0, 10.0, -52.0, -171.0, -7.0, -187.0, 4.0, -197.0, 27.0, 8.0, -566.0, 15.0, -574.0, 0.0, 11.0, 0.0, -43.0, -188.0, 10.0, -12.0, 4.0, -170.0, 9.0, -2.0, -191.0, -178.0, -200.0, -1.0, -2.0, 10.0, 0.0, 1.0, 8.0, -169.0, -10.0, -406.0, -3.0, 0.0, -5.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 0.0, 0.0, -6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, -288.0, -296.0, 0.0, 0.0, 0.0, 0.0, -400.0, -386.0, 12.0, 0.0, 6.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, -380.0, 0.0, -17.0, 15.0, 0.0, 10.0, -60.0, -6.0, 0.0, 4.0, 1.0, -154.0, 15.0, 2.0, 0.0, -20.0, -20.0, -394.0, -394.0, -400.0, 0.0, 7.0, 0.0, -20.0, -141.0, 10.0, 0.0, 0.0, 1.0, 5.0, 0.0, 11.0, -10.0, 0.0, 0.0, -382.0, -400.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 0.0, 3.0, 0.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 15.0, -400.0, 7.0, 12.0, 0.0, 0.0, 0.0, -131.0, -322.0, 0.0, 0.0, 12.0, 15.0, -356.0, 14.0, -16.0, -12.0, -400.0, 14.0, 0.0, 8.0, 0.0, -364.0, 0.0, 0.0, -286.0, 0.0, 0.0, -13.0, -1.0, 0.0, -135.0, -50.0, -20.0, 0.0, -288.0, -292.0, 5.0, 15.0, 0.0, 9.0, -58.0, -55.0, -352.0, 5.0, -12.0, -8.0, 13.0, -400.0, -1.0, 0.0, -394.0, 0.0, 15.0, 12.0, 8.0, 0.0, -373.0, -394.0, 0.0, 15.0, -400.0, -374.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -86.0, 0.0, -8.0, -376.0, 0.0, 10.0, -6.0, -19.0, 11.0, -14.0, -4.0, -350.0, 6.0, 3.0, 1.0, -13.0, -326.0, -42.0, -374.0, 9.0, -400.0, 0.0, 0.0, -11.0, 0.0, -4.0, -2.0, 11.0, 0.0, 0.0, 0.0, -9.0, -2.0, 9.0, 0.0, -351.0, 0.0, -20.0, -400.0, -400.0, -13.0, 0.0, 0.0, 0.0, -23.0, 0.0, -6.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 74.0, 148.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 190.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 77.0, 0.0, 0.0, 19.0, 0.0, 197.0, 16.0, 200.0, 200.0, 0.0, 0.0, 10.0, 78.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 200.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 163.0, 139.0, 0.0, 0.0, 0.0, 0.0, 178.0, 178.0, 18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 3.0, 143.0, 10.0, 0.0, 2.0, 0.0, 10.0, 81.0, 0.0, 10.0, 141.0, 11.0, 0.0, 0.0, 1.0, 0.0, 59.0, 2.0, 176.0, 0.0, 0.0, 13.0, 0.0, 200.0, 5.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 192.0, 0.0, 0.0, 3.0, 10.0, 0.0, 7.0, 184.0, 0.0, 0.0, 0.0, 10.0, 0.0, 177.0, 0.0, 187.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 182.0, 0.0, 10.0, 194.0, 200.0, 10.0, 0.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9112573503408892, "mean_inference_ms": 2.357221565825201, "mean_action_processing_ms": 0.4373650719490986, "mean_env_wait_ms": 0.3216610235831572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009710073471069336, "StateBufferConnector_ms": 0.005051016807556152, "ViewRequirementAgentConnector_ms": 0.17378950119018555}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -586.0, "episode_return_mean": -67.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.54599908171787, "num_env_steps_trained_throughput_per_sec": 315.54599908171787, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 12950.744, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12950.693, "sample_time_ms": 1859.446, "learn_time_ms": 11068.624, "learn_throughput": 361.382, "synch_weights_time_ms": 19.231}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "f1691_00000", "date": "2024-08-13_17-04-32", "timestamp": 1723583072, "time_this_iter_s": 12.724066972732544, "time_total_s": 1561.678889989853, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e07700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1561.678889989853, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 66.74444444444445, "ram_util_percent": 83.76111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7633561073314574, "cur_kl_coeff": 2.5628906250000005, "cur_lr": 0.009999999999999998, "total_loss": 2.3571299527057263, "policy_loss": 0.000625137593498621, "vf_loss": 2.3488290169882395, "vf_explained_var": 0.09482942838517447, "kl": 0.002994978020056097, "entropy": 0.029859330193952673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.074815702704693, "cur_kl_coeff": 3.978129825554787e-10, "cur_lr": 0.009999999999999998, "total_loss": 1.9190908244677953, "policy_loss": 0.00025963070284989147, "vf_loss": 1.9188311966638716, "vf_explained_var": -8.325728159102183e-09, "kl": -1.608902344943965e-11, "entropy": 1.3453636696402963e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -582.0, "episode_reward_mean": -71.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -72.14, "predator_policy": 36.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 5.0, -62.0, 2.0, -21.0, -575.0, 0.0, 7.0, -73.0, 10.0, 1.0, 10.0, 6.0, 0.0, -582.0, 7.0, 0.0, 12.0, 10.0, 3.0, 1.0, -2.0, 0.0, 15.0, 7.0, 12.0, 0.0, -151.0, 0.0, 27.0, 14.0, -10.0, -186.0, 8.0, -176.0, 0.0, -140.0, -3.0, 1.0, -94.0, -10.0, -428.0, 20.0, 10.0, -52.0, -171.0, -7.0, -187.0, 4.0, -197.0, 27.0, 8.0, -566.0, 15.0, -574.0, 0.0, 11.0, 0.0, -43.0, -188.0, 10.0, -12.0, 4.0, -170.0, 9.0, -2.0, -191.0, -178.0, -200.0, -1.0, -2.0, 10.0, 0.0, 1.0, 8.0, -169.0, -10.0, -406.0, -3.0, 0.0, -5.0, -2.0, -571.0, 13.0, 4.0, -13.0, 17.0, 17.0, -182.0, -3.0, -375.0, -1.0, -4.0, -17.0, -185.0, -8.0, -12.0, 15.0, -243.0, -29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, 4.0, 1.0, -154.0, 15.0, 2.0, 0.0, -20.0, -20.0, -394.0, -394.0, -400.0, 0.0, 7.0, 0.0, -20.0, -141.0, 10.0, 0.0, 0.0, 1.0, 5.0, 0.0, 11.0, -10.0, 0.0, 0.0, -382.0, -400.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 0.0, 3.0, 0.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 15.0, -400.0, 7.0, 12.0, 0.0, 0.0, 0.0, -131.0, -322.0, 0.0, 0.0, 12.0, 15.0, -356.0, 14.0, -16.0, -12.0, -400.0, 14.0, 0.0, 8.0, 0.0, -364.0, 0.0, 0.0, -286.0, 0.0, 0.0, -13.0, -1.0, 0.0, -135.0, -50.0, -20.0, 0.0, -288.0, -292.0, 5.0, 15.0, 0.0, 9.0, -58.0, -55.0, -352.0, 5.0, -12.0, -8.0, 13.0, -400.0, -1.0, 0.0, -394.0, 0.0, 15.0, 12.0, 8.0, 0.0, -373.0, -394.0, 0.0, 15.0, -400.0, -374.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -86.0, 0.0, -8.0, -376.0, 0.0, 10.0, -6.0, -19.0, 11.0, -14.0, -4.0, -350.0, 6.0, 3.0, 1.0, -13.0, -326.0, -42.0, -374.0, 9.0, -400.0, 0.0, 0.0, -11.0, 0.0, -4.0, -2.0, 11.0, 0.0, 0.0, 0.0, -9.0, -2.0, 9.0, 0.0, -351.0, 0.0, -20.0, -400.0, -400.0, -13.0, 0.0, 0.0, 0.0, -23.0, 0.0, -6.0, 0.0, -376.0, -400.0, 13.0, 0.0, 4.0, 0.0, -398.0, 0.0, 2.0, 15.0, 15.0, 2.0, 8.0, -383.0, -13.0, 0.0, -391.0, -362.0, -11.0, 0.0, 10.0, -32.0, 0.0, -37.0, -400.0, 15.0, -15.0, -6.0, -32.0, 0.0, 0.0, 15.0, -46.0, -394.0, -64.0, -4.0], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 0.0, 0.0, 77.0, 0.0, 0.0, 19.0, 0.0, 197.0, 16.0, 200.0, 200.0, 0.0, 0.0, 10.0, 78.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 200.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 163.0, 139.0, 0.0, 0.0, 0.0, 0.0, 178.0, 178.0, 18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 3.0, 143.0, 10.0, 0.0, 2.0, 0.0, 10.0, 81.0, 0.0, 10.0, 141.0, 11.0, 0.0, 0.0, 1.0, 0.0, 59.0, 2.0, 176.0, 0.0, 0.0, 13.0, 0.0, 200.0, 5.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 192.0, 0.0, 0.0, 3.0, 10.0, 0.0, 7.0, 184.0, 0.0, 0.0, 0.0, 10.0, 0.0, 177.0, 0.0, 187.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 182.0, 0.0, 10.0, 194.0, 200.0, 10.0, 0.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 200.0, 5.0, 0.0, 0.0, 0.0, 0.0, 199.0, 186.0, 0.0, 0.0, 0.0, 0.0, 11.0, 182.0, 10.0, 0.0, 197.0, 181.0, 10.0, 0.0, 8.0, 10.0, 10.0, 10.0, 200.0, 0.0, 0.0, 13.0, 10.0, 10.0, 0.0, 0.0, 197.0, 0.0, 29.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9128344992569524, "mean_inference_ms": 2.361571036165592, "mean_action_processing_ms": 0.43745896395014955, "mean_env_wait_ms": 0.3220432210991766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011679649353027344, "StateBufferConnector_ms": 0.005048513412475586, "ViewRequirementAgentConnector_ms": 0.17916250228881836}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -582.0, "episode_return_mean": -71.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.2761617145197, "num_env_steps_trained_throughput_per_sec": 313.2761617145197, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 12976.618, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12976.567, "sample_time_ms": 1898.972, "learn_time_ms": 11054.934, "learn_throughput": 361.829, "synch_weights_time_ms": 19.095}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "f1691_00000", "date": "2024-08-13_17-04-45", "timestamp": 1723583085, "time_this_iter_s": 12.816007852554321, "time_total_s": 1574.4948978424072, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d6bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1574.4948978424072, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 68.21666666666667, "ram_util_percent": 83.75555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.727338409928418, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 1.3092294742821386, "policy_loss": 0.002120907188309406, "vf_loss": 1.2987826665557882, "vf_explained_var": 0.0521839491273991, "kl": 0.006497272796269799, "entropy": 0.02969348738043909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2991765574884733, "cur_kl_coeff": 1.9890649127773934e-10, "cur_lr": 0.009999999999999998, "total_loss": 1.636628227290653, "policy_loss": -0.0001222497827949978, "vf_loss": 1.6367504807534041, "vf_explained_var": -1.0470233897052744e-08, "kl": 2.5925242066158032e-11, "entropy": 1.29480726011708e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -574.0, "episode_reward_mean": -71.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -75.04, "predator_policy": 39.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 7.0, 12.0, 0.0, -151.0, 0.0, 27.0, 14.0, -10.0, -186.0, 8.0, -176.0, 0.0, -140.0, -3.0, 1.0, -94.0, -10.0, -428.0, 20.0, 10.0, -52.0, -171.0, -7.0, -187.0, 4.0, -197.0, 27.0, 8.0, -566.0, 15.0, -574.0, 0.0, 11.0, 0.0, -43.0, -188.0, 10.0, -12.0, 4.0, -170.0, 9.0, -2.0, -191.0, -178.0, -200.0, -1.0, -2.0, 10.0, 0.0, 1.0, 8.0, -169.0, -10.0, -406.0, -3.0, 0.0, -5.0, -2.0, -571.0, 13.0, 4.0, -13.0, 17.0, 17.0, -182.0, -3.0, -375.0, -1.0, -4.0, -17.0, -185.0, -8.0, -12.0, 15.0, -243.0, -29.0, 0.0, -169.0, 0.0, -1.0, 8.0, 0.0, 0.0, -5.0, -1.0, 11.0, -20.0, -192.0, -7.0, 21.0, -8.0, 0.0, -544.0, 15.0, -146.0, 10.0, 0.0, 0.0, -194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, -400.0, 7.0, 12.0, 0.0, 0.0, 0.0, -131.0, -322.0, 0.0, 0.0, 12.0, 15.0, -356.0, 14.0, -16.0, -12.0, -400.0, 14.0, 0.0, 8.0, 0.0, -364.0, 0.0, 0.0, -286.0, 0.0, 0.0, -13.0, -1.0, 0.0, -135.0, -50.0, -20.0, 0.0, -288.0, -292.0, 5.0, 15.0, 0.0, 9.0, -58.0, -55.0, -352.0, 5.0, -12.0, -8.0, 13.0, -400.0, -1.0, 0.0, -394.0, 0.0, 15.0, 12.0, 8.0, 0.0, -373.0, -394.0, 0.0, 15.0, -400.0, -374.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -86.0, 0.0, -8.0, -376.0, 0.0, 10.0, -6.0, -19.0, 11.0, -14.0, -4.0, -350.0, 6.0, 3.0, 1.0, -13.0, -326.0, -42.0, -374.0, 9.0, -400.0, 0.0, 0.0, -11.0, 0.0, -4.0, -2.0, 11.0, 0.0, 0.0, 0.0, -9.0, -2.0, 9.0, 0.0, -351.0, 0.0, -20.0, -400.0, -400.0, -13.0, 0.0, 0.0, 0.0, -23.0, 0.0, -6.0, 0.0, -376.0, -400.0, 13.0, 0.0, 4.0, 0.0, -398.0, 0.0, 2.0, 15.0, 15.0, 2.0, 8.0, -383.0, -13.0, 0.0, -391.0, -362.0, -11.0, 0.0, 10.0, -32.0, 0.0, -37.0, -400.0, 15.0, -15.0, -6.0, -32.0, 0.0, 0.0, 15.0, -46.0, -394.0, -64.0, -4.0, 0.0, 0.0, -362.0, 12.0, 0.0, -362.0, -2.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, -10.0, 0.0, -3.0, -20.0, -20.0, 0.0, -384.0, -18.0, 0.0, 6.0, 15.0, 2.0, -20.0, 0.0, 0.0, -400.0, -344.0, 15.0, -352.0, -102.0, -98.0, 15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 163.0, 139.0, 0.0, 0.0, 0.0, 0.0, 178.0, 178.0, 18.0, 0.0, 200.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 3.0, 143.0, 10.0, 0.0, 2.0, 0.0, 10.0, 81.0, 0.0, 10.0, 141.0, 11.0, 0.0, 0.0, 1.0, 0.0, 59.0, 2.0, 176.0, 0.0, 0.0, 13.0, 0.0, 200.0, 5.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 192.0, 0.0, 0.0, 3.0, 10.0, 0.0, 7.0, 184.0, 0.0, 0.0, 0.0, 10.0, 0.0, 177.0, 0.0, 187.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 182.0, 0.0, 10.0, 194.0, 200.0, 10.0, 0.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 200.0, 5.0, 0.0, 0.0, 0.0, 0.0, 199.0, 186.0, 0.0, 0.0, 0.0, 0.0, 11.0, 182.0, 10.0, 0.0, 197.0, 181.0, 10.0, 0.0, 8.0, 10.0, 10.0, 10.0, 200.0, 0.0, 0.0, 13.0, 10.0, 10.0, 0.0, 0.0, 197.0, 0.0, 29.0, 10.0, 0.0, 0.0, 0.0, 181.0, 181.0, 181.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 3.0, 7.0, 7.0, 10.0, 10.0, 10.0, 182.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 176.0, 176.0, 0.0, 54.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913996857279685, "mean_inference_ms": 2.364639682047306, "mean_action_processing_ms": 0.4373118749860888, "mean_env_wait_ms": 0.3222370557941537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008769869804382324, "StateBufferConnector_ms": 0.00635528564453125, "ViewRequirementAgentConnector_ms": 0.19393455982208252}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -574.0, "episode_return_mean": -71.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.4992255921817, "num_env_steps_trained_throughput_per_sec": 332.4992255921817, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 12912.408, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12912.358, "sample_time_ms": 1916.063, "learn_time_ms": 10973.668, "learn_throughput": 364.509, "synch_weights_time_ms": 19.093}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "f1691_00000", "date": "2024-08-13_17-04-57", "timestamp": 1723583097, "time_this_iter_s": 12.077023983001709, "time_total_s": 1586.571921825409, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e074c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1586.571921825409, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 70.05882352941177, "ram_util_percent": 83.70588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6500421159008822, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 1.4986794268958783, "policy_loss": 0.002229396793646393, "vf_loss": 1.4862944241080964, "vf_explained_var": 0.05669147406936323, "kl": 0.007925118034341396, "entropy": 0.037686604180338756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.194702647655596, "cur_kl_coeff": 9.945324563886967e-11, "cur_lr": 0.009999999999999998, "total_loss": 2.247264999308914, "policy_loss": -0.0002172231813399959, "vf_loss": 2.2474822272699346, "vf_explained_var": -7.190401591951885e-09, "kl": 2.1936658520230173e-11, "entropy": 1.2541777017985179e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -595.0, "episode_reward_mean": -80.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -75.055, "predator_policy": 34.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.0, -7.0, -187.0, 4.0, -197.0, 27.0, 8.0, -566.0, 15.0, -574.0, 0.0, 11.0, 0.0, -43.0, -188.0, 10.0, -12.0, 4.0, -170.0, 9.0, -2.0, -191.0, -178.0, -200.0, -1.0, -2.0, 10.0, 0.0, 1.0, 8.0, -169.0, -10.0, -406.0, -3.0, 0.0, -5.0, -2.0, -571.0, 13.0, 4.0, -13.0, 17.0, 17.0, -182.0, -3.0, -375.0, -1.0, -4.0, -17.0, -185.0, -8.0, -12.0, 15.0, -243.0, -29.0, 0.0, -169.0, 0.0, -1.0, 8.0, 0.0, 0.0, -5.0, -1.0, 11.0, -20.0, -192.0, -7.0, 21.0, -8.0, 0.0, -544.0, 15.0, -146.0, 10.0, 0.0, 0.0, -194.0, 11.0, 0.0, 2.0, 0.0, -595.0, -3.0, 11.0, -9.0, -8.0, 15.0, 1.0, -548.0, 0.0, -1.0, 0.0, -562.0, 0.0, -2.0, 0.0, 23.0, -167.0, -204.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-352.0, 5.0, -12.0, -8.0, 13.0, -400.0, -1.0, 0.0, -394.0, 0.0, 15.0, 12.0, 8.0, 0.0, -373.0, -394.0, 0.0, 15.0, -400.0, -374.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -86.0, 0.0, -8.0, -376.0, 0.0, 10.0, -6.0, -19.0, 11.0, -14.0, -4.0, -350.0, 6.0, 3.0, 1.0, -13.0, -326.0, -42.0, -374.0, 9.0, -400.0, 0.0, 0.0, -11.0, 0.0, -4.0, -2.0, 11.0, 0.0, 0.0, 0.0, -9.0, -2.0, 9.0, 0.0, -351.0, 0.0, -20.0, -400.0, -400.0, -13.0, 0.0, 0.0, 0.0, -23.0, 0.0, -6.0, 0.0, -376.0, -400.0, 13.0, 0.0, 4.0, 0.0, -398.0, 0.0, 2.0, 15.0, 15.0, 2.0, 8.0, -383.0, -13.0, 0.0, -391.0, -362.0, -11.0, 0.0, 10.0, -32.0, 0.0, -37.0, -400.0, 15.0, -15.0, -6.0, -32.0, 0.0, 0.0, 15.0, -46.0, -394.0, -64.0, -4.0, 0.0, 0.0, -362.0, 12.0, 0.0, -362.0, -2.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, -10.0, 0.0, -3.0, -20.0, -20.0, 0.0, -384.0, -18.0, 0.0, 6.0, 15.0, 2.0, -20.0, 0.0, 0.0, -400.0, -344.0, 15.0, -352.0, -102.0, -98.0, 15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 8.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, -400.0, -400.0, -8.0, 1.0, 11.0, 0.0, -2.0, -14.0, -13.0, -10.0, 0.0, 15.0, -8.0, 0.0, -362.0, -379.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -362.0, -400.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 12.0, 9.0, -349.0, 0.0, -20.0, -391.0], "policy_predator_policy_reward": [176.0, 0.0, 0.0, 13.0, 0.0, 200.0, 5.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 43.0, 4.0, 192.0, 0.0, 0.0, 3.0, 10.0, 0.0, 7.0, 184.0, 0.0, 0.0, 0.0, 10.0, 0.0, 177.0, 0.0, 187.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 182.0, 0.0, 10.0, 194.0, 200.0, 10.0, 0.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 200.0, 5.0, 0.0, 0.0, 0.0, 0.0, 199.0, 186.0, 0.0, 0.0, 0.0, 0.0, 11.0, 182.0, 10.0, 0.0, 197.0, 181.0, 10.0, 0.0, 8.0, 10.0, 10.0, 10.0, 200.0, 0.0, 0.0, 13.0, 10.0, 10.0, 0.0, 0.0, 197.0, 0.0, 29.0, 10.0, 0.0, 0.0, 0.0, 181.0, 181.0, 181.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 3.0, 7.0, 7.0, 10.0, 10.0, 10.0, 182.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 176.0, 176.0, 0.0, 54.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 195.0, 4.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 9.0, 0.0, 193.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 2.0, 0.0, 182.0, 0.0, 197.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9142632852799035, "mean_inference_ms": 2.3661014127492717, "mean_action_processing_ms": 0.4368141971630126, "mean_env_wait_ms": 0.32203065698138483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009167671203613281, "StateBufferConnector_ms": 0.004830598831176758, "ViewRequirementAgentConnector_ms": 0.17626774311065674}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -595.0, "episode_return_mean": -80.12, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.9582845213347, "num_env_steps_trained_throughput_per_sec": 325.9582845213347, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 12764.733, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12764.683, "sample_time_ms": 1901.899, "learn_time_ms": 10839.141, "learn_throughput": 369.033, "synch_weights_time_ms": 19.992}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "f1691_00000", "date": "2024-08-13_17-05-09", "timestamp": 1723583109, "time_this_iter_s": 12.351992845535278, "time_total_s": 1598.9239146709442, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dcef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1598.9239146709442, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 68.91176470588235, "ram_util_percent": 83.54117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.313889747574216, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 1.924318306912821, "policy_loss": 0.0036662342278138984, "vf_loss": 1.9045759595891156, "vf_explained_var": 0.057655506033115284, "kl": 0.012545297688064812, "entropy": 0.024388803363587983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3924468318425904, "cur_kl_coeff": 4.9726622819434836e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.725242591503436, "policy_loss": -1.2613128668692692e-05, "vf_loss": 1.725255210374398, "vf_explained_var": -7.82113857370205e-09, "kl": 4.513636052497051e-12, "entropy": 1.2162172208552985e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -595.0, "episode_reward_mean": -68.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -69.05, "predator_policy": 34.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.0, 9.0, -2.0, -191.0, -178.0, -200.0, -1.0, -2.0, 10.0, 0.0, 1.0, 8.0, -169.0, -10.0, -406.0, -3.0, 0.0, -5.0, -2.0, -571.0, 13.0, 4.0, -13.0, 17.0, 17.0, -182.0, -3.0, -375.0, -1.0, -4.0, -17.0, -185.0, -8.0, -12.0, 15.0, -243.0, -29.0, 0.0, -169.0, 0.0, -1.0, 8.0, 0.0, 0.0, -5.0, -1.0, 11.0, -20.0, -192.0, -7.0, 21.0, -8.0, 0.0, -544.0, 15.0, -146.0, 10.0, 0.0, 0.0, -194.0, 11.0, 0.0, 2.0, 0.0, -595.0, -3.0, 11.0, -9.0, -8.0, 15.0, 1.0, -548.0, 0.0, -1.0, 0.0, -562.0, 0.0, -2.0, 0.0, 23.0, -167.0, -204.0, -8.0, -200.0, 1.0, 5.0, 0.0, 7.0, 0.0, -4.0, 0.0, -8.0, -185.0, -165.0, 1.0, -170.0, -4.0, -2.0, -6.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -350.0, 6.0, 3.0, 1.0, -13.0, -326.0, -42.0, -374.0, 9.0, -400.0, 0.0, 0.0, -11.0, 0.0, -4.0, -2.0, 11.0, 0.0, 0.0, 0.0, -9.0, -2.0, 9.0, 0.0, -351.0, 0.0, -20.0, -400.0, -400.0, -13.0, 0.0, 0.0, 0.0, -23.0, 0.0, -6.0, 0.0, -376.0, -400.0, 13.0, 0.0, 4.0, 0.0, -398.0, 0.0, 2.0, 15.0, 15.0, 2.0, 8.0, -383.0, -13.0, 0.0, -391.0, -362.0, -11.0, 0.0, 10.0, -32.0, 0.0, -37.0, -400.0, 15.0, -15.0, -6.0, -32.0, 0.0, 0.0, 15.0, -46.0, -394.0, -64.0, -4.0, 0.0, 0.0, -362.0, 12.0, 0.0, -362.0, -2.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, -10.0, 0.0, -3.0, -20.0, -20.0, 0.0, -384.0, -18.0, 0.0, 6.0, 15.0, 2.0, -20.0, 0.0, 0.0, -400.0, -344.0, 15.0, -352.0, -102.0, -98.0, 15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 8.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, -400.0, -400.0, -8.0, 1.0, 11.0, 0.0, -2.0, -14.0, -13.0, -10.0, 0.0, 15.0, -8.0, 0.0, -362.0, -379.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -362.0, -400.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 12.0, 9.0, -349.0, 0.0, -20.0, -391.0, -15.0, -6.0, -400.0, 0.0, 0.0, 1.0, 0.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, -386.0, 0.0, 0.0, 0.0, -16.0, -362.0, -8.0, -344.0, 0.0, 0.0, 1.0, -340.0, 0.0, 0.0, -14.0, -8.0, 0.0, -15.0, 0.0, -16.0, 0.0], "policy_predator_policy_reward": [184.0, 0.0, 0.0, 0.0, 10.0, 0.0, 177.0, 0.0, 187.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 182.0, 0.0, 10.0, 194.0, 200.0, 10.0, 0.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 200.0, 5.0, 0.0, 0.0, 0.0, 0.0, 199.0, 186.0, 0.0, 0.0, 0.0, 0.0, 11.0, 182.0, 10.0, 0.0, 197.0, 181.0, 10.0, 0.0, 8.0, 10.0, 10.0, 10.0, 200.0, 0.0, 0.0, 13.0, 10.0, 10.0, 0.0, 0.0, 197.0, 0.0, 29.0, 10.0, 0.0, 0.0, 0.0, 181.0, 181.0, 181.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 3.0, 7.0, 7.0, 10.0, 10.0, 10.0, 182.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 176.0, 176.0, 0.0, 54.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 195.0, 4.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 9.0, 0.0, 193.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 2.0, 0.0, 182.0, 0.0, 197.0, 10.0, 0.0, 13.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 193.0, 0.0, 0.0, 8.0, 0.0, 181.0, 4.0, 0.0, 179.0, 0.0, 0.0, 0.0, 170.0, 0.0, 10.0, 6.0, 0.0, 9.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9143189531999569, "mean_inference_ms": 2.365622350812078, "mean_action_processing_ms": 0.43641553387319915, "mean_env_wait_ms": 0.32196434973018545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00895237922668457, "StateBufferConnector_ms": 0.00448763370513916, "ViewRequirementAgentConnector_ms": 0.17002665996551514}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -595.0, "episode_return_mean": -68.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.9586146191062, "num_env_steps_trained_throughput_per_sec": 339.9586146191062, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 12721.392, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12721.342, "sample_time_ms": 1916.285, "learn_time_ms": 10781.211, "learn_throughput": 371.016, "synch_weights_time_ms": 20.437}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "f1691_00000", "date": "2024-08-13_17-05-21", "timestamp": 1723583121, "time_this_iter_s": 11.864614725112915, "time_total_s": 1610.7885293960571, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dcec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1610.7885293960571, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 63.764705882352956, "ram_util_percent": 83.72352941176472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4279743914250975, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 1.0223630716087957, "policy_loss": 0.0008391329001083418, "vf_loss": 1.016475650620839, "vf_explained_var": 0.029113124003486028, "kl": 0.003939526178145981, "entropy": 0.01539724660875946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.321090902566707, "cur_kl_coeff": 2.4863311409717418e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.8975626051258394, "policy_loss": -1.969820667038519e-05, "vf_loss": 0.8975823033118138, "vf_explained_var": 9.054229373023623e-08, "kl": 7.902884390534082e-13, "entropy": 1.1824396345541416e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -595.0, "episode_reward_mean": -60.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -61.12, "predator_policy": 30.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -571.0, 13.0, 4.0, -13.0, 17.0, 17.0, -182.0, -3.0, -375.0, -1.0, -4.0, -17.0, -185.0, -8.0, -12.0, 15.0, -243.0, -29.0, 0.0, -169.0, 0.0, -1.0, 8.0, 0.0, 0.0, -5.0, -1.0, 11.0, -20.0, -192.0, -7.0, 21.0, -8.0, 0.0, -544.0, 15.0, -146.0, 10.0, 0.0, 0.0, -194.0, 11.0, 0.0, 2.0, 0.0, -595.0, -3.0, 11.0, -9.0, -8.0, 15.0, 1.0, -548.0, 0.0, -1.0, 0.0, -562.0, 0.0, -2.0, 0.0, 23.0, -167.0, -204.0, -8.0, -200.0, 1.0, 5.0, 0.0, 7.0, 0.0, -4.0, 0.0, -8.0, -185.0, -165.0, 1.0, -170.0, -4.0, -2.0, -6.0, -6.0, 4.0, 15.0, -10.0, 14.0, -167.0, 4.0, 0.0, 11.0, 2.0, -10.0, -168.0, 5.0, -16.0, 0.0, -5.0, -2.0, -180.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, -376.0, -400.0, 13.0, 0.0, 4.0, 0.0, -398.0, 0.0, 2.0, 15.0, 15.0, 2.0, 8.0, -383.0, -13.0, 0.0, -391.0, -362.0, -11.0, 0.0, 10.0, -32.0, 0.0, -37.0, -400.0, 15.0, -15.0, -6.0, -32.0, 0.0, 0.0, 15.0, -46.0, -394.0, -64.0, -4.0, 0.0, 0.0, -362.0, 12.0, 0.0, -362.0, -2.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, -10.0, 0.0, -3.0, -20.0, -20.0, 0.0, -384.0, -18.0, 0.0, 6.0, 15.0, 2.0, -20.0, 0.0, 0.0, -400.0, -344.0, 15.0, -352.0, -102.0, -98.0, 15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 8.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, -400.0, -400.0, -8.0, 1.0, 11.0, 0.0, -2.0, -14.0, -13.0, -10.0, 0.0, 15.0, -8.0, 0.0, -362.0, -379.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -362.0, -400.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 12.0, 9.0, -349.0, 0.0, -20.0, -391.0, -15.0, -6.0, -400.0, 0.0, 0.0, 1.0, 0.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, -386.0, 0.0, 0.0, 0.0, -16.0, -362.0, -8.0, -344.0, 0.0, 0.0, 1.0, -340.0, 0.0, 0.0, -14.0, -8.0, 0.0, -15.0, 0.0, -16.0, 0.0, 2.0, -5.0, 15.0, 0.0, -20.0, 0.0, 0.0, 14.0, -364.0, 15.0, 0.0, 4.0, 6.0, -12.0, 10.0, -9.0, 0.0, 2.0, 0.0, -20.0, -352.0, 8.0, 1.0, 4.0, -35.0, 0.0, 0.0, 0.0, 0.0, -15.0, -4.0, -4.0, -356.0, -4.0, 0.0, 0.0], "policy_predator_policy_reward": [4.0, 0.0, 200.0, 5.0, 0.0, 0.0, 0.0, 0.0, 199.0, 186.0, 0.0, 0.0, 0.0, 0.0, 11.0, 182.0, 10.0, 0.0, 197.0, 181.0, 10.0, 0.0, 8.0, 10.0, 10.0, 10.0, 200.0, 0.0, 0.0, 13.0, 10.0, 10.0, 0.0, 0.0, 197.0, 0.0, 29.0, 10.0, 0.0, 0.0, 0.0, 181.0, 181.0, 181.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 3.0, 7.0, 7.0, 10.0, 10.0, 10.0, 182.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 176.0, 176.0, 0.0, 54.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 195.0, 4.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 9.0, 0.0, 193.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 2.0, 0.0, 182.0, 0.0, 197.0, 10.0, 0.0, 13.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 193.0, 0.0, 0.0, 8.0, 0.0, 181.0, 4.0, 0.0, 179.0, 0.0, 0.0, 0.0, 170.0, 0.0, 10.0, 6.0, 0.0, 9.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 176.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 178.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.914268112939071, "mean_inference_ms": 2.36562885805678, "mean_action_processing_ms": 0.43596375601903903, "mean_env_wait_ms": 0.32179117505383403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008668303489685059, "StateBufferConnector_ms": 0.005034208297729492, "ViewRequirementAgentConnector_ms": 0.17678165435791016}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -595.0, "episode_return_mean": -60.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.8517516638552, "num_env_steps_trained_throughput_per_sec": 329.8517516638552, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 12713.349, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12713.295, "sample_time_ms": 1997.979, "learn_time_ms": 10691.752, "learn_throughput": 374.12, "synch_weights_time_ms": 19.882}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "f1691_00000", "date": "2024-08-13_17-05-33", "timestamp": 1723583133, "time_this_iter_s": 12.178186178207397, "time_total_s": 1622.9667155742645, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d678b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1622.9667155742645, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 63.57647058823529, "ram_util_percent": 83.59411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1031464318946873, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.1879207103340714, "policy_loss": 0.0022147113735733366, "vf_loss": 1.1793922504498846, "vf_explained_var": 0.010210072773474235, "kl": 0.009854107021730818, "entropy": 0.017267417130365392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.456598316213035, "cur_kl_coeff": 1.2431655704858709e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.3279097410263838, "policy_loss": -3.864289515173782e-05, "vf_loss": 1.3279483831433392, "vf_explained_var": -9.240296782639923e-09, "kl": 1.6728176198553158e-11, "entropy": 1.1277025667187377e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -595.0, "episode_reward_mean": -50.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.565, "predator_policy": 25.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 0.0, 0.0, -5.0, -1.0, 11.0, -20.0, -192.0, -7.0, 21.0, -8.0, 0.0, -544.0, 15.0, -146.0, 10.0, 0.0, 0.0, -194.0, 11.0, 0.0, 2.0, 0.0, -595.0, -3.0, 11.0, -9.0, -8.0, 15.0, 1.0, -548.0, 0.0, -1.0, 0.0, -562.0, 0.0, -2.0, 0.0, 23.0, -167.0, -204.0, -8.0, -200.0, 1.0, 5.0, 0.0, 7.0, 0.0, -4.0, 0.0, -8.0, -185.0, -165.0, 1.0, -170.0, -4.0, -2.0, -6.0, -6.0, 4.0, 15.0, -10.0, 14.0, -167.0, 4.0, 0.0, 11.0, 2.0, -10.0, -168.0, 5.0, -16.0, 0.0, -5.0, -2.0, -180.0, 0.0, -177.0, 1.0, 0.0, 4.0, 0.0, -179.0, -10.0, 30.0, 3.0, -190.0, 14.0, -5.0, -2.0, 0.0, 0.0, 0.0, 15.0, -4.0, -9.0, -186.0, 0.0, 5.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, -10.0, 0.0, -3.0, -20.0, -20.0, 0.0, -384.0, -18.0, 0.0, 6.0, 15.0, 2.0, -20.0, 0.0, 0.0, -400.0, -344.0, 15.0, -352.0, -102.0, -98.0, 15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 8.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, -400.0, -400.0, -8.0, 1.0, 11.0, 0.0, -2.0, -14.0, -13.0, -10.0, 0.0, 15.0, -8.0, 0.0, -362.0, -379.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -362.0, -400.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 12.0, 9.0, -349.0, 0.0, -20.0, -391.0, -15.0, -6.0, -400.0, 0.0, 0.0, 1.0, 0.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, -386.0, 0.0, 0.0, 0.0, -16.0, -362.0, -8.0, -344.0, 0.0, 0.0, 1.0, -340.0, 0.0, 0.0, -14.0, -8.0, 0.0, -15.0, 0.0, -16.0, 0.0, 2.0, -5.0, 15.0, 0.0, -20.0, 0.0, 0.0, 14.0, -364.0, 15.0, 0.0, 4.0, 6.0, -12.0, 10.0, -9.0, 0.0, 2.0, 0.0, -20.0, -352.0, 8.0, 1.0, 4.0, -35.0, 0.0, 0.0, 0.0, 0.0, -15.0, -4.0, -4.0, -356.0, -4.0, 0.0, 0.0, 0.0, -359.0, -4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -358.0, 0.0, -20.0, 15.0, 15.0, 0.0, -6.0, 0.0, -380.0, 0.0, 14.0, 0.0, -15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -18.0, 0.0, 14.0, -400.0, -400.0, 0.0, 0.0, 5.0, 15.0, 1.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 3.0, 7.0, 7.0, 10.0, 10.0, 10.0, 182.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 176.0, 176.0, 0.0, 54.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 195.0, 4.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 9.0, 0.0, 193.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 2.0, 0.0, 182.0, 0.0, 197.0, 10.0, 0.0, 13.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 193.0, 0.0, 0.0, 8.0, 0.0, 181.0, 4.0, 0.0, 179.0, 0.0, 0.0, 0.0, 170.0, 0.0, 10.0, 6.0, 0.0, 9.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 176.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 178.0, 2.0, 0.0, 0.0, 0.0, 182.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 9.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9144903196199113, "mean_inference_ms": 2.367894670751681, "mean_action_processing_ms": 0.4361222686660423, "mean_env_wait_ms": 0.3215911656243726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006556034088134766, "StateBufferConnector_ms": 0.007275700569152832, "ViewRequirementAgentConnector_ms": 0.1808934211730957}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -595.0, "episode_return_mean": -50.09, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.57247447385805, "num_env_steps_trained_throughput_per_sec": 317.57247447385805, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 12753.098, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12753.04, "sample_time_ms": 2088.536, "learn_time_ms": 10641.411, "learn_throughput": 375.89, "synch_weights_time_ms": 19.691}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "f1691_00000", "date": "2024-08-13_17-05-46", "timestamp": 1723583146, "time_this_iter_s": 12.64736008644104, "time_total_s": 1635.6140756607056, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dcef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1635.6140756607056, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 66.40555555555555, "ram_util_percent": 83.67222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5645940840756767, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 0.9113256521798946, "policy_loss": 0.0008034765185719287, "vf_loss": 0.9046452085492472, "vf_explained_var": 0.01205300181000321, "kl": 0.00917240634493791, "entropy": 0.03202091876114657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.363894910920699, "cur_kl_coeff": 6.2158278524293545e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.0391581430321648, "policy_loss": -0.00023133020537594953, "vf_loss": 1.039389475375887, "vf_explained_var": -7.97882281913959e-09, "kl": 1.965297832950152e-11, "entropy": 1.0839849125541186e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -595.0, "episode_reward_mean": -45.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.875, "predator_policy": 23.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.0, 11.0, 0.0, 2.0, 0.0, -595.0, -3.0, 11.0, -9.0, -8.0, 15.0, 1.0, -548.0, 0.0, -1.0, 0.0, -562.0, 0.0, -2.0, 0.0, 23.0, -167.0, -204.0, -8.0, -200.0, 1.0, 5.0, 0.0, 7.0, 0.0, -4.0, 0.0, -8.0, -185.0, -165.0, 1.0, -170.0, -4.0, -2.0, -6.0, -6.0, 4.0, 15.0, -10.0, 14.0, -167.0, 4.0, 0.0, 11.0, 2.0, -10.0, -168.0, 5.0, -16.0, 0.0, -5.0, -2.0, -180.0, 0.0, -177.0, 1.0, 0.0, 4.0, 0.0, -179.0, -10.0, 30.0, 3.0, -190.0, 14.0, -5.0, -2.0, 0.0, 0.0, 0.0, 15.0, -4.0, -9.0, -186.0, 0.0, 5.0, 16.0, 4.0, -6.0, 22.0, 0.0, 4.0, -6.0, -195.0, -168.0, -13.0, 16.0, 9.0, -27.0, -8.0, 0.0, 0.0, 6.0, 0.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -388.0, 0.0, 8.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, -400.0, -400.0, -8.0, 1.0, 11.0, 0.0, -2.0, -14.0, -13.0, -10.0, 0.0, 15.0, -8.0, 0.0, -362.0, -379.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -362.0, -400.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 12.0, 9.0, -349.0, 0.0, -20.0, -391.0, -15.0, -6.0, -400.0, 0.0, 0.0, 1.0, 0.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, -386.0, 0.0, 0.0, 0.0, -16.0, -362.0, -8.0, -344.0, 0.0, 0.0, 1.0, -340.0, 0.0, 0.0, -14.0, -8.0, 0.0, -15.0, 0.0, -16.0, 0.0, 2.0, -5.0, 15.0, 0.0, -20.0, 0.0, 0.0, 14.0, -364.0, 15.0, 0.0, 4.0, 6.0, -12.0, 10.0, -9.0, 0.0, 2.0, 0.0, -20.0, -352.0, 8.0, 1.0, 4.0, -35.0, 0.0, 0.0, 0.0, 0.0, -15.0, -4.0, -4.0, -356.0, -4.0, 0.0, 0.0, 0.0, -359.0, -4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -358.0, 0.0, -20.0, 15.0, 15.0, 0.0, -6.0, 0.0, -380.0, 0.0, 14.0, 0.0, -15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -18.0, 0.0, 14.0, -400.0, -400.0, 0.0, 0.0, 5.0, 15.0, 1.0, 4.0, 0.0, 2.0, -16.0, 15.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, -12.0, 0.0, -390.0, -358.0, 11.0, -20.0, -6.0, 5.0, 11.0, 15.0, -12.0, 0.0, -54.0, 0.0, -17.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0], "policy_predator_policy_reward": [194.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 195.0, 4.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 9.0, 0.0, 193.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 2.0, 0.0, 182.0, 0.0, 197.0, 10.0, 0.0, 13.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 193.0, 0.0, 0.0, 8.0, 0.0, 181.0, 4.0, 0.0, 179.0, 0.0, 0.0, 0.0, 170.0, 0.0, 10.0, 6.0, 0.0, 9.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 176.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 178.0, 2.0, 0.0, 0.0, 0.0, 182.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 9.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 195.0, 0.0, 179.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9150362362508833, "mean_inference_ms": 2.365978732555815, "mean_action_processing_ms": 0.43498936423936485, "mean_env_wait_ms": 0.3216025394225835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005764007568359375, "StateBufferConnector_ms": 0.005939841270446777, "ViewRequirementAgentConnector_ms": 0.16204142570495605}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -595.0, "episode_return_mean": -45.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.4838637035877, "num_env_steps_trained_throughput_per_sec": 336.4838637035877, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 12533.109, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12533.051, "sample_time_ms": 2002.403, "learn_time_ms": 10507.64, "learn_throughput": 380.675, "synch_weights_time_ms": 19.586}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "f1691_00000", "date": "2024-08-13_17-05-58", "timestamp": 1723583158, "time_this_iter_s": 11.938143968582153, "time_total_s": 1647.5522196292877, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c6a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1647.5522196292877, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 67.39411764705882, "ram_util_percent": 83.5764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.423432715962488, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 2.188971648203633, "policy_loss": 0.0005675132943208886, "vf_loss": 2.1785828475598934, "vf_explained_var": 0.042729154087248304, "kl": 0.015328453526392052, "entropy": 0.026818704622731337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0219634783716636, "cur_kl_coeff": 3.1079139262146772e-12, "cur_lr": 0.009999999999999998, "total_loss": 2.4143784042388674, "policy_loss": -0.0002697025303773227, "vf_loss": 2.4146481087598852, "vf_explained_var": -4.698990514038732e-09, "kl": 1.2997116297512815e-11, "entropy": 1.0468710595403316e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -204.0, "episode_reward_mean": -39.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -46.175, "predator_policy": 26.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.0, -8.0, -200.0, 1.0, 5.0, 0.0, 7.0, 0.0, -4.0, 0.0, -8.0, -185.0, -165.0, 1.0, -170.0, -4.0, -2.0, -6.0, -6.0, 4.0, 15.0, -10.0, 14.0, -167.0, 4.0, 0.0, 11.0, 2.0, -10.0, -168.0, 5.0, -16.0, 0.0, -5.0, -2.0, -180.0, 0.0, -177.0, 1.0, 0.0, 4.0, 0.0, -179.0, -10.0, 30.0, 3.0, -190.0, 14.0, -5.0, -2.0, 0.0, 0.0, 0.0, 15.0, -4.0, -9.0, -186.0, 0.0, 5.0, 16.0, 4.0, -6.0, 22.0, 0.0, 4.0, -6.0, -195.0, -168.0, -13.0, 16.0, 9.0, -27.0, -8.0, 0.0, 0.0, 6.0, 0.0, 6.0, 18.0, -192.0, 0.0, 15.0, -8.0, -185.0, 27.0, 0.0, -185.0, -20.0, -5.0, -5.0, -193.0, 5.0, 0.0, 10.0, -182.0, 4.0, -198.0, -182.0, -1.0, -202.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -391.0, -15.0, -6.0, -400.0, 0.0, 0.0, 1.0, 0.0, 5.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, -386.0, 0.0, 0.0, 0.0, -16.0, -362.0, -8.0, -344.0, 0.0, 0.0, 1.0, -340.0, 0.0, 0.0, -14.0, -8.0, 0.0, -15.0, 0.0, -16.0, 0.0, 2.0, -5.0, 15.0, 0.0, -20.0, 0.0, 0.0, 14.0, -364.0, 15.0, 0.0, 4.0, 6.0, -12.0, 10.0, -9.0, 0.0, 2.0, 0.0, -20.0, -352.0, 8.0, 1.0, 4.0, -35.0, 0.0, 0.0, 0.0, 0.0, -15.0, -4.0, -4.0, -356.0, -4.0, 0.0, 0.0, 0.0, -359.0, -4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -358.0, 0.0, -20.0, 15.0, 15.0, 0.0, -6.0, 0.0, -380.0, 0.0, 14.0, 0.0, -15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -18.0, 0.0, 14.0, -400.0, -400.0, 0.0, 0.0, 5.0, 15.0, 1.0, 4.0, 0.0, 2.0, -16.0, 15.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, -12.0, 0.0, -390.0, -358.0, 11.0, -20.0, -6.0, 5.0, 11.0, 15.0, -12.0, 0.0, -54.0, 0.0, -17.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 11.0, -384.0, 0.0, 0.0, 0.0, 15.0, 0.0, -18.0, 0.0, 15.0, -400.0, 9.0, 15.0, 0.0, 0.0, -370.0, 0.0, -20.0, -20.0, -15.0, -1.0, 0.0, -15.0, -386.0, 0.0, 15.0, -20.0, 0.0, 0.0, 1.0, 9.0, -373.0, 0.0, 4.0, 0.0, -18.0, -380.0, 15.0, -394.0, 0.0, -11.0, -391.0, -13.0], "policy_predator_policy_reward": [197.0, 10.0, 0.0, 13.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 193.0, 0.0, 0.0, 8.0, 0.0, 181.0, 4.0, 0.0, 179.0, 0.0, 0.0, 0.0, 170.0, 0.0, 10.0, 6.0, 0.0, 9.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 176.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 178.0, 2.0, 0.0, 0.0, 0.0, 182.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 9.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 195.0, 0.0, 179.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 20.0, 0.0, 11.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 190.0, 10.0, 188.0, 9.0, 10.0, 0.0, 194.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9154120901436851, "mean_inference_ms": 2.3658583318217556, "mean_action_processing_ms": 0.4343693858537509, "mean_env_wait_ms": 0.32149086594650755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045087337493896484, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1709883213043213}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -204.0, "episode_return_mean": -39.6, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.6650003237137, "num_env_steps_trained_throughput_per_sec": 331.6650003237137, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 12244.216, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12244.158, "sample_time_ms": 1881.104, "learn_time_ms": 10344.471, "learn_throughput": 386.68, "synch_weights_time_ms": 15.748}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "f1691_00000", "date": "2024-08-13_17-06-10", "timestamp": 1723583170, "time_this_iter_s": 12.096083879470825, "time_total_s": 1659.6483035087585, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d6bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1659.6483035087585, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 67.41764705882352, "ram_util_percent": 83.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0364880187486216, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.576261528995302, "policy_loss": 0.001384290207975677, "vf_loss": 1.569149291168445, "vf_explained_var": 0.06696281231269635, "kl": 0.008939820744119056, "entropy": 0.008515026862178707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.088538503144848, "cur_kl_coeff": 1.5539569631073386e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.7606597889668096, "policy_loss": 1.6613031870552472e-06, "vf_loss": 1.7606581286778527, "vf_explained_var": -1.1353265671502976e-08, "kl": 1.0689008196906567e-12, "entropy": 1.0151124355439803e-08, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -570.0, "episode_reward_mean": -42.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.875, "predator_policy": 24.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 4.0, 15.0, -10.0, 14.0, -167.0, 4.0, 0.0, 11.0, 2.0, -10.0, -168.0, 5.0, -16.0, 0.0, -5.0, -2.0, -180.0, 0.0, -177.0, 1.0, 0.0, 4.0, 0.0, -179.0, -10.0, 30.0, 3.0, -190.0, 14.0, -5.0, -2.0, 0.0, 0.0, 0.0, 15.0, -4.0, -9.0, -186.0, 0.0, 5.0, 16.0, 4.0, -6.0, 22.0, 0.0, 4.0, -6.0, -195.0, -168.0, -13.0, 16.0, 9.0, -27.0, -8.0, 0.0, 0.0, 6.0, 0.0, 6.0, 18.0, -192.0, 0.0, 15.0, -8.0, -185.0, 27.0, 0.0, -185.0, -20.0, -5.0, -5.0, -193.0, 5.0, 0.0, 10.0, -182.0, 4.0, -198.0, -182.0, -1.0, -202.0, 0.0, 0.0, 0.0, -200.0, -181.0, -3.0, 0.0, 4.0, 14.0, 7.0, -181.0, 15.0, -570.0, -169.0, 0.0, 11.0, 0.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, 0.0, 2.0, -5.0, 15.0, 0.0, -20.0, 0.0, 0.0, 14.0, -364.0, 15.0, 0.0, 4.0, 6.0, -12.0, 10.0, -9.0, 0.0, 2.0, 0.0, -20.0, -352.0, 8.0, 1.0, 4.0, -35.0, 0.0, 0.0, 0.0, 0.0, -15.0, -4.0, -4.0, -356.0, -4.0, 0.0, 0.0, 0.0, -359.0, -4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -358.0, 0.0, -20.0, 15.0, 15.0, 0.0, -6.0, 0.0, -380.0, 0.0, 14.0, 0.0, -15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -18.0, 0.0, 14.0, -400.0, -400.0, 0.0, 0.0, 5.0, 15.0, 1.0, 4.0, 0.0, 2.0, -16.0, 15.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, -12.0, 0.0, -390.0, -358.0, 11.0, -20.0, -6.0, 5.0, 11.0, 15.0, -12.0, 0.0, -54.0, 0.0, -17.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 11.0, -384.0, 0.0, 0.0, 0.0, 15.0, 0.0, -18.0, 0.0, 15.0, -400.0, 9.0, 15.0, 0.0, 0.0, -370.0, 0.0, -20.0, -20.0, -15.0, -1.0, 0.0, -15.0, -386.0, 0.0, 15.0, -20.0, 0.0, 0.0, 1.0, 9.0, -373.0, 0.0, 4.0, 0.0, -18.0, -380.0, 15.0, -394.0, 0.0, -11.0, -391.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -362.0, 0.0, 0.0, -8.0, -20.0, 2.0, 4.0, 0.0, -2.0, 15.0, -4.0, 5.0, 5.0, -372.0, 15.0, 0.0, -400.0, -374.0, -351.0, 0.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, -20.0, 5.0], "policy_predator_policy_reward": [0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 176.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 178.0, 2.0, 0.0, 0.0, 0.0, 182.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 9.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 195.0, 0.0, 179.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 20.0, 0.0, 11.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 190.0, 10.0, 188.0, 9.0, 10.0, 0.0, 194.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 181.0, 0.0, 5.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 1.0, 2.0, 4.0, 9.0, 177.0, 0.0, 0.0, 4.0, 200.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9154364578589971, "mean_inference_ms": 2.36520550883733, "mean_action_processing_ms": 0.4338021835554139, "mean_env_wait_ms": 0.32132230423708924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005147218704223633, "StateBufferConnector_ms": 0.008883833885192871, "ViewRequirementAgentConnector_ms": 0.1750270128250122}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -570.0, "episode_return_mean": -42.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.22152666786496, "num_env_steps_trained_throughput_per_sec": 332.22152666786496, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 12222.297, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12222.239, "sample_time_ms": 1873.141, "learn_time_ms": 10332.813, "learn_throughput": 387.116, "synch_weights_time_ms": 13.359}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "f1691_00000", "date": "2024-08-13_17-06-22", "timestamp": 1723583182, "time_this_iter_s": 12.100725173950195, "time_total_s": 1671.7490286827087, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d6b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1671.7490286827087, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 67.6470588235294, "ram_util_percent": 83.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0543961027154216, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.0165781274043695, "policy_loss": -0.000134734755687455, "vf_loss": 1.0140323780516467, "vf_explained_var": 0.03740237973354481, "kl": 0.004183536497421193, "entropy": 0.00634713256179773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.264995895434915, "cur_kl_coeff": 7.769784815536693e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.1360193387422928, "policy_loss": -0.00025213197484691305, "vf_loss": 1.1362714718810465, "vf_explained_var": -7.694991177352017e-09, "kl": 1.1173375364277886e-11, "entropy": 9.851247508276241e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -570.0, "episode_reward_mean": -47.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -48.23, "predator_policy": 24.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -177.0, 1.0, 0.0, 4.0, 0.0, -179.0, -10.0, 30.0, 3.0, -190.0, 14.0, -5.0, -2.0, 0.0, 0.0, 0.0, 15.0, -4.0, -9.0, -186.0, 0.0, 5.0, 16.0, 4.0, -6.0, 22.0, 0.0, 4.0, -6.0, -195.0, -168.0, -13.0, 16.0, 9.0, -27.0, -8.0, 0.0, 0.0, 6.0, 0.0, 6.0, 18.0, -192.0, 0.0, 15.0, -8.0, -185.0, 27.0, 0.0, -185.0, -20.0, -5.0, -5.0, -193.0, 5.0, 0.0, 10.0, -182.0, 4.0, -198.0, -182.0, -1.0, -202.0, 0.0, 0.0, 0.0, -200.0, -181.0, -3.0, 0.0, 4.0, 14.0, 7.0, -181.0, 15.0, -570.0, -169.0, 0.0, 11.0, 0.0, -5.0, 11.0, -8.0, -568.0, 7.0, 8.0, -10.0, -10.0, -19.0, 0.0, 0.0, -176.0, 0.0, 0.0, 0.0, 1.0, 3.0, -195.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -359.0, -4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -358.0, 0.0, -20.0, 15.0, 15.0, 0.0, -6.0, 0.0, -380.0, 0.0, 14.0, 0.0, -15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -18.0, 0.0, 14.0, -400.0, -400.0, 0.0, 0.0, 5.0, 15.0, 1.0, 4.0, 0.0, 2.0, -16.0, 15.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, -12.0, 0.0, -390.0, -358.0, 11.0, -20.0, -6.0, 5.0, 11.0, 15.0, -12.0, 0.0, -54.0, 0.0, -17.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 11.0, -384.0, 0.0, 0.0, 0.0, 15.0, 0.0, -18.0, 0.0, 15.0, -400.0, 9.0, 15.0, 0.0, 0.0, -370.0, 0.0, -20.0, -20.0, -15.0, -1.0, 0.0, -15.0, -386.0, 0.0, 15.0, -20.0, 0.0, 0.0, 1.0, 9.0, -373.0, 0.0, 4.0, 0.0, -18.0, -380.0, 15.0, -394.0, 0.0, -11.0, -391.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -362.0, 0.0, 0.0, -8.0, -20.0, 2.0, 4.0, 0.0, -2.0, 15.0, -4.0, 5.0, 5.0, -372.0, 15.0, 0.0, -400.0, -374.0, -351.0, 0.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, -20.0, 5.0, 0.0, 11.0, -16.0, 0.0, -396.0, -380.0, 7.0, 0.0, 0.0, 8.0, 0.0, -20.0, -20.0, 0.0, -24.0, -14.0, 0.0, 0.0, 0.0, 0.0, -374.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, -390.0, 0.0, -12.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 182.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 9.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 195.0, 0.0, 179.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 20.0, 0.0, 11.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 190.0, 10.0, 188.0, 9.0, 10.0, 0.0, 194.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 181.0, 0.0, 5.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 1.0, 2.0, 4.0, 9.0, 177.0, 0.0, 0.0, 4.0, 200.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 10.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 2.0, 17.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 195.0, 0.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9150194713296552, "mean_inference_ms": 2.3628290781842645, "mean_action_processing_ms": 0.4329885157562427, "mean_env_wait_ms": 0.3209432119651907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004954814910888672, "StateBufferConnector_ms": 0.008376598358154297, "ViewRequirementAgentConnector_ms": 0.14530694484710693}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -570.0, "episode_return_mean": -47.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.87104442911607, "num_env_steps_trained_throughput_per_sec": 330.87104442911607, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 12163.584, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12163.524, "sample_time_ms": 1753.683, "learn_time_ms": 10394.073, "learn_throughput": 384.835, "synch_weights_time_ms": 13.103}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "f1691_00000", "date": "2024-08-13_17-06-34", "timestamp": 1723583194, "time_this_iter_s": 12.15048599243164, "time_total_s": 1683.8995146751404, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dced30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1683.8995146751404, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 65.83529411764707, "ram_util_percent": 83.50588235294119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.175813017891986, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 0.009999999999999998, "total_loss": 1.537102672978053, "policy_loss": 0.0004103764221466408, "vf_loss": 1.5327471680111355, "vf_explained_var": 0.047192669513995054, "kl": 0.012314613792495491, "entropy": 0.009732923834567414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1412623996838986, "cur_kl_coeff": 3.8848924077683466e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.6033027282467596, "policy_loss": 6.164047219076011e-05, "vf_loss": 1.6032410922504607, "vf_explained_var": -8.641096649977265e-09, "kl": 3.2233747181071336e-12, "entropy": 9.590582064901513e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -570.0, "episode_reward_mean": -50.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -49.2, "predator_policy": 24.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 4.0, -6.0, 22.0, 0.0, 4.0, -6.0, -195.0, -168.0, -13.0, 16.0, 9.0, -27.0, -8.0, 0.0, 0.0, 6.0, 0.0, 6.0, 18.0, -192.0, 0.0, 15.0, -8.0, -185.0, 27.0, 0.0, -185.0, -20.0, -5.0, -5.0, -193.0, 5.0, 0.0, 10.0, -182.0, 4.0, -198.0, -182.0, -1.0, -202.0, 0.0, 0.0, 0.0, -200.0, -181.0, -3.0, 0.0, 4.0, 14.0, 7.0, -181.0, 15.0, -570.0, -169.0, 0.0, 11.0, 0.0, -5.0, 11.0, -8.0, -568.0, 7.0, 8.0, -10.0, -10.0, -19.0, 0.0, 0.0, -176.0, 0.0, 0.0, 0.0, 1.0, 3.0, -195.0, -6.0, 5.0, 0.0, -4.0, 10.0, -363.0, -11.0, 0.0, -180.0, -80.0, -4.0, 11.0, -9.0, 9.0, -185.0, 15.0, 3.0, -4.0, 0.0, 0.0, -189.0, -6.0, -9.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 1.0, 4.0, 0.0, 2.0, -16.0, 15.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, -12.0, 0.0, -390.0, -358.0, 11.0, -20.0, -6.0, 5.0, 11.0, 15.0, -12.0, 0.0, -54.0, 0.0, -17.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 11.0, -384.0, 0.0, 0.0, 0.0, 15.0, 0.0, -18.0, 0.0, 15.0, -400.0, 9.0, 15.0, 0.0, 0.0, -370.0, 0.0, -20.0, -20.0, -15.0, -1.0, 0.0, -15.0, -386.0, 0.0, 15.0, -20.0, 0.0, 0.0, 1.0, 9.0, -373.0, 0.0, 4.0, 0.0, -18.0, -380.0, 15.0, -394.0, 0.0, -11.0, -391.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -362.0, 0.0, 0.0, -8.0, -20.0, 2.0, 4.0, 0.0, -2.0, 15.0, -4.0, 5.0, 5.0, -372.0, 15.0, 0.0, -400.0, -374.0, -351.0, 0.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, -20.0, 5.0, 0.0, 11.0, -16.0, 0.0, -396.0, -380.0, 7.0, 0.0, 0.0, 8.0, 0.0, -20.0, -20.0, 0.0, -24.0, -14.0, 0.0, 0.0, 0.0, 0.0, -374.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, -390.0, 0.0, -12.0, 0.0, -4.0, 7.0, 0.0, 0.0, -14.0, 3.0, 0.0, 10.0, -370.0, -367.0, -28.0, 0.0, 0.0, 0.0, -360.0, 0.0, -172.0, 0.0, 0.0, -8.0, 11.0, 0.0, 0.0, -18.0, 0.0, 3.0, -370.0, 0.0, 15.0, 0.0, 3.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -388.0, 0.0, -16.0, -18.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 195.0, 0.0, 179.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 20.0, 0.0, 11.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 190.0, 10.0, 188.0, 9.0, 10.0, 0.0, 194.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 181.0, 0.0, 5.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 1.0, 2.0, 4.0, 9.0, 177.0, 0.0, 0.0, 4.0, 200.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 10.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 2.0, 17.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 195.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 189.0, 185.0, 10.0, 7.0, 0.0, 0.0, 0.0, 180.0, 92.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 191.0, 2.0, 8.0, 9.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9136206273243366, "mean_inference_ms": 2.3586922636601373, "mean_action_processing_ms": 0.4317242618689552, "mean_env_wait_ms": 0.32034312930329506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005766153335571289, "StateBufferConnector_ms": 0.006153225898742676, "ViewRequirementAgentConnector_ms": 0.13730430603027344}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -570.0, "episode_return_mean": -50.3, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9769293243258, "num_env_steps_trained_throughput_per_sec": 307.9769293243258, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 12185.554, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12185.494, "sample_time_ms": 1708.876, "learn_time_ms": 10460.48, "learn_throughput": 382.392, "synch_weights_time_ms": 13.33}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "f1691_00000", "date": "2024-08-13_17-06-47", "timestamp": 1723583207, "time_this_iter_s": 13.03755784034729, "time_total_s": 1696.9370725154877, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d6bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1696.9370725154877, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 72.19999999999999, "ram_util_percent": 83.82222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6310744187149107, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 0.009999999999999998, "total_loss": 0.5048911410034018, "policy_loss": 0.00015254462724206624, "vf_loss": 0.5046145825011153, "vf_explained_var": 0.028612261632132152, "kl": 0.00038711359592857533, "entropy": 0.0013686795523003086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6474197921251985, "cur_kl_coeff": 1.9424462038841733e-13, "cur_lr": 0.009999999999999998, "total_loss": 0.623215228633551, "policy_loss": 0.0003405461114924894, "vf_loss": 0.6228746809415974, "vf_explained_var": 1.8541711978811435e-05, "kl": -1.076241601822256e-11, "entropy": 9.649096843814442e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -570.0, "episode_reward_mean": -50.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -49.22, "predator_policy": 24.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -8.0, -185.0, 27.0, 0.0, -185.0, -20.0, -5.0, -5.0, -193.0, 5.0, 0.0, 10.0, -182.0, 4.0, -198.0, -182.0, -1.0, -202.0, 0.0, 0.0, 0.0, -200.0, -181.0, -3.0, 0.0, 4.0, 14.0, 7.0, -181.0, 15.0, -570.0, -169.0, 0.0, 11.0, 0.0, -5.0, 11.0, -8.0, -568.0, 7.0, 8.0, -10.0, -10.0, -19.0, 0.0, 0.0, -176.0, 0.0, 0.0, 0.0, 1.0, 3.0, -195.0, -6.0, 5.0, 0.0, -4.0, 10.0, -363.0, -11.0, 0.0, -180.0, -80.0, -4.0, 11.0, -9.0, 9.0, -185.0, 15.0, 3.0, -4.0, 0.0, 0.0, -189.0, -6.0, -9.0, 0.0, -174.0, -10.0, 15.0, -180.0, -3.0, 0.0, -7.0, 0.0, 4.0, 14.0, 15.0, -10.0, 0.0, 29.0, -10.0, -180.0, -15.0, 15.0, 0.0, 13.0, -14.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, -18.0, 0.0, 15.0, -400.0, 9.0, 15.0, 0.0, 0.0, -370.0, 0.0, -20.0, -20.0, -15.0, -1.0, 0.0, -15.0, -386.0, 0.0, 15.0, -20.0, 0.0, 0.0, 1.0, 9.0, -373.0, 0.0, 4.0, 0.0, -18.0, -380.0, 15.0, -394.0, 0.0, -11.0, -391.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -362.0, 0.0, 0.0, -8.0, -20.0, 2.0, 4.0, 0.0, -2.0, 15.0, -4.0, 5.0, 5.0, -372.0, 15.0, 0.0, -400.0, -374.0, -351.0, 0.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, -20.0, 5.0, 0.0, 11.0, -16.0, 0.0, -396.0, -380.0, 7.0, 0.0, 0.0, 8.0, 0.0, -20.0, -20.0, 0.0, -24.0, -14.0, 0.0, 0.0, 0.0, 0.0, -374.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, -390.0, 0.0, -12.0, 0.0, -4.0, 7.0, 0.0, 0.0, -14.0, 3.0, 0.0, 10.0, -370.0, -367.0, -28.0, 0.0, 0.0, 0.0, -360.0, 0.0, -172.0, 0.0, 0.0, -8.0, 11.0, 0.0, 0.0, -18.0, 0.0, 3.0, -370.0, 0.0, 15.0, 0.0, 3.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -388.0, 0.0, -16.0, -18.0, 0.0, 0.0, 0.0, 0.0, -361.0, -20.0, 0.0, 15.0, 0.0, 0.0, -369.0, 0.0, -13.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, -11.0, 15.0, 0.0, -28.0, -3.0, 0.0, 0.0, 14.0, 15.0, -20.0, 0.0, -360.0, 0.0, -10.0, -20.0, 15.0, 0.0, 0.0, 0.0, 11.0, 2.0, -10.0, -16.0, 4.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 20.0, 0.0, 11.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 190.0, 10.0, 188.0, 9.0, 10.0, 0.0, 194.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 181.0, 0.0, 5.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 1.0, 2.0, 4.0, 9.0, 177.0, 0.0, 0.0, 4.0, 200.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 10.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 2.0, 17.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 195.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 189.0, 185.0, 10.0, 7.0, 0.0, 0.0, 0.0, 180.0, 92.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 191.0, 2.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 180.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.91237638737798, "mean_inference_ms": 2.355749329729879, "mean_action_processing_ms": 0.43050543002896147, "mean_env_wait_ms": 0.31974609138530125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057953596115112305, "StateBufferConnector_ms": 0.006155490875244141, "ViewRequirementAgentConnector_ms": 0.12614130973815918}, "num_episodes": 22, "episode_return_max": 29.0, "episode_return_min": -570.0, "episode_return_mean": -50.1, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.80809964609534, "num_env_steps_trained_throughput_per_sec": 329.80809964609534, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 12195.37, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12195.309, "sample_time_ms": 1697.008, "learn_time_ms": 10481.523, "learn_throughput": 381.624, "synch_weights_time_ms": 13.433}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "f1691_00000", "date": "2024-08-13_17-07-00", "timestamp": 1723583220, "time_this_iter_s": 12.189894914627075, "time_total_s": 1709.1269674301147, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c74d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1709.1269674301147, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 66.65, "ram_util_percent": 83.33888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.540734837026823, "cur_kl_coeff": 0.16018066406250003, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00019123578867899678, "vf_loss": 0.5643364043186897, "vf_explained_var": -0.00017451886777524595, "kl": Infinity, "entropy": 0.004081600514397929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.370331141724197, "cur_kl_coeff": 9.712231019420866e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.6594933387562238, "policy_loss": 0.0001666658003592775, "vf_loss": 0.6593266730940847, "vf_explained_var": 5.235116948526372e-09, "kl": 9.291006550141954e-12, "entropy": 9.65608530230359e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -570.0, "episode_reward_mean": -40.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.7, "predator_policy": 19.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.0, 0.0, 0.0, 0.0, -200.0, -181.0, -3.0, 0.0, 4.0, 14.0, 7.0, -181.0, 15.0, -570.0, -169.0, 0.0, 11.0, 0.0, -5.0, 11.0, -8.0, -568.0, 7.0, 8.0, -10.0, -10.0, -19.0, 0.0, 0.0, -176.0, 0.0, 0.0, 0.0, 1.0, 3.0, -195.0, -6.0, 5.0, 0.0, -4.0, 10.0, -363.0, -11.0, 0.0, -180.0, -80.0, -4.0, 11.0, -9.0, 9.0, -185.0, 15.0, 3.0, -4.0, 0.0, 0.0, -189.0, -6.0, -9.0, 0.0, -174.0, -10.0, 15.0, -180.0, -3.0, 0.0, -7.0, 0.0, 4.0, 14.0, 15.0, -10.0, 0.0, 29.0, -10.0, -180.0, -15.0, 15.0, 0.0, 13.0, -14.0, 4.0, 1.0, -192.0, 0.0, 0.0, 30.0, -10.0, 1.0, 7.0, 3.0, 8.0, 10.0, -10.0, -2.0, -6.0, 0.0, -7.0, -10.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-391.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -362.0, 0.0, 0.0, -8.0, -20.0, 2.0, 4.0, 0.0, -2.0, 15.0, -4.0, 5.0, 5.0, -372.0, 15.0, 0.0, -400.0, -374.0, -351.0, 0.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, -20.0, 5.0, 0.0, 11.0, -16.0, 0.0, -396.0, -380.0, 7.0, 0.0, 0.0, 8.0, 0.0, -20.0, -20.0, 0.0, -24.0, -14.0, 0.0, 0.0, 0.0, 0.0, -374.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, -390.0, 0.0, -12.0, 0.0, -4.0, 7.0, 0.0, 0.0, -14.0, 3.0, 0.0, 10.0, -370.0, -367.0, -28.0, 0.0, 0.0, 0.0, -360.0, 0.0, -172.0, 0.0, 0.0, -8.0, 11.0, 0.0, 0.0, -18.0, 0.0, 3.0, -370.0, 0.0, 15.0, 0.0, 3.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -388.0, 0.0, -16.0, -18.0, 0.0, 0.0, 0.0, 0.0, -361.0, -20.0, 0.0, 15.0, 0.0, 0.0, -369.0, 0.0, -13.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, -11.0, 15.0, 0.0, -28.0, -3.0, 0.0, 0.0, 14.0, 15.0, -20.0, 0.0, -360.0, 0.0, -10.0, -20.0, 15.0, 0.0, 0.0, 0.0, 11.0, 2.0, -10.0, -16.0, 4.0, 0.0, 0.0, 1.0, -364.0, -20.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, -19.0, -2.0, -12.0, 2.0, 7.0, 0.0, 3.0, 0.0, 8.0, 0.0, -4.0, 12.0, 0.0, -20.0, 0.0, -8.0, 0.0, -12.0, 0.0, 0.0, 0.0, -17.0, 0.0, -20.0, 0.0, -4.0], "policy_predator_policy_reward": [194.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 181.0, 0.0, 5.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 1.0, 2.0, 4.0, 9.0, 177.0, 0.0, 0.0, 4.0, 200.0, 0.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 10.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 2.0, 17.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 195.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 189.0, 185.0, 10.0, 7.0, 0.0, 0.0, 0.0, 180.0, 92.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 191.0, 2.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 180.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9111668219455537, "mean_inference_ms": 2.3512033240568835, "mean_action_processing_ms": 0.42962942518124947, "mean_env_wait_ms": 0.3193058571024789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005785822868347168, "StateBufferConnector_ms": 0.003355741500854492, "ViewRequirementAgentConnector_ms": 0.12541568279266357}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -570.0, "episode_return_mean": -40.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.4602505726261, "num_env_steps_trained_throughput_per_sec": 337.4602505726261, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 12153.544, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12153.484, "sample_time_ms": 1689.818, "learn_time_ms": 10447.712, "learn_throughput": 382.859, "synch_weights_time_ms": 12.668}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "f1691_00000", "date": "2024-08-13_17-07-12", "timestamp": 1723583232, "time_this_iter_s": 11.928799390792847, "time_total_s": 1721.0557668209076, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c74f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1721.0557668209076, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 68.25294117647059, "ram_util_percent": 83.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1554629195343566, "cur_kl_coeff": 0.24027099609374994, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 6.539595569607126e-05, "vf_loss": 0.3297619643276212, "vf_explained_var": 0.08811406723405948, "kl": Infinity, "entropy": 0.00020697024461537885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.239166459027079, "cur_kl_coeff": 4.856115509710433e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.4473009222408845, "policy_loss": 2.9046185777852775e-06, "vf_loss": 0.4472980200862617, "vf_explained_var": 3.9027260724829616e-05, "kl": 4.004830656425915e-12, "entropy": 9.69091707339829e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -568.0, "episode_reward_mean": -27.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.76, "predator_policy": 14.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 11.0, -8.0, -568.0, 7.0, 8.0, -10.0, -10.0, -19.0, 0.0, 0.0, -176.0, 0.0, 0.0, 0.0, 1.0, 3.0, -195.0, -6.0, 5.0, 0.0, -4.0, 10.0, -363.0, -11.0, 0.0, -180.0, -80.0, -4.0, 11.0, -9.0, 9.0, -185.0, 15.0, 3.0, -4.0, 0.0, 0.0, -189.0, -6.0, -9.0, 0.0, -174.0, -10.0, 15.0, -180.0, -3.0, 0.0, -7.0, 0.0, 4.0, 14.0, 15.0, -10.0, 0.0, 29.0, -10.0, -180.0, -15.0, 15.0, 0.0, 13.0, -14.0, 4.0, 1.0, -192.0, 0.0, 0.0, 30.0, -10.0, 1.0, 7.0, 3.0, 8.0, 10.0, -10.0, -2.0, -6.0, 0.0, -7.0, -10.0, 3.0, -7.0, 8.0, -6.0, 0.0, 15.0, 15.0, 3.0, -6.0, 0.0, 0.0, 0.0, 9.0, -4.0, 5.0, 5.0, -7.0, -200.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, 5.0, 0.0, 11.0, -16.0, 0.0, -396.0, -380.0, 7.0, 0.0, 0.0, 8.0, 0.0, -20.0, -20.0, 0.0, -24.0, -14.0, 0.0, 0.0, 0.0, 0.0, -374.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, -390.0, 0.0, -12.0, 0.0, -4.0, 7.0, 0.0, 0.0, -14.0, 3.0, 0.0, 10.0, -370.0, -367.0, -28.0, 0.0, 0.0, 0.0, -360.0, 0.0, -172.0, 0.0, 0.0, -8.0, 11.0, 0.0, 0.0, -18.0, 0.0, 3.0, -370.0, 0.0, 15.0, 0.0, 3.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -388.0, 0.0, -16.0, -18.0, 0.0, 0.0, 0.0, 0.0, -361.0, -20.0, 0.0, 15.0, 0.0, 0.0, -369.0, 0.0, -13.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, -11.0, 15.0, 0.0, -28.0, -3.0, 0.0, 0.0, 14.0, 15.0, -20.0, 0.0, -360.0, 0.0, -10.0, -20.0, 15.0, 0.0, 0.0, 0.0, 11.0, 2.0, -10.0, -16.0, 4.0, 0.0, 0.0, 1.0, -364.0, -20.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, -19.0, -2.0, -12.0, 2.0, 7.0, 0.0, 3.0, 0.0, 8.0, 0.0, -4.0, 12.0, 0.0, -20.0, 0.0, -8.0, 0.0, -12.0, 0.0, 0.0, 0.0, -17.0, 0.0, -20.0, 0.0, -4.0, 0.0, -17.0, 0.0, 8.0, 0.0, -12.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, -20.0, 13.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -11.0, -20.0, 15.0, -15.0, 10.0, 0.0, -24.0, 0.0, -400.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 10.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 2.0, 17.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 195.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 189.0, 185.0, 10.0, 7.0, 0.0, 0.0, 0.0, 180.0, 92.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 191.0, 2.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 180.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 7.0, 0.0, 200.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9099977334606146, "mean_inference_ms": 2.3478104973506233, "mean_action_processing_ms": 0.42867846756058314, "mean_env_wait_ms": 0.3188725260611507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004767179489135742, "StateBufferConnector_ms": 0.003344893455505371, "ViewRequirementAgentConnector_ms": 0.122184157371521}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -568.0, "episode_return_mean": -27.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.79269507570746, "num_env_steps_trained_throughput_per_sec": 356.79269507570746, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 12098.03, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12097.968, "sample_time_ms": 1653.608, "learn_time_ms": 10429.189, "learn_throughput": 383.539, "synch_weights_time_ms": 11.993}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "f1691_00000", "date": "2024-08-13_17-07-23", "timestamp": 1723583243, "time_this_iter_s": 11.227345943450928, "time_total_s": 1732.2831127643585, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e07820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1732.2831127643585, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 56.49375, "ram_util_percent": 79.86874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2073853715860023, "cur_kl_coeff": 0.360406494140625, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00010833861207757046, "vf_loss": 0.6187754715866749, "vf_explained_var": 0.012791702167066947, "kl": Infinity, "entropy": 0.00034521739980724936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4917663189124255, "cur_kl_coeff": 2.4280577548552166e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.8982705101094864, "policy_loss": 7.691127137236652e-05, "vf_loss": 0.8981935975885896, "vf_explained_var": -5.64509598666398e-09, "kl": -5.369753475625168e-12, "entropy": 9.645889800717747e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -363.0, "episode_reward_mean": -19.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -22.675, "predator_policy": 12.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-363.0, -11.0, 0.0, -180.0, -80.0, -4.0, 11.0, -9.0, 9.0, -185.0, 15.0, 3.0, -4.0, 0.0, 0.0, -189.0, -6.0, -9.0, 0.0, -174.0, -10.0, 15.0, -180.0, -3.0, 0.0, -7.0, 0.0, 4.0, 14.0, 15.0, -10.0, 0.0, 29.0, -10.0, -180.0, -15.0, 15.0, 0.0, 13.0, -14.0, 4.0, 1.0, -192.0, 0.0, 0.0, 30.0, -10.0, 1.0, 7.0, 3.0, 8.0, 10.0, -10.0, -2.0, -6.0, 0.0, -7.0, -10.0, 3.0, -7.0, 8.0, -6.0, 0.0, 15.0, 15.0, 3.0, -6.0, 0.0, 0.0, 0.0, 9.0, -4.0, 5.0, 5.0, -7.0, -200.0, 0.0, -9.0, 19.0, 1.0, -1.0, -10.0, 0.0, -191.0, 0.0, 0.0, 0.0, 0.0, -5.0, 7.0, -5.0, 5.0, 13.0, -2.0, 17.0, 1.0, 0.0, 8.0, 12.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-370.0, -367.0, -28.0, 0.0, 0.0, 0.0, -360.0, 0.0, -172.0, 0.0, 0.0, -8.0, 11.0, 0.0, 0.0, -18.0, 0.0, 3.0, -370.0, 0.0, 15.0, 0.0, 3.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -388.0, 0.0, -16.0, -18.0, 0.0, 0.0, 0.0, 0.0, -361.0, -20.0, 0.0, 15.0, 0.0, 0.0, -369.0, 0.0, -13.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, -11.0, 15.0, 0.0, -28.0, -3.0, 0.0, 0.0, 14.0, 15.0, -20.0, 0.0, -360.0, 0.0, -10.0, -20.0, 15.0, 0.0, 0.0, 0.0, 11.0, 2.0, -10.0, -16.0, 4.0, 0.0, 0.0, 1.0, -364.0, -20.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, -19.0, -2.0, -12.0, 2.0, 7.0, 0.0, 3.0, 0.0, 8.0, 0.0, -4.0, 12.0, 0.0, -20.0, 0.0, -8.0, 0.0, -12.0, 0.0, 0.0, 0.0, -17.0, 0.0, -20.0, 0.0, -4.0, 0.0, -17.0, 0.0, 8.0, 0.0, -12.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, -20.0, 13.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -11.0, -20.0, 15.0, -15.0, 10.0, 0.0, -24.0, 0.0, -400.0, 0.0, 0.0, 0.0, -19.0, 8.0, 9.0, 0.0, 1.0, 0.0, -21.0, -13.0, -14.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 12.0, -10.0, 0.0, -16.0, 6.0, -2.0, 10.0, 3.0, -12.0, 0.0, 2.0, 15.0, 1.0, -3.0, 0.0, 0.0, 8.0, 0.0, 15.0, -6.0, 15.0, 6.0], "policy_predator_policy_reward": [189.0, 185.0, 10.0, 7.0, 0.0, 0.0, 0.0, 180.0, 92.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 191.0, 2.0, 8.0, 9.0, 0.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 180.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 7.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 10.0, 17.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 8.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9079730568695145, "mean_inference_ms": 2.344913412121778, "mean_action_processing_ms": 0.4280269705722256, "mean_env_wait_ms": 0.3181701153894581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038241147994995117, "StateBufferConnector_ms": 0.003299236297607422, "ViewRequirementAgentConnector_ms": 0.11425232887268066}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -363.0, "episode_return_mean": -19.59, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.81777343549123, "num_env_steps_trained_throughput_per_sec": 411.81777343549123, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 11856.667, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11856.61, "sample_time_ms": 1528.57, "learn_time_ms": 10312.793, "learn_throughput": 387.868, "synch_weights_time_ms": 12.458}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "f1691_00000", "date": "2024-08-13_17-07-33", "timestamp": 1723583253, "time_this_iter_s": 9.720396995544434, "time_total_s": 1742.003509759903, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d24160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1742.003509759903, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 39.73076923076923, "ram_util_percent": 77.24615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.068366911451495, "cur_kl_coeff": 0.5406097412109376, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.000464371486108691, "vf_loss": 0.453021520897549, "vf_explained_var": 0.01111337350159095, "kl": Infinity, "entropy": 0.0002915879826678057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.370831362995881, "cur_kl_coeff": 1.2140288774276083e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.6530433441231411, "policy_loss": 4.255884553665522e-05, "vf_loss": 0.6530007844748316, "vf_explained_var": 7.595019365744616e-06, "kl": -4.989915817317727e-14, "entropy": 9.428309054117432e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -555.0, "episode_reward_mean": -16.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -17.775, "predator_policy": 9.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -174.0, -10.0, 15.0, -180.0, -3.0, 0.0, -7.0, 0.0, 4.0, 14.0, 15.0, -10.0, 0.0, 29.0, -10.0, -180.0, -15.0, 15.0, 0.0, 13.0, -14.0, 4.0, 1.0, -192.0, 0.0, 0.0, 30.0, -10.0, 1.0, 7.0, 3.0, 8.0, 10.0, -10.0, -2.0, -6.0, 0.0, -7.0, -10.0, 3.0, -7.0, 8.0, -6.0, 0.0, 15.0, 15.0, 3.0, -6.0, 0.0, 0.0, 0.0, 9.0, -4.0, 5.0, 5.0, -7.0, -200.0, 0.0, -9.0, 19.0, 1.0, -1.0, -10.0, 0.0, -191.0, 0.0, 0.0, 0.0, 0.0, -5.0, 7.0, -5.0, 5.0, 13.0, -2.0, 17.0, 1.0, 0.0, 8.0, 12.0, 21.0, -2.0, 0.0, -171.0, -5.0, 13.0, 0.0, -555.0, 5.0, 0.0, 15.0, 4.0, 17.0, 0.0, -10.0, 0.0, -5.0, 15.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -361.0, -20.0, 0.0, 15.0, 0.0, 0.0, -369.0, 0.0, -13.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, -11.0, 15.0, 0.0, -28.0, -3.0, 0.0, 0.0, 14.0, 15.0, -20.0, 0.0, -360.0, 0.0, -10.0, -20.0, 15.0, 0.0, 0.0, 0.0, 11.0, 2.0, -10.0, -16.0, 4.0, 0.0, 0.0, 1.0, -364.0, -20.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, -19.0, -2.0, -12.0, 2.0, 7.0, 0.0, 3.0, 0.0, 8.0, 0.0, -4.0, 12.0, 0.0, -20.0, 0.0, -8.0, 0.0, -12.0, 0.0, 0.0, 0.0, -17.0, 0.0, -20.0, 0.0, -4.0, 0.0, -17.0, 0.0, 8.0, 0.0, -12.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, -20.0, 13.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -11.0, -20.0, 15.0, -15.0, 10.0, 0.0, -24.0, 0.0, -400.0, 0.0, 0.0, 0.0, -19.0, 8.0, 9.0, 0.0, 1.0, 0.0, -21.0, -13.0, -14.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 12.0, -10.0, 0.0, -16.0, 6.0, -2.0, 10.0, 3.0, -12.0, 0.0, 2.0, 15.0, 1.0, -3.0, 0.0, 0.0, 8.0, 0.0, 15.0, -6.0, 15.0, 6.0, 0.0, -12.0, 0.0, 0.0, -12.0, -345.0, 0.0, -15.0, -7.0, 15.0, 0.0, 0.0, -363.0, -387.0, 5.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 15.0, 2.0, 0.0, 0.0, -20.0, 0.0, 0.0, -6.0, -15.0, 0.0, 15.0, 0.0, 0.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 180.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 7.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 10.0, 17.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 8.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 180.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9068538001330738, "mean_inference_ms": 2.338868595580033, "mean_action_processing_ms": 0.4264261670117244, "mean_env_wait_ms": 0.31767782937402067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008362293243408203, "StateBufferConnector_ms": 0.0032275915145874023, "ViewRequirementAgentConnector_ms": 0.11208164691925049}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -555.0, "episode_return_mean": -16.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.07832124705885, "num_env_steps_trained_throughput_per_sec": 393.07832124705885, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 11614.719, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11614.666, "sample_time_ms": 1461.515, "learn_time_ms": 10138.071, "learn_throughput": 394.552, "synch_weights_time_ms": 12.438}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "f1691_00000", "date": "2024-08-13_17-07-43", "timestamp": 1723583263, "time_this_iter_s": 10.183295965194702, "time_total_s": 1752.1868057250977, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3dcec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1752.1868057250977, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 43.81333333333334, "ram_util_percent": 76.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.205605556307331, "cur_kl_coeff": 0.810914611816406, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00048322311193539354, "vf_loss": 0.8016342341899871, "vf_explained_var": 0.0033714566596601374, "kl": Infinity, "entropy": 0.0007371990183708243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.442243444792823, "cur_kl_coeff": 6.0701443871380415e-15, "cur_lr": 0.009999999999999998, "total_loss": 1.20943576892217, "policy_loss": 0.0003935011936519196, "vf_loss": 1.209042261737995, "vf_explained_var": -7.127327893776868e-09, "kl": 8.512738935440693e-13, "entropy": 9.538902908708998e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -578.0, "episode_reward_mean": -20.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -19.72, "predator_policy": 9.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 1.0, -192.0, 0.0, 0.0, 30.0, -10.0, 1.0, 7.0, 3.0, 8.0, 10.0, -10.0, -2.0, -6.0, 0.0, -7.0, -10.0, 3.0, -7.0, 8.0, -6.0, 0.0, 15.0, 15.0, 3.0, -6.0, 0.0, 0.0, 0.0, 9.0, -4.0, 5.0, 5.0, -7.0, -200.0, 0.0, -9.0, 19.0, 1.0, -1.0, -10.0, 0.0, -191.0, 0.0, 0.0, 0.0, 0.0, -5.0, 7.0, -5.0, 5.0, 13.0, -2.0, 17.0, 1.0, 0.0, 8.0, 12.0, 21.0, -2.0, 0.0, -171.0, -5.0, 13.0, 0.0, -555.0, 5.0, 0.0, 15.0, 4.0, 17.0, 0.0, -10.0, 0.0, -5.0, 15.0, 10.0, 1.0, -10.0, -3.0, -171.0, 0.0, -578.0, 6.0, -10.0, 14.0, 10.0, 4.0, -8.0, 0.0, 10.0, -10.0, -199.0, 9.0, 0.0, 6.0, 18.0, -4.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, 0.0, 0.0, 1.0, -364.0, -20.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, -19.0, -2.0, -12.0, 2.0, 7.0, 0.0, 3.0, 0.0, 8.0, 0.0, -4.0, 12.0, 0.0, -20.0, 0.0, -8.0, 0.0, -12.0, 0.0, 0.0, 0.0, -17.0, 0.0, -20.0, 0.0, -4.0, 0.0, -17.0, 0.0, 8.0, 0.0, -12.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, -20.0, 13.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -11.0, -20.0, 15.0, -15.0, 10.0, 0.0, -24.0, 0.0, -400.0, 0.0, 0.0, 0.0, -19.0, 8.0, 9.0, 0.0, 1.0, 0.0, -21.0, -13.0, -14.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 12.0, -10.0, 0.0, -16.0, 6.0, -2.0, 10.0, 3.0, -12.0, 0.0, 2.0, 15.0, 1.0, -3.0, 0.0, 0.0, 8.0, 0.0, 15.0, -6.0, 15.0, 6.0, 0.0, -12.0, 0.0, 0.0, -12.0, -345.0, 0.0, -15.0, -7.0, 15.0, 0.0, 0.0, -363.0, -387.0, 5.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 15.0, 2.0, 0.0, 0.0, -20.0, 0.0, 0.0, -6.0, -15.0, 0.0, 15.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, -20.0, -6.0, 0.0, -369.0, 9.0, 0.0, 0.0, -378.0, -400.0, 6.0, 0.0, -20.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 4.0, -16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -20.0, 0.0, -398.0, 0.0, 9.0, 0.0, 0.0, 0.0, 6.0, 15.0, 3.0, 0.0, -8.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 7.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 10.0, 17.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 8.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 180.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 189.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052225755915982, "mean_inference_ms": 2.3346605174602963, "mean_action_processing_ms": 0.42538646153954446, "mean_env_wait_ms": 0.3170385416339976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008290529251098633, "StateBufferConnector_ms": 0.0032035112380981445, "ViewRequirementAgentConnector_ms": 0.11214959621429443}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -578.0, "episode_return_mean": -20.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.29338441455917, "num_env_steps_trained_throughput_per_sec": 379.29338441455917, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 11480.547, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11480.496, "sample_time_ms": 1479.616, "learn_time_ms": 9985.728, "learn_throughput": 400.572, "synch_weights_time_ms": 12.567}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "f1691_00000", "date": "2024-08-13_17-07-53", "timestamp": 1723583273, "time_this_iter_s": 10.54990267753601, "time_total_s": 1762.7367084026337, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3d72670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1762.7367084026337, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 47.78666666666667, "ram_util_percent": 76.88000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.144476275573726, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00018996832813456576, "vf_loss": 1.1674785148845148, "vf_explained_var": 0.00463626640183585, "kl": Infinity, "entropy": 0.0015098769201736869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0885868179627876, "cur_kl_coeff": 3.0350721935690207e-15, "cur_lr": 0.009999999999999998, "total_loss": 1.6401433337460118, "policy_loss": -0.00011714162987474569, "vf_loss": 1.6402604741709572, "vf_explained_var": -8.420338706364707e-09, "kl": 8.477245117748067e-12, "entropy": 9.546535382550657e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -584.0, "episode_reward_mean": -29.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.11, "predator_policy": 12.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -7.0, 8.0, -6.0, 0.0, 15.0, 15.0, 3.0, -6.0, 0.0, 0.0, 0.0, 9.0, -4.0, 5.0, 5.0, -7.0, -200.0, 0.0, -9.0, 19.0, 1.0, -1.0, -10.0, 0.0, -191.0, 0.0, 0.0, 0.0, 0.0, -5.0, 7.0, -5.0, 5.0, 13.0, -2.0, 17.0, 1.0, 0.0, 8.0, 12.0, 21.0, -2.0, 0.0, -171.0, -5.0, 13.0, 0.0, -555.0, 5.0, 0.0, 15.0, 4.0, 17.0, 0.0, -10.0, 0.0, -5.0, 15.0, 10.0, 1.0, -10.0, -3.0, -171.0, 0.0, -578.0, 6.0, -10.0, 14.0, 10.0, 4.0, -8.0, 0.0, 10.0, -10.0, -199.0, 9.0, 0.0, 6.0, 18.0, -4.0, 0.0, -204.0, -584.0, 15.0, 4.0, 0.0, 0.0, -151.0, 15.0, 21.0, -10.0, -180.0, 5.0, 13.0, -10.0, 4.0, 0.0, -14.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -4.0, 0.0, -17.0, 0.0, 8.0, 0.0, -12.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, -20.0, 13.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -11.0, -20.0, 15.0, -15.0, 10.0, 0.0, -24.0, 0.0, -400.0, 0.0, 0.0, 0.0, -19.0, 8.0, 9.0, 0.0, 1.0, 0.0, -21.0, -13.0, -14.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 12.0, -10.0, 0.0, -16.0, 6.0, -2.0, 10.0, 3.0, -12.0, 0.0, 2.0, 15.0, 1.0, -3.0, 0.0, 0.0, 8.0, 0.0, 15.0, -6.0, 15.0, 6.0, 0.0, -12.0, 0.0, 0.0, -12.0, -345.0, 0.0, -15.0, -7.0, 15.0, 0.0, 0.0, -363.0, -387.0, 5.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 15.0, 2.0, 0.0, 0.0, -20.0, 0.0, 0.0, -6.0, -15.0, 0.0, 15.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, -20.0, -6.0, 0.0, -369.0, 9.0, 0.0, 0.0, -378.0, -400.0, 6.0, 0.0, -20.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 4.0, -16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -20.0, 0.0, -398.0, 0.0, 9.0, 0.0, 0.0, 0.0, 6.0, 15.0, 3.0, 0.0, -8.0, 0.0, 0.0, -15.0, -400.0, -400.0, -384.0, 15.0, 0.0, 11.0, -17.0, 0.0, -10.0, 0.0, 0.0, 12.0, -341.0, 15.0, 0.0, 15.0, 6.0, -20.0, 0.0, -380.0, 10.0, -20.0, 15.0, -2.0, 14.0, -20.0, 0.0, 4.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 11.0], "policy_predator_policy_reward": [0.0, 7.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 7.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 10.0, 17.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 8.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 180.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 189.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 11.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037173933254382, "mean_inference_ms": 2.330899570642689, "mean_action_processing_ms": 0.4244917717113529, "mean_env_wait_ms": 0.316453845869378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008323431015014648, "StateBufferConnector_ms": 0.003191351890563965, "ViewRequirementAgentConnector_ms": 0.105507493019104}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -584.0, "episode_return_mean": -29.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.07356556853614, "num_env_steps_trained_throughput_per_sec": 396.07356556853614, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 11284.424, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11284.372, "sample_time_ms": 1461.168, "learn_time_ms": 9808.078, "learn_throughput": 407.827, "synch_weights_time_ms": 12.478}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "f1691_00000", "date": "2024-08-13_17-08-04", "timestamp": 1723583284, "time_this_iter_s": 10.142170906066895, "time_total_s": 1772.8788793087006, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c580d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1772.8788793087006, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 46.10714285714285, "ram_util_percent": 77.63571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.233469422863274, "cur_kl_coeff": 1.8245578765869146, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0018861289397276268, "vf_loss": 0.9841075601204047, "vf_explained_var": 0.0039029355717714502, "kl": Infinity, "entropy": 0.0023006204477318765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1865319577649376, "cur_kl_coeff": 1.5175360967845104e-15, "cur_lr": 0.009999999999999998, "total_loss": 1.2712950143982809, "policy_loss": -0.00014379505725902698, "vf_loss": 1.2714388107811962, "vf_explained_var": -5.3928011939639136e-09, "kl": 4.145308166033924e-12, "entropy": 9.367032121148172e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -584.0, "episode_reward_mean": -34.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.545, "predator_policy": 13.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -9.0, 19.0, 1.0, -1.0, -10.0, 0.0, -191.0, 0.0, 0.0, 0.0, 0.0, -5.0, 7.0, -5.0, 5.0, 13.0, -2.0, 17.0, 1.0, 0.0, 8.0, 12.0, 21.0, -2.0, 0.0, -171.0, -5.0, 13.0, 0.0, -555.0, 5.0, 0.0, 15.0, 4.0, 17.0, 0.0, -10.0, 0.0, -5.0, 15.0, 10.0, 1.0, -10.0, -3.0, -171.0, 0.0, -578.0, 6.0, -10.0, 14.0, 10.0, 4.0, -8.0, 0.0, 10.0, -10.0, -199.0, 9.0, 0.0, 6.0, 18.0, -4.0, 0.0, -204.0, -584.0, 15.0, 4.0, 0.0, 0.0, -151.0, 15.0, 21.0, -10.0, -180.0, 5.0, 13.0, -10.0, 4.0, 0.0, -14.0, 11.0, 0.0, 15.0, 7.0, 0.0, -537.0, 0.0, 4.0, -2.0, 5.0, 0.0, 3.0, -10.0, 10.0, -4.0, -8.0, 4.0, -192.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -19.0, 8.0, 9.0, 0.0, 1.0, 0.0, -21.0, -13.0, -14.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 12.0, -10.0, 0.0, -16.0, 6.0, -2.0, 10.0, 3.0, -12.0, 0.0, 2.0, 15.0, 1.0, -3.0, 0.0, 0.0, 8.0, 0.0, 15.0, -6.0, 15.0, 6.0, 0.0, -12.0, 0.0, 0.0, -12.0, -345.0, 0.0, -15.0, -7.0, 15.0, 0.0, 0.0, -363.0, -387.0, 5.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 15.0, 2.0, 0.0, 0.0, -20.0, 0.0, 0.0, -6.0, -15.0, 0.0, 15.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, -20.0, -6.0, 0.0, -369.0, 9.0, 0.0, 0.0, -378.0, -400.0, 6.0, 0.0, -20.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 4.0, -16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -20.0, 0.0, -398.0, 0.0, 9.0, 0.0, 0.0, 0.0, 6.0, 15.0, 3.0, 0.0, -8.0, 0.0, 0.0, -15.0, -400.0, -400.0, -384.0, 15.0, 0.0, 11.0, -17.0, 0.0, -10.0, 0.0, 0.0, 12.0, -341.0, 15.0, 0.0, 15.0, 6.0, -20.0, 0.0, -380.0, 10.0, -20.0, 15.0, -2.0, 14.0, -20.0, 0.0, 4.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 11.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, -352.0, -370.0, 0.0, 0.0, -22.0, 15.0, 0.0, -12.0, -4.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, -20.0, 0.0, 10.0, -20.0, 0.0, 0.0, -16.0, -6.0, 7.0, 6.0, -396.0, 15.0, -10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 10.0, 17.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 8.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 180.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 189.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 11.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 8.0, 0.0, 3.0, 0.0, 198.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.902072178636934, "mean_inference_ms": 2.3266136016241363, "mean_action_processing_ms": 0.4235500971043409, "mean_env_wait_ms": 0.31578847161340484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008610367774963379, "StateBufferConnector_ms": 0.0030843019485473633, "ViewRequirementAgentConnector_ms": 0.10074329376220703}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -584.0, "episode_return_mean": -34.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.7324763504256, "num_env_steps_trained_throughput_per_sec": 373.7324763504256, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 11150.693, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11150.642, "sample_time_ms": 1429.695, "learn_time_ms": 9705.631, "learn_throughput": 412.132, "synch_weights_time_ms": 12.692}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "f1691_00000", "date": "2024-08-13_17-08-14", "timestamp": 1723583294, "time_this_iter_s": 10.761594772338867, "time_total_s": 1783.6404740810394, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e69670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1783.6404740810394, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 49.48666666666667, "ram_util_percent": 79.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2697685321802816, "cur_kl_coeff": 2.7368368148803706, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0014160928418662734, "vf_loss": 1.6821057026663786, "vf_explained_var": 0.0034417847161570553, "kl": Infinity, "entropy": 0.006536906617924537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.384811777395206, "cur_kl_coeff": 7.587680483922552e-16, "cur_lr": 0.009999999999999998, "total_loss": 2.1284069295913453, "policy_loss": 3.7720010039352235e-05, "vf_loss": 2.128369205464762, "vf_explained_var": -6.591201459289228e-09, "kl": 4.673357181020614e-12, "entropy": 9.109286896572727e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -593.0, "episode_reward_mean": -51.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.21, "predator_policy": 19.695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -2.0, 0.0, -171.0, -5.0, 13.0, 0.0, -555.0, 5.0, 0.0, 15.0, 4.0, 17.0, 0.0, -10.0, 0.0, -5.0, 15.0, 10.0, 1.0, -10.0, -3.0, -171.0, 0.0, -578.0, 6.0, -10.0, 14.0, 10.0, 4.0, -8.0, 0.0, 10.0, -10.0, -199.0, 9.0, 0.0, 6.0, 18.0, -4.0, 0.0, -204.0, -584.0, 15.0, 4.0, 0.0, 0.0, -151.0, 15.0, 21.0, -10.0, -180.0, 5.0, 13.0, -10.0, 4.0, 0.0, -14.0, 11.0, 0.0, 15.0, 7.0, 0.0, -537.0, 0.0, 4.0, -2.0, 5.0, 0.0, 3.0, -10.0, 10.0, -4.0, -8.0, 4.0, -192.0, 10.0, -200.0, 15.0, -198.0, -194.0, 15.0, -593.0, -167.0, 11.0, -174.0, 18.0, 0.0, -9.0, 0.0, -4.0, 25.0, -163.0, 15.0, 0.0, 2.0, -194.0, 15.0, 10.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 6.0, 0.0, -12.0, 0.0, 0.0, -12.0, -345.0, 0.0, -15.0, -7.0, 15.0, 0.0, 0.0, -363.0, -387.0, 5.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 15.0, 2.0, 0.0, 0.0, -20.0, 0.0, 0.0, -6.0, -15.0, 0.0, 15.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, -20.0, -6.0, 0.0, -369.0, 9.0, 0.0, 0.0, -378.0, -400.0, 6.0, 0.0, -20.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 4.0, -16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -20.0, 0.0, -398.0, 0.0, 9.0, 0.0, 0.0, 0.0, 6.0, 15.0, 3.0, 0.0, -8.0, 0.0, 0.0, -15.0, -400.0, -400.0, -384.0, 15.0, 0.0, 11.0, -17.0, 0.0, -10.0, 0.0, 0.0, 12.0, -341.0, 15.0, 0.0, 15.0, 6.0, -20.0, 0.0, -380.0, 10.0, -20.0, 15.0, -2.0, 14.0, -20.0, 0.0, 4.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 11.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, -352.0, -370.0, 0.0, 0.0, -22.0, 15.0, 0.0, -12.0, -4.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, -20.0, 0.0, 10.0, -20.0, 0.0, 0.0, -16.0, -6.0, 7.0, 6.0, -396.0, 15.0, -10.0, 0.0, -400.0, 0.0, 15.0, -400.0, 0.0, -388.0, 0.0, 0.0, 15.0, -400.0, -396.0, 0.0, -349.0, 11.0, 0.0, 7.0, -362.0, 12.0, 6.0, 0.0, 0.0, 1.0, -20.0, 0.0, 0.0, 0.0, -14.0, 7.0, 14.0, -341.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 8.0, -390.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 180.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 189.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 11.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 8.0, 0.0, 3.0, 0.0, 198.0, 5.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 198.0, 194.0, 0.0, 0.0, 0.0, 200.0, 3.0, 182.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9003135123059315, "mean_inference_ms": 2.322946279819388, "mean_action_processing_ms": 0.4225281787433104, "mean_env_wait_ms": 0.3150676343134507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009699583053588867, "StateBufferConnector_ms": 0.00324094295501709, "ViewRequirementAgentConnector_ms": 0.10997891426086426}, "num_episodes": 23, "episode_return_max": 25.0, "episode_return_min": -593.0, "episode_return_mean": -51.03, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.247998578857, "num_env_steps_trained_throughput_per_sec": 329.247998578857, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 11156.651, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11156.601, "sample_time_ms": 1461.517, "learn_time_ms": 9678.979, "learn_throughput": 413.267, "synch_weights_time_ms": 13.175}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "f1691_00000", "date": "2024-08-13_17-08-27", "timestamp": 1723583307, "time_this_iter_s": 12.190239906311035, "time_total_s": 1795.8307139873505, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e699d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1795.8307139873505, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 56.01176470588235, "ram_util_percent": 83.37058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.182362516200732, "cur_kl_coeff": 4.105255222320557, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.001981074837277885, "vf_loss": 1.8023840882790783, "vf_explained_var": 0.0037552648435824764, "kl": Infinity, "entropy": 0.005058636500052792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.128836592778603, "cur_kl_coeff": 3.793840241961276e-16, "cur_lr": 0.009999999999999998, "total_loss": 2.412854420255732, "policy_loss": 0.0002019647910461697, "vf_loss": 2.4126524544897534, "vf_explained_var": -7.631917479177e-09, "kl": 1.1195183913525375e-12, "entropy": 9.124729085663954e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -66.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -58.935, "predator_policy": 25.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.0, 0.0, -578.0, 6.0, -10.0, 14.0, 10.0, 4.0, -8.0, 0.0, 10.0, -10.0, -199.0, 9.0, 0.0, 6.0, 18.0, -4.0, 0.0, -204.0, -584.0, 15.0, 4.0, 0.0, 0.0, -151.0, 15.0, 21.0, -10.0, -180.0, 5.0, 13.0, -10.0, 4.0, 0.0, -14.0, 11.0, 0.0, 15.0, 7.0, 0.0, -537.0, 0.0, 4.0, -2.0, 5.0, 0.0, 3.0, -10.0, 10.0, -4.0, -8.0, 4.0, -192.0, 10.0, -200.0, 15.0, -198.0, -194.0, 15.0, -593.0, -167.0, 11.0, -174.0, 18.0, 0.0, -9.0, 0.0, -4.0, 25.0, -163.0, 15.0, 0.0, 2.0, -194.0, 15.0, 10.0, -10.0, 1.0, 0.0, -198.0, -200.0, 1.0, -5.0, 0.0, -600.0, 15.0, 0.0, 0.0, 15.0, -4.0, 10.0, -195.0, -210.0, -182.0, 26.0, -542.0, -173.0, 19.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-369.0, 9.0, 0.0, 0.0, -378.0, -400.0, 6.0, 0.0, -20.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 4.0, -16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -20.0, 0.0, -398.0, 0.0, 9.0, 0.0, 0.0, 0.0, 6.0, 15.0, 3.0, 0.0, -8.0, 0.0, 0.0, -15.0, -400.0, -400.0, -384.0, 15.0, 0.0, 11.0, -17.0, 0.0, -10.0, 0.0, 0.0, 12.0, -341.0, 15.0, 0.0, 15.0, 6.0, -20.0, 0.0, -380.0, 10.0, -20.0, 15.0, -2.0, 14.0, -20.0, 0.0, 4.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 11.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, -352.0, -370.0, 0.0, 0.0, -22.0, 15.0, 0.0, -12.0, -4.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, -20.0, 0.0, 10.0, -20.0, 0.0, 0.0, -16.0, -6.0, 7.0, 6.0, -396.0, 15.0, -10.0, 0.0, -400.0, 0.0, 15.0, -400.0, 0.0, -388.0, 0.0, 0.0, 15.0, -400.0, -396.0, 0.0, -349.0, 11.0, 0.0, 7.0, -362.0, 12.0, 6.0, 0.0, 0.0, 1.0, -20.0, 0.0, 0.0, 0.0, -14.0, 7.0, 14.0, -341.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 8.0, -390.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, -20.0, -8.0, 0.0, 0.0, 0.0, -397.0, 0.0, -400.0, 0.0, 1.0, 0.0, 0.0, -15.0, 10.0, -20.0, -400.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 0.0, 10.0, -400.0, 5.0, -400.0, -20.0, -373.0, 0.0, 13.0, 13.0, -390.0, -347.0, -376.0, 15.0, 15.0, 4.0, -17.0, 0.0], "policy_predator_policy_reward": [0.0, 189.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 11.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 8.0, 0.0, 3.0, 0.0, 198.0, 5.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 198.0, 194.0, 0.0, 0.0, 0.0, 200.0, 3.0, 182.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 199.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 10.0, 200.0, 0.0, 191.0, 0.0, 0.0, 195.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8984423002041305, "mean_inference_ms": 2.3207278492154138, "mean_action_processing_ms": 0.42140591602896693, "mean_env_wait_ms": 0.3143852270825812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058525800704956055, "StateBufferConnector_ms": 0.0032362937927246094, "ViewRequirementAgentConnector_ms": 0.10942423343658447}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -66.72, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.4857857143065, "num_env_steps_trained_throughput_per_sec": 348.4857857143065, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 11005.676, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11005.626, "sample_time_ms": 1447.373, "learn_time_ms": 9542.731, "learn_throughput": 419.167, "synch_weights_time_ms": 12.875}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "f1691_00000", "date": "2024-08-13_17-08-38", "timestamp": 1723583318, "time_this_iter_s": 11.527674198150635, "time_total_s": 1807.358388185501, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c58160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1807.358388185501, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 49.22352941176471, "ram_util_percent": 83.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3045788640481613, "cur_kl_coeff": 6.157882833480835, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0008710724168590136, "vf_loss": 0.9543624222593964, "vf_explained_var": 0.006382046773950889, "kl": Infinity, "entropy": 0.001965335240450658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6238082522144492, "cur_kl_coeff": 1.896920120980638e-16, "cur_lr": 0.009999999999999998, "total_loss": 1.335946095451003, "policy_loss": -0.00036946323074439847, "vf_loss": 1.3363155585590494, "vf_explained_var": -6.875033101076802e-09, "kl": 1.2061618208276196e-11, "entropy": 8.856282380234776e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -64.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -56.89, "predator_policy": 24.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -204.0, -584.0, 15.0, 4.0, 0.0, 0.0, -151.0, 15.0, 21.0, -10.0, -180.0, 5.0, 13.0, -10.0, 4.0, 0.0, -14.0, 11.0, 0.0, 15.0, 7.0, 0.0, -537.0, 0.0, 4.0, -2.0, 5.0, 0.0, 3.0, -10.0, 10.0, -4.0, -8.0, 4.0, -192.0, 10.0, -200.0, 15.0, -198.0, -194.0, 15.0, -593.0, -167.0, 11.0, -174.0, 18.0, 0.0, -9.0, 0.0, -4.0, 25.0, -163.0, 15.0, 0.0, 2.0, -194.0, 15.0, 10.0, -10.0, 1.0, 0.0, -198.0, -200.0, 1.0, -5.0, 0.0, -600.0, 15.0, 0.0, 0.0, 15.0, -4.0, 10.0, -195.0, -210.0, -182.0, 26.0, -542.0, -173.0, 19.0, -7.0, 0.0, 4.0, 5.0, 0.0, 15.0, 15.0, 0.0, 11.0, -20.0, -3.0, -5.0, 8.0, 0.0, 15.0, 23.0, -532.0, 0.0, -195.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -15.0, -400.0, -400.0, -384.0, 15.0, 0.0, 11.0, -17.0, 0.0, -10.0, 0.0, 0.0, 12.0, -341.0, 15.0, 0.0, 15.0, 6.0, -20.0, 0.0, -380.0, 10.0, -20.0, 15.0, -2.0, 14.0, -20.0, 0.0, 4.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 11.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, -352.0, -370.0, 0.0, 0.0, -22.0, 15.0, 0.0, -12.0, -4.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, -20.0, 0.0, 10.0, -20.0, 0.0, 0.0, -16.0, -6.0, 7.0, 6.0, -396.0, 15.0, -10.0, 0.0, -400.0, 0.0, 15.0, -400.0, 0.0, -388.0, 0.0, 0.0, 15.0, -400.0, -396.0, 0.0, -349.0, 11.0, 0.0, 7.0, -362.0, 12.0, 6.0, 0.0, 0.0, 1.0, -20.0, 0.0, 0.0, 0.0, -14.0, 7.0, 14.0, -341.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 8.0, -390.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, -20.0, -8.0, 0.0, 0.0, 0.0, -397.0, 0.0, -400.0, 0.0, 1.0, 0.0, 0.0, -15.0, 10.0, -20.0, -400.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 0.0, 10.0, -400.0, 5.0, -400.0, -20.0, -373.0, 0.0, 13.0, 13.0, -390.0, -347.0, -376.0, 15.0, 15.0, 4.0, -17.0, 0.0, 0.0, 0.0, -5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 0.0, -4.0, -34.0, -12.0, 0.0, -9.0, 0.0, -20.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 9.0, 14.0, -353.0, -362.0, 0.0, 0.0, 3.0, -396.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 11.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 190.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 8.0, 0.0, 3.0, 0.0, 198.0, 5.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 198.0, 194.0, 0.0, 0.0, 0.0, 200.0, 3.0, 182.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 199.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 10.0, 200.0, 0.0, 191.0, 0.0, 0.0, 195.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 16.0, 10.0, 0.0, 6.0, 5.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 198.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8966054138813706, "mean_inference_ms": 2.31731470868036, "mean_action_processing_ms": 0.42048610711772, "mean_env_wait_ms": 0.31385771914968197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006350874900817871, "StateBufferConnector_ms": 0.003343939781188965, "ViewRequirementAgentConnector_ms": 0.10881733894348145}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -64.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.24163575185116, "num_env_steps_trained_throughput_per_sec": 341.24163575185116, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 10965.039, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10964.988, "sample_time_ms": 1483.719, "learn_time_ms": 9465.687, "learn_throughput": 422.579, "synch_weights_time_ms": 13.062}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "f1691_00000", "date": "2024-08-13_17-08-50", "timestamp": 1723583330, "time_this_iter_s": 11.765073299407959, "time_total_s": 1819.123461484909, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e07700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1819.123461484909, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 52.99411764705883, "ram_util_percent": 83.66470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.655442741507339, "cur_kl_coeff": 9.23682425022125, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0021109207915191454, "vf_loss": 1.3460156664646492, "vf_explained_var": 0.013206387386120186, "kl": Infinity, "entropy": 0.0028648796493107196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.233023769833411, "cur_kl_coeff": 9.48460060490319e-17, "cur_lr": 0.009999999999999998, "total_loss": 1.4381436904034917, "policy_loss": 0.00011852507309485522, "vf_loss": 1.4380251550327534, "vf_explained_var": -7.568843781001984e-09, "kl": -1.2711189297058678e-12, "entropy": 8.757285940734971e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -61.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -55.48, "predator_policy": 24.905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 0.0, 15.0, 7.0, 0.0, -537.0, 0.0, 4.0, -2.0, 5.0, 0.0, 3.0, -10.0, 10.0, -4.0, -8.0, 4.0, -192.0, 10.0, -200.0, 15.0, -198.0, -194.0, 15.0, -593.0, -167.0, 11.0, -174.0, 18.0, 0.0, -9.0, 0.0, -4.0, 25.0, -163.0, 15.0, 0.0, 2.0, -194.0, 15.0, 10.0, -10.0, 1.0, 0.0, -198.0, -200.0, 1.0, -5.0, 0.0, -600.0, 15.0, 0.0, 0.0, 15.0, -4.0, 10.0, -195.0, -210.0, -182.0, 26.0, -542.0, -173.0, 19.0, -7.0, 0.0, 4.0, 5.0, 0.0, 15.0, 15.0, 0.0, 11.0, -20.0, -3.0, -5.0, 8.0, 0.0, 15.0, 23.0, -532.0, 0.0, -195.0, -200.0, -8.0, 0.0, 5.0, 0.0, -7.0, 6.0, 8.0, -18.0, 6.0, -186.0, -200.0, -186.0, 10.0, 0.0, -7.0, 24.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 11.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, -352.0, -370.0, 0.0, 0.0, -22.0, 15.0, 0.0, -12.0, -4.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, -20.0, 0.0, 10.0, -20.0, 0.0, 0.0, -16.0, -6.0, 7.0, 6.0, -396.0, 15.0, -10.0, 0.0, -400.0, 0.0, 15.0, -400.0, 0.0, -388.0, 0.0, 0.0, 15.0, -400.0, -396.0, 0.0, -349.0, 11.0, 0.0, 7.0, -362.0, 12.0, 6.0, 0.0, 0.0, 1.0, -20.0, 0.0, 0.0, 0.0, -14.0, 7.0, 14.0, -341.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 8.0, -390.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, -20.0, -8.0, 0.0, 0.0, 0.0, -397.0, 0.0, -400.0, 0.0, 1.0, 0.0, 0.0, -15.0, 10.0, -20.0, -400.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 0.0, 10.0, -400.0, 5.0, -400.0, -20.0, -373.0, 0.0, 13.0, 13.0, -390.0, -347.0, -376.0, 15.0, 15.0, 4.0, -17.0, 0.0, 0.0, 0.0, -5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 0.0, -4.0, -34.0, -12.0, 0.0, -9.0, 0.0, -20.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 9.0, 14.0, -353.0, -362.0, 0.0, 0.0, 3.0, -396.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, -20.0, 15.0, -18.0, 4.0, 4.0, -20.0, -16.0, 10.0, -8.0, 0.0, -372.0, 0.0, -400.0, -378.0, 0.0, -2.0, 5.0, 0.0, 0.0, 0.0, -21.0, 15.0, -8.0, 0.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 11.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 8.0, 0.0, 3.0, 0.0, 198.0, 5.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 198.0, 194.0, 0.0, 0.0, 0.0, 200.0, 3.0, 182.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 199.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 10.0, 200.0, 0.0, 191.0, 0.0, 0.0, 195.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 16.0, 10.0, 0.0, 6.0, 5.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 0.0, 186.0, 0.0, 200.0, 0.0, 192.0, 7.0, 0.0, 0.0, 0.0, 4.0, 10.0, 7.0, 10.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8950469122651868, "mean_inference_ms": 2.3159436846515664, "mean_action_processing_ms": 0.419552706322503, "mean_env_wait_ms": 0.313408679925737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007097125053405762, "StateBufferConnector_ms": 0.0040313005447387695, "ViewRequirementAgentConnector_ms": 0.10944259166717529}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -61.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.2245689959484, "num_env_steps_trained_throughput_per_sec": 344.2245689959484, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 10941.747, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10941.695, "sample_time_ms": 1503.492, "learn_time_ms": 9422.613, "learn_throughput": 424.511, "synch_weights_time_ms": 12.871}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "f1691_00000", "date": "2024-08-13_17-09-02", "timestamp": 1723583342, "time_this_iter_s": 11.64729905128479, "time_total_s": 1830.7707605361938, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c74dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1830.7707605361938, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 50.66875, "ram_util_percent": 83.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6564086087274723, "cur_kl_coeff": 13.855236375331883, "cur_lr": 0.009999999999999998, "total_loss": 1.5378465219464883, "policy_loss": 0.0014276459611085042, "vf_loss": 1.4992224663338334, "vf_explained_var": 0.015888340542556115, "kl": 0.002684646354132329, "entropy": 0.002808779133799059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.06155533035866, "cur_kl_coeff": 4.742300302451595e-17, "cur_lr": 0.009999999999999998, "total_loss": 2.3061677032677586, "policy_loss": -0.0002574490791029006, "vf_loss": 2.306425145883409, "vf_explained_var": -7.884212271877066e-09, "kl": 7.756058994624773e-12, "entropy": 8.61357361169024e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -74.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -65.055, "predator_policy": 27.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -593.0, -167.0, 11.0, -174.0, 18.0, 0.0, -9.0, 0.0, -4.0, 25.0, -163.0, 15.0, 0.0, 2.0, -194.0, 15.0, 10.0, -10.0, 1.0, 0.0, -198.0, -200.0, 1.0, -5.0, 0.0, -600.0, 15.0, 0.0, 0.0, 15.0, -4.0, 10.0, -195.0, -210.0, -182.0, 26.0, -542.0, -173.0, 19.0, -7.0, 0.0, 4.0, 5.0, 0.0, 15.0, 15.0, 0.0, 11.0, -20.0, -3.0, -5.0, 8.0, 0.0, 15.0, 23.0, -532.0, 0.0, -195.0, -200.0, -8.0, 0.0, 5.0, 0.0, -7.0, 6.0, 8.0, -18.0, 6.0, -186.0, -200.0, -186.0, 10.0, 0.0, -7.0, 24.0, -10.0, -5.0, -192.0, 0.0, -526.0, 21.0, -2.0, -10.0, -576.0, -3.0, 0.0, -178.0, -172.0, 4.0, 15.0, -198.0, -578.0, 0.0, 0.0, -1.0, -10.0, -200.0, 0.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, -400.0, -396.0, 0.0, -349.0, 11.0, 0.0, 7.0, -362.0, 12.0, 6.0, 0.0, 0.0, 1.0, -20.0, 0.0, 0.0, 0.0, -14.0, 7.0, 14.0, -341.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 8.0, -390.0, 0.0, 15.0, 0.0, 0.0, 10.0, 0.0, -20.0, -8.0, 0.0, 0.0, 0.0, -397.0, 0.0, -400.0, 0.0, 1.0, 0.0, 0.0, -15.0, 10.0, -20.0, -400.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 0.0, 10.0, -400.0, 5.0, -400.0, -20.0, -373.0, 0.0, 13.0, 13.0, -390.0, -347.0, -376.0, 15.0, 15.0, 4.0, -17.0, 0.0, 0.0, 0.0, -5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 0.0, -4.0, -34.0, -12.0, 0.0, -9.0, 0.0, -20.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 9.0, 14.0, -353.0, -362.0, 0.0, 0.0, 3.0, -396.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, -20.0, 15.0, -18.0, 4.0, 4.0, -20.0, -16.0, 10.0, -8.0, 0.0, -372.0, 0.0, -400.0, -378.0, 0.0, -2.0, 5.0, 0.0, 0.0, 0.0, -21.0, 15.0, -8.0, 0.0, -20.0, -15.0, 0.0, 5.0, -400.0, 0.0, 0.0, -358.0, -351.0, 15.0, 6.0, -12.0, 0.0, -16.0, -12.0, -382.0, -391.0, -6.0, 0.0, 0.0, 0.0, -374.0, 9.0, 0.0, -357.0, 4.0, 0.0, 0.0, 15.0, -396.0, 0.0, -378.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -400.0, 0.0, 0.0, 0.0, -4.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 3.0, 182.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 199.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 10.0, 200.0, 0.0, 191.0, 0.0, 0.0, 195.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 16.0, 10.0, 0.0, 6.0, 5.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 0.0, 186.0, 0.0, 200.0, 0.0, 192.0, 7.0, 0.0, 0.0, 0.0, 4.0, 10.0, 7.0, 10.0, 0.0, 10.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 4.0, 6.0, 18.0, 0.0, 197.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 187.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 194.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.893188892299849, "mean_inference_ms": 2.317664805913927, "mean_action_processing_ms": 0.41909885590825996, "mean_env_wait_ms": 0.31293616578464306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006816506385803223, "StateBufferConnector_ms": 0.0051985979080200195, "ViewRequirementAgentConnector_ms": 0.11311984062194824}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -74.67, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.1230812954622, "num_env_steps_trained_throughput_per_sec": 344.1230812954622, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 10983.021, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10982.972, "sample_time_ms": 1529.881, "learn_time_ms": 9436.924, "learn_throughput": 423.867, "synch_weights_time_ms": 13.287}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "f1691_00000", "date": "2024-08-13_17-09-13", "timestamp": 1723583353, "time_this_iter_s": 11.666072845458984, "time_total_s": 1842.4368333816528, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c6c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1842.4368333816528, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 50.22941176470588, "ram_util_percent": 83.50588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.15152574144698, "cur_kl_coeff": 6.927618187665941, "cur_lr": 0.009999999999999998, "total_loss": 1.8683403517203356, "policy_loss": 0.0008189214115085267, "vf_loss": 1.8457296357583748, "vf_explained_var": 0.014636382823267942, "kl": 0.003145639784255429, "entropy": 0.006450139699608799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0824215036582294, "cur_kl_coeff": 2.3711501512257975e-17, "cur_lr": 0.009999999999999998, "total_loss": 1.67965195625232, "policy_loss": 4.994593063004749e-05, "vf_loss": 1.6796020165322318, "vf_explained_var": -1.2930108125878389e-08, "kl": -3.809856986377256e-12, "entropy": 8.454462629804726e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -72.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -65.945, "predator_policy": 29.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 1.0, 0.0, -198.0, -200.0, 1.0, -5.0, 0.0, -600.0, 15.0, 0.0, 0.0, 15.0, -4.0, 10.0, -195.0, -210.0, -182.0, 26.0, -542.0, -173.0, 19.0, -7.0, 0.0, 4.0, 5.0, 0.0, 15.0, 15.0, 0.0, 11.0, -20.0, -3.0, -5.0, 8.0, 0.0, 15.0, 23.0, -532.0, 0.0, -195.0, -200.0, -8.0, 0.0, 5.0, 0.0, -7.0, 6.0, 8.0, -18.0, 6.0, -186.0, -200.0, -186.0, 10.0, 0.0, -7.0, 24.0, -10.0, -5.0, -192.0, 0.0, -526.0, 21.0, -2.0, -10.0, -576.0, -3.0, 0.0, -178.0, -172.0, 4.0, 15.0, -198.0, -578.0, 0.0, 0.0, -1.0, -10.0, -200.0, 0.0, -2.0, 17.0, -183.0, -14.0, -389.0, 3.0, 15.0, -13.0, -12.0, -186.0, -6.0, -1.0, -179.0, 0.0, 13.0, 7.0, 0.0, -3.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -20.0, -8.0, 0.0, 0.0, 0.0, -397.0, 0.0, -400.0, 0.0, 1.0, 0.0, 0.0, -15.0, 10.0, -20.0, -400.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 0.0, 10.0, -400.0, 5.0, -400.0, -20.0, -373.0, 0.0, 13.0, 13.0, -390.0, -347.0, -376.0, 15.0, 15.0, 4.0, -17.0, 0.0, 0.0, 0.0, -5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 0.0, -4.0, -34.0, -12.0, 0.0, -9.0, 0.0, -20.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 9.0, 14.0, -353.0, -362.0, 0.0, 0.0, 3.0, -396.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, -20.0, 15.0, -18.0, 4.0, 4.0, -20.0, -16.0, 10.0, -8.0, 0.0, -372.0, 0.0, -400.0, -378.0, 0.0, -2.0, 5.0, 0.0, 0.0, 0.0, -21.0, 15.0, -8.0, 0.0, -20.0, -15.0, 0.0, 5.0, -400.0, 0.0, 0.0, -358.0, -351.0, 15.0, 6.0, -12.0, 0.0, -16.0, -12.0, -382.0, -391.0, -6.0, 0.0, 0.0, 0.0, -374.0, 9.0, 0.0, -357.0, 4.0, 0.0, 0.0, 15.0, -396.0, 0.0, -378.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -400.0, 0.0, 0.0, 0.0, -4.0, 0.0, 2.0, 15.0, 9.0, -388.0, -28.0, 0.0, -378.0, -400.0, 0.0, 3.0, 0.0, 15.0, -20.0, -6.0, -20.0, -4.0, -372.0, 0.0, 0.0, -26.0, 0.0, -10.0, -374.0, 8.0, 0.0, 0.0, 15.0, -372.0, 0.0, -2.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 199.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 10.0, 200.0, 0.0, 191.0, 0.0, 0.0, 195.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 16.0, 10.0, 0.0, 6.0, 5.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 0.0, 186.0, 0.0, 200.0, 0.0, 192.0, 7.0, 0.0, 0.0, 0.0, 4.0, 10.0, 7.0, 10.0, 0.0, 10.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 4.0, 6.0, 18.0, 0.0, 197.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 187.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 194.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 3.0, 4.0, 10.0, 200.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 2.0, 10.0, 0.0, 186.0, 10.0, 10.0, 4.0, 5.0, 177.0, 10.0, 0.0, 0.0, 186.0, 184.0, 7.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8920346424516444, "mean_inference_ms": 2.315006423735141, "mean_action_processing_ms": 0.4176154264510367, "mean_env_wait_ms": 0.31260993464144976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006087064743041992, "StateBufferConnector_ms": 0.006096243858337402, "ViewRequirementAgentConnector_ms": 0.11803066730499268}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -72.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.70989985884404, "num_env_steps_trained_throughput_per_sec": 350.70989985884404, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 11152.262, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11152.211, "sample_time_ms": 1573.811, "learn_time_ms": 9561.122, "learn_throughput": 418.361, "synch_weights_time_ms": 13.903}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "f1691_00000", "date": "2024-08-13_17-09-25", "timestamp": 1723583365, "time_this_iter_s": 11.460169315338135, "time_total_s": 1853.897002696991, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3deb160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1853.897002696991, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 49.0125, "ram_util_percent": 83.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3293173859260543, "cur_kl_coeff": 3.4638090938329706, "cur_lr": 0.009999999999999998, "total_loss": 0.9637376918048455, "policy_loss": 0.001147737741105692, "vf_loss": 0.9390891768077694, "vf_explained_var": 0.0013954261307993893, "kl": 0.00678466311735545, "entropy": 0.00451515053539773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.347316916569422, "cur_kl_coeff": 1.1855750756128987e-17, "cur_lr": 0.009999999999999998, "total_loss": 1.2755595029188842, "policy_loss": -2.2937822347832104e-05, "vf_loss": 1.2755824395430782, "vf_explained_var": -8.483412404539724e-09, "kl": 2.993221267981981e-12, "entropy": 8.277384831407284e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -594.0, "episode_reward_mean": -59.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -54.545, "predator_policy": 25.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 0.0, 4.0, 5.0, 0.0, 15.0, 15.0, 0.0, 11.0, -20.0, -3.0, -5.0, 8.0, 0.0, 15.0, 23.0, -532.0, 0.0, -195.0, -200.0, -8.0, 0.0, 5.0, 0.0, -7.0, 6.0, 8.0, -18.0, 6.0, -186.0, -200.0, -186.0, 10.0, 0.0, -7.0, 24.0, -10.0, -5.0, -192.0, 0.0, -526.0, 21.0, -2.0, -10.0, -576.0, -3.0, 0.0, -178.0, -172.0, 4.0, 15.0, -198.0, -578.0, 0.0, 0.0, -1.0, -10.0, -200.0, 0.0, -2.0, 17.0, -183.0, -14.0, -389.0, 3.0, 15.0, -13.0, -12.0, -186.0, -6.0, -1.0, -179.0, 0.0, 13.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, -594.0, 0.0, -182.0, 0.0, -10.0, -184.0, 8.0, -1.0, 13.0, 3.0, 0.0, -2.0, 15.0, 1.0, 8.0, -2.0, 0.0, -8.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.0, 0.0, 0.0, 0.0, -5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 0.0, -4.0, -34.0, -12.0, 0.0, -9.0, 0.0, -20.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 9.0, 14.0, -353.0, -362.0, 0.0, 0.0, 3.0, -396.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, -20.0, 15.0, -18.0, 4.0, 4.0, -20.0, -16.0, 10.0, -8.0, 0.0, -372.0, 0.0, -400.0, -378.0, 0.0, -2.0, 5.0, 0.0, 0.0, 0.0, -21.0, 15.0, -8.0, 0.0, -20.0, -15.0, 0.0, 5.0, -400.0, 0.0, 0.0, -358.0, -351.0, 15.0, 6.0, -12.0, 0.0, -16.0, -12.0, -382.0, -391.0, -6.0, 0.0, 0.0, 0.0, -374.0, 9.0, 0.0, -357.0, 4.0, 0.0, 0.0, 15.0, -396.0, 0.0, -378.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -400.0, 0.0, 0.0, 0.0, -4.0, 0.0, 2.0, 15.0, 9.0, -388.0, -28.0, 0.0, -378.0, -400.0, 0.0, 3.0, 0.0, 15.0, -20.0, -6.0, -20.0, -4.0, -372.0, 0.0, 0.0, -26.0, 0.0, -10.0, -374.0, 8.0, 0.0, 0.0, 15.0, -372.0, 0.0, -2.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -397.0, -396.0, 0.0, 0.0, -373.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -368.0, 8.0, 0.0, 0.0, -2.0, 11.0, 2.0, 8.0, -15.0, 0.0, 0.0, 2.0, -8.0, 15.0, 0.0, -32.0, 15.0, 0.0, -1.0, -5.0, -6.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 16.0, 10.0, 0.0, 6.0, 5.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 0.0, 186.0, 0.0, 200.0, 0.0, 192.0, 7.0, 0.0, 0.0, 0.0, 4.0, 10.0, 7.0, 10.0, 0.0, 10.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 4.0, 6.0, 18.0, 0.0, 197.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 187.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 194.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 3.0, 4.0, 10.0, 200.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 2.0, 10.0, 0.0, 186.0, 10.0, 10.0, 4.0, 5.0, 177.0, 10.0, 0.0, 0.0, 186.0, 184.0, 7.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 10.0, 184.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 10.0, 3.0, 6.0, 6.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.890436493695083, "mean_inference_ms": 2.314237749623816, "mean_action_processing_ms": 0.416560758918273, "mean_env_wait_ms": 0.31213546735274833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006695747375488281, "StateBufferConnector_ms": 0.006204009056091309, "ViewRequirementAgentConnector_ms": 0.13014507293701172}, "num_episodes": 22, "episode_return_max": 24.0, "episode_return_min": -594.0, "episode_return_mean": -59.08, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.5222884985358, "num_env_steps_trained_throughput_per_sec": 343.5222884985358, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 11299.06, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11299.009, "sample_time_ms": 1552.357, "learn_time_ms": 9728.829, "learn_throughput": 411.149, "synch_weights_time_ms": 14.213}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "f1691_00000", "date": "2024-08-13_17-09-37", "timestamp": 1723583377, "time_this_iter_s": 11.690442085266113, "time_total_s": 1865.587444782257, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e07820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.587444782257, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 47.756249999999994, "ram_util_percent": 82.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1568121925351167, "cur_kl_coeff": 3.4638090938329706, "cur_lr": 0.009999999999999998, "total_loss": 1.6455077913387743, "policy_loss": -0.0002487191164166366, "vf_loss": 1.6453552968602962, "vf_explained_var": 0.0025437358195188817, "kl": 0.00011582886668216872, "entropy": 0.004162663433678626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9808279811403104, "cur_kl_coeff": 5.927875378064494e-18, "cur_lr": 0.009999999999999998, "total_loss": 1.9663252510406353, "policy_loss": -0.0001957091316827154, "vf_loss": 1.9665209540929744, "vf_explained_var": -7.158864742864377e-09, "kl": 6.369648115828529e-12, "entropy": 8.188465597526531e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -594.0, "episode_reward_mean": -69.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -64.515, "predator_policy": 29.745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.0, -200.0, -8.0, 0.0, 5.0, 0.0, -7.0, 6.0, 8.0, -18.0, 6.0, -186.0, -200.0, -186.0, 10.0, 0.0, -7.0, 24.0, -10.0, -5.0, -192.0, 0.0, -526.0, 21.0, -2.0, -10.0, -576.0, -3.0, 0.0, -178.0, -172.0, 4.0, 15.0, -198.0, -578.0, 0.0, 0.0, -1.0, -10.0, -200.0, 0.0, -2.0, 17.0, -183.0, -14.0, -389.0, 3.0, 15.0, -13.0, -12.0, -186.0, -6.0, -1.0, -179.0, 0.0, 13.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, -594.0, 0.0, -182.0, 0.0, -10.0, -184.0, 8.0, -1.0, 13.0, 3.0, 0.0, -2.0, 15.0, 1.0, 8.0, -2.0, 0.0, -8.0, 0.0, 0.0, 0.0, -582.0, 0.0, -16.0, 0.0, 15.0, 14.0, 10.0, 0.0, -198.0, -191.0, -20.0, 0.0, -4.0, 0.0, -360.0, 15.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, -396.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, -20.0, 15.0, -18.0, 4.0, 4.0, -20.0, -16.0, 10.0, -8.0, 0.0, -372.0, 0.0, -400.0, -378.0, 0.0, -2.0, 5.0, 0.0, 0.0, 0.0, -21.0, 15.0, -8.0, 0.0, -20.0, -15.0, 0.0, 5.0, -400.0, 0.0, 0.0, -358.0, -351.0, 15.0, 6.0, -12.0, 0.0, -16.0, -12.0, -382.0, -391.0, -6.0, 0.0, 0.0, 0.0, -374.0, 9.0, 0.0, -357.0, 4.0, 0.0, 0.0, 15.0, -396.0, 0.0, -378.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -400.0, 0.0, 0.0, 0.0, -4.0, 0.0, 2.0, 15.0, 9.0, -388.0, -28.0, 0.0, -378.0, -400.0, 0.0, 3.0, 0.0, 15.0, -20.0, -6.0, -20.0, -4.0, -372.0, 0.0, 0.0, -26.0, 0.0, -10.0, -374.0, 8.0, 0.0, 0.0, 15.0, -372.0, 0.0, -2.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -397.0, -396.0, 0.0, 0.0, -373.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -368.0, 8.0, 0.0, 0.0, -2.0, 11.0, 2.0, 8.0, -15.0, 0.0, 0.0, 2.0, -8.0, 15.0, 0.0, -32.0, 15.0, 0.0, -1.0, -5.0, -6.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -400.0, 0.0, 0.0, -18.0, -16.0, 0.0, 0.0, 0.0, 15.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, -396.0, 0.0, 0.0, -382.0, -20.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -362.0, -391.0, 0.0, 15.0, 0.0, -400.0], "policy_predator_policy_reward": [198.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 4.0, 0.0, 0.0, 186.0, 0.0, 200.0, 0.0, 192.0, 7.0, 0.0, 0.0, 0.0, 4.0, 10.0, 7.0, 10.0, 0.0, 10.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 4.0, 6.0, 18.0, 0.0, 197.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 187.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 194.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 3.0, 4.0, 10.0, 200.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 2.0, 10.0, 0.0, 186.0, 10.0, 10.0, 4.0, 5.0, 177.0, 10.0, 0.0, 0.0, 186.0, 184.0, 7.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 10.0, 184.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 10.0, 3.0, 6.0, 6.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 191.0, 0.0, 12.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 196.0, 197.0, 0.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8890783589765815, "mean_inference_ms": 2.313196520030516, "mean_action_processing_ms": 0.41564461043499507, "mean_env_wait_ms": 0.31165515210672756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00623929500579834, "StateBufferConnector_ms": 0.006181001663208008, "ViewRequirementAgentConnector_ms": 0.1391831636428833}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -594.0, "episode_return_mean": -69.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.1038931864778, "num_env_steps_trained_throughput_per_sec": 347.1038931864778, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 11396.861, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11396.806, "sample_time_ms": 1546.695, "learn_time_ms": 9829.567, "learn_throughput": 406.936, "synch_weights_time_ms": 16.764}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "f1691_00000", "date": "2024-08-13_17-09-48", "timestamp": 1723583388, "time_this_iter_s": 11.54478907585144, "time_total_s": 1877.1322338581085, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3c6c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1877.1322338581085, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 48.60588235294117, "ram_util_percent": 82.92941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.43329912271528, "cur_kl_coeff": 1.7319045469164853, "cur_lr": 0.009999999999999998, "total_loss": 1.2158508884212957, "policy_loss": 0.008994799478856659, "vf_loss": 1.1614063263097136, "vf_explained_var": 0.0030555303765352443, "kl": 0.026242650861023217, "entropy": 0.016032929796721065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2896200805807316, "cur_kl_coeff": 2.963937689032247e-18, "cur_lr": 0.009999999999999998, "total_loss": 1.2904595355508188, "policy_loss": -1.3171699361274482e-05, "vf_loss": 1.2904727051655451, "vf_explained_var": -1.0438697047965237e-08, "kl": -1.8627965014994487e-12, "entropy": 8.048872756536417e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -594.0, "episode_reward_mean": -63.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -58.195, "predator_policy": 26.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -5.0, -192.0, 0.0, -526.0, 21.0, -2.0, -10.0, -576.0, -3.0, 0.0, -178.0, -172.0, 4.0, 15.0, -198.0, -578.0, 0.0, 0.0, -1.0, -10.0, -200.0, 0.0, -2.0, 17.0, -183.0, -14.0, -389.0, 3.0, 15.0, -13.0, -12.0, -186.0, -6.0, -1.0, -179.0, 0.0, 13.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, -594.0, 0.0, -182.0, 0.0, -10.0, -184.0, 8.0, -1.0, 13.0, 3.0, 0.0, -2.0, 15.0, 1.0, 8.0, -2.0, 0.0, -8.0, 0.0, 0.0, 0.0, -582.0, 0.0, -16.0, 0.0, 15.0, 14.0, 10.0, 0.0, -198.0, -191.0, -20.0, 0.0, -4.0, 0.0, -360.0, 15.0, -200.0, -3.0, 5.0, 0.0, -192.0, 15.0, 14.0, -1.0, 0.0, 0.0, 8.0, -182.0, -4.0, 0.0, 15.0, 0.0, 4.0, 7.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -20.0, -15.0, 0.0, 5.0, -400.0, 0.0, 0.0, -358.0, -351.0, 15.0, 6.0, -12.0, 0.0, -16.0, -12.0, -382.0, -391.0, -6.0, 0.0, 0.0, 0.0, -374.0, 9.0, 0.0, -357.0, 4.0, 0.0, 0.0, 15.0, -396.0, 0.0, -378.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -400.0, 0.0, 0.0, 0.0, -4.0, 0.0, 2.0, 15.0, 9.0, -388.0, -28.0, 0.0, -378.0, -400.0, 0.0, 3.0, 0.0, 15.0, -20.0, -6.0, -20.0, -4.0, -372.0, 0.0, 0.0, -26.0, 0.0, -10.0, -374.0, 8.0, 0.0, 0.0, 15.0, -372.0, 0.0, -2.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -397.0, -396.0, 0.0, 0.0, -373.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -368.0, 8.0, 0.0, 0.0, -2.0, 11.0, 2.0, 8.0, -15.0, 0.0, 0.0, 2.0, -8.0, 15.0, 0.0, -32.0, 15.0, 0.0, -1.0, -5.0, -6.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -400.0, 0.0, 0.0, -18.0, -16.0, 0.0, 0.0, 0.0, 15.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, -396.0, 0.0, 0.0, -382.0, -20.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -362.0, -391.0, 0.0, 15.0, 0.0, -400.0, -21.0, 0.0, -13.0, 8.0, 0.0, 0.0, 0.0, -388.0, 0.0, 15.0, 0.0, 14.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, -14.0, 0.0, -364.0, 6.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 7.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 4.0, 6.0, 18.0, 0.0, 197.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 187.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 194.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 3.0, 4.0, 10.0, 200.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 2.0, 10.0, 0.0, 186.0, 10.0, 10.0, 4.0, 5.0, 177.0, 10.0, 0.0, 0.0, 186.0, 184.0, 7.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 10.0, 184.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 10.0, 3.0, 6.0, 6.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 191.0, 0.0, 12.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 196.0, 197.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 182.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8878187575822476, "mean_inference_ms": 2.3121564515261213, "mean_action_processing_ms": 0.4147170575907559, "mean_env_wait_ms": 0.31116267107318335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005495905876159668, "StateBufferConnector_ms": 0.005475401878356934, "ViewRequirementAgentConnector_ms": 0.14154112339019775}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -594.0, "episode_return_mean": -63.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.49133498016175, "num_env_steps_trained_throughput_per_sec": 365.49133498016175, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 11481.365, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11481.31, "sample_time_ms": 1589.879, "learn_time_ms": 9870.757, "learn_throughput": 405.237, "synch_weights_time_ms": 16.927}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "f1691_00000", "date": "2024-08-13_17-09-59", "timestamp": 1723583399, "time_this_iter_s": 10.980288982391357, "time_total_s": 1888.1125228404999, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3debc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1888.1125228404999, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 41.28666666666667, "ram_util_percent": 83.31333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.350167445264875, "cur_kl_coeff": 2.5978568203747274, "cur_lr": 0.009999999999999998, "total_loss": 1.1226013115474156, "policy_loss": -0.00019851914661192388, "vf_loss": 1.1226718429062101, "vf_explained_var": 0.003243671460126443, "kl": 4.926681946952388e-05, "entropy": 0.0023593427136013156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3489723748093834, "cur_kl_coeff": 1.4819688445161234e-18, "cur_lr": 0.009999999999999998, "total_loss": 1.2570483919016269, "policy_loss": 9.415911303626167e-05, "vf_loss": 1.2569542256297257, "vf_explained_var": -7.2219384410393934e-09, "kl": 6.289889355745077e-13, "entropy": 8.0265762605524e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -594.0, "episode_reward_mean": -49.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.505, "predator_policy": 25.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 17.0, -183.0, -14.0, -389.0, 3.0, 15.0, -13.0, -12.0, -186.0, -6.0, -1.0, -179.0, 0.0, 13.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, -594.0, 0.0, -182.0, 0.0, -10.0, -184.0, 8.0, -1.0, 13.0, 3.0, 0.0, -2.0, 15.0, 1.0, 8.0, -2.0, 0.0, -8.0, 0.0, 0.0, 0.0, -582.0, 0.0, -16.0, 0.0, 15.0, 14.0, 10.0, 0.0, -198.0, -191.0, -20.0, 0.0, -4.0, 0.0, -360.0, 15.0, -200.0, -3.0, 5.0, 0.0, -192.0, 15.0, 14.0, -1.0, 0.0, 0.0, 8.0, -182.0, -4.0, 0.0, 15.0, 0.0, 4.0, 7.0, 7.0, -201.0, -17.0, -3.0, 5.0, -179.0, 1.0, 15.0, 0.0, 15.0, -583.0, 15.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, -369.0, 25.0, -3.0, 0.0, 8.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 0.0, 2.0, 15.0, 9.0, -388.0, -28.0, 0.0, -378.0, -400.0, 0.0, 3.0, 0.0, 15.0, -20.0, -6.0, -20.0, -4.0, -372.0, 0.0, 0.0, -26.0, 0.0, -10.0, -374.0, 8.0, 0.0, 0.0, 15.0, -372.0, 0.0, -2.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -397.0, -396.0, 0.0, 0.0, -373.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -368.0, 8.0, 0.0, 0.0, -2.0, 11.0, 2.0, 8.0, -15.0, 0.0, 0.0, 2.0, -8.0, 15.0, 0.0, -32.0, 15.0, 0.0, -1.0, -5.0, -6.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -400.0, 0.0, 0.0, -18.0, -16.0, 0.0, 0.0, 0.0, 15.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, -396.0, 0.0, 0.0, -382.0, -20.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -362.0, -391.0, 0.0, 15.0, 0.0, -400.0, -21.0, 0.0, -13.0, 8.0, 0.0, 0.0, 0.0, -388.0, 0.0, 15.0, 0.0, 14.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, -14.0, 0.0, -364.0, 6.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 7.0, 0.0, -398.0, -12.0, -38.0, 1.0, 0.0, -6.0, -20.0, 15.0, 3.0, -373.0, 1.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -390.0, -391.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 0.0, -4.0, -369.0, -378.0, 15.0, 10.0, -14.0, 0.0, 0.0, 0.0, 11.0, -382.0, 3.0, 11.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 193.0, 3.0, 4.0, 10.0, 200.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 2.0, 10.0, 0.0, 186.0, 10.0, 10.0, 4.0, 5.0, 177.0, 10.0, 0.0, 0.0, 186.0, 184.0, 7.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 10.0, 184.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 10.0, 3.0, 6.0, 6.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 191.0, 0.0, 12.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 196.0, 197.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 182.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 3.0, 0.0, 10.0, 0.0, 190.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 189.0, 189.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 188.0, 191.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8868128987229906, "mean_inference_ms": 2.3123297663172178, "mean_action_processing_ms": 0.4137158014228837, "mean_env_wait_ms": 0.31074921889036144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005391240119934082, "StateBufferConnector_ms": 0.0043010711669921875, "ViewRequirementAgentConnector_ms": 0.13844358921051025}, "num_episodes": 23, "episode_return_max": 25.0, "episode_return_min": -594.0, "episode_return_mean": -49.69, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.8651615450594, "num_env_steps_trained_throughput_per_sec": 332.8651615450594, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 11612.768, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11612.712, "sample_time_ms": 1742.571, "learn_time_ms": 9849.759, "learn_throughput": 406.101, "synch_weights_time_ms": 16.92}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "f1691_00000", "date": "2024-08-13_17-10-11", "timestamp": 1723583411, "time_this_iter_s": 12.05872392654419, "time_total_s": 1900.171246767044, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3debb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1900.171246767044, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 46.44117647058823, "ram_util_percent": 83.23529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.17707958964424, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 0.009999999999999998, "total_loss": 1.1619434724093745, "policy_loss": 0.0008159612973156587, "vf_loss": 1.1588490766507609, "vf_explained_var": 0.0014142416772388276, "kl": 0.0017540870340167851, "entropy": 0.0027504295048687622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4949938334487674, "cur_kl_coeff": 7.409844222580617e-19, "cur_lr": 0.009999999999999998, "total_loss": 1.3675463956972909, "policy_loss": 5.340455198492953e-06, "vf_loss": 1.367541050737497, "vf_explained_var": -7.694991177352017e-09, "kl": -2.934196566533545e-12, "entropy": 7.980163520704644e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -583.0, "episode_reward_mean": -40.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.765, "predator_policy": 21.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -182.0, 0.0, -10.0, -184.0, 8.0, -1.0, 13.0, 3.0, 0.0, -2.0, 15.0, 1.0, 8.0, -2.0, 0.0, -8.0, 0.0, 0.0, 0.0, -582.0, 0.0, -16.0, 0.0, 15.0, 14.0, 10.0, 0.0, -198.0, -191.0, -20.0, 0.0, -4.0, 0.0, -360.0, 15.0, -200.0, -3.0, 5.0, 0.0, -192.0, 15.0, 14.0, -1.0, 0.0, 0.0, 8.0, -182.0, -4.0, 0.0, 15.0, 0.0, 4.0, 7.0, 7.0, -201.0, -17.0, -3.0, 5.0, -179.0, 1.0, 15.0, 0.0, 15.0, -583.0, 15.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, -369.0, 25.0, -3.0, 0.0, 8.0, 14.0, -10.0, 15.0, -169.0, -2.0, 15.0, 30.0, -6.0, -1.0, 13.0, 0.0, 8.0, 8.0, 5.0, 2.0, 21.0, 1.0, 0.0, -192.0, 0.0, -343.0, 15.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -373.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -368.0, 8.0, 0.0, 0.0, -2.0, 11.0, 2.0, 8.0, -15.0, 0.0, 0.0, 2.0, -8.0, 15.0, 0.0, -32.0, 15.0, 0.0, -1.0, -5.0, -6.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -400.0, 0.0, 0.0, -18.0, -16.0, 0.0, 0.0, 0.0, 15.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, -396.0, 0.0, 0.0, -382.0, -20.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -362.0, -391.0, 0.0, 15.0, 0.0, -400.0, -21.0, 0.0, -13.0, 8.0, 0.0, 0.0, 0.0, -388.0, 0.0, 15.0, 0.0, 14.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, -14.0, 0.0, -364.0, 6.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 7.0, 0.0, -398.0, -12.0, -38.0, 1.0, 0.0, -6.0, -20.0, 15.0, 3.0, -373.0, 1.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -390.0, -391.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 0.0, -4.0, -369.0, -378.0, 15.0, 10.0, -14.0, 0.0, 0.0, 0.0, 11.0, -382.0, 3.0, 11.0, -20.0, 0.0, 15.0, 0.0, 0.0, -351.0, -4.0, 0.0, 15.0, 0.0, 15.0, 15.0, -12.0, 0.0, 15.0, -36.0, 0.0, 13.0, 0.0, 0.0, -14.0, 15.0, 0.0, 8.0, 5.0, 0.0, 0.0, 2.0, 12.0, 9.0, 0.0, -1.0, 0.0, 0.0, 1.0, -386.0, 0.0, 0.0, -347.0, -382.0, 0.0, 15.0, 0.0, 8.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 10.0, 184.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 10.0, 3.0, 6.0, 6.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 191.0, 0.0, 12.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 196.0, 197.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 182.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 3.0, 0.0, 10.0, 0.0, 190.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 189.0, 189.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 188.0, 191.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 192.0, 194.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8860484744417321, "mean_inference_ms": 2.313458633337276, "mean_action_processing_ms": 0.41275320217745703, "mean_env_wait_ms": 0.310391239540718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005332827568054199, "StateBufferConnector_ms": 0.003419637680053711, "ViewRequirementAgentConnector_ms": 0.12496757507324219}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -583.0, "episode_return_mean": -40.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.571051913869, "num_env_steps_trained_throughput_per_sec": 360.571051913869, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 11507.23, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11507.177, "sample_time_ms": 1721.011, "learn_time_ms": 9766.218, "learn_throughput": 409.575, "synch_weights_time_ms": 16.744}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "f1691_00000", "date": "2024-08-13_17-10-23", "timestamp": 1723583423, "time_this_iter_s": 11.149492025375366, "time_total_s": 1911.3207387924194, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3df21f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1911.3207387924194, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 48.9, "ram_util_percent": 83.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2022188622396066, "cur_kl_coeff": 0.6494642050936819, "cur_lr": 0.009999999999999998, "total_loss": 0.37149743132648017, "policy_loss": 0.00010123044503704897, "vf_loss": 0.3713917647708619, "vf_explained_var": 0.059803529832728956, "kl": 6.830761651461474e-06, "entropy": 0.000246984782991666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4398962392348538, "cur_kl_coeff": 3.7049221112903085e-19, "cur_lr": 0.009999999999999998, "total_loss": 0.5196310054836055, "policy_loss": -8.334814738383684e-05, "vf_loss": 0.519714357251198, "vf_explained_var": 9.600447599219267e-07, "kl": 3.8662959008767955e-12, "entropy": 7.854877367001475e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -583.0, "episode_reward_mean": -38.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.83, "predator_policy": 20.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -582.0, 0.0, -16.0, 0.0, 15.0, 14.0, 10.0, 0.0, -198.0, -191.0, -20.0, 0.0, -4.0, 0.0, -360.0, 15.0, -200.0, -3.0, 5.0, 0.0, -192.0, 15.0, 14.0, -1.0, 0.0, 0.0, 8.0, -182.0, -4.0, 0.0, 15.0, 0.0, 4.0, 7.0, 7.0, -201.0, -17.0, -3.0, 5.0, -179.0, 1.0, 15.0, 0.0, 15.0, -583.0, 15.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, -369.0, 25.0, -3.0, 0.0, 8.0, 14.0, -10.0, 15.0, -169.0, -2.0, 15.0, 30.0, -6.0, -1.0, 13.0, 0.0, 8.0, 8.0, 5.0, 2.0, 21.0, 1.0, 0.0, -192.0, 0.0, -343.0, 15.0, 8.0, 15.0, -1.0, 0.0, -8.0, -10.0, 0.0, 24.0, 3.0, -3.0, -10.0, 0.0, -10.0, 9.0, 0.0, 11.0, 0.0, -174.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -382.0, -400.0, 0.0, 0.0, -18.0, -16.0, 0.0, 0.0, 0.0, 15.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, -396.0, 0.0, 0.0, -382.0, -20.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -362.0, -391.0, 0.0, 15.0, 0.0, -400.0, -21.0, 0.0, -13.0, 8.0, 0.0, 0.0, 0.0, -388.0, 0.0, 15.0, 0.0, 14.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, -14.0, 0.0, -364.0, 6.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 7.0, 0.0, -398.0, -12.0, -38.0, 1.0, 0.0, -6.0, -20.0, 15.0, 3.0, -373.0, 1.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -390.0, -391.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 0.0, -4.0, -369.0, -378.0, 15.0, 10.0, -14.0, 0.0, 0.0, 0.0, 11.0, -382.0, 3.0, 11.0, -20.0, 0.0, 15.0, 0.0, 0.0, -351.0, -4.0, 0.0, 15.0, 0.0, 15.0, 15.0, -12.0, 0.0, 15.0, -36.0, 0.0, 13.0, 0.0, 0.0, -14.0, 15.0, 0.0, 8.0, 5.0, 0.0, 0.0, 2.0, 12.0, 9.0, 0.0, -1.0, 0.0, 0.0, 1.0, -386.0, 0.0, 0.0, -347.0, -382.0, 0.0, 15.0, 0.0, 8.0, 0.0, 15.0, 0.0, -11.0, 0.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -360.0, 9.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 191.0, 0.0, 12.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 196.0, 197.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 182.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 3.0, 0.0, 10.0, 0.0, 190.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 189.0, 189.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 188.0, 191.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 192.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 5.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8853062059301183, "mean_inference_ms": 2.3128320444360497, "mean_action_processing_ms": 0.41207292697060566, "mean_env_wait_ms": 0.3101283333748105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004124641418457031, "StateBufferConnector_ms": 0.0038483142852783203, "ViewRequirementAgentConnector_ms": 0.11745274066925049}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -583.0, "episode_return_mean": -38.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.46302219616376, "num_env_steps_trained_throughput_per_sec": 351.46302219616376, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 11497.506, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11497.454, "sample_time_ms": 1738.241, "learn_time_ms": 9737.934, "learn_throughput": 410.765, "synch_weights_time_ms": 17.655}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "f1691_00000", "date": "2024-08-13_17-10-34", "timestamp": 1723583434, "time_this_iter_s": 11.424782991409302, "time_total_s": 1922.7455217838287, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3df2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1922.7455217838287, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 48.45, "ram_util_percent": 83.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.25523253553818, "cur_kl_coeff": 0.32473210254684093, "cur_lr": 0.009999999999999998, "total_loss": 1.1258231939777494, "policy_loss": 0.0002629173655930177, "vf_loss": 1.125483711032325, "vf_explained_var": 0.01773521171675788, "kl": 0.00023577294035373147, "entropy": 0.0005385039466971878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2256063438219598, "cur_kl_coeff": 1.8524610556451543e-19, "cur_lr": 0.009999999999999998, "total_loss": 1.6959142888506884, "policy_loss": -8.445052262494173e-05, "vf_loss": 1.6959987404485228, "vf_explained_var": -9.240296782639923e-09, "kl": 2.408109711309437e-12, "entropy": 7.711960497598464e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -583.0, "episode_reward_mean": -39.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.615, "predator_policy": 19.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.0, -3.0, 5.0, 0.0, -192.0, 15.0, 14.0, -1.0, 0.0, 0.0, 8.0, -182.0, -4.0, 0.0, 15.0, 0.0, 4.0, 7.0, 7.0, -201.0, -17.0, -3.0, 5.0, -179.0, 1.0, 15.0, 0.0, 15.0, -583.0, 15.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, -369.0, 25.0, -3.0, 0.0, 8.0, 14.0, -10.0, 15.0, -169.0, -2.0, 15.0, 30.0, -6.0, -1.0, 13.0, 0.0, 8.0, 8.0, 5.0, 2.0, 21.0, 1.0, 0.0, -192.0, 0.0, -343.0, 15.0, 8.0, 15.0, -1.0, 0.0, -8.0, -10.0, 0.0, 24.0, 3.0, -3.0, -10.0, 0.0, -10.0, 9.0, 0.0, 11.0, 0.0, -174.0, 9.0, -6.0, -549.0, -2.0, -200.0, 0.0, -2.0, -534.0, 0.0, 5.0, 2.0, -4.0, -8.0, 15.0, -197.0, 1.0, 15.0, 0.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -400.0, -21.0, 0.0, -13.0, 8.0, 0.0, 0.0, 0.0, -388.0, 0.0, 15.0, 0.0, 14.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, -14.0, 0.0, -364.0, 6.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 7.0, 0.0, -398.0, -12.0, -38.0, 1.0, 0.0, -6.0, -20.0, 15.0, 3.0, -373.0, 1.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -390.0, -391.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 0.0, -4.0, -369.0, -378.0, 15.0, 10.0, -14.0, 0.0, 0.0, 0.0, 11.0, -382.0, 3.0, 11.0, -20.0, 0.0, 15.0, 0.0, 0.0, -351.0, -4.0, 0.0, 15.0, 0.0, 15.0, 15.0, -12.0, 0.0, 15.0, -36.0, 0.0, 13.0, 0.0, 0.0, -14.0, 15.0, 0.0, 8.0, 5.0, 0.0, 0.0, 2.0, 12.0, 9.0, 0.0, -1.0, 0.0, 0.0, 1.0, -386.0, 0.0, 0.0, -347.0, -382.0, 0.0, 15.0, 0.0, 8.0, 0.0, 15.0, 0.0, -11.0, 0.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -360.0, 9.0, 0.0, -20.0, 4.0, -354.0, -390.0, -4.0, 0.0, 0.0, -400.0, 0.0, 0.0, 1.0, -8.0, -357.0, -362.0, 0.0, 0.0, 3.0, 0.0, -20.0, 12.0, -14.0, 0.0, -18.0, 0.0, 0.0, 15.0, -394.0, 0.0, 6.0, -15.0, 9.0, 6.0, 0.0, 0.0, 10.0, 0.0], "policy_predator_policy_reward": [0.0, 200.0, 10.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 182.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 3.0, 0.0, 10.0, 0.0, 190.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 189.0, 189.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 188.0, 191.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 192.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 5.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 195.0, 0.0, 2.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8845279950148494, "mean_inference_ms": 2.3129653254070752, "mean_action_processing_ms": 0.4113219337951331, "mean_env_wait_ms": 0.3098377816047818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093170166015625, "StateBufferConnector_ms": 0.0037729740142822266, "ViewRequirementAgentConnector_ms": 0.1095724105834961}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -583.0, "episode_return_mean": -39.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.83670245432387, "num_env_steps_trained_throughput_per_sec": 350.83670245432387, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 11465.448, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11465.397, "sample_time_ms": 1701.06, "learn_time_ms": 9744.04, "learn_throughput": 410.507, "synch_weights_time_ms": 17.193}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "f1691_00000", "date": "2024-08-13_17-10-46", "timestamp": 1723583446, "time_this_iter_s": 11.459153890609741, "time_total_s": 1934.2046756744385, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3debf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1934.2046756744385, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 50.587500000000006, "ram_util_percent": 83.50625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2483189774499763, "cur_kl_coeff": 0.16236605127342046, "cur_lr": 0.009999999999999998, "total_loss": 0.8493397274660686, "policy_loss": -0.00015934630440025732, "vf_loss": 0.8493077703253933, "vf_explained_var": 0.0034562921397900456, "kl": 0.0011782141333309295, "entropy": 0.001802180961263855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.317975920388258, "cur_kl_coeff": 9.262305278225771e-20, "cur_lr": 0.009999999999999998, "total_loss": 0.9927918119996628, "policy_loss": 0.00037924022901625863, "vf_loss": 0.9924125753776737, "vf_explained_var": -5.361264344876405e-09, "kl": -3.788435248365051e-12, "entropy": 7.75080891743517e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -583.0, "episode_reward_mean": -36.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.04, "predator_policy": 18.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.0, 1.0, 15.0, 0.0, 15.0, -583.0, 15.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, -369.0, 25.0, -3.0, 0.0, 8.0, 14.0, -10.0, 15.0, -169.0, -2.0, 15.0, 30.0, -6.0, -1.0, 13.0, 0.0, 8.0, 8.0, 5.0, 2.0, 21.0, 1.0, 0.0, -192.0, 0.0, -343.0, 15.0, 8.0, 15.0, -1.0, 0.0, -8.0, -10.0, 0.0, 24.0, 3.0, -3.0, -10.0, 0.0, -10.0, 9.0, 0.0, 11.0, 0.0, -174.0, 9.0, -6.0, -549.0, -2.0, -200.0, 0.0, -2.0, -534.0, 0.0, 5.0, 2.0, -4.0, -8.0, 15.0, -197.0, 1.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, -1.0, 15.0, 0.0, -187.0, 15.0, 0.0, -195.0, 0.0, 30.0, 18.0, 0.0, 24.0, -200.0, -4.0, 4.0, 15.0, -2.0, 9.0, 0.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, -373.0, 1.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, -390.0, -391.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 0.0, -4.0, -369.0, -378.0, 15.0, 10.0, -14.0, 0.0, 0.0, 0.0, 11.0, -382.0, 3.0, 11.0, -20.0, 0.0, 15.0, 0.0, 0.0, -351.0, -4.0, 0.0, 15.0, 0.0, 15.0, 15.0, -12.0, 0.0, 15.0, -36.0, 0.0, 13.0, 0.0, 0.0, -14.0, 15.0, 0.0, 8.0, 5.0, 0.0, 0.0, 2.0, 12.0, 9.0, 0.0, -1.0, 0.0, 0.0, 1.0, -386.0, 0.0, 0.0, -347.0, -382.0, 0.0, 15.0, 0.0, 8.0, 0.0, 15.0, 0.0, -11.0, 0.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -360.0, 9.0, 0.0, -20.0, 4.0, -354.0, -390.0, -4.0, 0.0, 0.0, -400.0, 0.0, 0.0, 1.0, -8.0, -357.0, -362.0, 0.0, 0.0, 3.0, 0.0, -20.0, 12.0, -14.0, 0.0, -18.0, 0.0, 0.0, 15.0, -394.0, 0.0, 6.0, -15.0, 9.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, -374.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 15.0, 15.0, 10.0, 8.0, 0.0, 0.0, 9.0, 15.0, -400.0, 0.0, 0.0, -15.0, 8.0, -14.0, 15.0, 0.0, -8.0, 0.0, 0.0, 9.0, 0.0, 0.0, -18.0, 15.0], "policy_predator_policy_reward": [190.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 189.0, 189.0, 0.0, 0.0, 4.0, 7.0, 0.0, 0.0, 188.0, 191.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 192.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 5.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 195.0, 0.0, 2.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830601752176347, "mean_inference_ms": 2.314847601755705, "mean_action_processing_ms": 0.41092162837041185, "mean_env_wait_ms": 0.30938184821132386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004123091697692871, "StateBufferConnector_ms": 0.0037919282913208008, "ViewRequirementAgentConnector_ms": 0.10970497131347656}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -583.0, "episode_return_mean": -36.95, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.56352044510544, "num_env_steps_trained_throughput_per_sec": 355.56352044510544, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 11428.391, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11428.34, "sample_time_ms": 1702.498, "learn_time_ms": 9705.626, "learn_throughput": 412.132, "synch_weights_time_ms": 17.315}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "f1691_00000", "date": "2024-08-13_17-10-57", "timestamp": 1723583457, "time_this_iter_s": 11.291743993759155, "time_total_s": 1945.4964196681976, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3debee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1945.4964196681976, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 49.875, "ram_util_percent": 83.43124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2865885427221655, "cur_kl_coeff": 0.08118302563671023, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00645643550380276, "vf_loss": 0.9193481362764797, "vf_explained_var": 0.0010060905148743323, "kl": Infinity, "entropy": 9.278792435702948e-05, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2928830080498726, "cur_kl_coeff": 4.6311526391128857e-20, "cur_lr": 0.009999999999999998, "total_loss": 1.0873332487527656, "policy_loss": -0.00011637434388003337, "vf_loss": 1.0874496240464468, "vf_explained_var": -5.361264344876405e-09, "kl": 4.250837719544554e-12, "entropy": 7.758844246451092e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -549.0, "episode_reward_mean": -31.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.58, "predator_policy": 15.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, -10.0, 15.0, -169.0, -2.0, 15.0, 30.0, -6.0, -1.0, 13.0, 0.0, 8.0, 8.0, 5.0, 2.0, 21.0, 1.0, 0.0, -192.0, 0.0, -343.0, 15.0, 8.0, 15.0, -1.0, 0.0, -8.0, -10.0, 0.0, 24.0, 3.0, -3.0, -10.0, 0.0, -10.0, 9.0, 0.0, 11.0, 0.0, -174.0, 9.0, -6.0, -549.0, -2.0, -200.0, 0.0, -2.0, -534.0, 0.0, 5.0, 2.0, -4.0, -8.0, 15.0, -197.0, 1.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, -1.0, 15.0, 0.0, -187.0, 15.0, 0.0, -195.0, 0.0, 30.0, 18.0, 0.0, 24.0, -200.0, -4.0, 4.0, 15.0, -2.0, 9.0, 0.0, 6.0, 15.0, -3.0, 21.0, 0.0, 0.0, 15.0, -191.0, 15.0, -15.0, -8.0, -2.0, 0.0, -8.0, -172.0, 11.0, 0.0, -6.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 11.0, -20.0, 0.0, 15.0, 0.0, 0.0, -351.0, -4.0, 0.0, 15.0, 0.0, 15.0, 15.0, -12.0, 0.0, 15.0, -36.0, 0.0, 13.0, 0.0, 0.0, -14.0, 15.0, 0.0, 8.0, 5.0, 0.0, 0.0, 2.0, 12.0, 9.0, 0.0, -1.0, 0.0, 0.0, 1.0, -386.0, 0.0, 0.0, -347.0, -382.0, 0.0, 15.0, 0.0, 8.0, 0.0, 15.0, 0.0, -11.0, 0.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -360.0, 9.0, 0.0, -20.0, 4.0, -354.0, -390.0, -4.0, 0.0, 0.0, -400.0, 0.0, 0.0, 1.0, -8.0, -357.0, -362.0, 0.0, 0.0, 3.0, 0.0, -20.0, 12.0, -14.0, 0.0, -18.0, 0.0, 0.0, 15.0, -394.0, 0.0, 6.0, -15.0, 9.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, -374.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 15.0, 15.0, 10.0, 8.0, 0.0, 0.0, 9.0, 15.0, -400.0, 0.0, 0.0, -15.0, 8.0, -14.0, 15.0, 0.0, -8.0, 0.0, 0.0, 9.0, 0.0, 0.0, -18.0, 15.0, 0.0, 15.0, -6.0, 0.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -382.0, 0.0, 15.0, 0.0, -15.0, -20.0, -16.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -358.0, 11.0, 0.0, 0.0, 0.0, -14.0, 0.0, -400.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 192.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 5.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 195.0, 0.0, 2.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.881912345638982, "mean_inference_ms": 2.311681384477681, "mean_action_processing_ms": 0.40949176729971926, "mean_env_wait_ms": 0.30893767777692693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004239559173583984, "StateBufferConnector_ms": 0.004097342491149902, "ViewRequirementAgentConnector_ms": 0.11238694190979004}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -549.0, "episode_return_mean": -31.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.43200158171175, "num_env_steps_trained_throughput_per_sec": 352.43200158171175, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 11400.988, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11400.935, "sample_time_ms": 1678.41, "learn_time_ms": 9702.393, "learn_throughput": 412.269, "synch_weights_time_ms": 17.339}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "f1691_00000", "date": "2024-08-13_17-11-08", "timestamp": 1723583468, "time_this_iter_s": 11.40745496749878, "time_total_s": 1956.9038746356964, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3df2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1956.9038746356964, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 47.17058823529412, "ram_util_percent": 83.23529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.487307436479423, "cur_kl_coeff": 0.1217745384550653, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -4.32386314348569e-06, "vf_loss": 0.802186577219181, "vf_explained_var": 0.00048474634765947937, "kl": Infinity, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.34908679464078, "cur_kl_coeff": 2.3155763195564428e-20, "cur_lr": 0.009999999999999998, "total_loss": 1.041340793937287, "policy_loss": 0.00026932427014110896, "vf_loss": 1.0410714713472222, "vf_explained_var": 1.4506950580253804e-09, "kl": -7.227301404106041e-12, "entropy": 7.799713301798565e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -549.0, "episode_reward_mean": -29.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.045, "predator_policy": 14.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 15.0, -1.0, 0.0, -8.0, -10.0, 0.0, 24.0, 3.0, -3.0, -10.0, 0.0, -10.0, 9.0, 0.0, 11.0, 0.0, -174.0, 9.0, -6.0, -549.0, -2.0, -200.0, 0.0, -2.0, -534.0, 0.0, 5.0, 2.0, -4.0, -8.0, 15.0, -197.0, 1.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, -1.0, 15.0, 0.0, -187.0, 15.0, 0.0, -195.0, 0.0, 30.0, 18.0, 0.0, 24.0, -200.0, -4.0, 4.0, 15.0, -2.0, 9.0, 0.0, 6.0, 15.0, -3.0, 21.0, 0.0, 0.0, 15.0, -191.0, 15.0, -15.0, -8.0, -2.0, 0.0, -8.0, -172.0, 11.0, 0.0, -6.0, -200.0, 20.0, -25.0, 0.0, 0.0, 7.0, -21.0, -185.0, 15.0, 7.0, 15.0, 8.0, -184.0, 23.0, 5.0, -11.0, -13.0, -3.0, -2.0, 0.0, -2.0, -10.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 8.0, 0.0, 15.0, 0.0, -11.0, 0.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 15.0, 9.0, 1.0, 0.0, 0.0, -10.0, 0.0, -20.0, 0.0, 0.0, -20.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -360.0, 9.0, 0.0, -20.0, 4.0, -354.0, -390.0, -4.0, 0.0, 0.0, -400.0, 0.0, 0.0, 1.0, -8.0, -357.0, -362.0, 0.0, 0.0, 3.0, 0.0, -20.0, 12.0, -14.0, 0.0, -18.0, 0.0, 0.0, 15.0, -394.0, 0.0, 6.0, -15.0, 9.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, -374.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 15.0, 15.0, 10.0, 8.0, 0.0, 0.0, 9.0, 15.0, -400.0, 0.0, 0.0, -15.0, 8.0, -14.0, 15.0, 0.0, -8.0, 0.0, 0.0, 9.0, 0.0, 0.0, -18.0, 15.0, 0.0, 15.0, -6.0, 0.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -382.0, 0.0, 15.0, 0.0, -15.0, -20.0, -16.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -358.0, 11.0, 0.0, 0.0, 0.0, -14.0, 0.0, -400.0, 0.0, 5.0, 15.0, -14.0, -36.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -12.0, -20.0, 15.0, -400.0, 0.0, 15.0, 7.0, 0.0, 0.0, 15.0, 0.0, 8.0, -376.0, 0.0, 12.0, 11.0, 0.0, 5.0, -10.0, -6.0, -30.0, 0.0, 6.0, -20.0, -12.0, 0.0, 0.0, 0.0, 2.0, -14.0, -20.0, 0.0, -30.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0, 5.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 179.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 195.0, 0.0, 2.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 7.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8801431678621847, "mean_inference_ms": 2.3103064133228077, "mean_action_processing_ms": 0.40845716632623885, "mean_env_wait_ms": 0.3083691884773308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00466609001159668, "StateBufferConnector_ms": 0.0041027069091796875, "ViewRequirementAgentConnector_ms": 0.11331808567047119}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -549.0, "episode_return_mean": -29.41, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.48421981513184, "num_env_steps_trained_throughput_per_sec": 311.48421981513184, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 11544.618, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11544.566, "sample_time_ms": 1688.194, "learn_time_ms": 9837.102, "learn_throughput": 406.624, "synch_weights_time_ms": 16.93}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "f1691_00000", "date": "2024-08-13_17-11-21", "timestamp": 1723583481, "time_this_iter_s": 12.875288009643555, "time_total_s": 1969.77916264534, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3de9670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1969.77916264534, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 59.97777777777779, "ram_util_percent": 83.62777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3297750061057587, "cur_kl_coeff": 0.18266180768259807, "cur_lr": 0.009999999999999998, "total_loss": 1.2907599517592678, "policy_loss": -0.00014299557312692283, "vf_loss": 1.2909029511232224, "vf_explained_var": 0.00045903161089256325, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9094310123334661, "cur_kl_coeff": 1.1577881597782214e-20, "cur_lr": 0.009999999999999998, "total_loss": 1.6609550745556594, "policy_loss": 0.0001470645894567487, "vf_loss": 1.6608080128828684, "vf_explained_var": -5.4558748921389304e-09, "kl": -4.135263746628207e-12, "entropy": 7.800459954391347e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -562.0, "episode_reward_mean": -42.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.58, "predator_policy": 17.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, -6.0, -549.0, -2.0, -200.0, 0.0, -2.0, -534.0, 0.0, 5.0, 2.0, -4.0, -8.0, 15.0, -197.0, 1.0, 15.0, 0.0, 10.0, 0.0, 0.0, 0.0, -1.0, 15.0, 0.0, -187.0, 15.0, 0.0, -195.0, 0.0, 30.0, 18.0, 0.0, 24.0, -200.0, -4.0, 4.0, 15.0, -2.0, 9.0, 0.0, 6.0, 15.0, -3.0, 21.0, 0.0, 0.0, 15.0, -191.0, 15.0, -15.0, -8.0, -2.0, 0.0, -8.0, -172.0, 11.0, 0.0, -6.0, -200.0, 20.0, -25.0, 0.0, 0.0, 7.0, -21.0, -185.0, 15.0, 7.0, 15.0, 8.0, -184.0, 23.0, 5.0, -11.0, -13.0, -3.0, -2.0, 0.0, -2.0, -10.0, -13.0, -5.0, 0.0, 12.0, 0.0, -8.0, 0.0, -562.0, 1.0, 5.0, 11.0, -200.0, -173.0, -15.0, 12.0, 15.0, -13.0, -513.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9.0, 0.0, -20.0, 4.0, -354.0, -390.0, -4.0, 0.0, 0.0, -400.0, 0.0, 0.0, 1.0, -8.0, -357.0, -362.0, 0.0, 0.0, 3.0, 0.0, -20.0, 12.0, -14.0, 0.0, -18.0, 0.0, 0.0, 15.0, -394.0, 0.0, 6.0, -15.0, 9.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, -374.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 15.0, 15.0, 10.0, 8.0, 0.0, 0.0, 9.0, 15.0, -400.0, 0.0, 0.0, -15.0, 8.0, -14.0, 15.0, 0.0, -8.0, 0.0, 0.0, 9.0, 0.0, 0.0, -18.0, 15.0, 0.0, 15.0, -6.0, 0.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -382.0, 0.0, 15.0, 0.0, -15.0, -20.0, -16.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -358.0, 11.0, 0.0, 0.0, 0.0, -14.0, 0.0, -400.0, 0.0, 5.0, 15.0, -14.0, -36.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -12.0, -20.0, 15.0, -400.0, 0.0, 15.0, 7.0, 0.0, 0.0, 15.0, 0.0, 8.0, -376.0, 0.0, 12.0, 11.0, 0.0, 5.0, -10.0, -6.0, -30.0, 0.0, 6.0, -20.0, -12.0, 0.0, 0.0, 0.0, 2.0, -14.0, -20.0, 0.0, -30.0, 0.0, -15.0, -10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -21.0, 0.0, 0.0, -372.0, -400.0, 7.0, -12.0, 0.0, 5.0, 0.0, 11.0, -400.0, 0.0, 15.0, -376.0, -15.0, -20.0, 12.0, 0.0, 0.0, 15.0, -10.0, -16.0, -343.0, -355.0, 0.0, -18.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 195.0, 0.0, 2.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 7.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 7.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 200.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 188.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 185.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8786477729690039, "mean_inference_ms": 2.30913235694149, "mean_action_processing_ms": 0.40761971938072983, "mean_env_wait_ms": 0.30791630301626105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047261714935302734, "StateBufferConnector_ms": 0.0036412477493286133, "ViewRequirementAgentConnector_ms": 0.11144840717315674}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -562.0, "episode_return_mean": -42.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.7570183087289, "num_env_steps_trained_throughput_per_sec": 341.7570183087289, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 11550.633, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11550.575, "sample_time_ms": 1694.107, "learn_time_ms": 9837.195, "learn_throughput": 406.62, "synch_weights_time_ms": 16.986}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "f1691_00000", "date": "2024-08-13_17-11-33", "timestamp": 1723583493, "time_this_iter_s": 11.771888017654419, "time_total_s": 1981.5510506629944, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3de9af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1981.5510506629944, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 49.993750000000006, "ram_util_percent": 83.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1305158523903054, "cur_kl_coeff": 0.09133090384129904, "cur_lr": 0.009999999999999998, "total_loss": 1.454034098241695, "policy_loss": 0.00013100828497458704, "vf_loss": 1.4539030944071119, "vf_explained_var": 0.000364169714942811, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.302879448204853, "cur_kl_coeff": 5.788940798891107e-21, "cur_lr": 0.009999999999999998, "total_loss": 1.5475551171277566, "policy_loss": 0.00024275330397936087, "vf_loss": 1.54731236298879, "vf_explained_var": -7.884212271877066e-09, "kl": -5.376808363517416e-12, "entropy": 7.873116410668975e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -562.0, "episode_reward_mean": -35.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.585, "predator_policy": 17.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 0.0, 0.0, -1.0, 15.0, 0.0, -187.0, 15.0, 0.0, -195.0, 0.0, 30.0, 18.0, 0.0, 24.0, -200.0, -4.0, 4.0, 15.0, -2.0, 9.0, 0.0, 6.0, 15.0, -3.0, 21.0, 0.0, 0.0, 15.0, -191.0, 15.0, -15.0, -8.0, -2.0, 0.0, -8.0, -172.0, 11.0, 0.0, -6.0, -200.0, 20.0, -25.0, 0.0, 0.0, 7.0, -21.0, -185.0, 15.0, 7.0, 15.0, 8.0, -184.0, 23.0, 5.0, -11.0, -13.0, -3.0, -2.0, 0.0, -2.0, -10.0, -13.0, -5.0, 0.0, 12.0, 0.0, -8.0, 0.0, -562.0, 1.0, 5.0, 11.0, -200.0, -173.0, -15.0, 12.0, 15.0, -13.0, -513.0, 2.0, -4.0, -6.0, 1.0, 10.0, 0.0, -4.0, -191.0, -9.0, 0.0, -10.0, -1.0, -180.0, -200.0, 14.0, -4.0, -6.0, -200.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, -374.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 15.0, 15.0, 10.0, 8.0, 0.0, 0.0, 9.0, 15.0, -400.0, 0.0, 0.0, -15.0, 8.0, -14.0, 15.0, 0.0, -8.0, 0.0, 0.0, 9.0, 0.0, 0.0, -18.0, 15.0, 0.0, 15.0, -6.0, 0.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -382.0, 0.0, 15.0, 0.0, -15.0, -20.0, -16.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -358.0, 11.0, 0.0, 0.0, 0.0, -14.0, 0.0, -400.0, 0.0, 5.0, 15.0, -14.0, -36.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -12.0, -20.0, 15.0, -400.0, 0.0, 15.0, 7.0, 0.0, 0.0, 15.0, 0.0, 8.0, -376.0, 0.0, 12.0, 11.0, 0.0, 5.0, -10.0, -6.0, -30.0, 0.0, 6.0, -20.0, -12.0, 0.0, 0.0, 0.0, 2.0, -14.0, -20.0, 0.0, -30.0, 0.0, -15.0, -10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -21.0, 0.0, 0.0, -372.0, -400.0, 7.0, -12.0, 0.0, 5.0, 0.0, 11.0, -400.0, 0.0, 15.0, -376.0, -15.0, -20.0, 12.0, 0.0, 0.0, 15.0, -10.0, -16.0, -343.0, -355.0, 0.0, -18.0, -24.0, 0.0, 4.0, -20.0, 0.0, 1.0, 15.0, -10.0, 0.0, 0.0, -20.0, 6.0, 0.0, -382.0, -18.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, 0.0, -370.0, 0.0, -400.0, 0.0, 14.0, 0.0, 0.0, -9.0, 0.0, -16.0, -400.0, 0.0, -17.0, -15.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 7.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 7.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 200.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 188.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 185.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 190.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 200.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8772230551980056, "mean_inference_ms": 2.308118475324144, "mean_action_processing_ms": 0.4068216985061892, "mean_env_wait_ms": 0.30747198999816894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004775881767272949, "StateBufferConnector_ms": 0.0036818981170654297, "ViewRequirementAgentConnector_ms": 0.11874353885650635}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -562.0, "episode_return_mean": -35.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.7168777638877, "num_env_steps_trained_throughput_per_sec": 338.7168777638877, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 11579.168, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11579.112, "sample_time_ms": 1676.708, "learn_time_ms": 9885.391, "learn_throughput": 404.638, "synch_weights_time_ms": 14.7}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "f1691_00000", "date": "2024-08-13_17-11-45", "timestamp": 1723583505, "time_this_iter_s": 11.857845067977905, "time_total_s": 1993.4088957309723, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ee35e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1993.4088957309723, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 51.55882352941177, "ram_util_percent": 83.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.559568274242153, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.009999999999999998, "total_loss": 1.0983929310841536, "policy_loss": -4.4491867382059655e-05, "vf_loss": 1.098437417365571, "vf_explained_var": 0.00020524077314548392, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.374202596766735, "cur_kl_coeff": 2.8944703994455535e-21, "cur_lr": 0.009999999999999998, "total_loss": 1.7347989487269568, "policy_loss": -0.0001238397583759651, "vf_loss": 1.7349227886351328, "vf_explained_var": -7.537306931914476e-09, "kl": 5.2342767426340975e-12, "entropy": 7.741929363082932e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -562.0, "episode_reward_mean": -51.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -47.315, "predator_policy": 21.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 15.0, -3.0, 21.0, 0.0, 0.0, 15.0, -191.0, 15.0, -15.0, -8.0, -2.0, 0.0, -8.0, -172.0, 11.0, 0.0, -6.0, -200.0, 20.0, -25.0, 0.0, 0.0, 7.0, -21.0, -185.0, 15.0, 7.0, 15.0, 8.0, -184.0, 23.0, 5.0, -11.0, -13.0, -3.0, -2.0, 0.0, -2.0, -10.0, -13.0, -5.0, 0.0, 12.0, 0.0, -8.0, 0.0, -562.0, 1.0, 5.0, 11.0, -200.0, -173.0, -15.0, 12.0, 15.0, -13.0, -513.0, 2.0, -4.0, -6.0, 1.0, 10.0, 0.0, -4.0, -191.0, -9.0, 0.0, -10.0, -1.0, -180.0, -200.0, 14.0, -4.0, -6.0, -200.0, -12.0, 0.0, -547.0, -181.0, 5.0, -195.0, 3.0, 11.0, 9.0, 0.0, 4.0, 0.0, -195.0, -3.0, 0.0, 0.0, -547.0, 6.0, -187.0, -198.0, 7.0, 7.0, -7.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, 15.0, 0.0, 15.0, -6.0, 0.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, -382.0, 0.0, 15.0, 0.0, -15.0, -20.0, -16.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -358.0, 11.0, 0.0, 0.0, 0.0, -14.0, 0.0, -400.0, 0.0, 5.0, 15.0, -14.0, -36.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -12.0, -20.0, 15.0, -400.0, 0.0, 15.0, 7.0, 0.0, 0.0, 15.0, 0.0, 8.0, -376.0, 0.0, 12.0, 11.0, 0.0, 5.0, -10.0, -6.0, -30.0, 0.0, 6.0, -20.0, -12.0, 0.0, 0.0, 0.0, 2.0, -14.0, -20.0, 0.0, -30.0, 0.0, -15.0, -10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -21.0, 0.0, 0.0, -372.0, -400.0, 7.0, -12.0, 0.0, 5.0, 0.0, 11.0, -400.0, 0.0, 15.0, -376.0, -15.0, -20.0, 12.0, 0.0, 0.0, 15.0, -10.0, -16.0, -343.0, -355.0, 0.0, -18.0, -24.0, 0.0, 4.0, -20.0, 0.0, 1.0, 15.0, -10.0, 0.0, 0.0, -20.0, 6.0, 0.0, -382.0, -18.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, 0.0, -370.0, 0.0, -400.0, 0.0, 14.0, 0.0, 0.0, -9.0, 0.0, -16.0, -400.0, 0.0, -17.0, -15.0, 0.0, 0.0, -400.0, -347.0, -364.0, 1.0, 15.0, -20.0, -11.0, -388.0, 3.0, 0.0, 11.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, -392.0, -13.0, 0.0, -8.0, 0.0, 0.0, 0.0, -400.0, -347.0, 0.0, 0.0, -374.0, 0.0, 0.0, -396.0, 7.0, 0.0, 0.0, 7.0, -13.0, -8.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 7.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 7.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 200.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 188.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 185.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 190.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 182.0, 10.0, 0.0, 10.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 6.0, 0.0, 187.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8755439444874596, "mean_inference_ms": 2.307074958165276, "mean_action_processing_ms": 0.405848065678382, "mean_env_wait_ms": 0.3069648580048968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004681825637817383, "StateBufferConnector_ms": 0.0036814212799072266, "ViewRequirementAgentConnector_ms": 0.12099039554595947}, "num_episodes": 23, "episode_return_max": 23.0, "episode_return_min": -562.0, "episode_return_mean": -51.32, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.0756167462616, "num_env_steps_trained_throughput_per_sec": 340.0756167462616, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 11660.959, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11660.904, "sample_time_ms": 1688.021, "learn_time_ms": 9955.293, "learn_throughput": 401.796, "synch_weights_time_ms": 15.148}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "f1691_00000", "date": "2024-08-13_17-11-57", "timestamp": 1723583517, "time_this_iter_s": 11.811180830001831, "time_total_s": 2005.2200765609741, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3de99d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2005.2200765609741, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 51.594117647058816, "ram_util_percent": 83.6470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6946936022105907, "cur_kl_coeff": 0.02283272596032476, "cur_lr": 0.009999999999999998, "total_loss": 0.8006420690546591, "policy_loss": 4.3208384393620745e-05, "vf_loss": 0.8005988570708762, "vf_explained_var": 0.00023173841219099742, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5286894143160517, "cur_kl_coeff": 1.4472351997227768e-21, "cur_lr": 0.009999999999999998, "total_loss": 0.9571952532720629, "policy_loss": -3.44849583352842e-05, "vf_loss": 0.9572297352647025, "vf_explained_var": -9.208759933552414e-09, "kl": 3.1206150400977208e-12, "entropy": 7.64646532570232e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -562.0, "episode_reward_mean": -49.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.375, "predator_policy": 20.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 7.0, -21.0, -185.0, 15.0, 7.0, 15.0, 8.0, -184.0, 23.0, 5.0, -11.0, -13.0, -3.0, -2.0, 0.0, -2.0, -10.0, -13.0, -5.0, 0.0, 12.0, 0.0, -8.0, 0.0, -562.0, 1.0, 5.0, 11.0, -200.0, -173.0, -15.0, 12.0, 15.0, -13.0, -513.0, 2.0, -4.0, -6.0, 1.0, 10.0, 0.0, -4.0, -191.0, -9.0, 0.0, -10.0, -1.0, -180.0, -200.0, 14.0, -4.0, -6.0, -200.0, -12.0, 0.0, -547.0, -181.0, 5.0, -195.0, 3.0, 11.0, 9.0, 0.0, 4.0, 0.0, -195.0, -3.0, 0.0, 0.0, -547.0, 6.0, -187.0, -198.0, 7.0, 7.0, -7.0, 0.0, 13.0, -7.0, -170.0, 0.0, 0.0, -10.0, 15.0, 12.0, -5.0, 0.0, 15.0, -27.0, -2.0, 29.0, -10.0, -10.0, 5.0, 0.0, -10.0, -177.0, 0.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 7.0, 0.0, -12.0, -20.0, 15.0, -400.0, 0.0, 15.0, 7.0, 0.0, 0.0, 15.0, 0.0, 8.0, -376.0, 0.0, 12.0, 11.0, 0.0, 5.0, -10.0, -6.0, -30.0, 0.0, 6.0, -20.0, -12.0, 0.0, 0.0, 0.0, 2.0, -14.0, -20.0, 0.0, -30.0, 0.0, -15.0, -10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -21.0, 0.0, 0.0, -372.0, -400.0, 7.0, -12.0, 0.0, 5.0, 0.0, 11.0, -400.0, 0.0, 15.0, -376.0, -15.0, -20.0, 12.0, 0.0, 0.0, 15.0, -10.0, -16.0, -343.0, -355.0, 0.0, -18.0, -24.0, 0.0, 4.0, -20.0, 0.0, 1.0, 15.0, -10.0, 0.0, 0.0, -20.0, 6.0, 0.0, -382.0, -18.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, 0.0, -370.0, 0.0, -400.0, 0.0, 14.0, 0.0, 0.0, -9.0, 0.0, -16.0, -400.0, 0.0, -17.0, -15.0, 0.0, 0.0, -400.0, -347.0, -364.0, 1.0, 15.0, -20.0, -11.0, -388.0, 3.0, 0.0, 11.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, -392.0, -13.0, 0.0, -8.0, 0.0, 0.0, 0.0, -400.0, -347.0, 0.0, 0.0, -374.0, 0.0, 0.0, -396.0, 7.0, 0.0, 0.0, 7.0, -13.0, -8.0, 0.0, 0.0, 2.0, 11.0, -14.0, 0.0, -355.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, 0.0, -36.0, -13.0, -10.0, 3.0, 15.0, 14.0, -20.0, 0.0, 0.0, -20.0, 15.0, -20.0, 0.0, 0.0, 0.0, -20.0, -349.0, -20.0, 0.0, 0.0, 1.0, 2.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 7.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 7.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 200.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 188.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 185.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 190.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 182.0, 10.0, 0.0, 10.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 6.0, 0.0, 187.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8742058678753827, "mean_inference_ms": 2.307041557941447, "mean_action_processing_ms": 0.40492350196470833, "mean_env_wait_ms": 0.30653512540397365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004558444023132324, "StateBufferConnector_ms": 0.003476262092590332, "ViewRequirementAgentConnector_ms": 0.12366163730621338}, "num_episodes": 22, "episode_return_max": 29.0, "episode_return_min": -562.0, "episode_return_mean": -49.41, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.9105169934029, "num_env_steps_trained_throughput_per_sec": 346.9105169934029, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 11612.307, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11612.251, "sample_time_ms": 1581.252, "learn_time_ms": 10013.386, "learn_throughput": 399.465, "synch_weights_time_ms": 15.125}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "f1691_00000", "date": "2024-08-13_17-12-08", "timestamp": 1723583528, "time_this_iter_s": 11.560001134872437, "time_total_s": 2016.7800776958466, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ee3550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2016.7800776958466, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 51.19375, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1455786198251956, "cur_kl_coeff": 0.01141636298016238, "cur_lr": 0.009999999999999998, "total_loss": 0.7876280090323201, "policy_loss": -2.0711839681974165e-05, "vf_loss": 0.7876487228189405, "vf_explained_var": 0.0003519787359489966, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.214329310500038, "cur_kl_coeff": 7.236175998613884e-22, "cur_lr": 0.009999999999999998, "total_loss": 0.8774954816622157, "policy_loss": 0.0001544240620677118, "vf_loss": 0.8773410509148287, "vf_explained_var": -8.641096649977265e-09, "kl": 2.254465309070095e-12, "entropy": 7.604704865826761e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -562.0, "episode_reward_mean": -49.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.27, "predator_policy": 20.695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, -5.0, 0.0, 12.0, 0.0, -8.0, 0.0, -562.0, 1.0, 5.0, 11.0, -200.0, -173.0, -15.0, 12.0, 15.0, -13.0, -513.0, 2.0, -4.0, -6.0, 1.0, 10.0, 0.0, -4.0, -191.0, -9.0, 0.0, -10.0, -1.0, -180.0, -200.0, 14.0, -4.0, -6.0, -200.0, -12.0, 0.0, -547.0, -181.0, 5.0, -195.0, 3.0, 11.0, 9.0, 0.0, 4.0, 0.0, -195.0, -3.0, 0.0, 0.0, -547.0, 6.0, -187.0, -198.0, 7.0, 7.0, -7.0, 0.0, 13.0, -7.0, -170.0, 0.0, 0.0, -10.0, 15.0, 12.0, -5.0, 0.0, 15.0, -27.0, -2.0, 29.0, -10.0, -10.0, 5.0, 0.0, -10.0, -177.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 16.0, -10.0, 2.0, 0.0, 11.0, -1.0, -190.0, 6.0, -10.0, 11.0, -17.0, -168.0, 15.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.0, 0.0, -15.0, -10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -21.0, 0.0, 0.0, -372.0, -400.0, 7.0, -12.0, 0.0, 5.0, 0.0, 11.0, -400.0, 0.0, 15.0, -376.0, -15.0, -20.0, 12.0, 0.0, 0.0, 15.0, -10.0, -16.0, -343.0, -355.0, 0.0, -18.0, -24.0, 0.0, 4.0, -20.0, 0.0, 1.0, 15.0, -10.0, 0.0, 0.0, -20.0, 6.0, 0.0, -382.0, -18.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, 0.0, -370.0, 0.0, -400.0, 0.0, 14.0, 0.0, 0.0, -9.0, 0.0, -16.0, -400.0, 0.0, -17.0, -15.0, 0.0, 0.0, -400.0, -347.0, -364.0, 1.0, 15.0, -20.0, -11.0, -388.0, 3.0, 0.0, 11.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, -392.0, -13.0, 0.0, -8.0, 0.0, 0.0, 0.0, -400.0, -347.0, 0.0, 0.0, -374.0, 0.0, 0.0, -396.0, 7.0, 0.0, 0.0, 7.0, -13.0, -8.0, 0.0, 0.0, 2.0, 11.0, -14.0, 0.0, -355.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, 0.0, -36.0, -13.0, -10.0, 3.0, 15.0, 14.0, -20.0, 0.0, 0.0, -20.0, 15.0, -20.0, 0.0, 0.0, 0.0, -20.0, -349.0, -20.0, 0.0, 0.0, 1.0, 2.0, 15.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, -20.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 11.0, -2.0, 0.0, -385.0, 0.0, 11.0, -12.0, 0.0, -25.0, 15.0, -17.0, -16.0, -19.0, 0.0, -350.0, -10.0, 15.0, 0.0, 5.0], "policy_predator_policy_reward": [10.0, 7.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 200.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 188.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 185.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 190.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 182.0, 10.0, 0.0, 10.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 6.0, 0.0, 187.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 195.0, 6.0, 1.0, 5.0, 10.0, 3.0, 10.0, 10.0, 8.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8729199634581739, "mean_inference_ms": 2.3053857586557753, "mean_action_processing_ms": 0.40427910056314603, "mean_env_wait_ms": 0.30613147099778476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041468143463134766, "StateBufferConnector_ms": 0.00346219539642334, "ViewRequirementAgentConnector_ms": 0.12125730514526367}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -562.0, "episode_return_mean": -49.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.09860384626387, "num_env_steps_trained_throughput_per_sec": 346.09860384626387, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 11658.696, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11658.64, "sample_time_ms": 1572.625, "learn_time_ms": 10067.445, "learn_throughput": 397.32, "synch_weights_time_ms": 15.257}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "f1691_00000", "date": "2024-08-13_17-12-20", "timestamp": 1723583540, "time_this_iter_s": 11.582313060760498, "time_total_s": 2028.362390756607, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3debaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2028.362390756607, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 51.711764705882345, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3486965574895735, "cur_kl_coeff": 0.00570818149008119, "cur_lr": 0.009999999999999998, "total_loss": 1.1714225136413776, "policy_loss": -6.834565533729142e-06, "vf_loss": 1.1714293483703855, "vf_explained_var": 0.00033393060719525374, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2222980131594112, "cur_kl_coeff": 3.618087999306942e-22, "cur_lr": 0.009999999999999998, "total_loss": 1.3266865970635855, "policy_loss": 2.0542930782077804e-05, "vf_loss": 1.3266660488865993, "vf_explained_var": -8.294191310014673e-09, "kl": -2.7864616933780007e-13, "entropy": 7.651621213647007e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -547.0, "episode_reward_mean": -43.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -43.42, "predator_policy": 21.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -4.0, -6.0, 1.0, 10.0, 0.0, -4.0, -191.0, -9.0, 0.0, -10.0, -1.0, -180.0, -200.0, 14.0, -4.0, -6.0, -200.0, -12.0, 0.0, -547.0, -181.0, 5.0, -195.0, 3.0, 11.0, 9.0, 0.0, 4.0, 0.0, -195.0, -3.0, 0.0, 0.0, -547.0, 6.0, -187.0, -198.0, 7.0, 7.0, -7.0, 0.0, 13.0, -7.0, -170.0, 0.0, 0.0, -10.0, 15.0, 12.0, -5.0, 0.0, 15.0, -27.0, -2.0, 29.0, -10.0, -10.0, 5.0, 0.0, -10.0, -177.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 16.0, -10.0, 2.0, 0.0, 11.0, -1.0, -190.0, 6.0, -10.0, 11.0, -17.0, -168.0, 15.0, 5.0, 9.0, -185.0, -3.0, 4.0, 1.0, 11.0, 0.0, -196.0, -26.0, -200.0, 6.0, 0.0, -191.0, 6.0, -187.0, -7.0, 0.0, 30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -18.0, -24.0, 0.0, 4.0, -20.0, 0.0, 1.0, 15.0, -10.0, 0.0, 0.0, -20.0, 6.0, 0.0, -382.0, -18.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, 0.0, -370.0, 0.0, -400.0, 0.0, 14.0, 0.0, 0.0, -9.0, 0.0, -16.0, -400.0, 0.0, -17.0, -15.0, 0.0, 0.0, -400.0, -347.0, -364.0, 1.0, 15.0, -20.0, -11.0, -388.0, 3.0, 0.0, 11.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, -392.0, -13.0, 0.0, -8.0, 0.0, 0.0, 0.0, -400.0, -347.0, 0.0, 0.0, -374.0, 0.0, 0.0, -396.0, 7.0, 0.0, 0.0, 7.0, -13.0, -8.0, 0.0, 0.0, 2.0, 11.0, -14.0, 0.0, -355.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, 0.0, -36.0, -13.0, -10.0, 3.0, 15.0, 14.0, -20.0, 0.0, 0.0, -20.0, 15.0, -20.0, 0.0, 0.0, 0.0, -20.0, -349.0, -20.0, 0.0, 0.0, 1.0, 2.0, 15.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, -20.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 11.0, -2.0, 0.0, -385.0, 0.0, 11.0, -12.0, 0.0, -25.0, 15.0, -17.0, -16.0, -19.0, 0.0, -350.0, -10.0, 15.0, 0.0, 5.0, 5.0, 4.0, -400.0, 15.0, 0.0, -6.0, 4.0, 0.0, 0.0, -5.0, 11.0, 0.0, 0.0, 0.0, -393.0, 0.0, -20.0, -20.0, -400.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, -384.0, 6.0, 0.0, 13.0, -400.0, -14.0, 0.0, 0.0, 0.0, 15.0, 15.0], "policy_predator_policy_reward": [10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 191.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 190.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 182.0, 10.0, 0.0, 10.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 6.0, 0.0, 187.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 195.0, 6.0, 1.0, 5.0, 10.0, 3.0, 10.0, 10.0, 8.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 7.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 14.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8717462654495236, "mean_inference_ms": 2.3047236502624258, "mean_action_processing_ms": 0.40356506945100146, "mean_env_wait_ms": 0.305729104859061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004235029220581055, "StateBufferConnector_ms": 0.0034666061401367188, "ViewRequirementAgentConnector_ms": 0.12939012050628662}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -547.0, "episode_return_mean": -43.97, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.5142870838703, "num_env_steps_trained_throughput_per_sec": 342.5142870838703, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 11688.43, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11688.374, "sample_time_ms": 1573.769, "learn_time_ms": 10095.588, "learn_throughput": 396.213, "synch_weights_time_ms": 16.054}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "f1691_00000", "date": "2024-08-13_17-12-32", "timestamp": 1723583552, "time_this_iter_s": 11.735050916671753, "time_total_s": 2040.0974416732788, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3df2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2040.0974416732788, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 50.25, "ram_util_percent": 83.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3110505014549565, "cur_kl_coeff": 0.002854090745040595, "cur_lr": 0.009999999999999998, "total_loss": 0.26877848851302316, "policy_loss": 0.00019841516173627012, "vf_loss": 0.2685800734441419, "vf_explained_var": 0.002414573153490743, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4572382767741425, "cur_kl_coeff": 1.809043999653471e-22, "cur_lr": 0.009999999999999998, "total_loss": 0.3576789686963869, "policy_loss": 0.0001668527717431071, "vf_loss": 0.3575121174345936, "vf_explained_var": 4.4829946346383875e-06, "kl": 1.4285229309548275e-12, "entropy": 7.599384009549136e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -547.0, "episode_reward_mean": -38.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.495, "predator_policy": 18.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 0.0, -547.0, -181.0, 5.0, -195.0, 3.0, 11.0, 9.0, 0.0, 4.0, 0.0, -195.0, -3.0, 0.0, 0.0, -547.0, 6.0, -187.0, -198.0, 7.0, 7.0, -7.0, 0.0, 13.0, -7.0, -170.0, 0.0, 0.0, -10.0, 15.0, 12.0, -5.0, 0.0, 15.0, -27.0, -2.0, 29.0, -10.0, -10.0, 5.0, 0.0, -10.0, -177.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 16.0, -10.0, 2.0, 0.0, 11.0, -1.0, -190.0, 6.0, -10.0, 11.0, -17.0, -168.0, 15.0, 5.0, 9.0, -185.0, -3.0, 4.0, 1.0, 11.0, 0.0, -196.0, -26.0, -200.0, 6.0, 0.0, -191.0, 6.0, -187.0, -7.0, 0.0, 30.0, -200.0, -11.0, 3.0, 0.0, 8.0, 4.0, -5.0, -12.0, -2.0, 10.0, 0.0, 11.0, 8.0, 12.0, 14.0, -17.0, -29.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.0, -15.0, 0.0, 0.0, -400.0, -347.0, -364.0, 1.0, 15.0, -20.0, -11.0, -388.0, 3.0, 0.0, 11.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, -392.0, -13.0, 0.0, -8.0, 0.0, 0.0, 0.0, -400.0, -347.0, 0.0, 0.0, -374.0, 0.0, 0.0, -396.0, 7.0, 0.0, 0.0, 7.0, -13.0, -8.0, 0.0, 0.0, 2.0, 11.0, -14.0, 0.0, -355.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, 0.0, -36.0, -13.0, -10.0, 3.0, 15.0, 14.0, -20.0, 0.0, 0.0, -20.0, 15.0, -20.0, 0.0, 0.0, 0.0, -20.0, -349.0, -20.0, 0.0, 0.0, 1.0, 2.0, 15.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, -20.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 11.0, -2.0, 0.0, -385.0, 0.0, 11.0, -12.0, 0.0, -25.0, 15.0, -17.0, -16.0, -19.0, 0.0, -350.0, -10.0, 15.0, 0.0, 5.0, 5.0, 4.0, -400.0, 15.0, 0.0, -6.0, 4.0, 0.0, 0.0, -5.0, 11.0, 0.0, 0.0, 0.0, -393.0, 0.0, -20.0, -20.0, -400.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, -384.0, 6.0, 0.0, 13.0, -400.0, -14.0, 0.0, 0.0, 0.0, 15.0, 15.0, -400.0, 0.0, -20.0, -2.0, -5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, -10.0, 0.0, -20.0, -4.0, -18.0, 7.0, 2.0, 8.0, 0.0, 0.0, -2.0, 12.0, 6.0, 0.0, 10.0, -8.0, 15.0, -2.0, -14.0, -20.0, -20.0, -20.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 182.0, 10.0, 0.0, 10.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 6.0, 0.0, 187.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 195.0, 6.0, 1.0, 5.0, 10.0, 3.0, 10.0, 10.0, 8.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 7.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 14.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 1.0, 10.0, 7.0, 0.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8706758163815727, "mean_inference_ms": 2.304332907294452, "mean_action_processing_ms": 0.4028620058386504, "mean_env_wait_ms": 0.3053712277667282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006212949752807617, "StateBufferConnector_ms": 0.0034568309783935547, "ViewRequirementAgentConnector_ms": 0.12296402454376221}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -547.0, "episode_return_mean": -38.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.2475592532356, "num_env_steps_trained_throughput_per_sec": 344.2475592532356, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 11710.253, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11710.197, "sample_time_ms": 1597.307, "learn_time_ms": 10092.767, "learn_throughput": 396.323, "synch_weights_time_ms": 17.089}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "f1691_00000", "date": "2024-08-13_17-12-43", "timestamp": 1723583563, "time_this_iter_s": 11.696102857589722, "time_total_s": 2051.7935445308685, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3eff3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2051.7935445308685, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 50.78235294117648, "ram_util_percent": 83.53529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4654631581847313, "cur_kl_coeff": 0.0014270453725202974, "cur_lr": 0.009999999999999998, "total_loss": 0.9243473748996776, "policy_loss": -0.00011180391493278048, "vf_loss": 0.9244591794001362, "vf_explained_var": 0.00012568765216403537, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.328668729926302, "cur_kl_coeff": 9.045219998267355e-23, "cur_lr": 0.009999999999999998, "total_loss": 1.060961468139338, "policy_loss": 8.716214320095128e-05, "vf_loss": 1.060874309189736, "vf_explained_var": -8.798780895414807e-09, "kl": 4.14602344150219e-12, "entropy": 7.532497846861895e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -200.0, "episode_reward_mean": -22.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.135, "predator_policy": 13.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -10.0, 15.0, 12.0, -5.0, 0.0, 15.0, -27.0, -2.0, 29.0, -10.0, -10.0, 5.0, 0.0, -10.0, -177.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 16.0, -10.0, 2.0, 0.0, 11.0, -1.0, -190.0, 6.0, -10.0, 11.0, -17.0, -168.0, 15.0, 5.0, 9.0, -185.0, -3.0, 4.0, 1.0, 11.0, 0.0, -196.0, -26.0, -200.0, 6.0, 0.0, -191.0, 6.0, -187.0, -7.0, 0.0, 30.0, -200.0, -11.0, 3.0, 0.0, 8.0, 4.0, -5.0, -12.0, -2.0, 10.0, 0.0, 11.0, 8.0, 12.0, 14.0, -17.0, -29.0, 0.0, 0.0, 0.0, 7.0, -20.0, -19.0, -200.0, -10.0, 3.0, -170.0, 4.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, -2.0, -200.0, -5.0, -10.0, 9.0, -8.0, -20.0, 8.0, 8.0, -3.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, 0.0, 12.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, 0.0, -36.0, -13.0, -10.0, 3.0, 15.0, 14.0, -20.0, 0.0, 0.0, -20.0, 15.0, -20.0, 0.0, 0.0, 0.0, -20.0, -349.0, -20.0, 0.0, 0.0, 1.0, 2.0, 15.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, -20.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 11.0, -2.0, 0.0, -385.0, 0.0, 11.0, -12.0, 0.0, -25.0, 15.0, -17.0, -16.0, -19.0, 0.0, -350.0, -10.0, 15.0, 0.0, 5.0, 5.0, 4.0, -400.0, 15.0, 0.0, -6.0, 4.0, 0.0, 0.0, -5.0, 11.0, 0.0, 0.0, 0.0, -393.0, 0.0, -20.0, -20.0, -400.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, -384.0, 6.0, 0.0, 13.0, -400.0, -14.0, 0.0, 0.0, 0.0, 15.0, 15.0, -400.0, 0.0, -20.0, -2.0, -5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, -10.0, 0.0, -20.0, -4.0, -18.0, 7.0, 2.0, 8.0, 0.0, 0.0, -2.0, 12.0, 6.0, 0.0, 10.0, -8.0, 15.0, -2.0, -14.0, -20.0, -20.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -20.0, -20.0, -19.0, -20.0, -400.0, 0.0, -20.0, 0.0, 0.0, 3.0, -355.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, -15.0, 0.0, -8.0, -20.0, 9.0, 0.0, -16.0, 0.0, -20.0, -20.0, 8.0, 0.0, 0.0, 8.0, -20.0, 3.0, 0.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 195.0, 6.0, 1.0, 5.0, 10.0, 3.0, 10.0, 10.0, 8.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 7.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 14.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 1.0, 10.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 10.0, 10.0, 10.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 200.0, 0.0, 0.0, 10.0, 10.0, 8.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8699963654470111, "mean_inference_ms": 2.306191958262543, "mean_action_processing_ms": 0.40202828386249656, "mean_env_wait_ms": 0.30506228889376247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01152181625366211, "StateBufferConnector_ms": 0.0038679838180541992, "ViewRequirementAgentConnector_ms": 0.145263671875}, "num_episodes": 27, "episode_return_max": 30.0, "episode_return_min": -200.0, "episode_return_mean": -22.45, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.8257196437769, "num_env_steps_trained_throughput_per_sec": 332.8257196437769, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 11787.108, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11787.053, "sample_time_ms": 1682.508, "learn_time_ms": 10084.589, "learn_throughput": 396.645, "synch_weights_time_ms": 17.108}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "f1691_00000", "date": "2024-08-13_17-12-56", "timestamp": 1723583576, "time_this_iter_s": 12.068059206008911, "time_total_s": 2063.8616037368774, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3effe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2063.8616037368774, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 49.523529411764706, "ram_util_percent": 83.4470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.490906381116756, "cur_kl_coeff": 0.0007135226862601487, "cur_lr": 0.009999999999999998, "total_loss": 1.0422429447924648, "policy_loss": 0.00020171001666871013, "vf_loss": 1.0420412345695749, "vf_explained_var": 4.093956064294886e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.421134766032328, "cur_kl_coeff": 4.5226099991336774e-23, "cur_lr": 0.009999999999999998, "total_loss": 1.2751999131586187, "policy_loss": -0.00013771661847987503, "vf_loss": 1.2753376311568356, "vf_explained_var": -1.072252868975281e-08, "kl": 6.045743666809799e-13, "entropy": 7.524174991934605e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -200.0, "episode_reward_mean": -25.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.785, "predator_policy": 15.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 5.0, 0.0, 0.0, 0.0, 16.0, -10.0, 2.0, 0.0, 11.0, -1.0, -190.0, 6.0, -10.0, 11.0, -17.0, -168.0, 15.0, 5.0, 9.0, -185.0, -3.0, 4.0, 1.0, 11.0, 0.0, -196.0, -26.0, -200.0, 6.0, 0.0, -191.0, 6.0, -187.0, -7.0, 0.0, 30.0, -200.0, -11.0, 3.0, 0.0, 8.0, 4.0, -5.0, -12.0, -2.0, 10.0, 0.0, 11.0, 8.0, 12.0, 14.0, -17.0, -29.0, 0.0, 0.0, 0.0, 7.0, -20.0, -19.0, -200.0, -10.0, 3.0, -170.0, 4.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, -2.0, -200.0, -5.0, -10.0, 9.0, -8.0, -20.0, 8.0, 8.0, -3.0, -10.0, 0.0, -1.0, 0.0, 11.0, -186.0, -200.0, -11.0, 29.0, 0.0, -2.0, 23.0, 14.0, 3.0, 19.0, 4.0, -200.0, 8.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 2.0, 15.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, -20.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 11.0, -2.0, 0.0, -385.0, 0.0, 11.0, -12.0, 0.0, -25.0, 15.0, -17.0, -16.0, -19.0, 0.0, -350.0, -10.0, 15.0, 0.0, 5.0, 5.0, 4.0, -400.0, 15.0, 0.0, -6.0, 4.0, 0.0, 0.0, -5.0, 11.0, 0.0, 0.0, 0.0, -393.0, 0.0, -20.0, -20.0, -400.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, -384.0, 6.0, 0.0, 13.0, -400.0, -14.0, 0.0, 0.0, 0.0, 15.0, 15.0, -400.0, 0.0, -20.0, -2.0, -5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, -10.0, 0.0, -20.0, -4.0, -18.0, 7.0, 2.0, 8.0, 0.0, 0.0, -2.0, 12.0, 6.0, 0.0, 10.0, -8.0, 15.0, -2.0, -14.0, -20.0, -20.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -20.0, -20.0, -19.0, -20.0, -400.0, 0.0, -20.0, 0.0, 0.0, 3.0, -355.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, -15.0, 0.0, -8.0, -20.0, 9.0, 0.0, -16.0, 0.0, -20.0, -20.0, 8.0, 0.0, 0.0, 8.0, -20.0, 3.0, 0.0, -20.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, 0.0, 11.0, -400.0, 14.0, -400.0, 0.0, -20.0, -11.0, 14.0, 15.0, 0.0, 0.0, -32.0, 12.0, 11.0, 12.0, 0.0, 14.0, 0.0, 3.0, 14.0, 5.0, -27.0, 15.0, -400.0, 0.0, 8.0, 0.0, -15.0, -16.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 195.0, 6.0, 1.0, 5.0, 10.0, 3.0, 10.0, 10.0, 8.0, 0.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 7.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 14.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 1.0, 10.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 10.0, 10.0, 10.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 200.0, 0.0, 0.0, 10.0, 10.0, 8.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 200.0, 0.0, 0.0, 8.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8699287345044692, "mean_inference_ms": 2.3078630982370476, "mean_action_processing_ms": 0.40183615152947466, "mean_env_wait_ms": 0.30503869099374514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012773394584655762, "StateBufferConnector_ms": 0.003818511962890625, "ViewRequirementAgentConnector_ms": 0.1535651683807373}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -200.0, "episode_return_mean": -25.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.3565497712875, "num_env_steps_trained_throughput_per_sec": 331.3565497712875, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 11859.295, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11859.242, "sample_time_ms": 1809.176, "learn_time_ms": 10030.152, "learn_throughput": 398.798, "synch_weights_time_ms": 16.915}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "f1691_00000", "date": "2024-08-13_17-13-08", "timestamp": 1723583588, "time_this_iter_s": 12.12558627128601, "time_total_s": 2075.9871900081635, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3df2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2075.9871900081635, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 48.46470588235294, "ram_util_percent": 83.26470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4421722304428553, "cur_kl_coeff": 0.00035676134313007436, "cur_lr": 0.009999999999999998, "total_loss": 0.7425619861278584, "policy_loss": -6.515895676794191e-05, "vf_loss": 0.7426271464261743, "vf_explained_var": 1.2060637196535786e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.10087793653242, "cur_kl_coeff": 2.2613049995668387e-23, "cur_lr": 0.009999999999999998, "total_loss": 1.039871388102177, "policy_loss": 0.0003411039123656573, "vf_loss": 1.0395302832047775, "vf_explained_var": -5.64509598666398e-09, "kl": 7.528466705646028e-13, "entropy": 7.478995092371734e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -558.0, "episode_reward_mean": -32.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.11, "predator_policy": 17.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 9.0, -185.0, -3.0, 4.0, 1.0, 11.0, 0.0, -196.0, -26.0, -200.0, 6.0, 0.0, -191.0, 6.0, -187.0, -7.0, 0.0, 30.0, -200.0, -11.0, 3.0, 0.0, 8.0, 4.0, -5.0, -12.0, -2.0, 10.0, 0.0, 11.0, 8.0, 12.0, 14.0, -17.0, -29.0, 0.0, 0.0, 0.0, 7.0, -20.0, -19.0, -200.0, -10.0, 3.0, -170.0, 4.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, -2.0, -200.0, -5.0, -10.0, 9.0, -8.0, -20.0, 8.0, 8.0, -3.0, -10.0, 0.0, -1.0, 0.0, 11.0, -186.0, -200.0, -11.0, 29.0, 0.0, -2.0, 23.0, 14.0, 3.0, 19.0, 4.0, -200.0, 8.0, -12.0, -558.0, 0.0, -9.0, -12.0, -180.0, 6.0, 0.0, 0.0, -23.0, 0.0, -15.0, -4.0, -3.0, 12.0, -4.0, 9.0, 0.0, -196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 5.0, 5.0, 4.0, -400.0, 15.0, 0.0, -6.0, 4.0, 0.0, 0.0, -5.0, 11.0, 0.0, 0.0, 0.0, -393.0, 0.0, -20.0, -20.0, -400.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, -384.0, 6.0, 0.0, 13.0, -400.0, -14.0, 0.0, 0.0, 0.0, 15.0, 15.0, -400.0, 0.0, -20.0, -2.0, -5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, -10.0, 0.0, -20.0, -4.0, -18.0, 7.0, 2.0, 8.0, 0.0, 0.0, -2.0, 12.0, 6.0, 0.0, 10.0, -8.0, 15.0, -2.0, -14.0, -20.0, -20.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -20.0, -20.0, -19.0, -20.0, -400.0, 0.0, -20.0, 0.0, 0.0, 3.0, -355.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, -15.0, 0.0, -8.0, -20.0, 9.0, 0.0, -16.0, 0.0, -20.0, -20.0, 8.0, 0.0, 0.0, 8.0, -20.0, 3.0, 0.0, -20.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, 0.0, 11.0, -400.0, 14.0, -400.0, 0.0, -20.0, -11.0, 14.0, 15.0, 0.0, 0.0, -32.0, 12.0, 11.0, 12.0, 0.0, 14.0, 0.0, 3.0, 14.0, 5.0, -27.0, 15.0, -400.0, 0.0, 8.0, 0.0, -15.0, -16.0, -400.0, -358.0, 0.0, 0.0, -9.0, -20.0, -20.0, -7.0, -384.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -16.0, -18.0, 0.0, 0.0, -18.0, -13.0, -8.0, 0.0, -8.0, 1.0, -20.0, 15.0, -10.0, 0.0, 7.0, 0.0, 0.0, 0.0, -393.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 193.0, 7.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 14.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 1.0, 10.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 10.0, 10.0, 10.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 200.0, 0.0, 0.0, 10.0, 10.0, 8.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 200.0, 0.0, 0.0, 8.0, 11.0, 193.0, 7.0, 0.0, 0.0, 20.0, 0.0, 5.0, 10.0, 0.0, 192.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 7.0, 4.0, 0.0, 0.0, 4.0, 10.0, 7.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 197.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8703520225294922, "mean_inference_ms": 2.311401656644102, "mean_action_processing_ms": 0.40170054227853436, "mean_env_wait_ms": 0.3051210038260187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013326287269592285, "StateBufferConnector_ms": 0.0038118362426757812, "ViewRequirementAgentConnector_ms": 0.16116511821746826}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -558.0, "episode_return_mean": -32.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.7830486447898, "num_env_steps_trained_throughput_per_sec": 330.7830486447898, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 11784.373, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11784.319, "sample_time_ms": 1874.416, "learn_time_ms": 9890.292, "learn_throughput": 404.437, "synch_weights_time_ms": 16.584}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "f1691_00000", "date": "2024-08-13_17-13-20", "timestamp": 1723583600, "time_this_iter_s": 12.124100923538208, "time_total_s": 2088.1112909317017, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3effc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2088.1112909317017, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 53.08235294117647, "ram_util_percent": 83.32352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.111139446978886, "cur_kl_coeff": 0.00017838067156503718, "cur_lr": 0.009999999999999998, "total_loss": 0.09992619136584893, "policy_loss": -8.667034328614594e-05, "vf_loss": 0.10001286224327506, "vf_explained_var": 0.0007191872155224836, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.289083996957178, "cur_kl_coeff": 1.1306524997834194e-23, "cur_lr": 0.009999999999999998, "total_loss": 0.211451512475134, "policy_loss": 0.00012036294530998304, "vf_loss": 0.21133115117348977, "vf_explained_var": 0.00023436691395189397, "kl": -1.5008109125610218e-13, "entropy": 7.5412289259785e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -558.0, "episode_reward_mean": -22.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -23.785, "predator_policy": 12.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, -200.0, -11.0, 3.0, 0.0, 8.0, 4.0, -5.0, -12.0, -2.0, 10.0, 0.0, 11.0, 8.0, 12.0, 14.0, -17.0, -29.0, 0.0, 0.0, 0.0, 7.0, -20.0, -19.0, -200.0, -10.0, 3.0, -170.0, 4.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, -2.0, -200.0, -5.0, -10.0, 9.0, -8.0, -20.0, 8.0, 8.0, -3.0, -10.0, 0.0, -1.0, 0.0, 11.0, -186.0, -200.0, -11.0, 29.0, 0.0, -2.0, 23.0, 14.0, 3.0, 19.0, 4.0, -200.0, 8.0, -12.0, -558.0, 0.0, -9.0, -12.0, -180.0, 6.0, 0.0, 0.0, -23.0, 0.0, -15.0, -4.0, -3.0, 12.0, -4.0, 9.0, 0.0, -196.0, 8.0, 0.0, 3.0, -11.0, 0.0, 0.0, -5.0, 0.0, -4.0, 0.0, 0.0, 7.0, 13.0, -20.0, 10.0, 2.0, -10.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 15.0, -400.0, 0.0, -20.0, -2.0, -5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 0.0, -10.0, 0.0, -20.0, -4.0, -18.0, 7.0, 2.0, 8.0, 0.0, 0.0, -2.0, 12.0, 6.0, 0.0, 10.0, -8.0, 15.0, -2.0, -14.0, -20.0, -20.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -20.0, -20.0, -19.0, -20.0, -400.0, 0.0, -20.0, 0.0, 0.0, 3.0, -355.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, -15.0, 0.0, -8.0, -20.0, 9.0, 0.0, -16.0, 0.0, -20.0, -20.0, 8.0, 0.0, 0.0, 8.0, -20.0, 3.0, 0.0, -20.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, 0.0, 11.0, -400.0, 14.0, -400.0, 0.0, -20.0, -11.0, 14.0, 15.0, 0.0, 0.0, -32.0, 12.0, 11.0, 12.0, 0.0, 14.0, 0.0, 3.0, 14.0, 5.0, -27.0, 15.0, -400.0, 0.0, 8.0, 0.0, -15.0, -16.0, -400.0, -358.0, 0.0, 0.0, -9.0, -20.0, -20.0, -7.0, -384.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -16.0, -18.0, 0.0, 0.0, -18.0, -13.0, -8.0, 0.0, -8.0, 1.0, -20.0, 15.0, -10.0, 0.0, 7.0, 0.0, 0.0, 0.0, -393.0, 0.0, -14.0, 15.0, 0.0, 0.0, 0.0, 3.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, 15.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 11.0, -32.0, -22.0, 9.0, 1.0, 0.0, 2.0, -20.0, 0.0, -12.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 200.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 1.0, 10.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 10.0, 10.0, 10.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 200.0, 0.0, 0.0, 10.0, 10.0, 8.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 200.0, 0.0, 0.0, 8.0, 11.0, 193.0, 7.0, 0.0, 0.0, 20.0, 0.0, 5.0, 10.0, 0.0, 192.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 7.0, 4.0, 0.0, 0.0, 4.0, 10.0, 7.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 197.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8707161842266015, "mean_inference_ms": 2.314526313231214, "mean_action_processing_ms": 0.40153844282986645, "mean_env_wait_ms": 0.30518709138466765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013353943824768066, "StateBufferConnector_ms": 0.003803253173828125, "ViewRequirementAgentConnector_ms": 0.1506134271621704}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -558.0, "episode_return_mean": -22.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.1899595528308, "num_env_steps_trained_throughput_per_sec": 348.1899595528308, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 11762.749, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11762.7, "sample_time_ms": 1865.108, "learn_time_ms": 9878.067, "learn_throughput": 404.938, "synch_weights_time_ms": 16.525}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "f1691_00000", "date": "2024-08-13_17-13-32", "timestamp": 1723583612, "time_this_iter_s": 11.533507108688354, "time_total_s": 2099.64479804039, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ee3820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2099.64479804039, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 49.79375, "ram_util_percent": 83.55625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4620899335304753, "cur_kl_coeff": 8.919033578251859e-05, "cur_lr": 0.009999999999999998, "total_loss": 0.6721295815138589, "policy_loss": 0.0002625032791266681, "vf_loss": 0.6718670801550307, "vf_explained_var": 1.4506950580253804e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.341245084890582, "cur_kl_coeff": 5.653262498917097e-24, "cur_lr": 0.009999999999999998, "total_loss": 0.7740354843142013, "policy_loss": 1.941741907367946e-05, "vf_loss": 0.7740160671018419, "vf_explained_var": -6.307369817501653e-10, "kl": 4.753167289562795e-13, "entropy": 7.544823971462617e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -558.0, "episode_reward_mean": -23.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.04, "predator_policy": 13.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -200.0, -10.0, 3.0, -170.0, 4.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, -2.0, -200.0, -5.0, -10.0, 9.0, -8.0, -20.0, 8.0, 8.0, -3.0, -10.0, 0.0, -1.0, 0.0, 11.0, -186.0, -200.0, -11.0, 29.0, 0.0, -2.0, 23.0, 14.0, 3.0, 19.0, 4.0, -200.0, 8.0, -12.0, -558.0, 0.0, -9.0, -12.0, -180.0, 6.0, 0.0, 0.0, -23.0, 0.0, -15.0, -4.0, -3.0, 12.0, -4.0, 9.0, 0.0, -196.0, 8.0, 0.0, 3.0, -11.0, 0.0, 0.0, -5.0, 0.0, -4.0, 0.0, 0.0, 7.0, 13.0, -20.0, 10.0, 2.0, -10.0, -6.0, -18.0, 8.0, 0.0, 0.0, 11.0, -200.0, 15.0, 17.0, -1.0, 0.0, 7.0, 10.0, -5.0, -7.0, 26.0, 0.0, -176.0, 6.0, -4.0, 5.0, 13.0, 0.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.0, -20.0, -400.0, 0.0, -20.0, 0.0, 0.0, 3.0, -355.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, -15.0, 0.0, -8.0, -20.0, 9.0, 0.0, -16.0, 0.0, -20.0, -20.0, 8.0, 0.0, 0.0, 8.0, -20.0, 3.0, 0.0, -20.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, 0.0, 11.0, -400.0, 14.0, -400.0, 0.0, -20.0, -11.0, 14.0, 15.0, 0.0, 0.0, -32.0, 12.0, 11.0, 12.0, 0.0, 14.0, 0.0, 3.0, 14.0, 5.0, -27.0, 15.0, -400.0, 0.0, 8.0, 0.0, -15.0, -16.0, -400.0, -358.0, 0.0, 0.0, -9.0, -20.0, -20.0, -7.0, -384.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -16.0, -18.0, 0.0, 0.0, -18.0, -13.0, -8.0, 0.0, -8.0, 1.0, -20.0, 15.0, -10.0, 0.0, 7.0, 0.0, 0.0, 0.0, -393.0, 0.0, -14.0, 15.0, 0.0, 0.0, 0.0, 3.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, 15.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 11.0, -32.0, -22.0, 9.0, 1.0, 0.0, 2.0, -20.0, 0.0, -12.0, 0.0, -20.0, -13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, -400.0, 0.0, 0.0, 15.0, -8.0, 15.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, -10.0, 0.0, -4.0, -15.0, 11.0, 15.0, 0.0, 0.0, 13.0, -378.0, 0.0, 6.0, -15.0, -9.0, 11.0, -16.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0], "policy_predator_policy_reward": [10.0, 10.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 200.0, 0.0, 0.0, 10.0, 10.0, 8.0, 0.0, 0.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 200.0, 0.0, 0.0, 8.0, 11.0, 193.0, 7.0, 0.0, 0.0, 20.0, 0.0, 5.0, 10.0, 0.0, 192.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 7.0, 4.0, 0.0, 0.0, 4.0, 10.0, 7.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 197.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 5.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8706712004572351, "mean_inference_ms": 2.320241991324329, "mean_action_processing_ms": 0.401790826941083, "mean_env_wait_ms": 0.305044044734392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011000990867614746, "StateBufferConnector_ms": 0.0037769079208374023, "ViewRequirementAgentConnector_ms": 0.1466888189315796}, "num_episodes": 23, "episode_return_max": 29.0, "episode_return_min": -558.0, "episode_return_mean": -23.79, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.0941659199758, "num_env_steps_trained_throughput_per_sec": 333.0941659199758, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 11782.683, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11782.635, "sample_time_ms": 1862.637, "learn_time_ms": 9900.542, "learn_throughput": 404.018, "synch_weights_time_ms": 16.502}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "f1691_00000", "date": "2024-08-13_17-13-44", "timestamp": 1723583624, "time_this_iter_s": 12.051935911178589, "time_total_s": 2111.6967339515686, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ee3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2111.6967339515686, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 51.66111111111111, "ram_util_percent": 83.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.290225829092032, "cur_kl_coeff": 4.4595167891259295e-05, "cur_lr": 0.009999999999999998, "total_loss": 1.1899432430822383, "policy_loss": 1.9929316831092356e-05, "vf_loss": 1.1899233175806267, "vf_explained_var": 0.00010169422815716455, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2577503293069885, "cur_kl_coeff": 2.8266312494585484e-24, "cur_lr": 0.009999999999999998, "total_loss": 1.3323647773928113, "policy_loss": -0.00036658975862400244, "vf_loss": 1.3327313631299942, "vf_explained_var": -1.0533307595227761e-08, "kl": 7.749081137814313e-12, "entropy": 7.398184701423785e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -558.0, "episode_reward_mean": -24.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -26.295, "predator_policy": 13.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, -1.0, 0.0, 11.0, -186.0, -200.0, -11.0, 29.0, 0.0, -2.0, 23.0, 14.0, 3.0, 19.0, 4.0, -200.0, 8.0, -12.0, -558.0, 0.0, -9.0, -12.0, -180.0, 6.0, 0.0, 0.0, -23.0, 0.0, -15.0, -4.0, -3.0, 12.0, -4.0, 9.0, 0.0, -196.0, 8.0, 0.0, 3.0, -11.0, 0.0, 0.0, -5.0, 0.0, -4.0, 0.0, 0.0, 7.0, 13.0, -20.0, 10.0, 2.0, -10.0, -6.0, -18.0, 8.0, 0.0, 0.0, 11.0, -200.0, 15.0, 17.0, -1.0, 0.0, 7.0, 10.0, -5.0, -7.0, 26.0, 0.0, -176.0, 6.0, -4.0, 5.0, 13.0, 0.0, 6.0, -9.0, -10.0, 0.0, -6.0, 0.0, -3.0, 9.0, -190.0, 19.0, 0.0, 21.0, -180.0, -10.0, -354.0, 20.0, 10.0, -10.0, 16.0, -12.0, 0.0, -6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -20.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, 0.0, 11.0, -400.0, 14.0, -400.0, 0.0, -20.0, -11.0, 14.0, 15.0, 0.0, 0.0, -32.0, 12.0, 11.0, 12.0, 0.0, 14.0, 0.0, 3.0, 14.0, 5.0, -27.0, 15.0, -400.0, 0.0, 8.0, 0.0, -15.0, -16.0, -400.0, -358.0, 0.0, 0.0, -9.0, -20.0, -20.0, -7.0, -384.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -16.0, -18.0, 0.0, 0.0, -18.0, -13.0, -8.0, 0.0, -8.0, 1.0, -20.0, 15.0, -10.0, 0.0, 7.0, 0.0, 0.0, 0.0, -393.0, 0.0, -14.0, 15.0, 0.0, 0.0, 0.0, 3.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, 15.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 11.0, -32.0, -22.0, 9.0, 1.0, 0.0, 2.0, -20.0, 0.0, -12.0, 0.0, -20.0, -13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, -400.0, 0.0, 0.0, 15.0, -8.0, 15.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, -10.0, 0.0, -4.0, -15.0, 11.0, 15.0, 0.0, 0.0, 13.0, -378.0, 0.0, 6.0, -15.0, -9.0, 11.0, -16.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, -4.0, -14.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -6.0, 5.0, 4.0, -382.0, 1.0, 4.0, 15.0, 0.0, 0.0, 15.0, 6.0, -378.0, 6.0, 0.0, -20.0, -357.0, -364.0, 11.0, 6.0, 11.0, -9.0, -20.0, 0.0, -3.0, 12.0, -4.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 200.0, 0.0, 0.0, 8.0, 11.0, 193.0, 7.0, 0.0, 0.0, 20.0, 0.0, 5.0, 10.0, 0.0, 192.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 7.0, 4.0, 0.0, 0.0, 4.0, 10.0, 7.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 197.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 5.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 184.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 2.0, 0.0, 10.0, 185.0, 182.0, 0.0, 3.0, 0.0, 8.0, 10.0, 0.0, 7.0, 0.0, 2.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8706985730179315, "mean_inference_ms": 2.3197488489688136, "mean_action_processing_ms": 0.40085888391817853, "mean_env_wait_ms": 0.3050430556796386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061187744140625, "StateBufferConnector_ms": 0.003726482391357422, "ViewRequirementAgentConnector_ms": 0.12455081939697266}, "num_episodes": 22, "episode_return_max": 29.0, "episode_return_min": -558.0, "episode_return_mean": -24.83, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.55377001698866, "num_env_steps_trained_throughput_per_sec": 354.55377001698866, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 11734.653, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11734.602, "sample_time_ms": 1847.763, "learn_time_ms": 9867.205, "learn_throughput": 405.383, "synch_weights_time_ms": 16.465}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "f1691_00000", "date": "2024-08-13_17-13-55", "timestamp": 1723583635, "time_this_iter_s": 11.314432859420776, "time_total_s": 2123.0111668109894, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e63ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2123.0111668109894, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 51.55625, "ram_util_percent": 83.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0834094474758897, "cur_kl_coeff": 2.2297583945629647e-05, "cur_lr": 0.009999999999999998, "total_loss": 0.7908689517981161, "policy_loss": -8.266004511997813e-06, "vf_loss": 0.7908772158086615, "vf_explained_var": -4.9828221558263064e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3241447720554085, "cur_kl_coeff": 1.4133156247292742e-24, "cur_lr": 0.009999999999999998, "total_loss": 0.8986297889834358, "policy_loss": 5.0769364658408065e-05, "vf_loss": 0.8985790181412268, "vf_explained_var": -8.704170348152282e-09, "kl": 1.9996252402299134e-12, "entropy": 7.290906524488229e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -558.0, "episode_reward_mean": -22.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -24.11, "predator_policy": 12.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -558.0, 0.0, -9.0, -12.0, -180.0, 6.0, 0.0, 0.0, -23.0, 0.0, -15.0, -4.0, -3.0, 12.0, -4.0, 9.0, 0.0, -196.0, 8.0, 0.0, 3.0, -11.0, 0.0, 0.0, -5.0, 0.0, -4.0, 0.0, 0.0, 7.0, 13.0, -20.0, 10.0, 2.0, -10.0, -6.0, -18.0, 8.0, 0.0, 0.0, 11.0, -200.0, 15.0, 17.0, -1.0, 0.0, 7.0, 10.0, -5.0, -7.0, 26.0, 0.0, -176.0, 6.0, -4.0, 5.0, 13.0, 0.0, 6.0, -9.0, -10.0, 0.0, -6.0, 0.0, -3.0, 9.0, -190.0, 19.0, 0.0, 21.0, -180.0, -10.0, -354.0, 20.0, 10.0, -10.0, 16.0, -12.0, 0.0, -6.0, 0.0, 11.0, 25.0, 0.0, 0.0, -6.0, 0.0, -184.0, -1.0, -8.0, -2.0, 0.0, 0.0, -153.0, 0.0, 3.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, -16.0, -400.0, -358.0, 0.0, 0.0, -9.0, -20.0, -20.0, -7.0, -384.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, -16.0, -18.0, 0.0, 0.0, -18.0, -13.0, -8.0, 0.0, -8.0, 1.0, -20.0, 15.0, -10.0, 0.0, 7.0, 0.0, 0.0, 0.0, -393.0, 0.0, -14.0, 15.0, 0.0, 0.0, 0.0, 3.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, 15.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 11.0, -32.0, -22.0, 9.0, 1.0, 0.0, 2.0, -20.0, 0.0, -12.0, 0.0, -20.0, -13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, -400.0, 0.0, 0.0, 15.0, -8.0, 15.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, -10.0, 0.0, -4.0, -15.0, 11.0, 15.0, 0.0, 0.0, 13.0, -378.0, 0.0, 6.0, -15.0, -9.0, 11.0, -16.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, -4.0, -14.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -6.0, 5.0, 4.0, -382.0, 1.0, 4.0, 15.0, 0.0, 0.0, 15.0, 6.0, -378.0, 6.0, 0.0, -20.0, -357.0, -364.0, 11.0, 6.0, 11.0, -9.0, -20.0, 0.0, -3.0, 12.0, -4.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 11.0, 15.0, 10.0, -20.0, 10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -376.0, 0.0, -11.0, 0.0, 0.0, -16.0, -16.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, -351.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [8.0, 11.0, 193.0, 7.0, 0.0, 0.0, 20.0, 0.0, 5.0, 10.0, 0.0, 192.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 7.0, 4.0, 0.0, 0.0, 4.0, 10.0, 7.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 197.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 5.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 184.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 2.0, 0.0, 10.0, 185.0, 182.0, 0.0, 3.0, 0.0, 8.0, 10.0, 0.0, 7.0, 0.0, 2.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 184.0, 8.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8698805587213135, "mean_inference_ms": 2.3197372866167476, "mean_action_processing_ms": 0.4002500889821684, "mean_env_wait_ms": 0.3047289621359563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004764080047607422, "StateBufferConnector_ms": 0.003936767578125, "ViewRequirementAgentConnector_ms": 0.11794793605804443}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -558.0, "episode_return_mean": -22.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.6358693758747, "num_env_steps_trained_throughput_per_sec": 344.6358693758747, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 11742.263, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11742.212, "sample_time_ms": 1847.106, "learn_time_ms": 9874.951, "learn_throughput": 405.065, "synch_weights_time_ms": 16.785}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "f1691_00000", "date": "2024-08-13_17-14-07", "timestamp": 1723583647, "time_this_iter_s": 11.661312818527222, "time_total_s": 2134.6724796295166, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e6b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2134.6724796295166, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 49.54375, "ram_util_percent": 83.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.359986381679798, "cur_kl_coeff": 1.1148791972814824e-05, "cur_lr": 0.009999999999999998, "total_loss": 1.241406548401666, "policy_loss": -4.1885830944886916e-05, "vf_loss": 1.2414484290613068, "vf_explained_var": -9.587202122602513e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4199515475249704, "cur_kl_coeff": 7.066578123646371e-25, "cur_lr": 0.009999999999999998, "total_loss": 1.6506391352288938, "policy_loss": 0.00019726873814034714, "vf_loss": 1.6504418643694074, "vf_explained_var": -1.0091791708002645e-08, "kl": -2.758003171210632e-12, "entropy": 7.321749854494656e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -590.0, "episode_reward_mean": -29.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.785, "predator_policy": 16.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-196.0, 8.0, 0.0, 3.0, -11.0, 0.0, 0.0, -5.0, 0.0, -4.0, 0.0, 0.0, 7.0, 13.0, -20.0, 10.0, 2.0, -10.0, -6.0, -18.0, 8.0, 0.0, 0.0, 11.0, -200.0, 15.0, 17.0, -1.0, 0.0, 7.0, 10.0, -5.0, -7.0, 26.0, 0.0, -176.0, 6.0, -4.0, 5.0, 13.0, 0.0, 6.0, -9.0, -10.0, 0.0, -6.0, 0.0, -3.0, 9.0, -190.0, 19.0, 0.0, 21.0, -180.0, -10.0, -354.0, 20.0, 10.0, -10.0, 16.0, -12.0, 0.0, -6.0, 0.0, 11.0, 25.0, 0.0, 0.0, -6.0, 0.0, -184.0, -1.0, -8.0, -2.0, 0.0, 0.0, -153.0, 0.0, 3.0, 0.0, 0.0, 0.0, -12.0, 6.0, 4.0, -10.0, 7.0, -590.0, -171.0, -187.0, 12.0, 12.0, 10.0, 30.0, -384.0, -2.0, 15.0, -3.0, -5.0, -173.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-393.0, 0.0, -14.0, 15.0, 0.0, 0.0, 0.0, 3.0, -25.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, 15.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 11.0, -32.0, -22.0, 9.0, 1.0, 0.0, 2.0, -20.0, 0.0, -12.0, 0.0, -20.0, -13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, -400.0, 0.0, 0.0, 15.0, -8.0, 15.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, -10.0, 0.0, -4.0, -15.0, 11.0, 15.0, 0.0, 0.0, 13.0, -378.0, 0.0, 6.0, -15.0, -9.0, 11.0, -16.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, -4.0, -14.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -6.0, 5.0, 4.0, -382.0, 1.0, 4.0, 15.0, 0.0, 0.0, 15.0, 6.0, -378.0, 6.0, 0.0, -20.0, -357.0, -364.0, 11.0, 6.0, 11.0, -9.0, -20.0, 0.0, -3.0, 12.0, -4.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 11.0, 15.0, 10.0, -20.0, 10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -376.0, 0.0, -11.0, 0.0, 0.0, -16.0, -16.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, -351.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -8.0, 6.0, 0.0, 0.0, 4.0, -20.0, 0.0, 0.0, 7.0, -394.0, -394.0, 0.0, -356.0, -400.0, 13.0, 12.0, 0.0, 12.0, 0.0, 2.0, 8.0, 15.0, 15.0, -400.0, -375.0, 0.0, -4.0, 0.0, 15.0, -13.0, 0.0, -15.0, 0.0, -370.0, 12.0], "policy_predator_policy_reward": [0.0, 197.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 5.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 184.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 2.0, 0.0, 10.0, 185.0, 182.0, 0.0, 3.0, 0.0, 8.0, 10.0, 0.0, 7.0, 0.0, 2.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 184.0, 8.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 185.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8686581095538739, "mean_inference_ms": 2.3185223105464017, "mean_action_processing_ms": 0.39949536183020734, "mean_env_wait_ms": 0.30429878366836155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004410743713378906, "StateBufferConnector_ms": 0.0040740966796875, "ViewRequirementAgentConnector_ms": 0.11114978790283203}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -590.0, "episode_return_mean": -29.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.7571993421527, "num_env_steps_trained_throughput_per_sec": 345.7571993421527, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 11743.404, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11743.354, "sample_time_ms": 1844.087, "learn_time_ms": 9879.827, "learn_throughput": 404.865, "synch_weights_time_ms": 16.871}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "f1691_00000", "date": "2024-08-13_17-14-18", "timestamp": 1723583658, "time_this_iter_s": 11.60297703742981, "time_total_s": 2146.2754566669464, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e63b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2146.2754566669464, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 51.762499999999996, "ram_util_percent": 83.49374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.34208980416337, "cur_kl_coeff": 5.574395986407412e-06, "cur_lr": 0.009999999999999998, "total_loss": 0.8511325726748774, "policy_loss": 7.001498896411802e-05, "vf_loss": 0.8510625592221028, "vf_explained_var": -6.149685572064112e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1998595646751316, "cur_kl_coeff": 3.5332890618231855e-25, "cur_lr": 0.009999999999999998, "total_loss": 1.1658530928706996, "policy_loss": 0.00021427364615851608, "vf_loss": 1.165638824903145, "vf_explained_var": -9.11414938628989e-09, "kl": -2.439102203752544e-12, "entropy": 7.334575839330885e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -590.0, "episode_reward_mean": -29.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.09, "predator_policy": 16.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -18.0, 8.0, 0.0, 0.0, 11.0, -200.0, 15.0, 17.0, -1.0, 0.0, 7.0, 10.0, -5.0, -7.0, 26.0, 0.0, -176.0, 6.0, -4.0, 5.0, 13.0, 0.0, 6.0, -9.0, -10.0, 0.0, -6.0, 0.0, -3.0, 9.0, -190.0, 19.0, 0.0, 21.0, -180.0, -10.0, -354.0, 20.0, 10.0, -10.0, 16.0, -12.0, 0.0, -6.0, 0.0, 11.0, 25.0, 0.0, 0.0, -6.0, 0.0, -184.0, -1.0, -8.0, -2.0, 0.0, 0.0, -153.0, 0.0, 3.0, 0.0, 0.0, 0.0, -12.0, 6.0, 4.0, -10.0, 7.0, -590.0, -171.0, -187.0, 12.0, 12.0, 10.0, 30.0, -384.0, -2.0, 15.0, -3.0, -5.0, -173.0, -6.0, 8.0, -3.0, -24.0, -2.0, -10.0, 0.0, -9.0, 15.0, -22.0, -10.0, -200.0, 14.0, 0.0, 0.0, 15.0, 0.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 0.0, -20.0, -13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, -400.0, 0.0, 0.0, 15.0, -8.0, 15.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, -10.0, 0.0, -4.0, -15.0, 11.0, 15.0, 0.0, 0.0, 13.0, -378.0, 0.0, 6.0, -15.0, -9.0, 11.0, -16.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, -4.0, -14.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -6.0, 5.0, 4.0, -382.0, 1.0, 4.0, 15.0, 0.0, 0.0, 15.0, 6.0, -378.0, 6.0, 0.0, -20.0, -357.0, -364.0, 11.0, 6.0, 11.0, -9.0, -20.0, 0.0, -3.0, 12.0, -4.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 11.0, 15.0, 10.0, -20.0, 10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -376.0, 0.0, -11.0, 0.0, 0.0, -16.0, -16.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, -351.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -8.0, 6.0, 0.0, 0.0, 4.0, -20.0, 0.0, 0.0, 7.0, -394.0, -394.0, 0.0, -356.0, -400.0, 13.0, 12.0, 0.0, 12.0, 0.0, 2.0, 8.0, 15.0, 15.0, -400.0, -375.0, 0.0, -4.0, 0.0, 15.0, -13.0, 0.0, -15.0, 0.0, -370.0, 12.0, -13.0, -6.0, 8.0, 0.0, 0.0, -13.0, -18.0, -20.0, -7.0, 0.0, -20.0, 0.0, 0.0, 0.0, -1.0, -20.0, 15.0, 0.0, -34.0, -14.0, 0.0, -20.0, 0.0, -400.0, 15.0, -2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -15.0], "policy_predator_policy_reward": [6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 5.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 184.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 2.0, 0.0, 10.0, 185.0, 182.0, 0.0, 3.0, 0.0, 8.0, 10.0, 0.0, 7.0, 0.0, 2.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 184.0, 8.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 185.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 185.0, 3.0, 10.0, 0.0, 0.0, 0.0, 10.0, 14.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 17.0, 9.0, 0.0, 10.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8674060027618304, "mean_inference_ms": 2.3172600455432617, "mean_action_processing_ms": 0.39873346238715035, "mean_env_wait_ms": 0.30386076879623247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007245302200317383, "StateBufferConnector_ms": 0.00410914421081543, "ViewRequirementAgentConnector_ms": 0.11131119728088379}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -590.0, "episode_return_mean": -29.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.7808717261896, "num_env_steps_trained_throughput_per_sec": 347.7808717261896, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 11725.719, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11725.67, "sample_time_ms": 1819.22, "learn_time_ms": 9887.784, "learn_throughput": 404.54, "synch_weights_time_ms": 16.248}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "f1691_00000", "date": "2024-08-13_17-14-30", "timestamp": 1723583670, "time_this_iter_s": 11.55282711982727, "time_total_s": 2157.8282837867737, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e6b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2157.8282837867737, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 49.6, "ram_util_percent": 83.54117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.484799379151975, "cur_kl_coeff": 2.787197993203706e-06, "cur_lr": 0.009999999999999998, "total_loss": 0.9657857959548002, "policy_loss": -4.595574164004238e-05, "vf_loss": 0.9658317488889215, "vf_explained_var": -7.758064875527034e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5675831961816313, "cur_kl_coeff": 1.7666445309115927e-25, "cur_lr": 0.009999999999999998, "total_loss": 1.4071158208780818, "policy_loss": -0.0001664280096837689, "vf_loss": 1.4072822463102441, "vf_explained_var": -6.938106799251818e-09, "kl": 3.244979154446265e-12, "entropy": 7.29752105586823e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -590.0, "episode_reward_mean": -43.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.825, "predator_policy": 19.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 0.0, -3.0, 9.0, -190.0, 19.0, 0.0, 21.0, -180.0, -10.0, -354.0, 20.0, 10.0, -10.0, 16.0, -12.0, 0.0, -6.0, 0.0, 11.0, 25.0, 0.0, 0.0, -6.0, 0.0, -184.0, -1.0, -8.0, -2.0, 0.0, 0.0, -153.0, 0.0, 3.0, 0.0, 0.0, 0.0, -12.0, 6.0, 4.0, -10.0, 7.0, -590.0, -171.0, -187.0, 12.0, 12.0, 10.0, 30.0, -384.0, -2.0, 15.0, -3.0, -5.0, -173.0, -6.0, 8.0, -3.0, -24.0, -2.0, -10.0, 0.0, -9.0, 15.0, -22.0, -10.0, -200.0, 14.0, 0.0, 0.0, 15.0, 0.0, -5.0, -4.0, 7.0, 15.0, -4.0, 0.0, -10.0, -200.0, -585.0, 10.0, 0.0, 16.0, 10.0, 4.0, 4.0, 0.0, -556.0, 16.0, -15.0, 0.0, -185.0, -200.0, 2.0, 8.0, 0.0, -2.0, 0.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -12.0, 0.0, 0.0, 0.0, -6.0, 5.0, 4.0, -382.0, 1.0, 4.0, 15.0, 0.0, 0.0, 15.0, 6.0, -378.0, 6.0, 0.0, -20.0, -357.0, -364.0, 11.0, 6.0, 11.0, -9.0, -20.0, 0.0, -3.0, 12.0, -4.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 11.0, 15.0, 10.0, -20.0, 10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -376.0, 0.0, -11.0, 0.0, 0.0, -16.0, -16.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, -351.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -8.0, 6.0, 0.0, 0.0, 4.0, -20.0, 0.0, 0.0, 7.0, -394.0, -394.0, 0.0, -356.0, -400.0, 13.0, 12.0, 0.0, 12.0, 0.0, 2.0, 8.0, 15.0, 15.0, -400.0, -375.0, 0.0, -4.0, 0.0, 15.0, -13.0, 0.0, -15.0, 0.0, -370.0, 12.0, -13.0, -6.0, 8.0, 0.0, 0.0, -13.0, -18.0, -20.0, -7.0, 0.0, -20.0, 0.0, 0.0, 0.0, -1.0, -20.0, 15.0, 0.0, -34.0, -14.0, 0.0, -20.0, 0.0, -400.0, 15.0, -2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, -18.0, 0.0, 7.0, 0.0, 15.0, 6.0, -20.0, 0.0, 0.0, 0.0, -20.0, -400.0, 0.0, -400.0, -385.0, 10.0, 0.0, 4.0, -18.0, 15.0, 1.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, -384.0, -366.0, 3.0, 13.0, -15.0, -20.0, 0.0, 0.0, -400.0, 15.0, 0.0, -400.0, -1.0, -8.0, -14.0, 15.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -6.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 184.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 2.0, 0.0, 10.0, 185.0, 182.0, 0.0, 3.0, 0.0, 8.0, 10.0, 0.0, 7.0, 0.0, 2.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 184.0, 8.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 185.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 185.0, 3.0, 10.0, 0.0, 0.0, 0.0, 10.0, 14.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 17.0, 9.0, 0.0, 10.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8656874104562812, "mean_inference_ms": 2.316165855675043, "mean_action_processing_ms": 0.39762403029654103, "mean_env_wait_ms": 0.3032362082458156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00751042366027832, "StateBufferConnector_ms": 0.004188418388366699, "ViewRequirementAgentConnector_ms": 0.11294353008270264}, "num_episodes": 27, "episode_return_max": 30.0, "episode_return_min": -590.0, "episode_return_mean": -43.38, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.2197454756826, "num_env_steps_trained_throughput_per_sec": 345.2197454756826, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 11722.448, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11722.395, "sample_time_ms": 1802.487, "learn_time_ms": 9901.836, "learn_throughput": 403.965, "synch_weights_time_ms": 15.608}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "f1691_00000", "date": "2024-08-13_17-14-42", "timestamp": 1723583682, "time_this_iter_s": 11.657089948654175, "time_total_s": 2169.485373735428, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3df2ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2169.485373735428, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 50.6875, "ram_util_percent": 83.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3145285051636937, "cur_kl_coeff": 1.393598996601853e-06, "cur_lr": 0.009999999999999998, "total_loss": 1.1259190790552311, "policy_loss": 2.0695486347432488e-05, "vf_loss": 1.125898378157111, "vf_explained_var": -7.789601724614542e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.10101169878851, "cur_kl_coeff": 8.833222654557964e-26, "cur_lr": 0.009999999999999998, "total_loss": 1.4975613979908524, "policy_loss": -0.0002263151996192478, "vf_loss": 1.4977877113711897, "vf_explained_var": -1.1164044576977927e-08, "kl": 2.6760045811024496e-12, "entropy": 7.162771800258041e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -590.0, "episode_reward_mean": -47.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -43.27, "predator_policy": 19.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 11.0, 25.0, 0.0, 0.0, -6.0, 0.0, -184.0, -1.0, -8.0, -2.0, 0.0, 0.0, -153.0, 0.0, 3.0, 0.0, 0.0, 0.0, -12.0, 6.0, 4.0, -10.0, 7.0, -590.0, -171.0, -187.0, 12.0, 12.0, 10.0, 30.0, -384.0, -2.0, 15.0, -3.0, -5.0, -173.0, -6.0, 8.0, -3.0, -24.0, -2.0, -10.0, 0.0, -9.0, 15.0, -22.0, -10.0, -200.0, 14.0, 0.0, 0.0, 15.0, 0.0, -5.0, -4.0, 7.0, 15.0, -4.0, 0.0, -10.0, -200.0, -585.0, 10.0, 0.0, 16.0, 10.0, 4.0, 4.0, 0.0, -556.0, 16.0, -15.0, 0.0, -185.0, -200.0, 2.0, 8.0, 0.0, -2.0, 0.0, 2.0, -199.0, 0.0, 15.0, -574.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 23.0, 0.0, 0.0, 10.0, -198.0, 0.0, -15.0, -195.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 11.0, 15.0, 10.0, -20.0, 10.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, -376.0, 0.0, -11.0, 0.0, 0.0, -16.0, -16.0, 6.0, 0.0, 0.0, 0.0, 0.0, 15.0, -351.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -8.0, 6.0, 0.0, 0.0, 4.0, -20.0, 0.0, 0.0, 7.0, -394.0, -394.0, 0.0, -356.0, -400.0, 13.0, 12.0, 0.0, 12.0, 0.0, 2.0, 8.0, 15.0, 15.0, -400.0, -375.0, 0.0, -4.0, 0.0, 15.0, -13.0, 0.0, -15.0, 0.0, -370.0, 12.0, -13.0, -6.0, 8.0, 0.0, 0.0, -13.0, -18.0, -20.0, -7.0, 0.0, -20.0, 0.0, 0.0, 0.0, -1.0, -20.0, 15.0, 0.0, -34.0, -14.0, 0.0, -20.0, 0.0, -400.0, 15.0, -2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, -18.0, 0.0, 7.0, 0.0, 15.0, 6.0, -20.0, 0.0, 0.0, 0.0, -20.0, -400.0, 0.0, -400.0, -385.0, 10.0, 0.0, 4.0, -18.0, 15.0, 1.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, -384.0, -366.0, 3.0, 13.0, -15.0, -20.0, 0.0, 0.0, -400.0, 15.0, 0.0, -400.0, -1.0, -8.0, -14.0, 15.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -6.0, 0.0, -398.0, 0.0, -8.0, 0.0, 0.0, 15.0, -388.0, -380.0, 0.0, 0.0, -15.0, 10.0, 9.0, -6.0, 0.0, 0.0, -5.0, 0.0, 6.0, -14.0, 8.0, 15.0, 0.0, 0.0, 6.0, -12.0, 0.0, 5.0, 0.0, -396.0, 0.0, 0.0, 0.0, -32.0, 0.0, -400.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 184.0, 8.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 185.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 185.0, 3.0, 10.0, 0.0, 0.0, 0.0, 10.0, 14.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 17.0, 9.0, 0.0, 10.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 199.0, 8.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 8.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 198.0, 0.0, 0.0, 0.0, 10.0, 7.0, 5.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8642849507910871, "mean_inference_ms": 2.314312959348456, "mean_action_processing_ms": 0.39692449687678955, "mean_env_wait_ms": 0.30284625738551446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007542848587036133, "StateBufferConnector_ms": 0.0038660764694213867, "ViewRequirementAgentConnector_ms": 0.11298596858978271}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -590.0, "episode_return_mean": -47.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.6764695441551, "num_env_steps_trained_throughput_per_sec": 347.6764695441551, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 11671.112, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11671.06, "sample_time_ms": 1713.221, "learn_time_ms": 9939.352, "learn_throughput": 402.441, "synch_weights_time_ms": 15.973}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "f1691_00000", "date": "2024-08-13_17-14-53", "timestamp": 1723583693, "time_this_iter_s": 11.585768938064575, "time_total_s": 2181.0711426734924, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3eff3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2181.0711426734924, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 52.805882352941175, "ram_util_percent": 83.63529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.159801370558383, "cur_kl_coeff": 6.967994983009265e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.776250984555199, "policy_loss": 0.00010192938045495086, "vf_loss": 0.7761490529649472, "vf_explained_var": -6.938106799251819e-10, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.197072953928851, "cur_kl_coeff": 4.416611327278982e-26, "cur_lr": 0.009999999999999998, "total_loss": 0.8533183399371054, "policy_loss": 2.345848488547499e-05, "vf_loss": 0.8532948816185275, "vf_explained_var": -8.578022951802249e-09, "kl": 2.175495656787169e-12, "entropy": 7.035779639555476e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -590.0, "episode_reward_mean": -46.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.545, "predator_policy": 18.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -12.0, 6.0, 4.0, -10.0, 7.0, -590.0, -171.0, -187.0, 12.0, 12.0, 10.0, 30.0, -384.0, -2.0, 15.0, -3.0, -5.0, -173.0, -6.0, 8.0, -3.0, -24.0, -2.0, -10.0, 0.0, -9.0, 15.0, -22.0, -10.0, -200.0, 14.0, 0.0, 0.0, 15.0, 0.0, -5.0, -4.0, 7.0, 15.0, -4.0, 0.0, -10.0, -200.0, -585.0, 10.0, 0.0, 16.0, 10.0, 4.0, 4.0, 0.0, -556.0, 16.0, -15.0, 0.0, -185.0, -200.0, 2.0, 8.0, 0.0, -2.0, 0.0, 2.0, -199.0, 0.0, 15.0, -574.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 23.0, 0.0, 0.0, 10.0, -198.0, 0.0, -15.0, -195.0, 0.0, 26.0, -7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 15.0, 1.0, 0.0, 1.0, -10.0, 0.0, 9.0, 0.0, -200.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -8.0, -8.0, 6.0, 0.0, 0.0, 4.0, -20.0, 0.0, 0.0, 7.0, -394.0, -394.0, 0.0, -356.0, -400.0, 13.0, 12.0, 0.0, 12.0, 0.0, 2.0, 8.0, 15.0, 15.0, -400.0, -375.0, 0.0, -4.0, 0.0, 15.0, -13.0, 0.0, -15.0, 0.0, -370.0, 12.0, -13.0, -6.0, 8.0, 0.0, 0.0, -13.0, -18.0, -20.0, -7.0, 0.0, -20.0, 0.0, 0.0, 0.0, -1.0, -20.0, 15.0, 0.0, -34.0, -14.0, 0.0, -20.0, 0.0, -400.0, 15.0, -2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, -18.0, 0.0, 7.0, 0.0, 15.0, 6.0, -20.0, 0.0, 0.0, 0.0, -20.0, -400.0, 0.0, -400.0, -385.0, 10.0, 0.0, 4.0, -18.0, 15.0, 1.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, -384.0, -366.0, 3.0, 13.0, -15.0, -20.0, 0.0, 0.0, -400.0, 15.0, 0.0, -400.0, -1.0, -8.0, -14.0, 15.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -6.0, 0.0, -398.0, 0.0, -8.0, 0.0, 0.0, 15.0, -388.0, -380.0, 0.0, 0.0, -15.0, 10.0, 9.0, -6.0, 0.0, 0.0, -5.0, 0.0, 6.0, -14.0, 8.0, 15.0, 0.0, 0.0, 6.0, -12.0, 0.0, 5.0, 0.0, -396.0, 0.0, 0.0, 0.0, -32.0, 0.0, -400.0, 0.0, 0.0, 11.0, 15.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 0.0, 15.0, -9.0, 0.0, 0.0, 0.0, 7.0, -12.0, -20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -400.0, 0.0, -1.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 185.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 185.0, 3.0, 10.0, 0.0, 0.0, 0.0, 10.0, 14.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 17.0, 9.0, 0.0, 10.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 199.0, 8.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 8.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 198.0, 0.0, 0.0, 0.0, 10.0, 7.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 200.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8629529737016309, "mean_inference_ms": 2.3129876905470557, "mean_action_processing_ms": 0.3961819879133541, "mean_env_wait_ms": 0.30241456644839393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007537126541137695, "StateBufferConnector_ms": 0.003538846969604492, "ViewRequirementAgentConnector_ms": 0.10742008686065674}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -590.0, "episode_return_mean": -46.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.1318054499554, "num_env_steps_trained_throughput_per_sec": 345.1318054499554, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 11622.931, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11622.878, "sample_time_ms": 1588.033, "learn_time_ms": 10016.336, "learn_throughput": 399.348, "synch_weights_time_ms": 16.014}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "f1691_00000", "date": "2024-08-13_17-15-05", "timestamp": 1723583705, "time_this_iter_s": 11.64842700958252, "time_total_s": 2192.719569683075, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f0d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2192.719569683075, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 51.56875, "ram_util_percent": 83.51875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.413179626719282, "cur_kl_coeff": 3.4839974915046324e-07, "cur_lr": 0.009999999999999998, "total_loss": 1.6843203793757806, "policy_loss": -0.00013949368986739682, "vf_loss": 1.684459867426958, "vf_explained_var": -9.965644311652613e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.233933478158593, "cur_kl_coeff": 2.208305663639491e-26, "cur_lr": 0.009999999999999998, "total_loss": 2.470259693186119, "policy_loss": -4.627280449741101e-05, "vf_loss": 2.470305974332113, "vf_explained_var": -7.2850121392144095e-09, "kl": 3.740591203651585e-12, "entropy": 7.018435571927168e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -591.0, "episode_reward_mean": -48.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.0, "predator_policy": 19.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.0, -6.0, 8.0, -3.0, -24.0, -2.0, -10.0, 0.0, -9.0, 15.0, -22.0, -10.0, -200.0, 14.0, 0.0, 0.0, 15.0, 0.0, -5.0, -4.0, 7.0, 15.0, -4.0, 0.0, -10.0, -200.0, -585.0, 10.0, 0.0, 16.0, 10.0, 4.0, 4.0, 0.0, -556.0, 16.0, -15.0, 0.0, -185.0, -200.0, 2.0, 8.0, 0.0, -2.0, 0.0, 2.0, -199.0, 0.0, 15.0, -574.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 23.0, 0.0, 0.0, 10.0, -198.0, 0.0, -15.0, -195.0, 0.0, 26.0, -7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 15.0, 1.0, 0.0, 1.0, -10.0, 0.0, 9.0, 0.0, -200.0, 0.0, -190.0, 6.0, 15.0, -177.0, -192.0, -6.0, 2.0, -3.0, 0.0, -591.0, -367.0, 0.0, 0.0, -26.0, -4.0, 22.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-370.0, 12.0, -13.0, -6.0, 8.0, 0.0, 0.0, -13.0, -18.0, -20.0, -7.0, 0.0, -20.0, 0.0, 0.0, 0.0, -1.0, -20.0, 15.0, 0.0, -34.0, -14.0, 0.0, -20.0, 0.0, -400.0, 15.0, -2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -15.0, 5.0, -18.0, 0.0, 7.0, 0.0, 15.0, 6.0, -20.0, 0.0, 0.0, 0.0, -20.0, -400.0, 0.0, -400.0, -385.0, 10.0, 0.0, 4.0, -18.0, 15.0, 1.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, -384.0, -366.0, 3.0, 13.0, -15.0, -20.0, 0.0, 0.0, -400.0, 15.0, 0.0, -400.0, -1.0, -8.0, -14.0, 15.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -6.0, 0.0, -398.0, 0.0, -8.0, 0.0, 0.0, 15.0, -388.0, -380.0, 0.0, 0.0, -15.0, 10.0, 9.0, -6.0, 0.0, 0.0, -5.0, 0.0, 6.0, -14.0, 8.0, 15.0, 0.0, 0.0, 6.0, -12.0, 0.0, 5.0, 0.0, -396.0, 0.0, 0.0, 0.0, -32.0, 0.0, -400.0, 0.0, 0.0, 11.0, 15.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 0.0, 15.0, -9.0, 0.0, 0.0, 0.0, 7.0, -12.0, -20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -400.0, 0.0, -1.0, 0.0, -380.0, 0.0, 3.0, -6.0, 0.0, 15.0, -365.0, 0.0, -390.0, 3.0, 0.0, -14.0, 0.0, -5.0, -18.0, 0.0, 0.0, 0.0, -391.0, -400.0, -367.0, -400.0, 0.0, 0.0, 0.0, 0.0, -24.0, -28.0, 0.0, -24.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 185.0, 3.0, 10.0, 0.0, 0.0, 0.0, 10.0, 14.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 17.0, 9.0, 0.0, 10.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 199.0, 8.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 8.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 198.0, 0.0, 0.0, 0.0, 10.0, 7.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 200.0, 0.0, 0.0, 1.0, 0.0, 190.0, 9.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 195.0, 0.0, 8.0, 7.0, 0.0, 6.0, 9.0, 0.0, 0.0, 200.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 14.0, 12.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8616291455756602, "mean_inference_ms": 2.3117006720831794, "mean_action_processing_ms": 0.395435682245677, "mean_env_wait_ms": 0.3019781016649072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007645726203918457, "StateBufferConnector_ms": 0.003482222557067871, "ViewRequirementAgentConnector_ms": 0.10555136203765869}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -591.0, "episode_return_mean": -48.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.0591954851479, "num_env_steps_trained_throughput_per_sec": 350.0591954851479, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 11556.343, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11556.291, "sample_time_ms": 1503.697, "learn_time_ms": 10034.246, "learn_throughput": 398.635, "synch_weights_time_ms": 15.883}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "f1691_00000", "date": "2024-08-13_17-15-16", "timestamp": 1723583716, "time_this_iter_s": 11.468899965286255, "time_total_s": 2204.188469648361, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db3040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2204.188469648361, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 50.9125, "ram_util_percent": 83.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4812515337317667, "cur_kl_coeff": 1.7419987457523162e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.8039785723522227, "policy_loss": 7.258585836521532e-05, "vf_loss": 0.8039059871955524, "vf_explained_var": -2.7752427197007274e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2663804267843872, "cur_kl_coeff": 1.1041528318197455e-26, "cur_lr": 0.009999999999999998, "total_loss": 0.979688939998153, "policy_loss": -0.00013181654559004874, "vf_loss": 0.9798207565432503, "vf_explained_var": -7.032717346514344e-09, "kl": 3.935125086324744e-12, "entropy": 6.884549964329579e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -597.0, "episode_reward_mean": -61.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -53.5, "predator_policy": 22.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -200.0, -585.0, 10.0, 0.0, 16.0, 10.0, 4.0, 4.0, 0.0, -556.0, 16.0, -15.0, 0.0, -185.0, -200.0, 2.0, 8.0, 0.0, -2.0, 0.0, 2.0, -199.0, 0.0, 15.0, -574.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 23.0, 0.0, 0.0, 10.0, -198.0, 0.0, -15.0, -195.0, 0.0, 26.0, -7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 15.0, 1.0, 0.0, 1.0, -10.0, 0.0, 9.0, 0.0, -200.0, 0.0, -190.0, 6.0, 15.0, -177.0, -192.0, -6.0, 2.0, -3.0, 0.0, -591.0, -367.0, 0.0, 0.0, -26.0, -4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 10.0, -200.0, 17.0, 0.0, 10.0, -5.0, -180.0, 0.0, 0.0, -569.0, -191.0, -1.0, -597.0, -8.0, -17.0, 5.0, -17.0, 21.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -20.0, -400.0, 0.0, -400.0, -385.0, 10.0, 0.0, 4.0, -18.0, 15.0, 1.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, -384.0, -366.0, 3.0, 13.0, -15.0, -20.0, 0.0, 0.0, -400.0, 15.0, 0.0, -400.0, -1.0, -8.0, -14.0, 15.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, -6.0, 0.0, -398.0, 0.0, -8.0, 0.0, 0.0, 15.0, -388.0, -380.0, 0.0, 0.0, -15.0, 10.0, 9.0, -6.0, 0.0, 0.0, -5.0, 0.0, 6.0, -14.0, 8.0, 15.0, 0.0, 0.0, 6.0, -12.0, 0.0, 5.0, 0.0, -396.0, 0.0, 0.0, 0.0, -32.0, 0.0, -400.0, 0.0, 0.0, 11.0, 15.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 0.0, 15.0, -9.0, 0.0, 0.0, 0.0, 7.0, -12.0, -20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -400.0, 0.0, -1.0, 0.0, -380.0, 0.0, 3.0, -6.0, 0.0, 15.0, -365.0, 0.0, -390.0, 3.0, 0.0, -14.0, 0.0, -5.0, -18.0, 0.0, 0.0, 0.0, -391.0, -400.0, -367.0, -400.0, 0.0, 0.0, 0.0, 0.0, -24.0, -28.0, 0.0, -24.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -400.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, -10.0, 0.0, -390.0, 15.0, 0.0, 0.0, 0.0, 0.0, -380.0, -398.0, 0.0, -386.0, -11.0, 0.0, -400.0, -397.0, -12.0, -12.0, -31.0, -12.0, -20.0, 15.0, -20.0, -14.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 199.0, 8.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 8.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 198.0, 0.0, 0.0, 0.0, 10.0, 7.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 200.0, 0.0, 0.0, 1.0, 0.0, 190.0, 9.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 195.0, 0.0, 8.0, 7.0, 0.0, 6.0, 9.0, 0.0, 0.0, 200.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 14.0, 12.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 5.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 10.0, 199.0, 1.0, 194.0, 0.0, 10.0, 200.0, 0.0, 16.0, 0.0, 10.0, 16.0, 10.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.859797674457418, "mean_inference_ms": 2.312480152734984, "mean_action_processing_ms": 0.39503219116726673, "mean_env_wait_ms": 0.3012927872142914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005101919174194336, "StateBufferConnector_ms": 0.0036412477493286133, "ViewRequirementAgentConnector_ms": 0.11243772506713867}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -597.0, "episode_return_mean": -61.84, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.63366641387813, "num_env_steps_trained_throughput_per_sec": 356.63366641387813, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 11529.144, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11529.092, "sample_time_ms": 1506.121, "learn_time_ms": 10004.608, "learn_throughput": 399.816, "synch_weights_time_ms": 15.841}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "f1691_00000", "date": "2024-08-13_17-15-28", "timestamp": 1723583728, "time_this_iter_s": 11.267279863357544, "time_total_s": 2215.4557495117188, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3effe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2215.4557495117188, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 52.40625, "ram_util_percent": 83.19375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2464489167234944, "cur_kl_coeff": 8.709993728761581e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.6677446532817113, "policy_loss": 6.642482741169198e-05, "vf_loss": 1.667678230843216, "vf_explained_var": -1.002871800982763e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.376342187002215, "cur_kl_coeff": 5.520764159098727e-27, "cur_lr": 0.009999999999999998, "total_loss": 2.06948168943168, "policy_loss": -0.0001146446893770228, "vf_loss": 2.069596338429779, "vf_explained_var": -8.514949253627232e-09, "kl": 3.161925745514147e-12, "entropy": 6.7943679183716964e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -597.0, "episode_reward_mean": -59.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -53.295, "predator_policy": 23.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -199.0, 0.0, 15.0, -574.0, 0.0, 3.0, 9.0, 0.0, 0.0, 2.0, 23.0, 0.0, 0.0, 10.0, -198.0, 0.0, -15.0, -195.0, 0.0, 26.0, -7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 15.0, 1.0, 0.0, 1.0, -10.0, 0.0, 9.0, 0.0, -200.0, 0.0, -190.0, 6.0, 15.0, -177.0, -192.0, -6.0, 2.0, -3.0, 0.0, -591.0, -367.0, 0.0, 0.0, -26.0, -4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 10.0, -200.0, 17.0, 0.0, 10.0, -5.0, -180.0, 0.0, 0.0, -569.0, -191.0, -1.0, -597.0, -8.0, -17.0, 5.0, -17.0, 21.0, 0.0, 0.0, 0.0, -2.0, -200.0, -4.0, 0.0, -6.0, 0.0, 0.0, 0.0, 3.0, 2.0, -200.0, -1.0, 4.0, -9.0, 0.0, -176.0, -549.0, -174.0, -194.0, 12.0, 23.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, -398.0, 0.0, -8.0, 0.0, 0.0, 15.0, -388.0, -380.0, 0.0, 0.0, -15.0, 10.0, 9.0, -6.0, 0.0, 0.0, -5.0, 0.0, 6.0, -14.0, 8.0, 15.0, 0.0, 0.0, 6.0, -12.0, 0.0, 5.0, 0.0, -396.0, 0.0, 0.0, 0.0, -32.0, 0.0, -400.0, 0.0, 0.0, 11.0, 15.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 0.0, 15.0, -9.0, 0.0, 0.0, 0.0, 7.0, -12.0, -20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -400.0, 0.0, -1.0, 0.0, -380.0, 0.0, 3.0, -6.0, 0.0, 15.0, -365.0, 0.0, -390.0, 3.0, 0.0, -14.0, 0.0, -5.0, -18.0, 0.0, 0.0, 0.0, -391.0, -400.0, -367.0, -400.0, 0.0, 0.0, 0.0, 0.0, -24.0, -28.0, 0.0, -24.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -400.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, -10.0, 0.0, -390.0, 15.0, 0.0, 0.0, 0.0, 0.0, -380.0, -398.0, 0.0, -386.0, -11.0, 0.0, -400.0, -397.0, -12.0, -12.0, -31.0, -12.0, -20.0, 15.0, -20.0, -14.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, 0.0, 1.0, -15.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -8.0, 0.0, 0.0, -400.0, -2.0, 0.0, 0.0, 4.0, 0.0, -19.0, 0.0, 0.0, -362.0, -10.0, -356.0, -389.0, -378.0, 14.0, -391.0, 0.0, 10.0, 2.0, 13.0, 10.0, 3.0, 0.0], "policy_predator_policy_reward": [0.0, 8.0, 0.0, 199.0, 8.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 8.0, 3.0, 3.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 198.0, 0.0, 0.0, 0.0, 10.0, 7.0, 5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 200.0, 0.0, 0.0, 1.0, 0.0, 190.0, 9.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 195.0, 0.0, 8.0, 7.0, 0.0, 6.0, 9.0, 0.0, 0.0, 200.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 14.0, 12.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 5.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 10.0, 199.0, 1.0, 194.0, 0.0, 10.0, 200.0, 0.0, 16.0, 0.0, 10.0, 16.0, 10.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 182.0, 14.0, 196.0, 0.0, 180.0, 10.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8585565357041617, "mean_inference_ms": 2.3086203511381007, "mean_action_processing_ms": 0.39365619954394704, "mean_env_wait_ms": 0.3009424416726153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049866437911987305, "StateBufferConnector_ms": 0.0035545825958251953, "ViewRequirementAgentConnector_ms": 0.10835719108581543}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -597.0, "episode_return_mean": -59.69, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.84132037881056, "num_env_steps_trained_throughput_per_sec": 342.84132037881056, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 11495.003, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11494.951, "sample_time_ms": 1504.87, "learn_time_ms": 9970.587, "learn_throughput": 401.18, "synch_weights_time_ms": 16.762}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "f1691_00000", "date": "2024-08-13_17-15-39", "timestamp": 1723583739, "time_this_iter_s": 11.71409797668457, "time_total_s": 2227.1698474884033, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f0dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2227.1698474884033, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 48.35294117647059, "ram_util_percent": 83.05294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2676880630902287, "cur_kl_coeff": 4.3549968643807905e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.4824125497114091, "policy_loss": -0.00012260172836403682, "vf_loss": 1.4825351507890792, "vf_explained_var": -9.618738971690021e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9130073699334245, "cur_kl_coeff": 2.7603820795493636e-27, "cur_lr": 0.009999999999999998, "total_loss": 1.7207054275999625, "policy_loss": 0.0003092601429671049, "vf_loss": 1.7203961640123338, "vf_explained_var": -1.0627918142490286e-08, "kl": -8.036654096853254e-13, "entropy": 6.7915404077768415e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -597.0, "episode_reward_mean": -63.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -57.475, "predator_policy": 25.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.0, 0.0, 26.0, -7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 15.0, 1.0, 0.0, 1.0, -10.0, 0.0, 9.0, 0.0, -200.0, 0.0, -190.0, 6.0, 15.0, -177.0, -192.0, -6.0, 2.0, -3.0, 0.0, -591.0, -367.0, 0.0, 0.0, -26.0, -4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 10.0, -200.0, 17.0, 0.0, 10.0, -5.0, -180.0, 0.0, 0.0, -569.0, -191.0, -1.0, -597.0, -8.0, -17.0, 5.0, -17.0, 21.0, 0.0, 0.0, 0.0, -2.0, -200.0, -4.0, 0.0, -6.0, 0.0, 0.0, 0.0, 3.0, 2.0, -200.0, -1.0, 4.0, -9.0, 0.0, -176.0, -549.0, -174.0, -194.0, 12.0, 23.0, 3.0, 0.0, 0.0, 11.0, -10.0, 6.0, -12.0, -5.0, -10.0, 14.0, -388.0, 1.0, -9.0, -8.0, 15.0, -580.0, -388.0, 15.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -400.0, 0.0, 0.0, 11.0, 15.0, -8.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 0.0, 15.0, -9.0, 0.0, 0.0, 0.0, 7.0, -12.0, -20.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -400.0, 0.0, -1.0, 0.0, -380.0, 0.0, 3.0, -6.0, 0.0, 15.0, -365.0, 0.0, -390.0, 3.0, 0.0, -14.0, 0.0, -5.0, -18.0, 0.0, 0.0, 0.0, -391.0, -400.0, -367.0, -400.0, 0.0, 0.0, 0.0, 0.0, -24.0, -28.0, 0.0, -24.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -400.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, -10.0, 0.0, -390.0, 15.0, 0.0, 0.0, 0.0, 0.0, -380.0, -398.0, 0.0, -386.0, -11.0, 0.0, -400.0, -397.0, -12.0, -12.0, -31.0, -12.0, -20.0, 15.0, -20.0, -14.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, 0.0, 1.0, -15.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -8.0, 0.0, 0.0, -400.0, -2.0, 0.0, 0.0, 4.0, 0.0, -19.0, 0.0, 0.0, -362.0, -10.0, -356.0, -389.0, -378.0, 14.0, -391.0, 0.0, 10.0, 2.0, 13.0, 10.0, 3.0, 0.0, 5.0, -18.0, 0.0, 0.0, 7.0, 0.0, -20.0, 0.0, -10.0, 11.0, -20.0, -12.0, 0.0, -10.0, -20.0, 0.0, 14.0, 0.0, -400.0, -376.0, 0.0, 1.0, -18.0, 0.0, 0.0, -18.0, 0.0, 15.0, -380.0, -400.0, -388.0, -400.0, 0.0, 15.0, 0.0, 0.0], "policy_predator_policy_reward": [5.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 200.0, 0.0, 0.0, 1.0, 0.0, 190.0, 9.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 195.0, 0.0, 8.0, 7.0, 0.0, 6.0, 9.0, 0.0, 0.0, 200.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 14.0, 12.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 5.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 10.0, 199.0, 1.0, 194.0, 0.0, 10.0, 200.0, 0.0, 16.0, 0.0, 10.0, 16.0, 10.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 182.0, 14.0, 196.0, 0.0, 180.0, 10.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 5.0, 10.0, 10.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8573659623718715, "mean_inference_ms": 2.3072757238351422, "mean_action_processing_ms": 0.39293357671633883, "mean_env_wait_ms": 0.3005176634853493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004918932914733887, "StateBufferConnector_ms": 0.003616809844970703, "ViewRequirementAgentConnector_ms": 0.10932254791259766}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -597.0, "episode_return_mean": -63.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.61720683269203, "num_env_steps_trained_throughput_per_sec": 342.61720683269203, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 11534.307, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11534.259, "sample_time_ms": 1497.807, "learn_time_ms": 10017.114, "learn_throughput": 399.317, "synch_weights_time_ms": 16.822}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "f1691_00000", "date": "2024-08-13_17-15-51", "timestamp": 1723583751, "time_this_iter_s": 11.718873977661133, "time_total_s": 2238.8887214660645, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e6b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2238.8887214660645, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 51.970588235294116, "ram_util_percent": 83.44705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.145763154234129, "cur_kl_coeff": 2.1774984321903952e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.292261989532955, "policy_loss": -7.905503710308088e-06, "vf_loss": 1.2922698970509585, "vf_explained_var": -1.0438697047965237e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.071159447546403, "cur_kl_coeff": 1.3801910397746818e-27, "cur_lr": 0.009999999999999998, "total_loss": 1.6136826382742988, "policy_loss": -9.711983086413176e-06, "vf_loss": 1.6136923421943, "vf_explained_var": -7.316548988301918e-09, "kl": 3.5659802842213665e-12, "entropy": 6.801777962966082e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -598.0, "episode_reward_mean": -71.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -63.46, "predator_policy": 27.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -190.0, 6.0, 15.0, -177.0, -192.0, -6.0, 2.0, -3.0, 0.0, -591.0, -367.0, 0.0, 0.0, -26.0, -4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 10.0, -200.0, 17.0, 0.0, 10.0, -5.0, -180.0, 0.0, 0.0, -569.0, -191.0, -1.0, -597.0, -8.0, -17.0, 5.0, -17.0, 21.0, 0.0, 0.0, 0.0, -2.0, -200.0, -4.0, 0.0, -6.0, 0.0, 0.0, 0.0, 3.0, 2.0, -200.0, -1.0, 4.0, -9.0, 0.0, -176.0, -549.0, -174.0, -194.0, 12.0, 23.0, 3.0, 0.0, 0.0, 11.0, -10.0, 6.0, -12.0, -5.0, -10.0, 14.0, -388.0, 1.0, -9.0, -8.0, 15.0, -580.0, -388.0, 15.0, 0.0, -195.0, 0.0, 0.0, 15.0, -3.0, -8.0, 20.0, 12.0, -3.0, -598.0, -3.0, -186.0, 0.0, 10.0, 0.0, -6.0, 15.0, -189.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.0, 0.0, -380.0, 0.0, 3.0, -6.0, 0.0, 15.0, -365.0, 0.0, -390.0, 3.0, 0.0, -14.0, 0.0, -5.0, -18.0, 0.0, 0.0, 0.0, -391.0, -400.0, -367.0, -400.0, 0.0, 0.0, 0.0, 0.0, -24.0, -28.0, 0.0, -24.0, 15.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -400.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, -10.0, 0.0, -390.0, 15.0, 0.0, 0.0, 0.0, 0.0, -380.0, -398.0, 0.0, -386.0, -11.0, 0.0, -400.0, -397.0, -12.0, -12.0, -31.0, -12.0, -20.0, 15.0, -20.0, -14.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, 0.0, 1.0, -15.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -8.0, 0.0, 0.0, -400.0, -2.0, 0.0, 0.0, 4.0, 0.0, -19.0, 0.0, 0.0, -362.0, -10.0, -356.0, -389.0, -378.0, 14.0, -391.0, 0.0, 10.0, 2.0, 13.0, 10.0, 3.0, 0.0, 5.0, -18.0, 0.0, 0.0, 7.0, 0.0, -20.0, 0.0, -10.0, 11.0, -20.0, -12.0, 0.0, -10.0, -20.0, 0.0, 14.0, 0.0, -400.0, -376.0, 0.0, 1.0, -18.0, 0.0, 0.0, -18.0, 0.0, 15.0, -380.0, -400.0, -388.0, -400.0, 0.0, 15.0, 0.0, 0.0, -390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -16.0, 0.0, -18.0, -15.0, 15.0, 12.0, 0.0, -13.0, 0.0, -400.0, -398.0, 0.0, -13.0, 3.0, -385.0, 0.0, -10.0, 15.0, -10.0, 0.0, 0.0, -16.0, 0.0, 15.0, 0.0, 0.0, -378.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 190.0, 9.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 195.0, 0.0, 8.0, 7.0, 0.0, 6.0, 9.0, 0.0, 0.0, 200.0, 0.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 14.0, 12.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 5.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 10.0, 199.0, 1.0, 194.0, 0.0, 10.0, 200.0, 0.0, 16.0, 0.0, 10.0, 16.0, 10.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 182.0, 14.0, 196.0, 0.0, 180.0, 10.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 5.0, 10.0, 10.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 200.0, 0.0, 10.0, 0.0, 10.0, 186.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 189.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8561915391566596, "mean_inference_ms": 2.3058810138395716, "mean_action_processing_ms": 0.392203110258562, "mean_env_wait_ms": 0.3000950675305131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004929661750793457, "StateBufferConnector_ms": 0.0036400556564331055, "ViewRequirementAgentConnector_ms": 0.10856509208679199}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -598.0, "episode_return_mean": -71.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.88012539504186, "num_env_steps_trained_throughput_per_sec": 230.88012539504186, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 12106.163, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12106.114, "sample_time_ms": 1484.642, "learn_time_ms": 10594.953, "learn_throughput": 377.538, "synch_weights_time_ms": 22.682}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "f1691_00000", "date": "2024-08-13_17-16-09", "timestamp": 1723583769, "time_this_iter_s": 17.53078603744507, "time_total_s": 2256.4195075035095, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db3040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2256.4195075035095, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 72.94782608695652, "ram_util_percent": 83.76521739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.502866580693677, "cur_kl_coeff": 1.0887492160951976e-08, "cur_lr": 0.009999999999999998, "total_loss": 0.980700158962497, "policy_loss": -0.00018809849948242858, "vf_loss": 0.9808882569904049, "vf_explained_var": -7.852675422789559e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.61159633917872, "cur_kl_coeff": 6.900955198873409e-28, "cur_lr": 0.009999999999999998, "total_loss": 1.1656422339024999, "policy_loss": -0.0003406380209579039, "vf_loss": 1.1659828726419066, "vf_explained_var": -6.906569950164311e-09, "kl": 6.804930175026139e-12, "entropy": 6.704344658273055e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -598.0, "episode_reward_mean": -63.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -57.215, "predator_policy": 25.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 10.0, -200.0, 17.0, 0.0, 10.0, -5.0, -180.0, 0.0, 0.0, -569.0, -191.0, -1.0, -597.0, -8.0, -17.0, 5.0, -17.0, 21.0, 0.0, 0.0, 0.0, -2.0, -200.0, -4.0, 0.0, -6.0, 0.0, 0.0, 0.0, 3.0, 2.0, -200.0, -1.0, 4.0, -9.0, 0.0, -176.0, -549.0, -174.0, -194.0, 12.0, 23.0, 3.0, 0.0, 0.0, 11.0, -10.0, 6.0, -12.0, -5.0, -10.0, 14.0, -388.0, 1.0, -9.0, -8.0, 15.0, -580.0, -388.0, 15.0, 0.0, -195.0, 0.0, 0.0, 15.0, -3.0, -8.0, 20.0, 12.0, -3.0, -598.0, -3.0, -186.0, 0.0, 10.0, 0.0, -6.0, 15.0, -189.0, -8.0, 4.0, -171.0, -187.0, 0.0, 3.0, -3.0, -2.0, 0.0, -191.0, 0.0, 15.0, -184.0, 6.0, 15.0, 0.0, 1.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, -400.0, 10.0, 7.0, 0.0, 0.0, 0.0, 3.0, -10.0, 0.0, -390.0, 15.0, 0.0, 0.0, 0.0, 0.0, -380.0, -398.0, 0.0, -386.0, -11.0, 0.0, -400.0, -397.0, -12.0, -12.0, -31.0, -12.0, -20.0, 15.0, -20.0, -14.0, 15.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -400.0, 0.0, 1.0, -15.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -8.0, 0.0, 0.0, -400.0, -2.0, 0.0, 0.0, 4.0, 0.0, -19.0, 0.0, 0.0, -362.0, -10.0, -356.0, -389.0, -378.0, 14.0, -391.0, 0.0, 10.0, 2.0, 13.0, 10.0, 3.0, 0.0, 5.0, -18.0, 0.0, 0.0, 7.0, 0.0, -20.0, 0.0, -10.0, 11.0, -20.0, -12.0, 0.0, -10.0, -20.0, 0.0, 14.0, 0.0, -400.0, -376.0, 0.0, 1.0, -18.0, 0.0, 0.0, -18.0, 0.0, 15.0, -380.0, -400.0, -388.0, -400.0, 0.0, 15.0, 0.0, 0.0, -390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -16.0, 0.0, -18.0, -15.0, 15.0, 12.0, 0.0, -13.0, 0.0, -400.0, -398.0, 0.0, -13.0, 3.0, -385.0, 0.0, -10.0, 15.0, -10.0, 0.0, 0.0, -16.0, 0.0, 15.0, 0.0, 0.0, -378.0, -16.0, 0.0, -10.0, 0.0, 0.0, -355.0, -400.0, 13.0, 0.0, 0.0, 0.0, -4.0, -6.0, 0.0, -14.0, -1.0, 0.0, 0.0, -386.0, 2.0, 0.0, 0.0, 0.0, 15.0, -376.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 5.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 10.0, 199.0, 1.0, 194.0, 0.0, 10.0, 200.0, 0.0, 16.0, 0.0, 10.0, 16.0, 10.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 182.0, 14.0, 196.0, 0.0, 180.0, 10.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 5.0, 10.0, 10.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 200.0, 0.0, 10.0, 0.0, 10.0, 186.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 189.0, 0.0, 8.0, 0.0, 10.0, 4.0, 184.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555651240968843, "mean_inference_ms": 2.3067114380254865, "mean_action_processing_ms": 0.3917944300094145, "mean_env_wait_ms": 0.2999801152349927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004778742790222168, "StateBufferConnector_ms": 0.003596663475036621, "ViewRequirementAgentConnector_ms": 0.13699984550476074}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -598.0, "episode_return_mean": -63.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.0551952447693, "num_env_steps_trained_throughput_per_sec": 312.0551952447693, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 12231.108, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12231.045, "sample_time_ms": 1632.576, "learn_time_ms": 10571.562, "learn_throughput": 378.374, "synch_weights_time_ms": 23.192}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "f1691_00000", "date": "2024-08-13_17-16-22", "timestamp": 1723583782, "time_this_iter_s": 12.91453218460083, "time_total_s": 2269.3340396881104, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e299d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2269.3340396881104, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 56.54736842105264, "ram_util_percent": 83.67894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.681919321205027, "cur_kl_coeff": 5.443746080475988e-09, "cur_lr": 0.009999999999999998, "total_loss": 1.055676757579758, "policy_loss": 0.00010815181414641085, "vf_loss": 1.0555686036588023, "vf_explained_var": -9.99718116074012e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5186944195002234, "cur_kl_coeff": 3.4504775994367046e-28, "cur_lr": 0.009999999999999998, "total_loss": 1.4492780321016514, "policy_loss": -0.00010715192109937706, "vf_loss": 1.4493851847118802, "vf_explained_var": -5.172043250351356e-09, "kl": 2.901366423535106e-12, "entropy": 6.578275904952794e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -598.0, "episode_reward_mean": -54.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.915, "predator_policy": 23.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -6.0, 0.0, 0.0, 0.0, 3.0, 2.0, -200.0, -1.0, 4.0, -9.0, 0.0, -176.0, -549.0, -174.0, -194.0, 12.0, 23.0, 3.0, 0.0, 0.0, 11.0, -10.0, 6.0, -12.0, -5.0, -10.0, 14.0, -388.0, 1.0, -9.0, -8.0, 15.0, -580.0, -388.0, 15.0, 0.0, -195.0, 0.0, 0.0, 15.0, -3.0, -8.0, 20.0, 12.0, -3.0, -598.0, -3.0, -186.0, 0.0, 10.0, 0.0, -6.0, 15.0, -189.0, -8.0, 4.0, -171.0, -187.0, 0.0, 3.0, -3.0, -2.0, 0.0, -191.0, 0.0, 15.0, -184.0, 6.0, 15.0, 0.0, 1.0, 0.0, -182.0, 8.0, -3.0, 7.0, 15.0, -14.0, 0.0, -6.0, 0.0, 3.0, 5.0, 3.0, 11.0, 6.0, -215.0, 5.0, 18.0, 0.0, 11.0, -187.0, 0.0, 10.0, -6.0, 16.0, -27.0, -552.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -20.0, 4.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -8.0, 0.0, 0.0, -400.0, -2.0, 0.0, 0.0, 4.0, 0.0, -19.0, 0.0, 0.0, -362.0, -10.0, -356.0, -389.0, -378.0, 14.0, -391.0, 0.0, 10.0, 2.0, 13.0, 10.0, 3.0, 0.0, 5.0, -18.0, 0.0, 0.0, 7.0, 0.0, -20.0, 0.0, -10.0, 11.0, -20.0, -12.0, 0.0, -10.0, -20.0, 0.0, 14.0, 0.0, -400.0, -376.0, 0.0, 1.0, -18.0, 0.0, 0.0, -18.0, 0.0, 15.0, -380.0, -400.0, -388.0, -400.0, 0.0, 15.0, 0.0, 0.0, -390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -16.0, 0.0, -18.0, -15.0, 15.0, 12.0, 0.0, -13.0, 0.0, -400.0, -398.0, 0.0, -13.0, 3.0, -385.0, 0.0, -10.0, 15.0, -10.0, 0.0, 0.0, -16.0, 0.0, 15.0, 0.0, 0.0, -378.0, -16.0, 0.0, -10.0, 0.0, 0.0, -355.0, -400.0, 13.0, 0.0, 0.0, 0.0, -4.0, -6.0, 0.0, -14.0, -1.0, 0.0, 0.0, -386.0, 2.0, 0.0, 0.0, 0.0, 15.0, -376.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -371.0, 0.0, 2.0, 3.0, -13.0, 0.0, 7.0, 0.0, 4.0, 8.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -24.0, 15.0, -20.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, -400.0, -19.0, 5.0, 0.0, 3.0, 15.0, 0.0, 0.0, 11.0, 0.0, -374.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, -26.0, 12.0, 4.0, -20.0, -20.0, -352.0, -400.0, 5.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 182.0, 14.0, 196.0, 0.0, 180.0, 10.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 5.0, 10.0, 10.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 200.0, 0.0, 10.0, 0.0, 10.0, 186.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 189.0, 0.0, 8.0, 0.0, 10.0, 4.0, 184.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 10.0, 179.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 10.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 193.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 200.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554359153864222, "mean_inference_ms": 2.310669911079572, "mean_action_processing_ms": 0.39146023664053403, "mean_env_wait_ms": 0.3001006377469427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006043910980224609, "StateBufferConnector_ms": 0.003473043441772461, "ViewRequirementAgentConnector_ms": 0.14863550662994385}, "num_episodes": 27, "episode_return_max": 23.0, "episode_return_min": -598.0, "episode_return_mean": -54.96, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.390100602494, "num_env_steps_trained_throughput_per_sec": 301.390100602494, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 12408.144, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12408.073, "sample_time_ms": 1735.581, "learn_time_ms": 10646.316, "learn_throughput": 375.717, "synch_weights_time_ms": 22.382}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "f1691_00000", "date": "2024-08-13_17-16-35", "timestamp": 1723583795, "time_this_iter_s": 13.294153928756714, "time_total_s": 2282.628193616867, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e29c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2282.628193616867, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 58.19999999999999, "ram_util_percent": 82.6421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2641041325529048, "cur_kl_coeff": 2.721873040237994e-09, "cur_lr": 0.009999999999999998, "total_loss": 1.0328858671049592, "policy_loss": -0.00020976949818235225, "vf_loss": 1.033095637468434, "vf_explained_var": -8.956465140852348e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3792653996524495, "cur_kl_coeff": 1.7252387997183523e-28, "cur_lr": 0.009999999999999998, "total_loss": 1.1746996168737058, "policy_loss": -0.000225306222481387, "vf_loss": 1.174924918835756, "vf_explained_var": -6.685812006551753e-09, "kl": 5.425261154066159e-12, "entropy": 6.4328697007679704e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -598.0, "episode_reward_mean": -49.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -47.365, "predator_policy": 22.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 0.0, 0.0, 11.0, -10.0, 6.0, -12.0, -5.0, -10.0, 14.0, -388.0, 1.0, -9.0, -8.0, 15.0, -580.0, -388.0, 15.0, 0.0, -195.0, 0.0, 0.0, 15.0, -3.0, -8.0, 20.0, 12.0, -3.0, -598.0, -3.0, -186.0, 0.0, 10.0, 0.0, -6.0, 15.0, -189.0, -8.0, 4.0, -171.0, -187.0, 0.0, 3.0, -3.0, -2.0, 0.0, -191.0, 0.0, 15.0, -184.0, 6.0, 15.0, 0.0, 1.0, 0.0, -182.0, 8.0, -3.0, 7.0, 15.0, -14.0, 0.0, -6.0, 0.0, 3.0, 5.0, 3.0, 11.0, 6.0, -215.0, 5.0, 18.0, 0.0, 11.0, -187.0, 0.0, 10.0, -6.0, 16.0, -27.0, -552.0, 9.0, 0.0, -2.0, -7.0, -6.0, -381.0, -158.0, 0.0, 0.0, 1.0, 2.0, -12.0, 8.0, 1.0, -4.0, -3.0, 15.0, -194.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 0.0, 5.0, -18.0, 0.0, 0.0, 7.0, 0.0, -20.0, 0.0, -10.0, 11.0, -20.0, -12.0, 0.0, -10.0, -20.0, 0.0, 14.0, 0.0, -400.0, -376.0, 0.0, 1.0, -18.0, 0.0, 0.0, -18.0, 0.0, 15.0, -380.0, -400.0, -388.0, -400.0, 0.0, 15.0, 0.0, 0.0, -390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -16.0, 0.0, -18.0, -15.0, 15.0, 12.0, 0.0, -13.0, 0.0, -400.0, -398.0, 0.0, -13.0, 3.0, -385.0, 0.0, -10.0, 15.0, -10.0, 0.0, 0.0, -16.0, 0.0, 15.0, 0.0, 0.0, -378.0, -16.0, 0.0, -10.0, 0.0, 0.0, -355.0, -400.0, 13.0, 0.0, 0.0, 0.0, -4.0, -6.0, 0.0, -14.0, -1.0, 0.0, 0.0, -386.0, 2.0, 0.0, 0.0, 0.0, 15.0, -376.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -371.0, 0.0, 2.0, 3.0, -13.0, 0.0, 7.0, 0.0, 4.0, 8.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -24.0, 15.0, -20.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, -400.0, -19.0, 5.0, 0.0, 3.0, 15.0, 0.0, 0.0, 11.0, 0.0, -374.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, -26.0, 12.0, 4.0, -20.0, -20.0, -352.0, -400.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, -5.0, -5.0, -12.0, 0.0, -362.0, -400.0, 15.0, -365.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -7.0, 1.0, -16.0, -14.0, 8.0, 0.0, 0.0, -9.0, -2.0, -15.0, -13.0, 0.0, 15.0, 0.0, 0.0, -391.0, 13.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 5.0, 10.0, 10.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 200.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 200.0, 0.0, 10.0, 0.0, 10.0, 186.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 189.0, 0.0, 8.0, 0.0, 10.0, 4.0, 184.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 10.0, 179.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 10.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 193.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 181.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 8.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556119603101574, "mean_inference_ms": 2.313412796058223, "mean_action_processing_ms": 0.3914888229677514, "mean_env_wait_ms": 0.3003049052161661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006061911582946777, "StateBufferConnector_ms": 0.004972696304321289, "ViewRequirementAgentConnector_ms": 0.14992690086364746}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -598.0, "episode_return_mean": -49.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.318994854741, "num_env_steps_trained_throughput_per_sec": 326.318994854741, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 12475.256, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12475.188, "sample_time_ms": 1829.72, "learn_time_ms": 10619.352, "learn_throughput": 376.671, "synch_weights_time_ms": 22.361}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "f1691_00000", "date": "2024-08-13_17-16-47", "timestamp": 1723583807, "time_this_iter_s": 12.296602964401245, "time_total_s": 2294.9247965812683, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2294.9247965812683, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 55.1, "ram_util_percent": 81.14117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.069238955853384, "cur_kl_coeff": 1.360936520118997e-09, "cur_lr": 0.009999999999999998, "total_loss": 0.3137228595516669, "policy_loss": 4.2950157963094255e-07, "vf_loss": 0.31372242970780156, "vf_explained_var": 9.56787003411187e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.405733262729879, "cur_kl_coeff": 8.626193998591761e-29, "cur_lr": 0.009999999999999998, "total_loss": 0.5482746032396795, "policy_loss": -0.0002053842704900831, "vf_loss": 0.548479991600351, "vf_explained_var": 0.0008984151971403253, "kl": 2.2018790733398026e-12, "entropy": 6.351125614371023e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -598.0, "episode_reward_mean": -36.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -36.985, "predator_policy": 18.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -195.0, 0.0, 0.0, 15.0, -3.0, -8.0, 20.0, 12.0, -3.0, -598.0, -3.0, -186.0, 0.0, 10.0, 0.0, -6.0, 15.0, -189.0, -8.0, 4.0, -171.0, -187.0, 0.0, 3.0, -3.0, -2.0, 0.0, -191.0, 0.0, 15.0, -184.0, 6.0, 15.0, 0.0, 1.0, 0.0, -182.0, 8.0, -3.0, 7.0, 15.0, -14.0, 0.0, -6.0, 0.0, 3.0, 5.0, 3.0, 11.0, 6.0, -215.0, 5.0, 18.0, 0.0, 11.0, -187.0, 0.0, 10.0, -6.0, 16.0, -27.0, -552.0, 9.0, 0.0, -2.0, -7.0, -6.0, -381.0, -158.0, 0.0, 0.0, 1.0, 2.0, -12.0, 8.0, 1.0, -4.0, -3.0, 15.0, -194.0, 14.0, 4.0, 0.0, 3.0, -1.0, 15.0, -185.0, 21.0, 19.0, -5.0, 8.0, -10.0, 14.0, -5.0, -1.0, 0.0, 24.0, 6.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -16.0, 0.0, -18.0, -15.0, 15.0, 12.0, 0.0, -13.0, 0.0, -400.0, -398.0, 0.0, -13.0, 3.0, -385.0, 0.0, -10.0, 15.0, -10.0, 0.0, 0.0, -16.0, 0.0, 15.0, 0.0, 0.0, -378.0, -16.0, 0.0, -10.0, 0.0, 0.0, -355.0, -400.0, 13.0, 0.0, 0.0, 0.0, -4.0, -6.0, 0.0, -14.0, -1.0, 0.0, 0.0, -386.0, 2.0, 0.0, 0.0, 0.0, 15.0, -376.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -371.0, 0.0, 2.0, 3.0, -13.0, 0.0, 7.0, 0.0, 4.0, 8.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -24.0, 15.0, -20.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, -400.0, -19.0, 5.0, 0.0, 3.0, 15.0, 0.0, 0.0, 11.0, 0.0, -374.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, -26.0, 12.0, 4.0, -20.0, -20.0, -352.0, -400.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, -5.0, -5.0, -12.0, 0.0, -362.0, -400.0, 15.0, -365.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -7.0, 1.0, -16.0, -14.0, 8.0, 0.0, 0.0, -9.0, -2.0, -15.0, -13.0, 0.0, 15.0, 0.0, 0.0, -391.0, 13.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, -2.0, 0.0, 0.0, 15.0, 15.0, -400.0, 5.0, 11.0, 14.0, 5.0, 0.0, -15.0, -26.0, 15.0, -20.0, 0.0, 14.0, 0.0, -10.0, 0.0, -2.0, 0.0, 0.0, 0.0, 9.0, 15.0, 3.0, 0.0, 0.0, 4.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 195.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 5.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 200.0, 0.0, 10.0, 0.0, 10.0, 186.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 189.0, 0.0, 8.0, 0.0, 10.0, 4.0, 184.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 10.0, 179.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 10.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 193.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 181.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 8.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8558729078797285, "mean_inference_ms": 2.31685801083224, "mean_action_processing_ms": 0.39151565573998093, "mean_env_wait_ms": 0.30051011874664085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006294965744018555, "StateBufferConnector_ms": 0.005060553550720215, "ViewRequirementAgentConnector_ms": 0.15218377113342285}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -598.0, "episode_return_mean": -36.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.888527050293, "num_env_steps_trained_throughput_per_sec": 354.888527050293, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 12451.875, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12451.808, "sample_time_ms": 1830.192, "learn_time_ms": 10595.346, "learn_throughput": 377.524, "synch_weights_time_ms": 22.521}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "f1691_00000", "date": "2024-08-13_17-16-59", "timestamp": 1723583819, "time_this_iter_s": 11.314511060714722, "time_total_s": 2306.239307641983, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3db3e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2306.239307641983, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 52.2875, "ram_util_percent": 81.66874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2708728682254713, "cur_kl_coeff": 6.804682600594985e-10, "cur_lr": 0.009999999999999998, "total_loss": 0.43135460284809585, "policy_loss": -0.00015458821604846332, "vf_loss": 0.4315091917268493, "vf_explained_var": 7.478112266177223e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1527669623607175, "cur_kl_coeff": 4.3130969992958807e-29, "cur_lr": 0.009999999999999998, "total_loss": 0.5322399834870661, "policy_loss": -0.0003564439270467985, "vf_loss": 0.5325964289751716, "vf_explained_var": 0.0008069295416433344, "kl": 5.248139602499967e-12, "entropy": 6.230690709523747e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -552.0, "episode_reward_mean": -27.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.27, "predator_policy": 15.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.0, -8.0, 4.0, -171.0, -187.0, 0.0, 3.0, -3.0, -2.0, 0.0, -191.0, 0.0, 15.0, -184.0, 6.0, 15.0, 0.0, 1.0, 0.0, -182.0, 8.0, -3.0, 7.0, 15.0, -14.0, 0.0, -6.0, 0.0, 3.0, 5.0, 3.0, 11.0, 6.0, -215.0, 5.0, 18.0, 0.0, 11.0, -187.0, 0.0, 10.0, -6.0, 16.0, -27.0, -552.0, 9.0, 0.0, -2.0, -7.0, -6.0, -381.0, -158.0, 0.0, 0.0, 1.0, 2.0, -12.0, 8.0, 1.0, -4.0, -3.0, 15.0, -194.0, 14.0, 4.0, 0.0, 3.0, -1.0, 15.0, -185.0, 21.0, 19.0, -5.0, 8.0, -10.0, 14.0, -5.0, -1.0, 0.0, 24.0, 6.0, 9.0, 15.0, -7.0, -18.0, 0.0, 15.0, 16.0, 0.0, -8.0, 30.0, -13.0, -7.0, 0.0, -24.0, 0.0, 10.0, -2.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -378.0, -16.0, 0.0, -10.0, 0.0, 0.0, -355.0, -400.0, 13.0, 0.0, 0.0, 0.0, -4.0, -6.0, 0.0, -14.0, -1.0, 0.0, 0.0, -386.0, 2.0, 0.0, 0.0, 0.0, 15.0, -376.0, 0.0, 6.0, 0.0, 15.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -371.0, 0.0, 2.0, 3.0, -13.0, 0.0, 7.0, 0.0, 4.0, 8.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -24.0, 15.0, -20.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, -400.0, -19.0, 5.0, 0.0, 3.0, 15.0, 0.0, 0.0, 11.0, 0.0, -374.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, -26.0, 12.0, 4.0, -20.0, -20.0, -352.0, -400.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, -5.0, -5.0, -12.0, 0.0, -362.0, -400.0, 15.0, -365.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -7.0, 1.0, -16.0, -14.0, 8.0, 0.0, 0.0, -9.0, -2.0, -15.0, -13.0, 0.0, 15.0, 0.0, 0.0, -391.0, 13.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, -2.0, 0.0, 0.0, 15.0, 15.0, -400.0, 5.0, 11.0, 14.0, 5.0, 0.0, -15.0, -26.0, 15.0, -20.0, 0.0, 14.0, 0.0, -10.0, 0.0, -2.0, 0.0, 0.0, 0.0, 9.0, 15.0, 3.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, -17.0, -10.0, -20.0, 0.0, 0.0, 0.0, 15.0, 9.0, -4.0, 0.0, 0.0, -16.0, 0.0, 15.0, 15.0, -20.0, -6.0, -14.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [189.0, 0.0, 8.0, 0.0, 10.0, 4.0, 184.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 10.0, 179.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 10.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 193.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 181.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 8.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8562172585866225, "mean_inference_ms": 2.3204508887673265, "mean_action_processing_ms": 0.3915782839293762, "mean_env_wait_ms": 0.30073856690853135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065490007400512695, "StateBufferConnector_ms": 0.005008339881896973, "ViewRequirementAgentConnector_ms": 0.15039396286010742}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -552.0, "episode_return_mean": -27.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.75865620968966, "num_env_steps_trained_throughput_per_sec": 342.75865620968966, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 12459.9, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12459.832, "sample_time_ms": 1847.397, "learn_time_ms": 10586.188, "learn_throughput": 377.851, "synch_weights_time_ms": 22.551}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "f1691_00000", "date": "2024-08-13_17-17-11", "timestamp": 1723583831, "time_this_iter_s": 11.722959995269775, "time_total_s": 2317.962267637253, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e29c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2317.962267637253, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 53.89411764705883, "ram_util_percent": 82.0529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.207100787244382, "cur_kl_coeff": 3.4023413002974926e-10, "cur_lr": 0.009999999999999998, "total_loss": 1.2361384615696296, "policy_loss": 0.00021413480025277566, "vf_loss": 1.2359243279727048, "vf_explained_var": -6.780422553814277e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.355838638526528, "cur_kl_coeff": 2.1565484996479404e-29, "cur_lr": 0.009999999999999998, "total_loss": 1.1472563562727478, "policy_loss": -7.127046673780396e-05, "vf_loss": 1.1473276214940207, "vf_explained_var": -9.776423217127562e-09, "kl": 1.0502612928749582e-12, "entropy": 6.120211934189298e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -552.0, "episode_reward_mean": -22.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.815, "predator_policy": 14.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -14.0, 0.0, -6.0, 0.0, 3.0, 5.0, 3.0, 11.0, 6.0, -215.0, 5.0, 18.0, 0.0, 11.0, -187.0, 0.0, 10.0, -6.0, 16.0, -27.0, -552.0, 9.0, 0.0, -2.0, -7.0, -6.0, -381.0, -158.0, 0.0, 0.0, 1.0, 2.0, -12.0, 8.0, 1.0, -4.0, -3.0, 15.0, -194.0, 14.0, 4.0, 0.0, 3.0, -1.0, 15.0, -185.0, 21.0, 19.0, -5.0, 8.0, -10.0, 14.0, -5.0, -1.0, 0.0, 24.0, 6.0, 9.0, 15.0, -7.0, -18.0, 0.0, 15.0, 16.0, 0.0, -8.0, 30.0, -13.0, -7.0, 0.0, -24.0, 0.0, 10.0, -2.0, 0.0, 0.0, -14.0, 5.0, -184.0, -5.0, -161.0, -10.0, -3.0, 3.0, 0.0, -2.0, 5.0, 0.0, 9.0, 0.0, 15.0, 15.0, -8.0, 0.0, -24.0, 0.0, -9.0, 15.0, -181.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, 8.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -24.0, 15.0, -20.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 1.0, -400.0, -19.0, 5.0, 0.0, 3.0, 15.0, 0.0, 0.0, 11.0, 0.0, -374.0, 0.0, 0.0, 0.0, -10.0, 10.0, 0.0, -26.0, 12.0, 4.0, -20.0, -20.0, -352.0, -400.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, -5.0, -5.0, -12.0, 0.0, -362.0, -400.0, 15.0, -365.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -7.0, 1.0, -16.0, -14.0, 8.0, 0.0, 0.0, -9.0, -2.0, -15.0, -13.0, 0.0, 15.0, 0.0, 0.0, -391.0, 13.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, -2.0, 0.0, 0.0, 15.0, 15.0, -400.0, 5.0, 11.0, 14.0, 5.0, 0.0, -15.0, -26.0, 15.0, -20.0, 0.0, 14.0, 0.0, -10.0, 0.0, -2.0, 0.0, 0.0, 0.0, 9.0, 15.0, 3.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, -17.0, -10.0, -20.0, 0.0, 0.0, 0.0, 15.0, 9.0, -4.0, 0.0, 0.0, -16.0, 0.0, 15.0, 15.0, -20.0, -6.0, -14.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -7.0, -14.0, 0.0, 4.0, 0.0, -376.0, 0.0, -10.0, -364.0, 15.0, -20.0, 0.0, -6.0, 0.0, -21.0, 11.0, 0.0, 0.0, 0.0, -4.0, 5.0, 0.0, 0.0, 0.0, -394.0, 9.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, -16.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, 0.0, 15.0, -392.0], "policy_predator_policy_reward": [0.0, 3.0, 10.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 193.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 13.0, 0.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 181.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 8.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 192.0, 0.0, 0.0, 5.0, 188.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 196.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8557156063263313, "mean_inference_ms": 2.324169102566524, "mean_action_processing_ms": 0.39174519205899405, "mean_env_wait_ms": 0.300558180421989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007101535797119141, "StateBufferConnector_ms": 0.004931330680847168, "ViewRequirementAgentConnector_ms": 0.13310039043426514}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -552.0, "episode_return_mean": -22.32, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.0077606968271, "num_env_steps_trained_throughput_per_sec": 350.0077606968271, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 12460.068, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12460.0, "sample_time_ms": 1852.032, "learn_time_ms": 10580.986, "learn_throughput": 378.037, "synch_weights_time_ms": 23.189}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "f1691_00000", "date": "2024-08-13_17-17-22", "timestamp": 1723583842, "time_this_iter_s": 11.472128868103027, "time_total_s": 2329.434396505356, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f2e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2329.434396505356, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 51.775, "ram_util_percent": 81.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.281377718597589, "cur_kl_coeff": 1.7011706501487463e-10, "cur_lr": 0.009999999999999998, "total_loss": 0.9592918026226538, "policy_loss": 0.0002282208851760342, "vf_loss": 0.9590635830526629, "vf_explained_var": -7.348085837389426e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4075857156670835, "cur_kl_coeff": 1.0782742498239702e-29, "cur_lr": 0.009999999999999998, "total_loss": 1.323587599822453, "policy_loss": 1.3991636002347582e-05, "vf_loss": 1.323573610186577, "vf_explained_var": -7.2219384410393934e-09, "kl": 1.549323492960201e-13, "entropy": 6.0451008779551036e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -557.0, "episode_reward_mean": -24.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.585, "predator_policy": 15.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 0.0, -2.0, -7.0, -6.0, -381.0, -158.0, 0.0, 0.0, 1.0, 2.0, -12.0, 8.0, 1.0, -4.0, -3.0, 15.0, -194.0, 14.0, 4.0, 0.0, 3.0, -1.0, 15.0, -185.0, 21.0, 19.0, -5.0, 8.0, -10.0, 14.0, -5.0, -1.0, 0.0, 24.0, 6.0, 9.0, 15.0, -7.0, -18.0, 0.0, 15.0, 16.0, 0.0, -8.0, 30.0, -13.0, -7.0, 0.0, -24.0, 0.0, 10.0, -2.0, 0.0, 0.0, -14.0, 5.0, -184.0, -5.0, -161.0, -10.0, -3.0, 3.0, 0.0, -2.0, 5.0, 0.0, 9.0, 0.0, 15.0, 15.0, -8.0, 0.0, -24.0, 0.0, -9.0, 15.0, -181.0, -197.0, -179.0, 0.0, 7.0, -1.0, 4.0, -9.0, -10.0, -10.0, -20.0, -176.0, 0.0, 13.0, 0.0, 0.0, 0.0, 9.0, 7.0, 5.0, -557.0, 15.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 0.0, 0.0, 0.0, 0.0, -4.0, -5.0, -5.0, -12.0, 0.0, -362.0, -400.0, 15.0, -365.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -7.0, 1.0, -16.0, -14.0, 8.0, 0.0, 0.0, -9.0, -2.0, -15.0, -13.0, 0.0, 15.0, 0.0, 0.0, -391.0, 13.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, -2.0, 0.0, 0.0, 15.0, 15.0, -400.0, 5.0, 11.0, 14.0, 5.0, 0.0, -15.0, -26.0, 15.0, -20.0, 0.0, 14.0, 0.0, -10.0, 0.0, -2.0, 0.0, 0.0, 0.0, 9.0, 15.0, 3.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, -17.0, -10.0, -20.0, 0.0, 0.0, 0.0, 15.0, 9.0, -4.0, 0.0, 0.0, -16.0, 0.0, 15.0, 15.0, -20.0, -6.0, -14.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -7.0, -14.0, 0.0, 4.0, 0.0, -376.0, 0.0, -10.0, -364.0, 15.0, -20.0, 0.0, -6.0, 0.0, -21.0, 11.0, 0.0, 0.0, 0.0, -4.0, 5.0, 0.0, 0.0, 0.0, -394.0, 9.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, -16.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, 0.0, 15.0, -392.0, 0.0, -395.0, 14.0, -386.0, 0.0, 0.0, 0.0, 7.0, -2.0, -10.0, 0.0, 4.0, -18.0, 0.0, 0.0, -20.0, 0.0, -20.0, -20.0, -20.0, 13.0, -383.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 5.0, 0.0, -400.0, -357.0, 0.0, 15.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 181.0, 182.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 8.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 192.0, 0.0, 0.0, 5.0, 188.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 196.0, 0.0, 198.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 8.0, 186.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8553992757539879, "mean_inference_ms": 2.322270400480171, "mean_action_processing_ms": 0.3909210012704889, "mean_env_wait_ms": 0.3003976943627552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01389622688293457, "StateBufferConnector_ms": 0.005198001861572266, "ViewRequirementAgentConnector_ms": 0.13565599918365479}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -557.0, "episode_return_mean": -24.26, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.38830760644396, "num_env_steps_trained_throughput_per_sec": 349.38830760644396, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 12483.326, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12483.258, "sample_time_ms": 1865.44, "learn_time_ms": 10591.216, "learn_throughput": 377.671, "synch_weights_time_ms": 22.945}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "f1691_00000", "date": "2024-08-13_17-17-34", "timestamp": 1723583854, "time_this_iter_s": 11.490962982177734, "time_total_s": 2340.9253594875336, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f2e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2340.9253594875336, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 51.15882352941177, "ram_util_percent": 81.97058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0976216683504862, "cur_kl_coeff": 8.505853250743731e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.6588736777267759, "policy_loss": -4.527827468577516e-05, "vf_loss": 0.6589189545975791, "vf_explained_var": -5.203580099438864e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9824520231039502, "cur_kl_coeff": 5.391371249119851e-30, "cur_lr": 0.009999999999999998, "total_loss": 0.7199272267205059, "policy_loss": -0.0002843828789308352, "vf_loss": 0.7202116123780057, "vf_explained_var": -9.776423217127562e-09, "kl": 1.9091168913035038e-12, "entropy": 6.0130764832963666e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -557.0, "episode_reward_mean": -20.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -23.99, "predator_policy": 13.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 4.0, 0.0, 3.0, -1.0, 15.0, -185.0, 21.0, 19.0, -5.0, 8.0, -10.0, 14.0, -5.0, -1.0, 0.0, 24.0, 6.0, 9.0, 15.0, -7.0, -18.0, 0.0, 15.0, 16.0, 0.0, -8.0, 30.0, -13.0, -7.0, 0.0, -24.0, 0.0, 10.0, -2.0, 0.0, 0.0, -14.0, 5.0, -184.0, -5.0, -161.0, -10.0, -3.0, 3.0, 0.0, -2.0, 5.0, 0.0, 9.0, 0.0, 15.0, 15.0, -8.0, 0.0, -24.0, 0.0, -9.0, 15.0, -181.0, -197.0, -179.0, 0.0, 7.0, -1.0, 4.0, -9.0, -10.0, -10.0, -20.0, -176.0, 0.0, 13.0, 0.0, 0.0, 0.0, 9.0, 7.0, 5.0, -557.0, 15.0, 1.0, 1.0, 0.0, 3.0, -12.0, -182.0, -10.0, 13.0, -5.0, -10.0, 4.0, 0.0, 8.0, 4.0, 0.0, -11.0, 0.0, 12.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, -2.0, 0.0, 0.0, 15.0, 15.0, -400.0, 5.0, 11.0, 14.0, 5.0, 0.0, -15.0, -26.0, 15.0, -20.0, 0.0, 14.0, 0.0, -10.0, 0.0, -2.0, 0.0, 0.0, 0.0, 9.0, 15.0, 3.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, -17.0, -10.0, -20.0, 0.0, 0.0, 0.0, 15.0, 9.0, -4.0, 0.0, 0.0, -16.0, 0.0, 15.0, 15.0, -20.0, -6.0, -14.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -7.0, -14.0, 0.0, 4.0, 0.0, -376.0, 0.0, -10.0, -364.0, 15.0, -20.0, 0.0, -6.0, 0.0, -21.0, 11.0, 0.0, 0.0, 0.0, -4.0, 5.0, 0.0, 0.0, 0.0, -394.0, 9.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, -16.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, 0.0, 15.0, -392.0, 0.0, -395.0, 14.0, -386.0, 0.0, 0.0, 0.0, 7.0, -2.0, -10.0, 0.0, 4.0, -18.0, 0.0, 0.0, -20.0, 0.0, -20.0, -20.0, -20.0, 13.0, -383.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 5.0, 0.0, -400.0, -357.0, 0.0, 15.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, -24.0, 0.0, 9.0, -398.0, -20.0, 0.0, 0.0, 13.0, -10.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -4.0, 0.0, 0.0, -20.0, -11.0, 0.0, 0.0, 10.0, 2.0, -400.0, 0.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 192.0, 0.0, 0.0, 5.0, 188.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 196.0, 0.0, 198.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 8.0, 186.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 10.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.854522588063103, "mean_inference_ms": 2.3212832230550253, "mean_action_processing_ms": 0.39034143140168964, "mean_env_wait_ms": 0.30005776576171045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014101982116699219, "StateBufferConnector_ms": 0.0037755966186523438, "ViewRequirementAgentConnector_ms": 0.1372281312942505}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -557.0, "episode_return_mean": -20.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.4620629095851, "num_env_steps_trained_throughput_per_sec": 337.4620629095851, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 12501.924, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12501.856, "sample_time_ms": 1864.053, "learn_time_ms": 10611.822, "learn_throughput": 376.938, "synch_weights_time_ms": 22.077}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "f1691_00000", "date": "2024-08-13_17-17-45", "timestamp": 1723583865, "time_this_iter_s": 11.899224758148193, "time_total_s": 2352.8245842456818, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3da3280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2352.8245842456818, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 54.300000000000004, "ram_util_percent": 82.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.200438156169679, "cur_kl_coeff": 4.252926625371866e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.7303095153399877, "policy_loss": 2.7295821420257055e-05, "vf_loss": 0.7302822209224499, "vf_explained_var": 2.3633083969196947e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.207814648510856, "cur_kl_coeff": 2.6956856245599254e-30, "cur_lr": 0.009999999999999998, "total_loss": 0.9780040428554886, "policy_loss": 0.00013369602045270975, "vf_loss": 0.9778703457148618, "vf_explained_var": -5.140506401263848e-09, "kl": -1.609699199628904e-12, "entropy": 5.921074746555948e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -557.0, "episode_reward_mean": -21.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -24.635, "predator_policy": 13.745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 15.0, -7.0, -18.0, 0.0, 15.0, 16.0, 0.0, -8.0, 30.0, -13.0, -7.0, 0.0, -24.0, 0.0, 10.0, -2.0, 0.0, 0.0, -14.0, 5.0, -184.0, -5.0, -161.0, -10.0, -3.0, 3.0, 0.0, -2.0, 5.0, 0.0, 9.0, 0.0, 15.0, 15.0, -8.0, 0.0, -24.0, 0.0, -9.0, 15.0, -181.0, -197.0, -179.0, 0.0, 7.0, -1.0, 4.0, -9.0, -10.0, -10.0, -20.0, -176.0, 0.0, 13.0, 0.0, 0.0, 0.0, 9.0, 7.0, 5.0, -557.0, 15.0, 1.0, 1.0, 0.0, 3.0, -12.0, -182.0, -10.0, 13.0, -5.0, -10.0, 4.0, 0.0, 8.0, 4.0, 0.0, -11.0, 0.0, 12.0, -200.0, 10.0, -7.0, 0.0, 13.0, -8.0, 1.0, -200.0, 0.0, 15.0, -4.0, 6.0, -6.0, -1.0, 0.0, 12.0, -10.0, -5.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 4.0, 15.0, 0.0, 0.0, -17.0, -10.0, -20.0, 0.0, 0.0, 0.0, 15.0, 9.0, -4.0, 0.0, 0.0, -16.0, 0.0, 15.0, 15.0, -20.0, -6.0, -14.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, -7.0, -14.0, 0.0, 4.0, 0.0, -376.0, 0.0, -10.0, -364.0, 15.0, -20.0, 0.0, -6.0, 0.0, -21.0, 11.0, 0.0, 0.0, 0.0, -4.0, 5.0, 0.0, 0.0, 0.0, -394.0, 9.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, -16.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, 0.0, 15.0, -392.0, 0.0, -395.0, 14.0, -386.0, 0.0, 0.0, 0.0, 7.0, -2.0, -10.0, 0.0, 4.0, -18.0, 0.0, 0.0, -20.0, 0.0, -20.0, -20.0, -20.0, 13.0, -383.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 5.0, 0.0, -400.0, -357.0, 0.0, 15.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, -24.0, 0.0, 9.0, -398.0, -20.0, 0.0, 0.0, 13.0, -10.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -4.0, 0.0, 0.0, -20.0, -11.0, 0.0, 0.0, 10.0, 2.0, -400.0, 0.0, 10.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 13.0, -28.0, 0.0, 1.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 6.0, 0.0, -12.0, -2.0, 0.0, 0.0, 0.0, 12.0, 0.0, -24.0, -24.0, -15.0, 0.0, 7.0, 0.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 192.0, 0.0, 0.0, 5.0, 188.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 196.0, 0.0, 198.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 8.0, 186.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 10.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 19.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8536075783479479, "mean_inference_ms": 2.3201769696994456, "mean_action_processing_ms": 0.38976959042358317, "mean_env_wait_ms": 0.2997236008209622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01435708999633789, "StateBufferConnector_ms": 0.004252314567565918, "ViewRequirementAgentConnector_ms": 0.13498926162719727}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -557.0, "episode_return_mean": -21.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.61595389118185, "num_env_steps_trained_throughput_per_sec": 351.61595389118185, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 12472.045, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12471.977, "sample_time_ms": 1862.81, "learn_time_ms": 10582.998, "learn_throughput": 377.965, "synch_weights_time_ms": 22.017}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "f1691_00000", "date": "2024-08-13_17-17-57", "timestamp": 1723583877, "time_this_iter_s": 11.424224138259888, "time_total_s": 2364.2488083839417, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3da3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2364.2488083839417, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 53.3125, "ram_util_percent": 83.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2459022490993554, "cur_kl_coeff": 2.126463312685933e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.2357805876504808, "policy_loss": -0.0003574576150014918, "vf_loss": 1.2361380413411156, "vf_explained_var": -7.97882281913959e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.266687704605368, "cur_kl_coeff": 1.3478428122799627e-30, "cur_lr": 0.009999999999999998, "total_loss": 1.413645299748769, "policy_loss": 0.0001764493866296357, "vf_loss": 1.4134688450230493, "vf_explained_var": -8.294191310014673e-09, "kl": 1.0445750154796024e-12, "entropy": 5.939622295473014e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -557.0, "episode_reward_mean": -34.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.385, "predator_policy": 18.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -14.0, 5.0, -184.0, -5.0, -161.0, -10.0, -3.0, 3.0, 0.0, -2.0, 5.0, 0.0, 9.0, 0.0, 15.0, 15.0, -8.0, 0.0, -24.0, 0.0, -9.0, 15.0, -181.0, -197.0, -179.0, 0.0, 7.0, -1.0, 4.0, -9.0, -10.0, -10.0, -20.0, -176.0, 0.0, 13.0, 0.0, 0.0, 0.0, 9.0, 7.0, 5.0, -557.0, 15.0, 1.0, 1.0, 0.0, 3.0, -12.0, -182.0, -10.0, 13.0, -5.0, -10.0, 4.0, 0.0, 8.0, 4.0, 0.0, -11.0, 0.0, 12.0, -200.0, 10.0, -7.0, 0.0, 13.0, -8.0, 1.0, -200.0, 0.0, 15.0, -4.0, 6.0, -6.0, -1.0, 0.0, 12.0, -10.0, -5.0, 7.0, 0.0, 21.0, 10.0, 0.0, 7.0, 0.0, -525.0, -10.0, 0.0, 26.0, 26.0, -10.0, -200.0, 2.0, -183.0, -196.0, 0.0, -187.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -7.0, -14.0, 0.0, 4.0, 0.0, -376.0, 0.0, -10.0, -364.0, 15.0, -20.0, 0.0, -6.0, 0.0, -21.0, 11.0, 0.0, 0.0, 0.0, -4.0, 5.0, 0.0, 0.0, 0.0, -394.0, 9.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, -16.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, 0.0, 15.0, -392.0, 0.0, -395.0, 14.0, -386.0, 0.0, 0.0, 0.0, 7.0, -2.0, -10.0, 0.0, 4.0, -18.0, 0.0, 0.0, -20.0, 0.0, -20.0, -20.0, -20.0, 13.0, -383.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 5.0, 0.0, -400.0, -357.0, 0.0, 15.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, -24.0, 0.0, 9.0, -398.0, -20.0, 0.0, 0.0, 13.0, -10.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -4.0, 0.0, 0.0, -20.0, -11.0, 0.0, 0.0, 10.0, 2.0, -400.0, 0.0, 10.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 13.0, -28.0, 0.0, 1.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 6.0, 0.0, -12.0, -2.0, 0.0, 0.0, 0.0, 12.0, 0.0, -24.0, -24.0, -15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 7.0, 3.0, 7.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -364.0, -343.0, 0.0, -20.0, 0.0, 0.0, 11.0, 15.0, 15.0, 11.0, 0.0, -20.0, -400.0, 0.0, 5.0, -6.0, -379.0, 3.0, -400.0, 4.0, 0.0, 0.0, 0.0, -374.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 192.0, 0.0, 0.0, 5.0, 188.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 196.0, 0.0, 198.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 8.0, 186.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 10.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 19.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 193.0, 0.0, 200.0, 0.0, 0.0, 187.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8526989071720183, "mean_inference_ms": 2.31923147110345, "mean_action_processing_ms": 0.3892204953833115, "mean_env_wait_ms": 0.2994104986418942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014135360717773438, "StateBufferConnector_ms": 0.004304170608520508, "ViewRequirementAgentConnector_ms": 0.14057159423828125}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -557.0, "episode_return_mean": -34.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.8856872208371, "num_env_steps_trained_throughput_per_sec": 351.8856872208371, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 11876.277, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11876.209, "sample_time_ms": 1882.571, "learn_time_ms": 9974.822, "learn_throughput": 401.01, "synch_weights_time_ms": 15.993}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "f1691_00000", "date": "2024-08-13_17-18-08", "timestamp": 1723583888, "time_this_iter_s": 11.489400148391724, "time_total_s": 2375.7382085323334, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f2e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2375.7382085323334, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 51.175, "ram_util_percent": 83.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5119964690222147, "cur_kl_coeff": 1.0632316563429664e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.6887748625543383, "policy_loss": 3.3842720012500805e-06, "vf_loss": 0.6887714786898522, "vf_explained_var": -2.5544847760881697e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3679926222622663, "cur_kl_coeff": 6.739214061399814e-31, "cur_lr": 0.009999999999999998, "total_loss": 0.7882850359110211, "policy_loss": 0.0001267055295920246, "vf_loss": 0.7881583310893759, "vf_explained_var": 8.581176636711e-07, "kl": -9.279937471240238e-13, "entropy": 5.957547736968653e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -557.0, "episode_reward_mean": -33.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.92, "predator_policy": 15.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -1.0, 4.0, -9.0, -10.0, -10.0, -20.0, -176.0, 0.0, 13.0, 0.0, 0.0, 0.0, 9.0, 7.0, 5.0, -557.0, 15.0, 1.0, 1.0, 0.0, 3.0, -12.0, -182.0, -10.0, 13.0, -5.0, -10.0, 4.0, 0.0, 8.0, 4.0, 0.0, -11.0, 0.0, 12.0, -200.0, 10.0, -7.0, 0.0, 13.0, -8.0, 1.0, -200.0, 0.0, 15.0, -4.0, 6.0, -6.0, -1.0, 0.0, 12.0, -10.0, -5.0, 7.0, 0.0, 21.0, 10.0, 0.0, 7.0, 0.0, -525.0, -10.0, 0.0, 26.0, 26.0, -10.0, -200.0, 2.0, -183.0, -196.0, 0.0, -187.0, 0.0, 0.0, -8.0, -3.0, -187.0, -20.0, 3.0, 0.0, 9.0, 3.0, 2.0, -11.0, 4.0, -4.0, 0.0, -200.0, 17.0, -189.0, -5.0, -7.0, 0.0, -188.0, 15.0, 0.0, 0.0, 0.0, -29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 7.0, -2.0, -10.0, 0.0, 4.0, -18.0, 0.0, 0.0, -20.0, 0.0, -20.0, -20.0, -20.0, 13.0, -383.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 5.0, 0.0, -400.0, -357.0, 0.0, 15.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, -24.0, 0.0, 9.0, -398.0, -20.0, 0.0, 0.0, 13.0, -10.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -4.0, 0.0, 0.0, -20.0, -11.0, 0.0, 0.0, 10.0, 2.0, -400.0, 0.0, 10.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 13.0, -28.0, 0.0, 1.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 6.0, 0.0, -12.0, -2.0, 0.0, 0.0, 0.0, 12.0, 0.0, -24.0, -24.0, -15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 7.0, 3.0, 7.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -364.0, -343.0, 0.0, -20.0, 0.0, 0.0, 11.0, 15.0, 15.0, 11.0, 0.0, -20.0, -400.0, 0.0, 5.0, -6.0, -379.0, 3.0, -400.0, 4.0, 0.0, 0.0, 0.0, -374.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, -16.0, 3.0, -385.0, 0.0, -40.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, -9.0, -15.0, 0.0, 4.0, -8.0, 0.0, 0.0, 0.0, -400.0, 0.0, 2.0, 15.0, 0.0, -378.0, -10.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -376.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 8.0, 186.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 10.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 19.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 193.0, 0.0, 200.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 192.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.85166948293748, "mean_inference_ms": 2.3186484291717697, "mean_action_processing_ms": 0.3927332316597279, "mean_env_wait_ms": 0.2990327038813127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398838996887207, "StateBufferConnector_ms": 0.0047653913497924805, "ViewRequirementAgentConnector_ms": 0.1338493824005127}, "num_episodes": 27, "episode_return_max": 26.0, "episode_return_min": -557.0, "episode_return_mean": -33.01, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.14621548265444, "num_env_steps_trained_throughput_per_sec": 305.14621548265444, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 11905.298, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11905.243, "sample_time_ms": 1894.644, "learn_time_ms": 9992.519, "learn_throughput": 400.299, "synch_weights_time_ms": 15.126}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "f1691_00000", "date": "2024-08-13_17-18-22", "timestamp": 1723583902, "time_this_iter_s": 13.168715000152588, "time_total_s": 2388.906923532486, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3da3280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2388.906923532486, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 53.38947368421052, "ram_util_percent": 83.71052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.189603766757835, "cur_kl_coeff": 5.316158281714832e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.2691433710711344, "policy_loss": 0.00023606352448936492, "vf_loss": 1.2689073038795007, "vf_explained_var": -7.316548988301918e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1909612413079396, "cur_kl_coeff": 3.369607030699907e-31, "cur_lr": 0.009999999999999998, "total_loss": 1.6871948840756896, "policy_loss": 6.442513026139409e-05, "vf_loss": 1.6871304574151518, "vf_explained_var": -8.641096649977265e-09, "kl": 2.4264421797382193e-12, "entropy": 5.966856651571949e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -560.0, "episode_reward_mean": -36.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.565, "predator_policy": 17.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 1.0, 0.0, 3.0, -12.0, -182.0, -10.0, 13.0, -5.0, -10.0, 4.0, 0.0, 8.0, 4.0, 0.0, -11.0, 0.0, 12.0, -200.0, 10.0, -7.0, 0.0, 13.0, -8.0, 1.0, -200.0, 0.0, 15.0, -4.0, 6.0, -6.0, -1.0, 0.0, 12.0, -10.0, -5.0, 7.0, 0.0, 21.0, 10.0, 0.0, 7.0, 0.0, -525.0, -10.0, 0.0, 26.0, 26.0, -10.0, -200.0, 2.0, -183.0, -196.0, 0.0, -187.0, 0.0, 0.0, -8.0, -3.0, -187.0, -20.0, 3.0, 0.0, 9.0, 3.0, 2.0, -11.0, 4.0, -4.0, 0.0, -200.0, 17.0, -189.0, -5.0, -7.0, 0.0, -188.0, 15.0, 0.0, 0.0, 0.0, -29.0, 8.0, 1.0, -2.0, 3.0, -199.0, -3.0, 6.0, -6.0, -195.0, -181.0, -3.0, 9.0, 0.0, 0.0, 0.0, -560.0, 0.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, -24.0, 0.0, 9.0, -398.0, -20.0, 0.0, 0.0, 13.0, -10.0, 0.0, 0.0, -20.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -4.0, 0.0, 0.0, -20.0, -11.0, 0.0, 0.0, 10.0, 2.0, -400.0, 0.0, 10.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 13.0, -28.0, 0.0, 1.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 6.0, 0.0, -12.0, -2.0, 0.0, 0.0, 0.0, 12.0, 0.0, -24.0, -24.0, -15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 7.0, 3.0, 7.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -364.0, -343.0, 0.0, -20.0, 0.0, 0.0, 11.0, 15.0, 15.0, 11.0, 0.0, -20.0, -400.0, 0.0, 5.0, -6.0, -379.0, 3.0, -400.0, 4.0, 0.0, 0.0, 0.0, -374.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, -16.0, 3.0, -385.0, 0.0, -40.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, -9.0, -15.0, 0.0, 4.0, -8.0, 0.0, 0.0, 0.0, -400.0, 0.0, 2.0, 15.0, 0.0, -378.0, -10.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -376.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 8.0, 0.0, -9.0, -4.0, 0.0, 0.0, 3.0, -400.0, 0.0, -8.0, -11.0, 6.0, 0.0, -12.0, 0.0, -392.0, 1.0, 0.0, -362.0, -6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -394.0, -364.0, 0.0, 0.0, 15.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 10.0, 197.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 19.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 193.0, 0.0, 200.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 192.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 198.0, 16.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 196.0, 0.0, 181.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 188.0, 10.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850800717037477, "mean_inference_ms": 2.317338023396663, "mean_action_processing_ms": 0.3949559504001963, "mean_env_wait_ms": 0.2986978096875197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004920482635498047, "StateBufferConnector_ms": 0.0044460296630859375, "ViewRequirementAgentConnector_ms": 0.1197667121887207}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -560.0, "episode_return_mean": -36.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.45977853558858, "num_env_steps_trained_throughput_per_sec": 84.45977853558858, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 15314.094, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15314.045, "sample_time_ms": 1805.479, "learn_time_ms": 13489.499, "learn_throughput": 296.527, "synch_weights_time_ms": 15.728}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "f1691_00000", "date": "2024-08-13_17-19-09", "timestamp": 1723583949, "time_this_iter_s": 47.500131130218506, "time_total_s": 2436.4070546627045, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e29160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2436.4070546627045, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 83.15806451612903, "ram_util_percent": 84.04516129032258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2956196516287504, "cur_kl_coeff": 2.658079140857416e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.3111536526175402, "policy_loss": -0.00020063523518503028, "vf_loss": 1.3113542909029299, "vf_explained_var": -5.266653797613881e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1199692095797045, "cur_kl_coeff": 1.6848035153499534e-31, "cur_lr": 0.009999999999999998, "total_loss": 1.6428390595332656, "policy_loss": 0.00019082481696925782, "vf_loss": 1.6426482343484485, "vf_explained_var": -6.496590912026703e-09, "kl": -3.638173542966427e-12, "entropy": 6.016848547203918e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -594.0, "episode_reward_mean": -46.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -43.27, "predator_policy": 19.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.0, 10.0, -7.0, 0.0, 13.0, -8.0, 1.0, -200.0, 0.0, 15.0, -4.0, 6.0, -6.0, -1.0, 0.0, 12.0, -10.0, -5.0, 7.0, 0.0, 21.0, 10.0, 0.0, 7.0, 0.0, -525.0, -10.0, 0.0, 26.0, 26.0, -10.0, -200.0, 2.0, -183.0, -196.0, 0.0, -187.0, 0.0, 0.0, -8.0, -3.0, -187.0, -20.0, 3.0, 0.0, 9.0, 3.0, 2.0, -11.0, 4.0, -4.0, 0.0, -200.0, 17.0, -189.0, -5.0, -7.0, 0.0, -188.0, 15.0, 0.0, 0.0, 0.0, -29.0, 8.0, 1.0, -2.0, 3.0, -199.0, -3.0, 6.0, -6.0, -195.0, -181.0, -3.0, 9.0, 0.0, 0.0, 0.0, -560.0, 0.0, 15.0, -189.0, 0.0, -594.0, 0.0, -2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -190.0, 0.0, -5.0, 0.0, 15.0, -3.0, 0.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, 0.0, 10.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 13.0, -28.0, 0.0, 1.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, 0.0, 6.0, 0.0, -12.0, -2.0, 0.0, 0.0, 0.0, 12.0, 0.0, -24.0, -24.0, -15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, 7.0, 3.0, 7.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -364.0, -343.0, 0.0, -20.0, 0.0, 0.0, 11.0, 15.0, 15.0, 11.0, 0.0, -20.0, -400.0, 0.0, 5.0, -6.0, -379.0, 3.0, -400.0, 4.0, 0.0, 0.0, 0.0, -374.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, -16.0, 3.0, -385.0, 0.0, -40.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, -9.0, -15.0, 0.0, 4.0, -8.0, 0.0, 0.0, 0.0, -400.0, 0.0, 2.0, 15.0, 0.0, -378.0, -10.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -376.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 8.0, 0.0, -9.0, -4.0, 0.0, 0.0, 3.0, -400.0, 0.0, -8.0, -11.0, 6.0, 0.0, -12.0, 0.0, -392.0, 1.0, 0.0, -362.0, -6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -394.0, -364.0, 0.0, 0.0, 15.0, 0.0, -400.0, 11.0, 0.0, 0.0, -400.0, -394.0, 0.0, 0.0, 0.0, -7.0, -2.0, -13.0, 0.0, 0.0, -7.0, -378.0, 0.0, 0.0, 0.0, 0.0, -384.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, -13.0, 0.0, 0.0, 0.0, 0.0, -18.0], "policy_predator_policy_reward": [200.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 19.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 193.0, 0.0, 200.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 192.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 198.0, 16.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 196.0, 0.0, 181.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 188.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 10.0, 0.0, 0.0, 183.0, 14.0, 0.0, 0.0, 0.0, 0.0, 184.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8509573247805767, "mean_inference_ms": 2.3191248410661838, "mean_action_processing_ms": 0.3975620967375468, "mean_env_wait_ms": 0.2987688933073083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01059412956237793, "StateBufferConnector_ms": 0.004499673843383789, "ViewRequirementAgentConnector_ms": 0.15206217765808105}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -594.0, "episode_return_mean": -46.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.33949134113635, "num_env_steps_trained_throughput_per_sec": 263.33949134113635, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 15607.252, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15607.2, "sample_time_ms": 1912.241, "learn_time_ms": 13675.221, "learn_throughput": 292.5, "synch_weights_time_ms": 15.977}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "f1691_00000", "date": "2024-08-13_17-19-25", "timestamp": 1723583965, "time_this_iter_s": 15.280816316604614, "time_total_s": 2451.687870979309, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e15040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2451.687870979309, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 74.2909090909091, "ram_util_percent": 83.64090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1142433852613927, "cur_kl_coeff": 1.329039570428708e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.6120852143360824, "policy_loss": 1.6721829072271706e-06, "vf_loss": 1.6120835375691218, "vf_explained_var": -9.492591575339989e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1559046306771785, "cur_kl_coeff": 8.424017576749767e-32, "cur_lr": 0.009999999999999998, "total_loss": 1.8229551639821795, "policy_loss": -6.413896267533933e-05, "vf_loss": 1.8230193034366324, "vf_explained_var": -8.136507064577132e-09, "kl": -1.2036059358307597e-12, "entropy": 5.984765291692481e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -594.0, "episode_reward_mean": -55.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.12, "predator_policy": 22.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 0.0, 21.0, 10.0, 0.0, 7.0, 0.0, -525.0, -10.0, 0.0, 26.0, 26.0, -10.0, -200.0, 2.0, -183.0, -196.0, 0.0, -187.0, 0.0, 0.0, -8.0, -3.0, -187.0, -20.0, 3.0, 0.0, 9.0, 3.0, 2.0, -11.0, 4.0, -4.0, 0.0, -200.0, 17.0, -189.0, -5.0, -7.0, 0.0, -188.0, 15.0, 0.0, 0.0, 0.0, -29.0, 8.0, 1.0, -2.0, 3.0, -199.0, -3.0, 6.0, -6.0, -195.0, -181.0, -3.0, 9.0, 0.0, 0.0, 0.0, -560.0, 0.0, 15.0, -189.0, 0.0, -594.0, 0.0, -2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -190.0, 0.0, -5.0, 0.0, 15.0, -3.0, 0.0, -9.0, 0.0, 15.0, -5.0, 0.0, 0.0, -184.0, 0.0, 15.0, -163.0, 0.0, 0.0, -9.0, -183.0, 24.0, -566.0, -200.0, 0.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.0, 0.0, 0.0, 0.0, 14.0, 7.0, 3.0, 7.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -364.0, -343.0, 0.0, -20.0, 0.0, 0.0, 11.0, 15.0, 15.0, 11.0, 0.0, -20.0, -400.0, 0.0, 5.0, -6.0, -379.0, 3.0, -400.0, 4.0, 0.0, 0.0, 0.0, -374.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, -16.0, 3.0, -385.0, 0.0, -40.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, -9.0, -15.0, 0.0, 4.0, -8.0, 0.0, 0.0, 0.0, -400.0, 0.0, 2.0, 15.0, 0.0, -378.0, -10.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -376.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 8.0, 0.0, -9.0, -4.0, 0.0, 0.0, 3.0, -400.0, 0.0, -8.0, -11.0, 6.0, 0.0, -12.0, 0.0, -392.0, 1.0, 0.0, -362.0, -6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -394.0, -364.0, 0.0, 0.0, 15.0, 0.0, -400.0, 11.0, 0.0, 0.0, -400.0, -394.0, 0.0, 0.0, 0.0, -7.0, -2.0, -13.0, 0.0, 0.0, -7.0, -378.0, 0.0, 0.0, 0.0, 0.0, -384.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, -13.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 8.0, 7.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -376.0, 0.0, 5.0, -15.0, 0.0, 15.0, -354.0, 14.0, 0.0, 0.0, 0.0, 0.0, -12.0, -6.0, 5.0, -376.0, 15.0, 9.0, -391.0, -374.0, -400.0, 0.0, 0.0, 0.0, -5.0, 6.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 200.0, 3.0, 0.0, 0.0, 193.0, 0.0, 200.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 192.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 198.0, 16.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 196.0, 0.0, 181.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 188.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 10.0, 0.0, 0.0, 183.0, 14.0, 0.0, 0.0, 0.0, 0.0, 184.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 10.0, 0.0, 0.0, 0.0, 177.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 10.0, 178.0, 0.0, 0.0, 197.0, 2.0, 0.0, 200.0, 0.0, 0.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.851225263553629, "mean_inference_ms": 2.321416938152491, "mean_action_processing_ms": 0.4002176471994588, "mean_env_wait_ms": 0.2988670801160346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010155320167541504, "StateBufferConnector_ms": 0.004145264625549316, "ViewRequirementAgentConnector_ms": 0.1504446268081665}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -594.0, "episode_return_mean": -55.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.86037685588127, "num_env_steps_trained_throughput_per_sec": 339.86037685588127, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 15657.092, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15657.039, "sample_time_ms": 1940.972, "learn_time_ms": 13696.347, "learn_throughput": 292.049, "synch_weights_time_ms": 15.897}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "f1691_00000", "date": "2024-08-13_17-19-36", "timestamp": 1723583976, "time_this_iter_s": 11.816669940948486, "time_total_s": 2463.5045409202576, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e15280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2463.5045409202576, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 54.86875, "ram_util_percent": 83.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.580919197558736, "cur_kl_coeff": 6.64519785214354e-13, "cur_lr": 0.009999999999999998, "total_loss": 0.6064947676327493, "policy_loss": 0.00025879219001917925, "vf_loss": 0.6062359739715855, "vf_explained_var": 3.391788119361514e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4849773273315456, "cur_kl_coeff": 4.2120087883748835e-32, "cur_lr": 0.009999999999999998, "total_loss": 0.9564305768323639, "policy_loss": -0.00014761419851017535, "vf_loss": 0.9565781943933673, "vf_explained_var": -6.780422553814277e-09, "kl": 2.492812459742592e-13, "entropy": 5.952373557012909e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -594.0, "episode_reward_mean": -50.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -47.21, "predator_policy": 21.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.0, -20.0, 3.0, 0.0, 9.0, 3.0, 2.0, -11.0, 4.0, -4.0, 0.0, -200.0, 17.0, -189.0, -5.0, -7.0, 0.0, -188.0, 15.0, 0.0, 0.0, 0.0, -29.0, 8.0, 1.0, -2.0, 3.0, -199.0, -3.0, 6.0, -6.0, -195.0, -181.0, -3.0, 9.0, 0.0, 0.0, 0.0, -560.0, 0.0, 15.0, -189.0, 0.0, -594.0, 0.0, -2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -190.0, 0.0, -5.0, 0.0, 15.0, -3.0, 0.0, -9.0, 0.0, 15.0, -5.0, 0.0, 0.0, -184.0, 0.0, 15.0, -163.0, 0.0, 0.0, -9.0, -183.0, 24.0, -566.0, -200.0, 0.0, 8.0, 1.0, -2.0, -3.0, 15.0, -384.0, 10.0, 3.0, 8.0, -199.0, 0.0, 1.0, -7.0, -10.0, 0.0, 7.0, -10.0, -5.0, -200.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, -385.0, 0.0, -40.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 2.0, 0.0, -9.0, -15.0, 0.0, 4.0, -8.0, 0.0, 0.0, 0.0, -400.0, 0.0, 2.0, 15.0, 0.0, -378.0, -10.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -376.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, 8.0, 0.0, -9.0, -4.0, 0.0, 0.0, 3.0, -400.0, 0.0, -8.0, -11.0, 6.0, 0.0, -12.0, 0.0, -392.0, 1.0, 0.0, -362.0, -6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -394.0, -364.0, 0.0, 0.0, 15.0, 0.0, -400.0, 11.0, 0.0, 0.0, -400.0, -394.0, 0.0, 0.0, 0.0, -7.0, -2.0, -13.0, 0.0, 0.0, -7.0, -378.0, 0.0, 0.0, 0.0, 0.0, -384.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, -13.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 8.0, 7.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -376.0, 0.0, 5.0, -15.0, 0.0, 15.0, -354.0, 14.0, 0.0, 0.0, 0.0, 0.0, -12.0, -6.0, 5.0, -376.0, 15.0, 9.0, -391.0, -374.0, -400.0, 0.0, 0.0, 0.0, -5.0, 6.0, 0.0, 1.0, -8.0, -12.0, -6.0, 0.0, -20.0, 15.0, -368.0, -400.0, 0.0, 10.0, 3.0, 0.0, 8.0, 0.0, -398.0, 0.0, 0.0, 0.0, 1.0, 0.0, -17.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, -36.0, 0.0, -15.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [192.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 198.0, 16.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 196.0, 0.0, 181.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 188.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 10.0, 0.0, 0.0, 183.0, 14.0, 0.0, 0.0, 0.0, 0.0, 184.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 10.0, 0.0, 0.0, 0.0, 177.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 10.0, 178.0, 0.0, 0.0, 197.0, 2.0, 0.0, 200.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 18.0, 3.0, 0.0, 10.0, 10.0, 184.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 10.0, 0.0, 10.0, 2.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8514154818180734, "mean_inference_ms": 2.326601880112799, "mean_action_processing_ms": 0.4036244244994796, "mean_env_wait_ms": 0.2989219893177417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01009523868560791, "StateBufferConnector_ms": 0.004089713096618652, "ViewRequirementAgentConnector_ms": 0.1516958475112915}, "num_episodes": 23, "episode_return_max": 24.0, "episode_return_min": -594.0, "episode_return_mean": -50.86, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.70021471375594, "num_env_steps_trained_throughput_per_sec": 12.70021471375594, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 45985.62, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45985.568, "sample_time_ms": 1962.665, "learn_time_ms": 44002.473, "learn_throughput": 90.904, "synch_weights_time_ms": 16.452}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "f1691_00000", "date": "2024-08-13_17-24-51", "timestamp": 1723584291, "time_this_iter_s": 315.02424216270447, "time_total_s": 2778.528783082962, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e29940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2778.528783082962, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 53.91111111111111, "ram_util_percent": 83.16111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.564655637425967, "cur_kl_coeff": 3.32259892607177e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.3057524301072276, "policy_loss": 0.0002628215737690134, "vf_loss": 1.3054896051290805, "vf_explained_var": -7.789601724614542e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2942741906786246, "cur_kl_coeff": 2.1060043941874417e-32, "cur_lr": 0.009999999999999998, "total_loss": 1.6698546993984746, "policy_loss": -5.56780367833439e-05, "vf_loss": 1.6699103798500445, "vf_explained_var": -1.0564844444315269e-08, "kl": 5.208636492627984e-13, "entropy": 5.887333863922527e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -595.0, "episode_reward_mean": -60.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -53.415, "predator_policy": 23.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.0, 8.0, 1.0, -2.0, 3.0, -199.0, -3.0, 6.0, -6.0, -195.0, -181.0, -3.0, 9.0, 0.0, 0.0, 0.0, -560.0, 0.0, 15.0, -189.0, 0.0, -594.0, 0.0, -2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -190.0, 0.0, -5.0, 0.0, 15.0, -3.0, 0.0, -9.0, 0.0, 15.0, -5.0, 0.0, 0.0, -184.0, 0.0, 15.0, -163.0, 0.0, 0.0, -9.0, -183.0, 24.0, -566.0, -200.0, 0.0, 8.0, 1.0, -2.0, -3.0, 15.0, -384.0, 10.0, 3.0, 8.0, -199.0, 0.0, 1.0, -7.0, -10.0, 0.0, 7.0, -10.0, -5.0, -200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, -14.0, 15.0, 0.0, -196.0, -595.0, -10.0, 4.0, 15.0, -180.0, -8.0, -6.0, 0.0, 0.0, -1.0, -195.0, -8.0, 0.0, 0.0, -558.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -20.0, 0.0, 8.0, 0.0, -9.0, -4.0, 0.0, 0.0, 3.0, -400.0, 0.0, -8.0, -11.0, 6.0, 0.0, -12.0, 0.0, -392.0, 1.0, 0.0, -362.0, -6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -394.0, -364.0, 0.0, 0.0, 15.0, 0.0, -400.0, 11.0, 0.0, 0.0, -400.0, -394.0, 0.0, 0.0, 0.0, -7.0, -2.0, -13.0, 0.0, 0.0, -7.0, -378.0, 0.0, 0.0, 0.0, 0.0, -384.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, -13.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 8.0, 7.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -376.0, 0.0, 5.0, -15.0, 0.0, 15.0, -354.0, 14.0, 0.0, 0.0, 0.0, 0.0, -12.0, -6.0, 5.0, -376.0, 15.0, 9.0, -391.0, -374.0, -400.0, 0.0, 0.0, 0.0, -5.0, 6.0, 0.0, 1.0, -8.0, -12.0, -6.0, 0.0, -20.0, 15.0, -368.0, -400.0, 0.0, 10.0, 3.0, 0.0, 8.0, 0.0, -398.0, 0.0, 0.0, 0.0, 1.0, 0.0, -17.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, -36.0, 0.0, -15.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, -13.0, -19.0, -17.0, 0.0, 15.0, 0.0, 0.0, 0.0, -394.0, -396.0, -398.0, -20.0, 0.0, 0.0, -4.0, -6.0, 15.0, -356.0, -12.0, -4.0, -12.0, -6.0, -6.0, 0.0, 0.0, -10.0, 0.0, -16.0, 7.0, -390.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -400.0, -368.0, -15.0, 0.0], "policy_predator_policy_reward": [11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 198.0, 16.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 196.0, 0.0, 181.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 188.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 10.0, 0.0, 0.0, 183.0, 14.0, 0.0, 0.0, 0.0, 0.0, 184.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 10.0, 0.0, 0.0, 0.0, 177.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 10.0, 178.0, 0.0, 0.0, 197.0, 2.0, 0.0, 200.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 18.0, 3.0, 0.0, 10.0, 10.0, 184.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 10.0, 0.0, 10.0, 2.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 199.0, 0.0, 10.0, 8.0, 0.0, 3.0, 3.0, 10.0, 178.0, 2.0, 6.0, 3.0, 3.0, 0.0, 0.0, 8.0, 2.0, 0.0, 8.0, 0.0, 195.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8520932216455637, "mean_inference_ms": 2.3281293309025832, "mean_action_processing_ms": 0.4028719780450259, "mean_env_wait_ms": 0.29923142955202997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010347962379455566, "StateBufferConnector_ms": 0.003903031349182129, "ViewRequirementAgentConnector_ms": 0.15336203575134277}, "num_episodes": 22, "episode_return_max": 24.0, "episode_return_min": -595.0, "episode_return_mean": -60.56, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.2049571241891, "num_env_steps_trained_throughput_per_sec": 350.2049571241891, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 45984.977, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45984.924, "sample_time_ms": 1997.266, "learn_time_ms": 43967.519, "learn_throughput": 90.976, "synch_weights_time_ms": 16.267}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "f1691_00000", "date": "2024-08-13_17-25-03", "timestamp": 1723584303, "time_this_iter_s": 11.486668586730957, "time_total_s": 2790.015451669693, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e63c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2790.015451669693, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 49.45294117647059, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.082191679617957, "cur_kl_coeff": 1.661299463035885e-13, "cur_lr": 0.009999999999999998, "total_loss": 0.9469798045183616, "policy_loss": -0.00028771872055672465, "vf_loss": 0.9472675240465573, "vf_explained_var": -7.316548988301918e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1901436846749487, "cur_kl_coeff": 1.0530021970937209e-32, "cur_lr": 0.009999999999999998, "total_loss": 1.25675739795758, "policy_loss": -6.170064191181194e-05, "vf_loss": 1.2568190958291765, "vf_explained_var": -6.244296119326637e-09, "kl": -1.173443657033779e-12, "entropy": 5.826272052230906e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -595.0, "episode_reward_mean": -60.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -53.48, "predator_policy": 23.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -189.0, 0.0, -594.0, 0.0, -2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -190.0, 0.0, -5.0, 0.0, 15.0, -3.0, 0.0, -9.0, 0.0, 15.0, -5.0, 0.0, 0.0, -184.0, 0.0, 15.0, -163.0, 0.0, 0.0, -9.0, -183.0, 24.0, -566.0, -200.0, 0.0, 8.0, 1.0, -2.0, -3.0, 15.0, -384.0, 10.0, 3.0, 8.0, -199.0, 0.0, 1.0, -7.0, -10.0, 0.0, 7.0, -10.0, -5.0, -200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, -14.0, 15.0, 0.0, -196.0, -595.0, -10.0, 4.0, 15.0, -180.0, -8.0, -6.0, 0.0, 0.0, -1.0, -195.0, -8.0, 0.0, 0.0, -558.0, -5.0, -198.0, 15.0, 0.0, -193.0, -10.0, 0.0, 11.0, 8.0, -573.0, -193.0, 0.0, -6.0, -9.0, 16.0, -18.0, 0.0, 0.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, -400.0, 11.0, 0.0, 0.0, -400.0, -394.0, 0.0, 0.0, 0.0, -7.0, -2.0, -13.0, 0.0, 0.0, -7.0, -378.0, 0.0, 0.0, 0.0, 0.0, -384.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 15.0, -13.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 8.0, 7.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -376.0, 0.0, 5.0, -15.0, 0.0, 15.0, -354.0, 14.0, 0.0, 0.0, 0.0, 0.0, -12.0, -6.0, 5.0, -376.0, 15.0, 9.0, -391.0, -374.0, -400.0, 0.0, 0.0, 0.0, -5.0, 6.0, 0.0, 1.0, -8.0, -12.0, -6.0, 0.0, -20.0, 15.0, -368.0, -400.0, 0.0, 10.0, 3.0, 0.0, 8.0, 0.0, -398.0, 0.0, 0.0, 0.0, 1.0, 0.0, -17.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, -36.0, 0.0, -15.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, -13.0, -19.0, -17.0, 0.0, 15.0, 0.0, 0.0, 0.0, -394.0, -396.0, -398.0, -20.0, 0.0, 0.0, -4.0, -6.0, 15.0, -356.0, -12.0, -4.0, -12.0, -6.0, -6.0, 0.0, 0.0, -10.0, 0.0, -16.0, 7.0, -390.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -400.0, -368.0, -15.0, 0.0, 0.0, -396.0, 15.0, 0.0, 0.0, 0.0, -389.0, 0.0, 0.0, -20.0, 0.0, 0.0, 10.0, 1.0, 0.0, 8.0, -378.0, -390.0, 0.0, -396.0, 0.0, 0.0, 0.0, -12.0, -15.0, -8.0, 15.0, 1.0, -18.0, -24.0, 0.0, 0.0, 0.0, 0.0, -4.0, 12.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 10.0, 0.0, 0.0, 183.0, 14.0, 0.0, 0.0, 0.0, 0.0, 184.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 10.0, 0.0, 0.0, 0.0, 177.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 10.0, 178.0, 0.0, 0.0, 197.0, 2.0, 0.0, 200.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 18.0, 3.0, 0.0, 10.0, 10.0, 184.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 10.0, 0.0, 10.0, 2.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 199.0, 0.0, 10.0, 8.0, 0.0, 3.0, 3.0, 10.0, 178.0, 2.0, 6.0, 3.0, 3.0, 0.0, 0.0, 8.0, 2.0, 0.0, 8.0, 0.0, 195.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 193.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 4.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853325535834163, "mean_inference_ms": 2.333862111843772, "mean_action_processing_ms": 0.4031611491117287, "mean_env_wait_ms": 0.2996888854050276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010432720184326172, "StateBufferConnector_ms": 0.005643367767333984, "ViewRequirementAgentConnector_ms": 0.19949638843536377}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -595.0, "episode_return_mean": -60.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.28320303434333, "num_env_steps_trained_throughput_per_sec": 299.28320303434333, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 46176.646, "restore_workers_time_ms": 0.014, "training_step_time_ms": 46176.592, "sample_time_ms": 2215.489, "learn_time_ms": 43940.193, "learn_throughput": 91.033, "synch_weights_time_ms": 16.761}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "f1691_00000", "date": "2024-08-13_17-25-16", "timestamp": 1723584316, "time_this_iter_s": 13.412266969680786, "time_total_s": 2803.427718639374, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3effca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2803.427718639374, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 57.021052631578954, "ram_util_percent": 83.83684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1446369347332856, "cur_kl_coeff": 8.306497315179425e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.635135130324061, "policy_loss": 9.097379371129646e-05, "vf_loss": 0.6350441558572351, "vf_explained_var": 4.7352578904893664e-07, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.109733095934501, "cur_kl_coeff": 5.2650109854686044e-33, "cur_lr": 0.009999999999999998, "total_loss": 0.7494867193586533, "policy_loss": -0.00012654151506327763, "vf_loss": 0.7496132620103059, "vf_explained_var": 1.1412870316278368e-06, "kl": 1.7014595559037628e-12, "entropy": 5.765616493348456e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -595.0, "episode_reward_mean": -50.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.665, "predator_policy": 20.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 0.0, 15.0, -5.0, 0.0, 0.0, -184.0, 0.0, 15.0, -163.0, 0.0, 0.0, -9.0, -183.0, 24.0, -566.0, -200.0, 0.0, 8.0, 1.0, -2.0, -3.0, 15.0, -384.0, 10.0, 3.0, 8.0, -199.0, 0.0, 1.0, -7.0, -10.0, 0.0, 7.0, -10.0, -5.0, -200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, -14.0, 15.0, 0.0, -196.0, -595.0, -10.0, 4.0, 15.0, -180.0, -8.0, -6.0, 0.0, 0.0, -1.0, -195.0, -8.0, 0.0, 0.0, -558.0, -5.0, -198.0, 15.0, 0.0, -193.0, -10.0, 0.0, 11.0, 8.0, -573.0, -193.0, 0.0, -6.0, -9.0, 16.0, -18.0, 0.0, 0.0, 10.0, 0.0, 20.0, 12.0, -187.0, -17.0, 0.0, 0.0, -7.0, 15.0, 0.0, -15.0, 15.0, 6.0, 7.0, -3.0, 0.0, 0.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -18.0, 0.0, 0.0, 8.0, 7.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -376.0, 0.0, 5.0, -15.0, 0.0, 15.0, -354.0, 14.0, 0.0, 0.0, 0.0, 0.0, -12.0, -6.0, 5.0, -376.0, 15.0, 9.0, -391.0, -374.0, -400.0, 0.0, 0.0, 0.0, -5.0, 6.0, 0.0, 1.0, -8.0, -12.0, -6.0, 0.0, -20.0, 15.0, -368.0, -400.0, 0.0, 10.0, 3.0, 0.0, 8.0, 0.0, -398.0, 0.0, 0.0, 0.0, 1.0, 0.0, -17.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, -36.0, 0.0, -15.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, -13.0, -19.0, -17.0, 0.0, 15.0, 0.0, 0.0, 0.0, -394.0, -396.0, -398.0, -20.0, 0.0, 0.0, -4.0, -6.0, 15.0, -356.0, -12.0, -4.0, -12.0, -6.0, -6.0, 0.0, 0.0, -10.0, 0.0, -16.0, 7.0, -390.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -400.0, -368.0, -15.0, 0.0, 0.0, -396.0, 15.0, 0.0, 0.0, 0.0, -389.0, 0.0, 0.0, -20.0, 0.0, 0.0, 10.0, 1.0, 0.0, 8.0, -378.0, -390.0, 0.0, -396.0, 0.0, 0.0, 0.0, -12.0, -15.0, -8.0, 15.0, 1.0, -18.0, -24.0, 0.0, 0.0, 0.0, 0.0, -4.0, 12.0, 0.0, 0.0, 5.0, 15.0, -6.0, 15.0, 11.0, -397.0, -14.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 15.0, 0.0, 0.0, -16.0, -14.0, 15.0, 0.0, 0.0, 6.0, 4.0, 0.0, -15.0, 2.0, 0.0, 0.0, 0.0, 0.0, -20.0, 12.0], "policy_predator_policy_reward": [0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 10.0, 0.0, 0.0, 0.0, 177.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 10.0, 178.0, 0.0, 0.0, 197.0, 2.0, 0.0, 200.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 18.0, 3.0, 0.0, 10.0, 10.0, 184.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 10.0, 0.0, 10.0, 2.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 199.0, 0.0, 10.0, 8.0, 0.0, 3.0, 3.0, 10.0, 178.0, 2.0, 6.0, 3.0, 3.0, 0.0, 0.0, 8.0, 2.0, 0.0, 8.0, 0.0, 195.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 193.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 4.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 199.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8538308257452747, "mean_inference_ms": 2.337484122939265, "mean_action_processing_ms": 0.40314283471222323, "mean_env_wait_ms": 0.29985104605237106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045299530029296875, "StateBufferConnector_ms": 0.006048917770385742, "ViewRequirementAgentConnector_ms": 0.17450928688049316}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -595.0, "episode_return_mean": -50.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.69126861793285, "num_env_steps_trained_throughput_per_sec": 322.69126861793285, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 46230.903, "restore_workers_time_ms": 0.014, "training_step_time_ms": 46230.849, "sample_time_ms": 2257.103, "learn_time_ms": 43952.465, "learn_throughput": 91.007, "synch_weights_time_ms": 17.557}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "f1691_00000", "date": "2024-08-13_17-25-29", "timestamp": 1723584329, "time_this_iter_s": 12.453099012374878, "time_total_s": 2815.8808176517487, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e29940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2815.8808176517487, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 55.65882352941177, "ram_util_percent": 83.62941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.329577382709018, "cur_kl_coeff": 4.1532486575897126e-14, "cur_lr": 0.009999999999999998, "total_loss": 1.4445130470568541, "policy_loss": -0.00016341008807695102, "vf_loss": 1.4446764543889061, "vf_explained_var": -7.442696384651951e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9381475265937274, "cur_kl_coeff": 2.6325054927343022e-33, "cur_lr": 0.009999999999999998, "total_loss": 1.7394037637918716, "policy_loss": -0.00011477584657431752, "vf_loss": 1.7395185354840819, "vf_explained_var": -4.162864079551091e-09, "kl": 6.536446079205128e-13, "entropy": 5.7182610933238575e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -595.0, "episode_reward_mean": -53.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -48.03, "predator_policy": 21.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 1.0, -2.0, -3.0, 15.0, -384.0, 10.0, 3.0, 8.0, -199.0, 0.0, 1.0, -7.0, -10.0, 0.0, 7.0, -10.0, -5.0, -200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, -14.0, 15.0, 0.0, -196.0, -595.0, -10.0, 4.0, 15.0, -180.0, -8.0, -6.0, 0.0, 0.0, -1.0, -195.0, -8.0, 0.0, 0.0, -558.0, -5.0, -198.0, 15.0, 0.0, -193.0, -10.0, 0.0, 11.0, 8.0, -573.0, -193.0, 0.0, -6.0, -9.0, 16.0, -18.0, 0.0, 0.0, 10.0, 0.0, 20.0, 12.0, -187.0, -17.0, 0.0, 0.0, -7.0, 15.0, 0.0, -15.0, 15.0, 6.0, 7.0, -3.0, 0.0, 0.0, 2.0, -5.0, -576.0, 0.0, -9.0, 0.0, 15.0, 0.0, 0.0, -200.0, -190.0, 0.0, -182.0, 0.0, -200.0, 12.0, 0.0, -190.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.0, 6.0, 0.0, 1.0, -8.0, -12.0, -6.0, 0.0, -20.0, 15.0, -368.0, -400.0, 0.0, 10.0, 3.0, 0.0, 8.0, 0.0, -398.0, 0.0, 0.0, 0.0, 1.0, 0.0, -17.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, -36.0, 0.0, -15.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, -13.0, -19.0, -17.0, 0.0, 15.0, 0.0, 0.0, 0.0, -394.0, -396.0, -398.0, -20.0, 0.0, 0.0, -4.0, -6.0, 15.0, -356.0, -12.0, -4.0, -12.0, -6.0, -6.0, 0.0, 0.0, -10.0, 0.0, -16.0, 7.0, -390.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -400.0, -368.0, -15.0, 0.0, 0.0, -396.0, 15.0, 0.0, 0.0, 0.0, -389.0, 0.0, 0.0, -20.0, 0.0, 0.0, 10.0, 1.0, 0.0, 8.0, -378.0, -390.0, 0.0, -396.0, 0.0, 0.0, 0.0, -12.0, -15.0, -8.0, 15.0, 1.0, -18.0, -24.0, 0.0, 0.0, 0.0, 0.0, -4.0, 12.0, 0.0, 0.0, 5.0, 15.0, -6.0, 15.0, 11.0, -397.0, -14.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 15.0, 0.0, 0.0, -16.0, -14.0, 15.0, 0.0, 0.0, 6.0, 4.0, 0.0, -15.0, 2.0, 0.0, 0.0, 0.0, 0.0, -20.0, 12.0, 0.0, -10.0, -400.0, -380.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -383.0, 0.0, 0.0, 0.0, -372.0, 0.0, 0.0, 0.0, 0.0, -400.0, 12.0, 0.0, 0.0, 0.0, -400.0, 10.0, -6.0, 0.0], "policy_predator_policy_reward": [7.0, 0.0, 0.0, 0.0, 0.0, 18.0, 3.0, 0.0, 10.0, 10.0, 184.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 10.0, 0.0, 10.0, 2.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 199.0, 0.0, 10.0, 8.0, 0.0, 3.0, 3.0, 10.0, 178.0, 2.0, 6.0, 3.0, 3.0, 0.0, 0.0, 8.0, 2.0, 0.0, 8.0, 0.0, 195.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 193.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 4.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 199.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 183.0, 10.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8543793503642293, "mean_inference_ms": 2.340867394845941, "mean_action_processing_ms": 0.4031008195564572, "mean_env_wait_ms": 0.29999347568613316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004521369934082031, "StateBufferConnector_ms": 0.006737112998962402, "ViewRequirementAgentConnector_ms": 0.17258870601654053}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -595.0, "episode_return_mean": -53.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.969328170018589, "num_env_steps_trained_throughput_per_sec": 5.969328170018589, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 112102.514, "restore_workers_time_ms": 0.014, "training_step_time_ms": 112102.457, "sample_time_ms": 2296.824, "learn_time_ms": 109783.26, "learn_throughput": 36.435, "synch_weights_time_ms": 18.712}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "f1691_00000", "date": "2024-08-13_17-36-39", "timestamp": 1723584999, "time_this_iter_s": 670.1803779602051, "time_total_s": 3486.0611956119537, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ea8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3486.0611956119537, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 82.13076923076923, "ram_util_percent": 82.73846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.360259875806083, "cur_kl_coeff": 2.0766243287948563e-14, "cur_lr": 0.009999999999999998, "total_loss": 1.675834421222172, "policy_loss": -0.00018337177280238064, "vf_loss": 1.6760177961417606, "vf_explained_var": -6.055075024801587e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3188997088779204, "cur_kl_coeff": 1.3162527463671511e-33, "cur_lr": 0.009999999999999998, "total_loss": 2.0945446305174045, "policy_loss": -3.866903205456399e-05, "vf_loss": 2.0945832951989756, "vf_explained_var": -6.212759270239129e-09, "kl": 7.910460991589526e-13, "entropy": 5.6386574678101085e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -595.0, "episode_reward_mean": -61.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -54.715, "predator_policy": 23.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 0.0, -196.0, -595.0, -10.0, 4.0, 15.0, -180.0, -8.0, -6.0, 0.0, 0.0, -1.0, -195.0, -8.0, 0.0, 0.0, -558.0, -5.0, -198.0, 15.0, 0.0, -193.0, -10.0, 0.0, 11.0, 8.0, -573.0, -193.0, 0.0, -6.0, -9.0, 16.0, -18.0, 0.0, 0.0, 10.0, 0.0, 20.0, 12.0, -187.0, -17.0, 0.0, 0.0, -7.0, 15.0, 0.0, -15.0, 15.0, 6.0, 7.0, -3.0, 0.0, 0.0, 2.0, -5.0, -576.0, 0.0, -9.0, 0.0, 15.0, 0.0, 0.0, -200.0, -190.0, 0.0, -182.0, 0.0, -200.0, 12.0, 0.0, -190.0, 2.0, 0.0, -592.0, -18.0, 15.0, 15.0, 27.0, 5.0, 15.0, 14.0, -172.0, 12.0, 0.0, 0.0, -191.0, -205.0, -5.0, -167.0, 0.0, 0.0, 15.0, 0.0, -5.0, -10.0, -5.0, 5.0, -152.0, -205.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, 0.0, 0.0, 0.0, -394.0, -396.0, -398.0, -20.0, 0.0, 0.0, -4.0, -6.0, 15.0, -356.0, -12.0, -4.0, -12.0, -6.0, -6.0, 0.0, 0.0, -10.0, 0.0, -16.0, 7.0, -390.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -400.0, -368.0, -15.0, 0.0, 0.0, -396.0, 15.0, 0.0, 0.0, 0.0, -389.0, 0.0, 0.0, -20.0, 0.0, 0.0, 10.0, 1.0, 0.0, 8.0, -378.0, -390.0, 0.0, -396.0, 0.0, 0.0, 0.0, -12.0, -15.0, -8.0, 15.0, 1.0, -18.0, -24.0, 0.0, 0.0, 0.0, 0.0, -4.0, 12.0, 0.0, 0.0, 5.0, 15.0, -6.0, 15.0, 11.0, -397.0, -14.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 15.0, 0.0, 0.0, -16.0, -14.0, 15.0, 0.0, 0.0, 6.0, 4.0, 0.0, -15.0, 2.0, 0.0, 0.0, 0.0, 0.0, -20.0, 12.0, 0.0, -10.0, -400.0, -380.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -383.0, 0.0, 0.0, 0.0, -372.0, 0.0, 0.0, 0.0, 0.0, -400.0, 12.0, 0.0, 0.0, 0.0, -400.0, 10.0, -6.0, 0.0, 0.0, 0.0, -400.0, -392.0, -36.0, 0.0, 0.0, 15.0, 0.0, 15.0, 12.0, 15.0, 0.0, 5.0, 15.0, 0.0, 9.0, -1.0, -358.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -15.0, -400.0, 0.0, -15.0, -6.0, -343.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -10.0, 5.0, 0.0, -345.0, 13.0, -19.0, -394.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 199.0, 0.0, 10.0, 8.0, 0.0, 3.0, 3.0, 10.0, 178.0, 2.0, 6.0, 3.0, 3.0, 0.0, 0.0, 8.0, 2.0, 0.0, 8.0, 0.0, 195.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 193.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 4.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 199.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 183.0, 10.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 200.0, 10.0, 10.0, 0.0, 179.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 180.0, 0.0, 10.0, 198.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8562354800732946, "mean_inference_ms": 2.349153290714896, "mean_action_processing_ms": 0.4033770501406551, "mean_env_wait_ms": 0.30061695288127427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005176901817321777, "StateBufferConnector_ms": 0.00696253776550293, "ViewRequirementAgentConnector_ms": 0.17197799682617188}, "num_episodes": 27, "episode_return_max": 27.0, "episode_return_min": -595.0, "episode_return_mean": -61.47, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.56725808708256, "num_env_steps_trained_throughput_per_sec": 256.56725808708256, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 112524.827, "restore_workers_time_ms": 0.014, "training_step_time_ms": 112524.77, "sample_time_ms": 2465.207, "learn_time_ms": 110036.309, "learn_throughput": 36.352, "synch_weights_time_ms": 19.429}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "f1691_00000", "date": "2024-08-13_17-36-55", "timestamp": 1723585015, "time_this_iter_s": 15.632367134094238, "time_total_s": 3501.693562746048, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e97040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3501.693562746048, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 71.77272727272727, "ram_util_percent": 83.46363636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.227613080520412, "cur_kl_coeff": 1.0383121643974282e-14, "cur_lr": 0.009999999999999998, "total_loss": 1.0604934371337689, "policy_loss": -0.00023713649851738144, "vf_loss": 1.0607305735802997, "vf_explained_var": 6.359446616399856e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4490186564338505, "cur_kl_coeff": 6.5812637318357555e-34, "cur_lr": 0.009999999999999998, "total_loss": 0.9281205424496894, "policy_loss": 0.000212619555424209, "vf_loss": 0.9279079222366726, "vf_explained_var": 3.1981518659642133e-07, "kl": -2.2766982187081742e-12, "entropy": 5.687177498836574e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -592.0, "episode_reward_mean": -45.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.745, "predator_policy": 21.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -198.0, 15.0, 0.0, -193.0, -10.0, 0.0, 11.0, 8.0, -573.0, -193.0, 0.0, -6.0, -9.0, 16.0, -18.0, 0.0, 0.0, 10.0, 0.0, 20.0, 12.0, -187.0, -17.0, 0.0, 0.0, -7.0, 15.0, 0.0, -15.0, 15.0, 6.0, 7.0, -3.0, 0.0, 0.0, 2.0, -5.0, -576.0, 0.0, -9.0, 0.0, 15.0, 0.0, 0.0, -200.0, -190.0, 0.0, -182.0, 0.0, -200.0, 12.0, 0.0, -190.0, 2.0, 0.0, -592.0, -18.0, 15.0, 15.0, 27.0, 5.0, 15.0, 14.0, -172.0, 12.0, 0.0, 0.0, -191.0, -205.0, -5.0, -167.0, 0.0, 0.0, 15.0, 0.0, -5.0, -10.0, -5.0, 5.0, -152.0, -205.0, 3.0, -168.0, 0.0, 6.0, -5.0, -4.0, -8.0, 11.0, -5.0, 15.0, 6.0, 9.0, 9.0, -1.0, 0.0, -8.0, 0.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, 0.0, 0.0, -396.0, 15.0, 0.0, 0.0, 0.0, -389.0, 0.0, 0.0, -20.0, 0.0, 0.0, 10.0, 1.0, 0.0, 8.0, -378.0, -390.0, 0.0, -396.0, 0.0, 0.0, 0.0, -12.0, -15.0, -8.0, 15.0, 1.0, -18.0, -24.0, 0.0, 0.0, 0.0, 0.0, -4.0, 12.0, 0.0, 0.0, 5.0, 15.0, -6.0, 15.0, 11.0, -397.0, -14.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 15.0, 0.0, 0.0, -16.0, -14.0, 15.0, 0.0, 0.0, 6.0, 4.0, 0.0, -15.0, 2.0, 0.0, 0.0, 0.0, 0.0, -20.0, 12.0, 0.0, -10.0, -400.0, -380.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -383.0, 0.0, 0.0, 0.0, -372.0, 0.0, 0.0, 0.0, 0.0, -400.0, 12.0, 0.0, 0.0, 0.0, -400.0, 10.0, -6.0, 0.0, 0.0, 0.0, -400.0, -392.0, -36.0, 0.0, 0.0, 15.0, 0.0, 15.0, 12.0, 15.0, 0.0, 5.0, 15.0, 0.0, 9.0, -1.0, -358.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -15.0, -400.0, 0.0, -15.0, -6.0, -343.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -10.0, 5.0, 0.0, -345.0, 13.0, -19.0, -394.0, 0.0, 3.0, 0.0, -351.0, 0.0, 0.0, 4.0, 0.0, 0.0, -15.0, -24.0, 0.0, 0.0, -18.0, -14.0, 15.0, -12.0, -6.0, 15.0, 0.0, 6.0, 0.0, 6.0, 3.0, 9.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 10.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 196.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 193.0, 10.0, 0.0, 0.0, 0.0, 6.0, 10.0, 4.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 199.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 183.0, 10.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 200.0, 10.0, 10.0, 0.0, 179.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 180.0, 0.0, 10.0, 198.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8571353833253964, "mean_inference_ms": 2.3533568667685545, "mean_action_processing_ms": 0.4035197162190277, "mean_env_wait_ms": 0.3009507530160121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004959225654602051, "StateBufferConnector_ms": 0.0067708492279052734, "ViewRequirementAgentConnector_ms": 0.16996896266937256}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -592.0, "episode_return_mean": -45.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.7016464093425, "num_env_steps_trained_throughput_per_sec": 288.7016464093425, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 112599.493, "restore_workers_time_ms": 0.014, "training_step_time_ms": 112599.424, "sample_time_ms": 2301.786, "learn_time_ms": 110273.464, "learn_throughput": 36.273, "synch_weights_time_ms": 19.907}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "f1691_00000", "date": "2024-08-13_17-37-09", "timestamp": 1723585029, "time_this_iter_s": 13.895679235458374, "time_total_s": 3515.5892419815063, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3515.5892419815063, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 83.81052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2630509048828453, "cur_kl_coeff": 5.191560821987141e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.9917644457369255, "policy_loss": 0.00012849825114090606, "vf_loss": 0.9916359479228656, "vf_explained_var": -4.9828221558263064e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.175260984063304, "cur_kl_coeff": 3.2906318659178777e-34, "cur_lr": 0.009999999999999998, "total_loss": 1.1299980733918134, "policy_loss": 0.00016833224713250442, "vf_loss": 1.1298297353759015, "vf_explained_var": -8.609559800889756e-09, "kl": -3.2538267155326176e-12, "entropy": 5.7211071565091e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -592.0, "episode_reward_mean": -39.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.89, "predator_policy": 21.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 20.0, 12.0, -187.0, -17.0, 0.0, 0.0, -7.0, 15.0, 0.0, -15.0, 15.0, 6.0, 7.0, -3.0, 0.0, 0.0, 2.0, -5.0, -576.0, 0.0, -9.0, 0.0, 15.0, 0.0, 0.0, -200.0, -190.0, 0.0, -182.0, 0.0, -200.0, 12.0, 0.0, -190.0, 2.0, 0.0, -592.0, -18.0, 15.0, 15.0, 27.0, 5.0, 15.0, 14.0, -172.0, 12.0, 0.0, 0.0, -191.0, -205.0, -5.0, -167.0, 0.0, 0.0, 15.0, 0.0, -5.0, -10.0, -5.0, 5.0, -152.0, -205.0, 3.0, -168.0, 0.0, 6.0, -5.0, -4.0, -8.0, 11.0, -5.0, 15.0, 6.0, 9.0, 9.0, -1.0, 0.0, -8.0, 0.0, 10.0, -9.0, 3.0, -183.0, 0.0, 0.0, 0.0, -182.0, -194.0, 0.0, 15.0, -9.0, 5.0, -1.0, 0.0, 5.0, 14.0, -47.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 12.0, 0.0, 0.0, 5.0, 15.0, -6.0, 15.0, 11.0, -397.0, -14.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 15.0, 0.0, 0.0, -16.0, -14.0, 15.0, 0.0, 0.0, 6.0, 4.0, 0.0, -15.0, 2.0, 0.0, 0.0, 0.0, 0.0, -20.0, 12.0, 0.0, -10.0, -400.0, -380.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -383.0, 0.0, 0.0, 0.0, -372.0, 0.0, 0.0, 0.0, 0.0, -400.0, 12.0, 0.0, 0.0, 0.0, -400.0, 10.0, -6.0, 0.0, 0.0, 0.0, -400.0, -392.0, -36.0, 0.0, 0.0, 15.0, 0.0, 15.0, 12.0, 15.0, 0.0, 5.0, 15.0, 0.0, 9.0, -1.0, -358.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -15.0, -400.0, 0.0, -15.0, -6.0, -343.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -10.0, 5.0, 0.0, -345.0, 13.0, -19.0, -394.0, 0.0, 3.0, 0.0, -351.0, 0.0, 0.0, 4.0, 0.0, 0.0, -15.0, -24.0, 0.0, 0.0, -18.0, -14.0, 15.0, -12.0, -6.0, 15.0, 0.0, 6.0, 0.0, 6.0, 3.0, 9.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 10.0, -10.0, -18.0, 13.0, -25.0, 15.0, -397.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -373.0, -10.0, -378.0, 0.0, 0.0, 0.0, 15.0, -18.0, 0.0, 15.0, -30.0, -2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 14.0, -36.0, -32.0, 12.0, 0.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 199.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 183.0, 10.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 200.0, 10.0, 10.0, 0.0, 179.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 180.0, 0.0, 10.0, 198.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 10.0, 5.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 189.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8572847951173224, "mean_inference_ms": 2.355322371996284, "mean_action_processing_ms": 0.40323730110119066, "mean_env_wait_ms": 0.30101820018043485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005473494529724121, "StateBufferConnector_ms": 0.005030035972595215, "ViewRequirementAgentConnector_ms": 0.12589478492736816}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -592.0, "episode_return_mean": -39.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.890499706373829, "num_env_steps_trained_throughput_per_sec": 15.890499706373829, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 133035.784, "restore_workers_time_ms": 0.014, "training_step_time_ms": 133035.716, "sample_time_ms": 2300.834, "learn_time_ms": 130710.59, "learn_throughput": 30.602, "synch_weights_time_ms": 20.202}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "f1691_00000", "date": "2024-08-13_17-41-21", "timestamp": 1723585281, "time_this_iter_s": 251.77095317840576, "time_total_s": 3767.360195159912, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f2ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3767.360195159912, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 64.99090909090908, "ram_util_percent": 83.76818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.280738774367002, "cur_kl_coeff": 2.5957804109935704e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.590822739993769, "policy_loss": -9.706646657336956e-05, "vf_loss": 0.5909198038772774, "vf_explained_var": 1.948977273608011e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2688312676121734, "cur_kl_coeff": 1.6453159329589389e-34, "cur_lr": 0.009999999999999998, "total_loss": 0.6628771394964248, "policy_loss": 0.00023006700403081678, "vf_loss": 0.6626470736134304, "vf_explained_var": -6.654275157464244e-09, "kl": 5.682825821958545e-13, "entropy": 5.698818514794932e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -592.0, "episode_reward_mean": -43.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.62, "predator_policy": 22.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -5.0, -576.0, 0.0, -9.0, 0.0, 15.0, 0.0, 0.0, -200.0, -190.0, 0.0, -182.0, 0.0, -200.0, 12.0, 0.0, -190.0, 2.0, 0.0, -592.0, -18.0, 15.0, 15.0, 27.0, 5.0, 15.0, 14.0, -172.0, 12.0, 0.0, 0.0, -191.0, -205.0, -5.0, -167.0, 0.0, 0.0, 15.0, 0.0, -5.0, -10.0, -5.0, 5.0, -152.0, -205.0, 3.0, -168.0, 0.0, 6.0, -5.0, -4.0, -8.0, 11.0, -5.0, 15.0, 6.0, 9.0, 9.0, -1.0, 0.0, -8.0, 0.0, 10.0, -9.0, 3.0, -183.0, 0.0, 0.0, 0.0, -182.0, -194.0, 0.0, 15.0, -9.0, 5.0, -1.0, 0.0, 5.0, 14.0, -47.0, 12.0, 1.0, 0.0, 15.0, -9.0, 10.0, 0.0, 8.0, 0.0, 12.0, 26.0, 2.0, 0.0, -188.0, 15.0, -3.0, -4.0, -195.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, 12.0, 0.0, -10.0, -400.0, -380.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -383.0, 0.0, 0.0, 0.0, -372.0, 0.0, 0.0, 0.0, 0.0, -400.0, 12.0, 0.0, 0.0, 0.0, -400.0, 10.0, -6.0, 0.0, 0.0, 0.0, -400.0, -392.0, -36.0, 0.0, 0.0, 15.0, 0.0, 15.0, 12.0, 15.0, 0.0, 5.0, 15.0, 0.0, 9.0, -1.0, -358.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -15.0, -400.0, 0.0, -15.0, -6.0, -343.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -10.0, 5.0, 0.0, -345.0, 13.0, -19.0, -394.0, 0.0, 3.0, 0.0, -351.0, 0.0, 0.0, 4.0, 0.0, 0.0, -15.0, -24.0, 0.0, 0.0, -18.0, -14.0, 15.0, -12.0, -6.0, 15.0, 0.0, 6.0, 0.0, 6.0, 3.0, 9.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 10.0, -10.0, -18.0, 13.0, -25.0, 15.0, -397.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -373.0, -10.0, -378.0, 0.0, 0.0, 0.0, 15.0, -18.0, 0.0, 15.0, -30.0, -2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 14.0, -36.0, -32.0, 12.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0, 0.0, -30.0, 1.0, 15.0, -15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 12.0, 0.0, 11.0, 15.0, -8.0, 6.0, 0.0, 0.0, -381.0, 0.0, 15.0, 0.0, 0.0, -6.0, -6.0, -2.0, -370.0, -20.0, -400.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 5.0, 4.0, 200.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 183.0, 10.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 200.0, 10.0, 10.0, 0.0, 179.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 180.0, 0.0, 10.0, 198.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 10.0, 5.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 189.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 3.0, 1.0, 3.0, 10.0, 185.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8573249170251089, "mean_inference_ms": 2.356904297853413, "mean_action_processing_ms": 0.40292663739483686, "mean_env_wait_ms": 0.3010522318369066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00534367561340332, "StateBufferConnector_ms": 0.0044907331466674805, "ViewRequirementAgentConnector_ms": 0.1198505163192749}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -592.0, "episode_return_mean": -43.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.0676474695595, "num_env_steps_trained_throughput_per_sec": 349.0676474695595, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 132662.745, "restore_workers_time_ms": 0.014, "training_step_time_ms": 132662.675, "sample_time_ms": 2107.189, "learn_time_ms": 130531.742, "learn_throughput": 30.644, "synch_weights_time_ms": 19.942}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "f1691_00000", "date": "2024-08-13_17-41-32", "timestamp": 1723585292, "time_this_iter_s": 11.505091905593872, "time_total_s": 3778.865287065506, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3effc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3778.865287065506, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 57.60625, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.275206581691145, "cur_kl_coeff": 1.2978902054967852e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.33020857534711323, "policy_loss": -0.00021276892502866094, "vf_loss": 0.33042134394078937, "vf_explained_var": 2.61350914284035e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.606840662757691, "cur_kl_coeff": 8.226579664794694e-35, "cur_lr": 0.009999999999999998, "total_loss": 0.45246332346082285, "policy_loss": -0.00012169357625738022, "vf_loss": 0.4525850176027725, "vf_explained_var": 3.008363108155589e-06, "kl": 2.076921325750976e-12, "entropy": 5.726295373208392e-09, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -205.0, "episode_reward_mean": -24.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.53, "predator_policy": 17.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, -172.0, 12.0, 0.0, 0.0, -191.0, -205.0, -5.0, -167.0, 0.0, 0.0, 15.0, 0.0, -5.0, -10.0, -5.0, 5.0, -152.0, -205.0, 3.0, -168.0, 0.0, 6.0, -5.0, -4.0, -8.0, 11.0, -5.0, 15.0, 6.0, 9.0, 9.0, -1.0, 0.0, -8.0, 0.0, 10.0, -9.0, 3.0, -183.0, 0.0, 0.0, 0.0, -182.0, -194.0, 0.0, 15.0, -9.0, 5.0, -1.0, 0.0, 5.0, 14.0, -47.0, 12.0, 1.0, 0.0, 15.0, -9.0, 10.0, 0.0, 8.0, 0.0, 12.0, 26.0, 2.0, 0.0, -188.0, 15.0, -3.0, -4.0, -195.0, -200.0, 0.0, 0.0, -3.0, -10.0, 7.0, -200.0, 0.0, 3.0, 5.0, 9.0, -14.0, 16.0, 0.0, 13.0, 12.0, 0.0, 14.0, 10.0, -5.0, 14.0, -3.0, -11.0, -10.0, 8.0, 2.0, -10.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9.0, -1.0, -358.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, -15.0, -400.0, 0.0, -15.0, -6.0, -343.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -10.0, 5.0, 0.0, -345.0, 13.0, -19.0, -394.0, 0.0, 3.0, 0.0, -351.0, 0.0, 0.0, 4.0, 0.0, 0.0, -15.0, -24.0, 0.0, 0.0, -18.0, -14.0, 15.0, -12.0, -6.0, 15.0, 0.0, 6.0, 0.0, 6.0, 3.0, 9.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 10.0, -10.0, -18.0, 13.0, -25.0, 15.0, -397.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -373.0, -10.0, -378.0, 0.0, 0.0, 0.0, 15.0, -18.0, 0.0, 15.0, -30.0, -2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 14.0, -36.0, -32.0, 12.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0, 0.0, -30.0, 1.0, 15.0, -15.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 12.0, 0.0, 11.0, 15.0, -8.0, 6.0, 0.0, 0.0, -381.0, 0.0, 15.0, 0.0, 0.0, -6.0, -6.0, -2.0, -370.0, -20.0, -400.0, 0.0, 2.0, -4.0, 0.0, 0.0, -14.0, 0.0, -20.0, 0.0, 0.0, 7.0, 0.0, -400.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 9.0, -12.0, -16.0, 8.0, 8.0, 0.0, 0.0, 2.0, 11.0, 8.0, 4.0, 0.0, 0.0, 6.0, 2.0, 0.0, 10.0, -15.0, 0.0, 0.0, 14.0, -20.0, 7.0, -15.0, -13.0, 0.0, -20.0, 8.0, 0.0, -8.0, 0.0, 0.0, -20.0, -10.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 200.0, 10.0, 10.0, 0.0, 179.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 180.0, 0.0, 10.0, 198.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 10.0, 5.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 189.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 3.0, 1.0, 3.0, 10.0, 185.0, 0.0, 200.0, 2.0, 0.0, 0.0, 0.0, 4.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 17.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566958204522435, "mean_inference_ms": 2.3604470441410914, "mean_action_processing_ms": 0.40295992189348484, "mean_env_wait_ms": 0.3008800133352934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414128303527832, "StateBufferConnector_ms": 0.0032297372817993164, "ViewRequirementAgentConnector_ms": 0.11186277866363525}, "num_episodes": 27, "episode_return_max": 26.0, "episode_return_min": -205.0, "episode_return_mean": -24.4, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.97943865122323, "num_env_steps_trained_throughput_per_sec": 344.97943865122323, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 132645.281, "restore_workers_time_ms": 0.014, "training_step_time_ms": 132645.211, "sample_time_ms": 2084.921, "learn_time_ms": 130536.924, "learn_throughput": 30.643, "synch_weights_time_ms": 19.73}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "f1691_00000", "date": "2024-08-13_17-41-44", "timestamp": 1723585304, "time_this_iter_s": 11.634737253189087, "time_total_s": 3790.500024318695, "pid": 83264, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e29e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3790.500024318695, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 55.7375, "ram_util_percent": 83.79374999999999}}
