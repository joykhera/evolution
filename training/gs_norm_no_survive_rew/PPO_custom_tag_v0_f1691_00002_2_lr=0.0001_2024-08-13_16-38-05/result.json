{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16226307985683283, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.314862642338667, "policy_loss": -0.0005999413166175444, "vf_loss": 4.315165093840745, "vf_explained_var": 2.7339105252866393e-05, "kl": 0.0014873987095297872, "entropy": 1.6079310923026353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48210410936957315, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.019652010650231, "policy_loss": -0.002772097174255621, "vf_loss": 6.021734092853688, "vf_explained_var": 0.004748961124470625, "kl": 0.003450033065624634, "entropy": 1.6060003927145055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 163.0, "episode_reward_min": -229.0, "episode_reward_mean": -1.1666666666666667, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -297.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 170.0, "predator_policy": 140.0}, "policy_reward_mean": {"prey_policy": -44.583333333333336, "predator_policy": 44.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, 0.0, -7.0, 96.0, 75.0, 109.0, -130.0, 163.0, -31.0, -108.0, 46.0, -23.0, -229.0, 83.0, 47.0, -126.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, 10.0, 0.0, -93.0, 0.0, 0.0, -5.0, -10.0, 0.0, 92.0, 50.0, -26.0, 0.0, 108.0, -295.0, 0.0, 70.0, 58.0, 20.0, -108.0, -2.0, -229.0, 170.0, -253.0, -229.0, 71.0, -297.0, -203.0, -90.0, 94.0, -248.0, 155.0, -253.0, 0.0, -40.0, -19.0], "policy_predator_policy_reward": [33.0, 57.0, 40.0, 49.0, 0.0, 0.0, 8.0, 0.0, 4.0, 0.0, 32.0, 19.0, 0.0, 1.0, 54.0, 111.0, 35.0, 0.0, 0.0, 57.0, 0.0, 123.0, 0.0, 129.0, 59.0, 76.0, 138.0, 133.0, 0.0, 79.0, 0.0, 140.0, 127.0, 0.0, 41.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0546002729511814, "mean_inference_ms": 5.475790562053111, "mean_action_processing_ms": 0.6923780349025667, "mean_env_wait_ms": 0.8018432516397211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02075301276312934, "StateBufferConnector_ms": 0.010292397605048286, "ViewRequirementAgentConnector_ms": 0.4037903414832221}, "num_episodes": 18, "episode_return_max": 163.0, "episode_return_min": -229.0, "episode_return_mean": -1.1666666666666667, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.1742952328851, "num_env_steps_trained_throughput_per_sec": 194.1742952328851, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 20600.058, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20599.973, "sample_time_ms": 4430.72, "learn_time_ms": 16150.882, "learn_throughput": 247.664, "synch_weights_time_ms": 15.084}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "f1691_00002", "date": "2024-08-13_18-18-11", "timestamp": 1723587491, "time_this_iter_s": 20.667527198791504, "time_total_s": 20.667527198791504, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.667527198791504, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 76.12962962962963, "ram_util_percent": 83.94814814814816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4764673786543349, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.111378657250177, "policy_loss": -0.0013862233562148595, "vf_loss": 4.112426343166009, "vf_explained_var": -0.0004244993288050253, "kl": 0.0033853330975932086, "entropy": 1.6072992035951563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9918046754464586, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.061355688458398, "policy_loss": -0.0013124890756059102, "vf_loss": 6.062431111159148, "vf_explained_var": 0.004217428568179015, "kl": 0.002370622733817269, "entropy": 1.601503792578581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 163.0, "episode_reward_min": -237.0, "episode_reward_mean": -3.861111111111111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -316.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 170.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -40.25, "predator_policy": 38.31944444444444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, 0.0, -7.0, 96.0, 75.0, 109.0, -130.0, 163.0, -31.0, -108.0, 46.0, -23.0, -229.0, 83.0, 47.0, -126.0, 21.0, 5.0, 103.0, 52.0, -37.0, -17.0, 52.0, -36.0, 1.0, -237.0, 13.0, 126.0, -63.0, -74.0, -27.0, 39.0, 109.0, -66.0, -61.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, 10.0, 0.0, -93.0, 0.0, 0.0, -5.0, -10.0, 0.0, 92.0, 50.0, -26.0, 0.0, 108.0, -295.0, 0.0, 70.0, 58.0, 20.0, -108.0, -2.0, -229.0, 170.0, -253.0, -229.0, 71.0, -297.0, -203.0, -90.0, 94.0, -248.0, 155.0, -253.0, 0.0, -40.0, -19.0, 5.0, 0.0, 103.0, 0.0, 43.0, -19.0, -142.0, 21.0, -34.0, 0.0, -207.0, 150.0, -82.0, -21.0, -83.0, 0.0, -185.0, -188.0, 4.0, -48.0, -8.0, 130.0, 7.0, -183.0, -180.0, 0.0, 0.0, -59.0, 0.0, 34.0, 45.0, 63.0, 83.0, -316.0, -226.0, 0.0], "policy_predator_policy_reward": [33.0, 57.0, 40.0, 49.0, 0.0, 0.0, 8.0, 0.0, 4.0, 0.0, 32.0, 19.0, 0.0, 1.0, 54.0, 111.0, 35.0, 0.0, 0.0, 57.0, 0.0, 123.0, 0.0, 129.0, 59.0, 76.0, 138.0, 133.0, 0.0, 79.0, 0.0, 140.0, 127.0, 0.0, 41.0, 39.0, 0.0, 0.0, 0.0, 0.0, 8.0, 20.0, 0.0, 84.0, 17.0, 0.0, 109.0, 0.0, 53.0, 14.0, 56.0, 28.0, 0.0, 136.0, 25.0, 32.0, 4.0, 0.0, 100.0, 13.0, 45.0, 61.0, 11.0, 21.0, 0.0, 5.0, 1.0, 0.0, 9.0, 158.0, 79.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7072733985194901, "mean_inference_ms": 4.525983909583521, "mean_action_processing_ms": 0.5814833735944267, "mean_env_wait_ms": 0.6573149940148212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013665358225504557, "StateBufferConnector_ms": 0.008499622344970703, "ViewRequirementAgentConnector_ms": 0.25207334094577366}, "num_episodes": 18, "episode_return_max": 163.0, "episode_return_min": -237.0, "episode_return_mean": -3.861111111111111, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.3474155951367566, "num_env_steps_trained_throughput_per_sec": 2.3474155951367566, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 862300.912, "restore_workers_time_ms": 0.123, "training_step_time_ms": 862300.644, "sample_time_ms": 2874.238, "learn_time_ms": 859403.538, "learn_throughput": 4.654, "synch_weights_time_ms": 20.323}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "f1691_00002", "date": "2024-08-13_18-46-39", "timestamp": 1723589199, "time_this_iter_s": 1704.141194820404, "time_total_s": 1724.8087220191956, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ea8af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1724.8087220191956, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 75.21428571428571, "ram_util_percent": 83.46785714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5215933666835544, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.158153604325794, "policy_loss": -0.0013837292070978534, "vf_loss": 4.159314109282519, "vf_explained_var": 0.0027990049155300887, "kl": 0.0044645918388902745, "entropy": 1.6025489341645014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.392770625844046, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.429047389005227, "policy_loss": -0.0012760788539828605, "vf_loss": 6.430088979731162, "vf_explained_var": 0.017376691607571153, "kl": 0.004689336656058542, "entropy": 1.5940683353514897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 163.0, "episode_reward_min": -237.0, "episode_reward_mean": -1.3333333333333333, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -316.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 170.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -37.19444444444444, "predator_policy": 36.52777777777778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, 0.0, -7.0, 96.0, 75.0, 109.0, -130.0, 163.0, -31.0, -108.0, 46.0, -23.0, -229.0, 83.0, 47.0, -126.0, 21.0, 5.0, 103.0, 52.0, -37.0, -17.0, 52.0, -36.0, 1.0, -237.0, 13.0, 126.0, -63.0, -74.0, -27.0, 39.0, 109.0, -66.0, -61.0, -12.0, 48.0, 27.0, 17.0, -80.0, -20.0, 65.0, 33.0, -149.0, 35.0, 46.0, 46.0, 45.0, 35.0, 52.0, -70.0, -80.0, 29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, 10.0, 0.0, -93.0, 0.0, 0.0, -5.0, -10.0, 0.0, 92.0, 50.0, -26.0, 0.0, 108.0, -295.0, 0.0, 70.0, 58.0, 20.0, -108.0, -2.0, -229.0, 170.0, -253.0, -229.0, 71.0, -297.0, -203.0, -90.0, 94.0, -248.0, 155.0, -253.0, 0.0, -40.0, -19.0, 5.0, 0.0, 103.0, 0.0, 43.0, -19.0, -142.0, 21.0, -34.0, 0.0, -207.0, 150.0, -82.0, -21.0, -83.0, 0.0, -185.0, -188.0, 4.0, -48.0, -8.0, 130.0, 7.0, -183.0, -180.0, 0.0, 0.0, -59.0, 0.0, 34.0, 45.0, 63.0, 83.0, -316.0, -226.0, 0.0, -22.0, -35.0, 48.0, 0.0, -2.0, -20.0, 18.0, -21.0, 0.0, -160.0, 16.0, -76.0, 0.0, 54.0, 114.0, -208.0, -101.0, -256.0, 52.0, -100.0, -169.0, 112.0, 0.0, 36.0, 51.0, -26.0, 64.0, -72.0, 81.0, -76.0, -240.0, 26.0, 0.0, -218.0, 14.0, -3.0], "policy_predator_policy_reward": [33.0, 57.0, 40.0, 49.0, 0.0, 0.0, 8.0, 0.0, 4.0, 0.0, 32.0, 19.0, 0.0, 1.0, 54.0, 111.0, 35.0, 0.0, 0.0, 57.0, 0.0, 123.0, 0.0, 129.0, 59.0, 76.0, 138.0, 133.0, 0.0, 79.0, 0.0, 140.0, 127.0, 0.0, 41.0, 39.0, 0.0, 0.0, 0.0, 0.0, 8.0, 20.0, 0.0, 84.0, 17.0, 0.0, 109.0, 0.0, 53.0, 14.0, 56.0, 28.0, 0.0, 136.0, 25.0, 32.0, 4.0, 0.0, 100.0, 13.0, 45.0, 61.0, 11.0, 21.0, 0.0, 5.0, 1.0, 0.0, 9.0, 158.0, 79.0, 86.0, 20.0, 25.0, 0.0, 0.0, 19.0, 30.0, 5.0, 15.0, 52.0, 28.0, 0.0, 40.0, 0.0, 11.0, 0.0, 127.0, 133.0, 75.0, 33.0, 50.0, 0.0, 103.0, 0.0, 10.0, 0.0, 20.0, 30.0, 13.0, 3.0, 44.0, 59.0, 85.0, 76.0, 62.0, 8.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6583879186860584, "mean_inference_ms": 4.380586469517453, "mean_action_processing_ms": 0.595352796641784, "mean_env_wait_ms": 0.6460915228734015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019445242705168547, "StateBufferConnector_ms": 0.016755527920193143, "ViewRequirementAgentConnector_ms": 0.2706576276708532}, "num_episodes": 18, "episode_return_max": 163.0, "episode_return_min": -237.0, "episode_return_mean": -1.3333333333333333, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.4959174064084, "num_env_steps_trained_throughput_per_sec": 274.4959174064084, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 579724.666, "restore_workers_time_ms": 0.088, "training_step_time_ms": 579724.471, "sample_time_ms": 3284.128, "learn_time_ms": 576419.217, "learn_throughput": 6.939, "synch_weights_time_ms": 18.7}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "f1691_00002", "date": "2024-08-13_18-46-54", "timestamp": 1723589214, "time_this_iter_s": 14.630600929260254, "time_total_s": 1739.4393229484558, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1739.4393229484558, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 81.8047619047619, "ram_util_percent": 82.87619047619049}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5334637951854834, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 3.915715330870694, "policy_loss": -0.0023137300440341864, "vf_loss": 3.917860483870935, "vf_explained_var": 0.0011138828027816045, "kl": 0.0067434040142190285, "entropy": 1.5872327709954883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9426544213224024, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 5.755340993972052, "policy_loss": -0.0010281628770162426, "vf_loss": 5.756294532553859, "vf_explained_var": 0.018954817075577994, "kl": 0.0029852887293843034, "entropy": 1.6025085840906417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 163.0, "episode_reward_min": -237.0, "episode_reward_mean": 5.625, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -316.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -32.770833333333336, "predator_policy": 35.583333333333336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, 0.0, -7.0, 96.0, 75.0, 109.0, -130.0, 163.0, -31.0, -108.0, 46.0, -23.0, -229.0, 83.0, 47.0, -126.0, 21.0, 5.0, 103.0, 52.0, -37.0, -17.0, 52.0, -36.0, 1.0, -237.0, 13.0, 126.0, -63.0, -74.0, -27.0, 39.0, 109.0, -66.0, -61.0, -12.0, 48.0, 27.0, 17.0, -80.0, -20.0, 65.0, 33.0, -149.0, 35.0, 46.0, 46.0, 45.0, 35.0, 52.0, -70.0, -80.0, 29.0, 0.0, 62.0, 57.0, 7.0, 105.0, 77.0, 61.0, 25.0, -98.0, -76.0, 159.0, 57.0, -147.0, 4.0, 94.0, 62.0, -104.0, 132.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, 10.0, 0.0, -93.0, 0.0, 0.0, -5.0, -10.0, 0.0, 92.0, 50.0, -26.0, 0.0, 108.0, -295.0, 0.0, 70.0, 58.0, 20.0, -108.0, -2.0, -229.0, 170.0, -253.0, -229.0, 71.0, -297.0, -203.0, -90.0, 94.0, -248.0, 155.0, -253.0, 0.0, -40.0, -19.0, 5.0, 0.0, 103.0, 0.0, 43.0, -19.0, -142.0, 21.0, -34.0, 0.0, -207.0, 150.0, -82.0, -21.0, -83.0, 0.0, -185.0, -188.0, 4.0, -48.0, -8.0, 130.0, 7.0, -183.0, -180.0, 0.0, 0.0, -59.0, 0.0, 34.0, 45.0, 63.0, 83.0, -316.0, -226.0, 0.0, -22.0, -35.0, 48.0, 0.0, -2.0, -20.0, 18.0, -21.0, 0.0, -160.0, 16.0, -76.0, 0.0, 54.0, 114.0, -208.0, -101.0, -256.0, 52.0, -100.0, -169.0, 112.0, 0.0, 36.0, 51.0, -26.0, 64.0, -72.0, 81.0, -76.0, -240.0, 26.0, 0.0, -218.0, 14.0, -3.0, 0.0, 0.0, 3.0, 46.0, -10.0, -54.0, 38.0, -117.0, 17.0, 30.0, -14.0, 21.0, -50.0, 78.0, 0.0, 25.0, -195.0, -75.0, -116.0, -42.0, 52.0, 48.0, 37.0, -30.0, -226.0, -81.0, 0.0, 0.0, -169.0, 173.0, -34.0, 51.0, -99.0, -112.0, 3.0, 100.0], "policy_predator_policy_reward": [33.0, 57.0, 40.0, 49.0, 0.0, 0.0, 8.0, 0.0, 4.0, 0.0, 32.0, 19.0, 0.0, 1.0, 54.0, 111.0, 35.0, 0.0, 0.0, 57.0, 0.0, 123.0, 0.0, 129.0, 59.0, 76.0, 138.0, 133.0, 0.0, 79.0, 0.0, 140.0, 127.0, 0.0, 41.0, 39.0, 0.0, 0.0, 0.0, 0.0, 8.0, 20.0, 0.0, 84.0, 17.0, 0.0, 109.0, 0.0, 53.0, 14.0, 56.0, 28.0, 0.0, 136.0, 25.0, 32.0, 4.0, 0.0, 100.0, 13.0, 45.0, 61.0, 11.0, 21.0, 0.0, 5.0, 1.0, 0.0, 9.0, 158.0, 79.0, 86.0, 20.0, 25.0, 0.0, 0.0, 19.0, 30.0, 5.0, 15.0, 52.0, 28.0, 0.0, 40.0, 0.0, 11.0, 0.0, 127.0, 133.0, 75.0, 33.0, 50.0, 0.0, 103.0, 0.0, 10.0, 0.0, 20.0, 30.0, 13.0, 3.0, 44.0, 59.0, 85.0, 76.0, 62.0, 8.0, 10.0, 0.0, 0.0, 0.0, 13.0, 38.0, 83.0, 66.0, 20.0, 14.0, 44.0, 56.0, 14.0, 33.0, 0.0, 0.0, 0.0, 67.0, 105.0, 23.0, 59.0, 0.0, 59.0, 0.0, 50.0, 19.0, 141.0, 0.0, 4.0, 2.0, 88.0, 4.0, 41.0, 60.0, 47.0, 20.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6316652565497505, "mean_inference_ms": 4.316826236548584, "mean_action_processing_ms": 0.597234755361238, "mean_env_wait_ms": 0.6369509929688308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016494592030843098, "StateBufferConnector_ms": 0.014031098948584663, "ViewRequirementAgentConnector_ms": 0.26773446136050755}, "num_episodes": 18, "episode_return_max": 163.0, "episode_return_min": -237.0, "episode_return_mean": 5.625, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.5747845274232, "num_env_steps_trained_throughput_per_sec": 319.5747845274232, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 437922.66, "restore_workers_time_ms": 0.069, "training_step_time_ms": 437922.486, "sample_time_ms": 3319.806, "learn_time_ms": 434582.142, "learn_throughput": 9.204, "synch_weights_time_ms": 17.528}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "f1691_00002", "date": "2024-08-13_18-47-06", "timestamp": 1723589226, "time_this_iter_s": 12.55640697479248, "time_total_s": 1751.9957299232483, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fe0430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1751.9957299232483, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 67.13888888888887, "ram_util_percent": 83.91666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30649446859443313, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.3626097767756729, "policy_loss": -0.004014335210415382, "vf_loss": 1.3663695431260205, "vf_explained_var": 0.0031911599573004185, "kl": 0.01018286638144259, "entropy": 1.575475729647137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.299572977009747, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 3.903635106767927, "policy_loss": -0.0046913733612253235, "vf_loss": 3.9082163045015283, "vf_explained_var": 0.043858782450358076, "kl": 0.008813871903497474, "entropy": 1.6020601601827713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 219.0, "episode_reward_min": -237.0, "episode_reward_mean": 9.737373737373737, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -316.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -26.707070707070706, "predator_policy": 31.575757575757574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, 0.0, -7.0, 96.0, 75.0, 109.0, -130.0, 163.0, -31.0, -108.0, 46.0, -23.0, -229.0, 83.0, 47.0, -126.0, 21.0, 5.0, 103.0, 52.0, -37.0, -17.0, 52.0, -36.0, 1.0, -237.0, 13.0, 126.0, -63.0, -74.0, -27.0, 39.0, 109.0, -66.0, -61.0, -12.0, 48.0, 27.0, 17.0, -80.0, -20.0, 65.0, 33.0, -149.0, 35.0, 46.0, 46.0, 45.0, 35.0, 52.0, -70.0, -80.0, 29.0, 0.0, 62.0, 57.0, 7.0, 105.0, 77.0, 61.0, 25.0, -98.0, -76.0, 159.0, 57.0, -147.0, 4.0, 94.0, 62.0, -104.0, 132.0, 103.0, 15.0, 70.0, -43.0, 128.0, 127.0, -13.0, 3.0, 25.0, -59.0, 89.0, 219.0, 18.0, 6.0, 1.0, -175.0, 19.0, 86.0, -88.0, 82.0, -57.0, -76.0, 30.0, 84.0, 18.0, -50.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, 10.0, 0.0, -93.0, 0.0, 0.0, -5.0, -10.0, 0.0, 92.0, 50.0, -26.0, 0.0, 108.0, -295.0, 0.0, 70.0, 58.0, 20.0, -108.0, -2.0, -229.0, 170.0, -253.0, -229.0, 71.0, -297.0, -203.0, -90.0, 94.0, -248.0, 155.0, -253.0, 0.0, -40.0, -19.0, 5.0, 0.0, 103.0, 0.0, 43.0, -19.0, -142.0, 21.0, -34.0, 0.0, -207.0, 150.0, -82.0, -21.0, -83.0, 0.0, -185.0, -188.0, 4.0, -48.0, -8.0, 130.0, 7.0, -183.0, -180.0, 0.0, 0.0, -59.0, 0.0, 34.0, 45.0, 63.0, 83.0, -316.0, -226.0, 0.0, -22.0, -35.0, 48.0, 0.0, -2.0, -20.0, 18.0, -21.0, 0.0, -160.0, 16.0, -76.0, 0.0, 54.0, 114.0, -208.0, -101.0, -256.0, 52.0, -100.0, -169.0, 112.0, 0.0, 36.0, 51.0, -26.0, 64.0, -72.0, 81.0, -76.0, -240.0, 26.0, 0.0, -218.0, 14.0, -3.0, 0.0, 0.0, 3.0, 46.0, -10.0, -54.0, 38.0, -117.0, 17.0, 30.0, -14.0, 21.0, -50.0, 78.0, 0.0, 25.0, -195.0, -75.0, -116.0, -42.0, 52.0, 48.0, 37.0, -30.0, -226.0, -81.0, 0.0, 0.0, -169.0, 173.0, -34.0, 51.0, -99.0, -112.0, 3.0, 100.0, 103.0, 0.0, 7.0, 7.0, 63.0, 7.0, -137.0, 0.0, 100.0, 0.0, 30.0, 50.0, -34.0, -16.0, 1.0, 2.0, 7.0, 17.0, -120.0, -27.0, 78.0, -10.0, 20.0, 199.0, -22.0, 0.0, 13.0, -14.0, 1.0, 0.0, -73.0, -228.0, 2.0, 0.0, 85.0, 0.0, -105.0, -93.0, 39.0, 42.0, 13.0, -253.0, -303.0, 10.0, 2.0, 28.0, 92.0, -42.0, 3.0, 15.0, 0.0, -120.0, 2.0, -10.0], "policy_predator_policy_reward": [33.0, 57.0, 40.0, 49.0, 0.0, 0.0, 8.0, 0.0, 4.0, 0.0, 32.0, 19.0, 0.0, 1.0, 54.0, 111.0, 35.0, 0.0, 0.0, 57.0, 0.0, 123.0, 0.0, 129.0, 59.0, 76.0, 138.0, 133.0, 0.0, 79.0, 0.0, 140.0, 127.0, 0.0, 41.0, 39.0, 0.0, 0.0, 0.0, 0.0, 8.0, 20.0, 0.0, 84.0, 17.0, 0.0, 109.0, 0.0, 53.0, 14.0, 56.0, 28.0, 0.0, 136.0, 25.0, 32.0, 4.0, 0.0, 100.0, 13.0, 45.0, 61.0, 11.0, 21.0, 0.0, 5.0, 1.0, 0.0, 9.0, 158.0, 79.0, 86.0, 20.0, 25.0, 0.0, 0.0, 19.0, 30.0, 5.0, 15.0, 52.0, 28.0, 0.0, 40.0, 0.0, 11.0, 0.0, 127.0, 133.0, 75.0, 33.0, 50.0, 0.0, 103.0, 0.0, 10.0, 0.0, 20.0, 30.0, 13.0, 3.0, 44.0, 59.0, 85.0, 76.0, 62.0, 8.0, 10.0, 0.0, 0.0, 0.0, 13.0, 38.0, 83.0, 66.0, 20.0, 14.0, 44.0, 56.0, 14.0, 33.0, 0.0, 0.0, 0.0, 67.0, 105.0, 23.0, 59.0, 0.0, 59.0, 0.0, 50.0, 19.0, 141.0, 0.0, 4.0, 2.0, 88.0, 4.0, 41.0, 60.0, 47.0, 20.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 42.0, 52.0, 0.0, 28.0, 20.0, 27.0, 32.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 88.0, 21.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 125.0, 1.0, 17.0, 0.0, 1.0, 0.0, 56.0, 54.0, 1.0, 0.0, 45.0, 138.0, 93.0, 124.0, 0.0, 0.0, 31.0, 3.0, 0.0, 0.0, 70.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5677499081738007, "mean_inference_ms": 4.135145823612714, "mean_action_processing_ms": 0.580412101703615, "mean_env_wait_ms": 0.6095472231097963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014306680120603002, "StateBufferConnector_ms": 0.011129331107091422, "ViewRequirementAgentConnector_ms": 0.2307658243660975}, "num_episodes": 27, "episode_return_max": 219.0, "episode_return_min": -237.0, "episode_return_mean": 9.737373737373737, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.91308185058585, "num_env_steps_trained_throughput_per_sec": 373.91308185058585, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 352477.664, "restore_workers_time_ms": 0.058, "training_step_time_ms": 352477.517, "sample_time_ms": 2948.064, "learn_time_ms": 349508.162, "learn_throughput": 11.445, "synch_weights_time_ms": 18.119}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "f1691_00002", "date": "2024-08-13_18-47-17", "timestamp": 1723589237, "time_this_iter_s": 10.732704639434814, "time_total_s": 1762.728434562683, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fe0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1762.728434562683, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.42, "ram_util_percent": 83.91333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3636694124569653, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 2.636969775686819, "policy_loss": -0.0020839769989449194, "vf_loss": 2.638730389478976, "vf_explained_var": 0.0033317277040431107, "kl": 0.012934737836899508, "entropy": 1.510686051530182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.943513128559583, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 5.8642769631885345, "policy_loss": -0.0036313347926205664, "vf_loss": 5.867849910574615, "vf_explained_var": 0.03673003596603555, "kl": 0.004671316029593375, "entropy": 1.5932735998794516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 263.0, "episode_reward_min": -237.0, "episode_reward_mean": 17.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -316.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -19.07, "predator_policy": 27.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 5.0, 103.0, 52.0, -37.0, -17.0, 52.0, -36.0, 1.0, -237.0, 13.0, 126.0, -63.0, -74.0, -27.0, 39.0, 109.0, -66.0, -61.0, -12.0, 48.0, 27.0, 17.0, -80.0, -20.0, 65.0, 33.0, -149.0, 35.0, 46.0, 46.0, 45.0, 35.0, 52.0, -70.0, -80.0, 29.0, 0.0, 62.0, 57.0, 7.0, 105.0, 77.0, 61.0, 25.0, -98.0, -76.0, 159.0, 57.0, -147.0, 4.0, 94.0, 62.0, -104.0, 132.0, 103.0, 15.0, 70.0, -43.0, 128.0, 127.0, -13.0, 3.0, 25.0, -59.0, 89.0, 219.0, 18.0, 6.0, 1.0, -175.0, 19.0, 86.0, -88.0, 82.0, -57.0, -76.0, 30.0, 84.0, 18.0, -50.0, -3.0, -25.0, -17.0, -2.0, 140.0, -5.0, 91.0, 23.0, 76.0, 1.0, 99.0, 88.0, 177.0, -60.0, 263.0, -83.0, 77.0, -69.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, -19.0, 5.0, 0.0, 103.0, 0.0, 43.0, -19.0, -142.0, 21.0, -34.0, 0.0, -207.0, 150.0, -82.0, -21.0, -83.0, 0.0, -185.0, -188.0, 4.0, -48.0, -8.0, 130.0, 7.0, -183.0, -180.0, 0.0, 0.0, -59.0, 0.0, 34.0, 45.0, 63.0, 83.0, -316.0, -226.0, 0.0, -22.0, -35.0, 48.0, 0.0, -2.0, -20.0, 18.0, -21.0, 0.0, -160.0, 16.0, -76.0, 0.0, 54.0, 114.0, -208.0, -101.0, -256.0, 52.0, -100.0, -169.0, 112.0, 0.0, 36.0, 51.0, -26.0, 64.0, -72.0, 81.0, -76.0, -240.0, 26.0, 0.0, -218.0, 14.0, -3.0, 0.0, 0.0, 3.0, 46.0, -10.0, -54.0, 38.0, -117.0, 17.0, 30.0, -14.0, 21.0, -50.0, 78.0, 0.0, 25.0, -195.0, -75.0, -116.0, -42.0, 52.0, 48.0, 37.0, -30.0, -226.0, -81.0, 0.0, 0.0, -169.0, 173.0, -34.0, 51.0, -99.0, -112.0, 3.0, 100.0, 103.0, 0.0, 7.0, 7.0, 63.0, 7.0, -137.0, 0.0, 100.0, 0.0, 30.0, 50.0, -34.0, -16.0, 1.0, 2.0, 7.0, 17.0, -120.0, -27.0, 78.0, -10.0, 20.0, 199.0, -22.0, 0.0, 13.0, -14.0, 1.0, 0.0, -73.0, -228.0, 2.0, 0.0, 85.0, 0.0, -105.0, -93.0, 39.0, 42.0, 13.0, -253.0, -303.0, 10.0, 2.0, 28.0, 92.0, -42.0, 3.0, 15.0, 0.0, -120.0, 2.0, -10.0, -4.0, -62.0, 31.0, -113.0, 2.0, -25.0, 55.0, 72.0, -97.0, -26.0, 15.0, 76.0, 0.0, 15.0, 117.0, -95.0, 0.0, -15.0, 0.0, 98.0, 88.0, 0.0, 49.0, 118.0, -65.0, -104.0, 131.0, 82.0, -30.0, -124.0, 56.0, -50.0, -268.0, 35.0, 0.0, -34.0], "policy_predator_policy_reward": [41.0, 39.0, 0.0, 0.0, 0.0, 0.0, 8.0, 20.0, 0.0, 84.0, 17.0, 0.0, 109.0, 0.0, 53.0, 14.0, 56.0, 28.0, 0.0, 136.0, 25.0, 32.0, 4.0, 0.0, 100.0, 13.0, 45.0, 61.0, 11.0, 21.0, 0.0, 5.0, 1.0, 0.0, 9.0, 158.0, 79.0, 86.0, 20.0, 25.0, 0.0, 0.0, 19.0, 30.0, 5.0, 15.0, 52.0, 28.0, 0.0, 40.0, 0.0, 11.0, 0.0, 127.0, 133.0, 75.0, 33.0, 50.0, 0.0, 103.0, 0.0, 10.0, 0.0, 20.0, 30.0, 13.0, 3.0, 44.0, 59.0, 85.0, 76.0, 62.0, 8.0, 10.0, 0.0, 0.0, 0.0, 13.0, 38.0, 83.0, 66.0, 20.0, 14.0, 44.0, 56.0, 14.0, 33.0, 0.0, 0.0, 0.0, 67.0, 105.0, 23.0, 59.0, 0.0, 59.0, 0.0, 50.0, 19.0, 141.0, 0.0, 4.0, 2.0, 88.0, 4.0, 41.0, 60.0, 47.0, 20.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 42.0, 52.0, 0.0, 28.0, 20.0, 27.0, 32.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 88.0, 21.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 125.0, 1.0, 17.0, 0.0, 1.0, 0.0, 56.0, 54.0, 1.0, 0.0, 45.0, 138.0, 93.0, 124.0, 0.0, 0.0, 31.0, 3.0, 0.0, 0.0, 70.0, 0.0, 5.0, 0.0, 2.0, 39.0, 0.0, 65.0, 1.0, 20.0, 1.0, 12.0, 70.0, 48.0, 0.0, 0.0, 8.0, 0.0, 6.0, 48.0, 1.0, 15.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 57.0, 52.0, 0.0, 50.0, 1.0, 70.0, 67.0, 4.0, 126.0, 38.0, 3.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.428995646537048, "mean_inference_ms": 3.7545435078984806, "mean_action_processing_ms": 0.5437347059110151, "mean_env_wait_ms": 0.5529775704695383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01238095760345459, "StateBufferConnector_ms": 0.009761452674865723, "ViewRequirementAgentConnector_ms": 0.18499445915222168}, "num_episodes": 18, "episode_return_max": 263.0, "episode_return_min": -237.0, "episode_return_mean": 17.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.211244621656798, "num_env_steps_trained_throughput_per_sec": 5.211244621656798, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 421659.88, "restore_workers_time_ms": 0.05, "training_step_time_ms": 421659.751, "sample_time_ms": 2670.163, "learn_time_ms": 418968.931, "learn_throughput": 9.547, "synch_weights_time_ms": 17.548}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "f1691_00002", "date": "2024-08-13_19-00-05", "timestamp": 1723590005, "time_this_iter_s": 767.6585569381714, "time_total_s": 2530.3869915008545, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2530.3869915008545, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 84.07619047619049, "ram_util_percent": 80.71904761904763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38077691952899967, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 2.9628553471868, "policy_loss": -0.001854192760708944, "vf_loss": 2.964468931016468, "vf_explained_var": 0.0008773242985760724, "kl": 0.009624145700513922, "entropy": 1.477059768432032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1806824460152594, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 5.74044201613734, "policy_loss": -0.0037809090900712858, "vf_loss": 5.744183280354455, "vf_explained_var": 0.037368467623594574, "kl": 0.006342311685812934, "entropy": 1.5907785445294051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 263.0, "episode_reward_min": -175.0, "episode_reward_mean": 25.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 226.0}, "policy_reward_mean": {"prey_policy": -16.885, "predator_policy": 29.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.0, -12.0, 48.0, 27.0, 17.0, -80.0, -20.0, 65.0, 33.0, -149.0, 35.0, 46.0, 46.0, 45.0, 35.0, 52.0, -70.0, -80.0, 29.0, 0.0, 62.0, 57.0, 7.0, 105.0, 77.0, 61.0, 25.0, -98.0, -76.0, 159.0, 57.0, -147.0, 4.0, 94.0, 62.0, -104.0, 132.0, 103.0, 15.0, 70.0, -43.0, 128.0, 127.0, -13.0, 3.0, 25.0, -59.0, 89.0, 219.0, 18.0, 6.0, 1.0, -175.0, 19.0, 86.0, -88.0, 82.0, -57.0, -76.0, 30.0, 84.0, 18.0, -50.0, -3.0, -25.0, -17.0, -2.0, 140.0, -5.0, 91.0, 23.0, 76.0, 1.0, 99.0, 88.0, 177.0, -60.0, 263.0, -83.0, 77.0, -69.0, -14.0, 25.0, 71.0, 119.0, 146.0, -96.0, 30.0, 71.0, -40.0, 11.0, 3.0, 166.0, 26.0, 132.0, 69.0, 9.0, -112.0, 77.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-226.0, 0.0, -22.0, -35.0, 48.0, 0.0, -2.0, -20.0, 18.0, -21.0, 0.0, -160.0, 16.0, -76.0, 0.0, 54.0, 114.0, -208.0, -101.0, -256.0, 52.0, -100.0, -169.0, 112.0, 0.0, 36.0, 51.0, -26.0, 64.0, -72.0, 81.0, -76.0, -240.0, 26.0, 0.0, -218.0, 14.0, -3.0, 0.0, 0.0, 3.0, 46.0, -10.0, -54.0, 38.0, -117.0, 17.0, 30.0, -14.0, 21.0, -50.0, 78.0, 0.0, 25.0, -195.0, -75.0, -116.0, -42.0, 52.0, 48.0, 37.0, -30.0, -226.0, -81.0, 0.0, 0.0, -169.0, 173.0, -34.0, 51.0, -99.0, -112.0, 3.0, 100.0, 103.0, 0.0, 7.0, 7.0, 63.0, 7.0, -137.0, 0.0, 100.0, 0.0, 30.0, 50.0, -34.0, -16.0, 1.0, 2.0, 7.0, 17.0, -120.0, -27.0, 78.0, -10.0, 20.0, 199.0, -22.0, 0.0, 13.0, -14.0, 1.0, 0.0, -73.0, -228.0, 2.0, 0.0, 85.0, 0.0, -105.0, -93.0, 39.0, 42.0, 13.0, -253.0, -303.0, 10.0, 2.0, 28.0, 92.0, -42.0, 3.0, 15.0, 0.0, -120.0, 2.0, -10.0, -4.0, -62.0, 31.0, -113.0, 2.0, -25.0, 55.0, 72.0, -97.0, -26.0, 15.0, 76.0, 0.0, 15.0, 117.0, -95.0, 0.0, -15.0, 0.0, 98.0, 88.0, 0.0, 49.0, 118.0, -65.0, -104.0, 131.0, 82.0, -30.0, -124.0, 56.0, -50.0, -268.0, 35.0, 0.0, -34.0, 67.0, -105.0, 2.0, 69.0, -6.0, 75.0, 48.0, 85.0, -138.0, -54.0, 65.0, -248.0, 87.0, -32.0, -59.0, -27.0, -31.0, 0.0, 40.0, -86.0, 0.0, 166.0, 22.0, -14.0, 104.0, -386.0, 83.0, -41.0, -69.0, -10.0, -350.0, 9.0, 68.0, 0.0, -31.0, 8.0], "policy_predator_policy_reward": [79.0, 86.0, 20.0, 25.0, 0.0, 0.0, 19.0, 30.0, 5.0, 15.0, 52.0, 28.0, 0.0, 40.0, 0.0, 11.0, 0.0, 127.0, 133.0, 75.0, 33.0, 50.0, 0.0, 103.0, 0.0, 10.0, 0.0, 20.0, 30.0, 13.0, 3.0, 44.0, 59.0, 85.0, 76.0, 62.0, 8.0, 10.0, 0.0, 0.0, 0.0, 13.0, 38.0, 83.0, 66.0, 20.0, 14.0, 44.0, 56.0, 14.0, 33.0, 0.0, 0.0, 0.0, 67.0, 105.0, 23.0, 59.0, 0.0, 59.0, 0.0, 50.0, 19.0, 141.0, 0.0, 4.0, 2.0, 88.0, 4.0, 41.0, 60.0, 47.0, 20.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 42.0, 52.0, 0.0, 28.0, 20.0, 27.0, 32.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 88.0, 21.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 125.0, 1.0, 17.0, 0.0, 1.0, 0.0, 56.0, 54.0, 1.0, 0.0, 45.0, 138.0, 93.0, 124.0, 0.0, 0.0, 31.0, 3.0, 0.0, 0.0, 70.0, 0.0, 5.0, 0.0, 2.0, 39.0, 0.0, 65.0, 1.0, 20.0, 1.0, 12.0, 70.0, 48.0, 0.0, 0.0, 8.0, 0.0, 6.0, 48.0, 1.0, 15.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 57.0, 52.0, 0.0, 50.0, 1.0, 70.0, 67.0, 4.0, 126.0, 38.0, 3.0, 17.0, 1.0, 62.0, 0.0, 0.0, 34.0, 16.0, 13.0, 0.0, 69.0, 27.0, 111.0, 102.0, 16.0, 0.0, 0.0, 46.0, 5.0, 37.0, 0.0, 49.0, 0.0, 0.0, 3.0, 15.0, 219.0, 195.0, 0.0, 27.0, 49.0, 39.0, 226.0, 3.0, 4.0, 5.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4021802447499845, "mean_inference_ms": 3.6712669574629166, "mean_action_processing_ms": 0.5428085672837899, "mean_env_wait_ms": 0.5415889705359573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014567852020263672, "StateBufferConnector_ms": 0.010738611221313477, "ViewRequirementAgentConnector_ms": 0.19770431518554688}, "num_episodes": 18, "episode_return_max": 263.0, "episode_return_min": -175.0, "episode_return_mean": 25.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.47908689974054, "num_env_steps_trained_throughput_per_sec": 317.47908689974054, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 363222.649, "restore_workers_time_ms": 0.045, "training_step_time_ms": 363222.529, "sample_time_ms": 2594.028, "learn_time_ms": 360608.679, "learn_throughput": 11.092, "synch_weights_time_ms": 16.793}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "f1691_00002", "date": "2024-08-13_19-00-17", "timestamp": 1723590017, "time_this_iter_s": 12.653809785842896, "time_total_s": 2543.0408012866974, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fbea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2543.0408012866974, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 63.71666666666667, "ram_util_percent": 83.32222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3772471222238093, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.9040712828674013, "policy_loss": -0.004435326998669004, "vf_loss": 1.908074817424098, "vf_explained_var": 0.0005992377561236184, "kl": 0.017272001637766186, "entropy": 1.4583790606922573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1971753882273797, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 5.272108424655975, "policy_loss": -0.0030582873320709617, "vf_loss": 5.275125004879381, "vf_explained_var": 0.05960076892817462, "kl": 0.006672301505287575, "entropy": 1.5922773129094845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 263.0, "episode_reward_min": -175.0, "episode_reward_mean": 32.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 226.0}, "policy_reward_mean": {"prey_policy": -8.835, "predator_policy": 25.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 0.0, 62.0, 57.0, 7.0, 105.0, 77.0, 61.0, 25.0, -98.0, -76.0, 159.0, 57.0, -147.0, 4.0, 94.0, 62.0, -104.0, 132.0, 103.0, 15.0, 70.0, -43.0, 128.0, 127.0, -13.0, 3.0, 25.0, -59.0, 89.0, 219.0, 18.0, 6.0, 1.0, -175.0, 19.0, 86.0, -88.0, 82.0, -57.0, -76.0, 30.0, 84.0, 18.0, -50.0, -3.0, -25.0, -17.0, -2.0, 140.0, -5.0, 91.0, 23.0, 76.0, 1.0, 99.0, 88.0, 177.0, -60.0, 263.0, -83.0, 77.0, -69.0, -14.0, 25.0, 71.0, 119.0, 146.0, -96.0, 30.0, 71.0, -40.0, 11.0, 3.0, 166.0, 26.0, 132.0, 69.0, 9.0, -112.0, 77.0, -3.0, 114.0, 78.0, 25.0, 104.0, -57.0, 98.0, -46.0, 5.0, -25.0, 24.0, 173.0, 97.0, 0.0, -33.0, 45.0, 43.0, 39.0, 48.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.0, -3.0, 0.0, 0.0, 3.0, 46.0, -10.0, -54.0, 38.0, -117.0, 17.0, 30.0, -14.0, 21.0, -50.0, 78.0, 0.0, 25.0, -195.0, -75.0, -116.0, -42.0, 52.0, 48.0, 37.0, -30.0, -226.0, -81.0, 0.0, 0.0, -169.0, 173.0, -34.0, 51.0, -99.0, -112.0, 3.0, 100.0, 103.0, 0.0, 7.0, 7.0, 63.0, 7.0, -137.0, 0.0, 100.0, 0.0, 30.0, 50.0, -34.0, -16.0, 1.0, 2.0, 7.0, 17.0, -120.0, -27.0, 78.0, -10.0, 20.0, 199.0, -22.0, 0.0, 13.0, -14.0, 1.0, 0.0, -73.0, -228.0, 2.0, 0.0, 85.0, 0.0, -105.0, -93.0, 39.0, 42.0, 13.0, -253.0, -303.0, 10.0, 2.0, 28.0, 92.0, -42.0, 3.0, 15.0, 0.0, -120.0, 2.0, -10.0, -4.0, -62.0, 31.0, -113.0, 2.0, -25.0, 55.0, 72.0, -97.0, -26.0, 15.0, 76.0, 0.0, 15.0, 117.0, -95.0, 0.0, -15.0, 0.0, 98.0, 88.0, 0.0, 49.0, 118.0, -65.0, -104.0, 131.0, 82.0, -30.0, -124.0, 56.0, -50.0, -268.0, 35.0, 0.0, -34.0, 67.0, -105.0, 2.0, 69.0, -6.0, 75.0, 48.0, 85.0, -138.0, -54.0, 65.0, -248.0, 87.0, -32.0, -59.0, -27.0, -31.0, 0.0, 40.0, -86.0, 0.0, 166.0, 22.0, -14.0, 104.0, -386.0, 83.0, -41.0, -69.0, -10.0, -350.0, 9.0, 68.0, 0.0, -31.0, 8.0, 0.0, 85.0, 65.0, 1.0, 25.0, -16.0, 72.0, 23.0, -42.0, -114.0, 124.0, -77.0, -74.0, -37.0, 2.0, 0.0, -17.0, -35.0, -19.0, 12.0, 186.0, -30.0, 97.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, 42.0, 0.0, 43.0, 8.0, 16.0, 45.0, -16.0], "policy_predator_policy_reward": [8.0, 10.0, 0.0, 0.0, 0.0, 13.0, 38.0, 83.0, 66.0, 20.0, 14.0, 44.0, 56.0, 14.0, 33.0, 0.0, 0.0, 0.0, 67.0, 105.0, 23.0, 59.0, 0.0, 59.0, 0.0, 50.0, 19.0, 141.0, 0.0, 4.0, 2.0, 88.0, 4.0, 41.0, 60.0, 47.0, 20.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 42.0, 52.0, 0.0, 28.0, 20.0, 27.0, 32.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 88.0, 21.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 125.0, 1.0, 17.0, 0.0, 1.0, 0.0, 56.0, 54.0, 1.0, 0.0, 45.0, 138.0, 93.0, 124.0, 0.0, 0.0, 31.0, 3.0, 0.0, 0.0, 70.0, 0.0, 5.0, 0.0, 2.0, 39.0, 0.0, 65.0, 1.0, 20.0, 1.0, 12.0, 70.0, 48.0, 0.0, 0.0, 8.0, 0.0, 6.0, 48.0, 1.0, 15.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 57.0, 52.0, 0.0, 50.0, 1.0, 70.0, 67.0, 4.0, 126.0, 38.0, 3.0, 17.0, 1.0, 62.0, 0.0, 0.0, 34.0, 16.0, 13.0, 0.0, 69.0, 27.0, 111.0, 102.0, 16.0, 0.0, 0.0, 46.0, 5.0, 37.0, 0.0, 49.0, 0.0, 0.0, 3.0, 15.0, 219.0, 195.0, 0.0, 27.0, 49.0, 39.0, 226.0, 3.0, 4.0, 5.0, 0.0, 20.0, 29.0, 0.0, 0.0, 12.0, 7.0, 9.0, 7.0, 2.0, 69.0, 30.0, 27.0, 24.0, 45.0, 20.0, 0.0, 3.0, 18.0, 9.0, 0.0, 31.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 24.0, 6.0, 27.0, 0.0, 0.0, 5.0, 10.0, 9.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3356785545984229, "mean_inference_ms": 3.500503370455143, "mean_action_processing_ms": 0.5154697908701279, "mean_env_wait_ms": 0.50959581008768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009769320487976074, "StateBufferConnector_ms": 0.005349516868591309, "ViewRequirementAgentConnector_ms": 0.16539275646209717}, "num_episodes": 18, "episode_return_max": 263.0, "episode_return_min": -175.0, "episode_return_mean": 32.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.1174071696505, "num_env_steps_trained_throughput_per_sec": 326.1174071696505, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 319353.009, "restore_workers_time_ms": 0.051, "training_step_time_ms": 319352.888, "sample_time_ms": 2499.48, "learn_time_ms": 316833.833, "learn_throughput": 12.625, "synch_weights_time_ms": 16.566}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "f1691_00002", "date": "2024-08-13_19-00-30", "timestamp": 1723590030, "time_this_iter_s": 12.311033248901367, "time_total_s": 2555.3518345355988, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fd7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2555.3518345355988, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 56.36666666666666, "ram_util_percent": 83.86111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2802773352672972, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.0763425155449167, "policy_loss": -0.002442011108286876, "vf_loss": 1.0785006468100522, "vf_explained_var": 0.003353848438414316, "kl": 0.011355241112817506, "entropy": 1.5169284211895453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.622873542761361, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 4.298655453434697, "policy_loss": -0.0017616720865209583, "vf_loss": 4.3003727962100315, "vf_explained_var": 0.09664625541242973, "kl": 0.007092936596288428, "entropy": 1.5652678141518244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 263.0, "episode_reward_min": -175.0, "episode_reward_mean": 42.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 226.0}, "policy_reward_mean": {"prey_policy": -1.525, "predator_policy": 22.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.0, 128.0, 127.0, -13.0, 3.0, 25.0, -59.0, 89.0, 219.0, 18.0, 6.0, 1.0, -175.0, 19.0, 86.0, -88.0, 82.0, -57.0, -76.0, 30.0, 84.0, 18.0, -50.0, -3.0, -25.0, -17.0, -2.0, 140.0, -5.0, 91.0, 23.0, 76.0, 1.0, 99.0, 88.0, 177.0, -60.0, 263.0, -83.0, 77.0, -69.0, -14.0, 25.0, 71.0, 119.0, 146.0, -96.0, 30.0, 71.0, -40.0, 11.0, 3.0, 166.0, 26.0, 132.0, 69.0, 9.0, -112.0, 77.0, -3.0, 114.0, 78.0, 25.0, 104.0, -57.0, 98.0, -46.0, 5.0, -25.0, 24.0, 173.0, 97.0, 0.0, -33.0, 45.0, 43.0, 39.0, 48.0, -7.0, 40.0, 138.0, 123.0, 3.0, -41.0, 149.0, 160.0, 97.0, 63.0, 114.0, 8.0, 148.0, 11.0, 113.0, 123.0, -14.0, 131.0, 29.0, -6.0, 50.0, 222.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-137.0, 0.0, 100.0, 0.0, 30.0, 50.0, -34.0, -16.0, 1.0, 2.0, 7.0, 17.0, -120.0, -27.0, 78.0, -10.0, 20.0, 199.0, -22.0, 0.0, 13.0, -14.0, 1.0, 0.0, -73.0, -228.0, 2.0, 0.0, 85.0, 0.0, -105.0, -93.0, 39.0, 42.0, 13.0, -253.0, -303.0, 10.0, 2.0, 28.0, 92.0, -42.0, 3.0, 15.0, 0.0, -120.0, 2.0, -10.0, -4.0, -62.0, 31.0, -113.0, 2.0, -25.0, 55.0, 72.0, -97.0, -26.0, 15.0, 76.0, 0.0, 15.0, 117.0, -95.0, 0.0, -15.0, 0.0, 98.0, 88.0, 0.0, 49.0, 118.0, -65.0, -104.0, 131.0, 82.0, -30.0, -124.0, 56.0, -50.0, -268.0, 35.0, 0.0, -34.0, 67.0, -105.0, 2.0, 69.0, -6.0, 75.0, 48.0, 85.0, -138.0, -54.0, 65.0, -248.0, 87.0, -32.0, -59.0, -27.0, -31.0, 0.0, 40.0, -86.0, 0.0, 166.0, 22.0, -14.0, 104.0, -386.0, 83.0, -41.0, -69.0, -10.0, -350.0, 9.0, 68.0, 0.0, -31.0, 8.0, 0.0, 85.0, 65.0, 1.0, 25.0, -16.0, 72.0, 23.0, -42.0, -114.0, 124.0, -77.0, -74.0, -37.0, 2.0, 0.0, -17.0, -35.0, -19.0, 12.0, 186.0, -30.0, 97.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, 42.0, 0.0, 43.0, 8.0, 16.0, 45.0, -16.0, -2.0, -10.0, -8.0, 44.0, 63.0, 69.0, 72.0, 46.0, 0.0, 3.0, -45.0, -46.0, 115.0, 34.0, 170.0, -33.0, 114.0, -39.0, -45.0, 45.0, 91.0, -14.0, -10.0, 2.0, 133.0, 9.0, 11.0, 0.0, 68.0, 38.0, 2.0, 69.0, 0.0, -28.0, 129.0, 0.0, -226.0, -7.0, 0.0, -53.0, 56.0, -38.0, 171.0, 8.0], "policy_predator_policy_reward": [42.0, 52.0, 0.0, 28.0, 20.0, 27.0, 32.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 88.0, 21.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 125.0, 1.0, 17.0, 0.0, 1.0, 0.0, 56.0, 54.0, 1.0, 0.0, 45.0, 138.0, 93.0, 124.0, 0.0, 0.0, 31.0, 3.0, 0.0, 0.0, 70.0, 0.0, 5.0, 0.0, 2.0, 39.0, 0.0, 65.0, 1.0, 20.0, 1.0, 12.0, 70.0, 48.0, 0.0, 0.0, 8.0, 0.0, 6.0, 48.0, 1.0, 15.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 57.0, 52.0, 0.0, 50.0, 1.0, 70.0, 67.0, 4.0, 126.0, 38.0, 3.0, 17.0, 1.0, 62.0, 0.0, 0.0, 34.0, 16.0, 13.0, 0.0, 69.0, 27.0, 111.0, 102.0, 16.0, 0.0, 0.0, 46.0, 5.0, 37.0, 0.0, 49.0, 0.0, 0.0, 3.0, 15.0, 219.0, 195.0, 0.0, 27.0, 49.0, 39.0, 226.0, 3.0, 4.0, 5.0, 0.0, 20.0, 29.0, 0.0, 0.0, 12.0, 7.0, 9.0, 7.0, 2.0, 69.0, 30.0, 27.0, 24.0, 45.0, 20.0, 0.0, 3.0, 18.0, 9.0, 0.0, 31.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 24.0, 6.0, 27.0, 0.0, 0.0, 5.0, 10.0, 9.0, 10.0, 5.0, 0.0, 4.0, 0.0, 4.0, 2.0, 5.0, 0.0, 0.0, 0.0, 27.0, 23.0, 0.0, 0.0, 17.0, 6.0, 20.0, 2.0, 36.0, 27.0, 10.0, 27.0, 11.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 7.0, 41.0, 11.0, 0.0, 14.0, 2.0, 0.0, 136.0, 126.0, 47.0, 0.0, 21.0, 11.0, 24.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.242342523927304, "mean_inference_ms": 3.2707868954257755, "mean_action_processing_ms": 0.4791602589044372, "mean_env_wait_ms": 0.4702706396206125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009067654609680176, "StateBufferConnector_ms": 0.005467057228088379, "ViewRequirementAgentConnector_ms": 0.13897836208343506}, "num_episodes": 22, "episode_return_max": 263.0, "episode_return_min": -175.0, "episode_return_mean": 42.21, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.0290135917043, "num_env_steps_trained_throughput_per_sec": 81.0290135917043, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 289354.346, "restore_workers_time_ms": 0.047, "training_step_time_ms": 289354.234, "sample_time_ms": 2393.719, "learn_time_ms": 286940.82, "learn_throughput": 13.94, "synch_weights_time_ms": 16.701}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "f1691_00002", "date": "2024-08-13_19-01-19", "timestamp": 1723590079, "time_this_iter_s": 49.41387701034546, "time_total_s": 2604.765711545944, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b371d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2604.765711545944, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.568749999999994, "ram_util_percent": 83.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38510295762113794, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.1317448306651343, "policy_loss": -0.00017343128602656107, "vf_loss": 1.131557943644347, "vf_explained_var": 0.02692721482937929, "kl": 0.014412818077703785, "entropy": 1.5570458783043755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.155078027070199, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 3.3262083944189484, "policy_loss": -0.004546734914627103, "vf_loss": 3.3307073275878945, "vf_explained_var": 0.10023513102026843, "kl": 0.007647630159067736, "entropy": 1.5351430694892925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -112.0, "episode_reward_mean": 53.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 226.0}, "policy_reward_mean": {"prey_policy": 7.69, "predator_policy": 18.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -25.0, -17.0, -2.0, 140.0, -5.0, 91.0, 23.0, 76.0, 1.0, 99.0, 88.0, 177.0, -60.0, 263.0, -83.0, 77.0, -69.0, -14.0, 25.0, 71.0, 119.0, 146.0, -96.0, 30.0, 71.0, -40.0, 11.0, 3.0, 166.0, 26.0, 132.0, 69.0, 9.0, -112.0, 77.0, -3.0, 114.0, 78.0, 25.0, 104.0, -57.0, 98.0, -46.0, 5.0, -25.0, 24.0, 173.0, 97.0, 0.0, -33.0, 45.0, 43.0, 39.0, 48.0, -7.0, 40.0, 138.0, 123.0, 3.0, -41.0, 149.0, 160.0, 97.0, 63.0, 114.0, 8.0, 148.0, 11.0, 113.0, 123.0, -14.0, 131.0, 29.0, -6.0, 50.0, 222.0, 64.0, 0.0, 35.0, 52.0, 204.0, 183.0, 6.0, 155.0, 175.0, 25.0, 0.0, 251.0, 101.0, 0.0, 0.0, 7.0, -13.0, 0.0, 24.0, -19.0, -43.0, -31.0, 311.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, -10.0, -4.0, -62.0, 31.0, -113.0, 2.0, -25.0, 55.0, 72.0, -97.0, -26.0, 15.0, 76.0, 0.0, 15.0, 117.0, -95.0, 0.0, -15.0, 0.0, 98.0, 88.0, 0.0, 49.0, 118.0, -65.0, -104.0, 131.0, 82.0, -30.0, -124.0, 56.0, -50.0, -268.0, 35.0, 0.0, -34.0, 67.0, -105.0, 2.0, 69.0, -6.0, 75.0, 48.0, 85.0, -138.0, -54.0, 65.0, -248.0, 87.0, -32.0, -59.0, -27.0, -31.0, 0.0, 40.0, -86.0, 0.0, 166.0, 22.0, -14.0, 104.0, -386.0, 83.0, -41.0, -69.0, -10.0, -350.0, 9.0, 68.0, 0.0, -31.0, 8.0, 0.0, 85.0, 65.0, 1.0, 25.0, -16.0, 72.0, 23.0, -42.0, -114.0, 124.0, -77.0, -74.0, -37.0, 2.0, 0.0, -17.0, -35.0, -19.0, 12.0, 186.0, -30.0, 97.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, 42.0, 0.0, 43.0, 8.0, 16.0, 45.0, -16.0, -2.0, -10.0, -8.0, 44.0, 63.0, 69.0, 72.0, 46.0, 0.0, 3.0, -45.0, -46.0, 115.0, 34.0, 170.0, -33.0, 114.0, -39.0, -45.0, 45.0, 91.0, -14.0, -10.0, 2.0, 133.0, 9.0, 11.0, 0.0, 68.0, 38.0, 2.0, 69.0, 0.0, -28.0, 129.0, 0.0, -226.0, -7.0, 0.0, -53.0, 56.0, -38.0, 171.0, 8.0, 20.0, -22.0, 0.0, 0.0, 0.0, 22.0, 52.0, 0.0, 118.0, 46.0, 0.0, 183.0, 5.0, 0.0, 149.0, 0.0, 88.0, 70.0, 2.0, 0.0, 11.0, -22.0, 51.0, 200.0, -6.0, 104.0, 0.0, 0.0, 0.0, 0.0, -66.0, 2.0, -26.0, 0.0, 0.0, 0.0, 0.0, 24.0, -11.0, -38.0, -90.0, -19.0, 0.0, -62.0, 182.0, 128.0], "policy_predator_policy_reward": [5.0, 0.0, 2.0, 39.0, 0.0, 65.0, 1.0, 20.0, 1.0, 12.0, 70.0, 48.0, 0.0, 0.0, 8.0, 0.0, 6.0, 48.0, 1.0, 15.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 57.0, 52.0, 0.0, 50.0, 1.0, 70.0, 67.0, 4.0, 126.0, 38.0, 3.0, 17.0, 1.0, 62.0, 0.0, 0.0, 34.0, 16.0, 13.0, 0.0, 69.0, 27.0, 111.0, 102.0, 16.0, 0.0, 0.0, 46.0, 5.0, 37.0, 0.0, 49.0, 0.0, 0.0, 3.0, 15.0, 219.0, 195.0, 0.0, 27.0, 49.0, 39.0, 226.0, 3.0, 4.0, 5.0, 0.0, 20.0, 29.0, 0.0, 0.0, 12.0, 7.0, 9.0, 7.0, 2.0, 69.0, 30.0, 27.0, 24.0, 45.0, 20.0, 0.0, 3.0, 18.0, 9.0, 0.0, 31.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 24.0, 6.0, 27.0, 0.0, 0.0, 5.0, 10.0, 9.0, 10.0, 5.0, 0.0, 4.0, 0.0, 4.0, 2.0, 5.0, 0.0, 0.0, 0.0, 27.0, 23.0, 0.0, 0.0, 17.0, 6.0, 20.0, 2.0, 36.0, 27.0, 10.0, 27.0, 11.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 7.0, 41.0, 11.0, 0.0, 14.0, 2.0, 0.0, 136.0, 126.0, 47.0, 0.0, 21.0, 11.0, 24.0, 19.0, 18.0, 48.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 17.0, 0.0, 20.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 41.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 9.0, 48.0, 18.0, 31.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1756188585060445, "mean_inference_ms": 3.1134483383402927, "mean_action_processing_ms": 0.45395326651657814, "mean_env_wait_ms": 0.43845594569356294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008358120918273926, "StateBufferConnector_ms": 0.005638003349304199, "ViewRequirementAgentConnector_ms": 0.13696205615997314}, "num_episodes": 23, "episode_return_max": 311.0, "episode_return_min": -112.0, "episode_return_mean": 53.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.26110665593643, "num_env_steps_trained_throughput_per_sec": 330.26110665593643, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 261630.075, "restore_workers_time_ms": 0.044, "training_step_time_ms": 261629.97, "sample_time_ms": 2354.21, "learn_time_ms": 259256.411, "learn_throughput": 15.429, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "f1691_00002", "date": "2024-08-13_19-01-31", "timestamp": 1723590091, "time_this_iter_s": 12.126309871673584, "time_total_s": 2616.892021417618, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fd7940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2616.892021417618, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.422222222222224, "ram_util_percent": 82.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3967326696784723, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.4096106201883347, "policy_loss": -0.003925745217031035, "vf_loss": 1.4133161608819609, "vf_explained_var": 0.005934220899349798, "kl": 0.008808207584357288, "entropy": 1.5602168317194338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.783617426888653, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 3.9167119002216078, "policy_loss": -0.005220042874238321, "vf_loss": 3.9218791282996928, "vf_explained_var": 0.11123993655361196, "kl": 0.00844858648283212, "entropy": 1.5087273341007335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -112.0, "episode_reward_mean": 55.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 226.0}, "policy_reward_mean": {"prey_policy": 10.29, "predator_policy": 17.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, 25.0, 71.0, 119.0, 146.0, -96.0, 30.0, 71.0, -40.0, 11.0, 3.0, 166.0, 26.0, 132.0, 69.0, 9.0, -112.0, 77.0, -3.0, 114.0, 78.0, 25.0, 104.0, -57.0, 98.0, -46.0, 5.0, -25.0, 24.0, 173.0, 97.0, 0.0, -33.0, 45.0, 43.0, 39.0, 48.0, -7.0, 40.0, 138.0, 123.0, 3.0, -41.0, 149.0, 160.0, 97.0, 63.0, 114.0, 8.0, 148.0, 11.0, 113.0, 123.0, -14.0, 131.0, 29.0, -6.0, 50.0, 222.0, 64.0, 0.0, 35.0, 52.0, 204.0, 183.0, 6.0, 155.0, 175.0, 25.0, 0.0, 251.0, 101.0, 0.0, 0.0, 7.0, -13.0, 0.0, 24.0, -19.0, -43.0, -31.0, 311.0, 39.0, -6.0, -22.0, -24.0, 2.0, -24.0, -76.0, 31.0, 0.0, 183.0, 120.0, 170.0, 0.0, 192.0, 147.0, 79.0, 145.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -34.0, 67.0, -105.0, 2.0, 69.0, -6.0, 75.0, 48.0, 85.0, -138.0, -54.0, 65.0, -248.0, 87.0, -32.0, -59.0, -27.0, -31.0, 0.0, 40.0, -86.0, 0.0, 166.0, 22.0, -14.0, 104.0, -386.0, 83.0, -41.0, -69.0, -10.0, -350.0, 9.0, 68.0, 0.0, -31.0, 8.0, 0.0, 85.0, 65.0, 1.0, 25.0, -16.0, 72.0, 23.0, -42.0, -114.0, 124.0, -77.0, -74.0, -37.0, 2.0, 0.0, -17.0, -35.0, -19.0, 12.0, 186.0, -30.0, 97.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, 42.0, 0.0, 43.0, 8.0, 16.0, 45.0, -16.0, -2.0, -10.0, -8.0, 44.0, 63.0, 69.0, 72.0, 46.0, 0.0, 3.0, -45.0, -46.0, 115.0, 34.0, 170.0, -33.0, 114.0, -39.0, -45.0, 45.0, 91.0, -14.0, -10.0, 2.0, 133.0, 9.0, 11.0, 0.0, 68.0, 38.0, 2.0, 69.0, 0.0, -28.0, 129.0, 0.0, -226.0, -7.0, 0.0, -53.0, 56.0, -38.0, 171.0, 8.0, 20.0, -22.0, 0.0, 0.0, 0.0, 22.0, 52.0, 0.0, 118.0, 46.0, 0.0, 183.0, 5.0, 0.0, 149.0, 0.0, 88.0, 70.0, 2.0, 0.0, 11.0, -22.0, 51.0, 200.0, -6.0, 104.0, 0.0, 0.0, 0.0, 0.0, -66.0, 2.0, -26.0, 0.0, 0.0, 0.0, 0.0, 24.0, -11.0, -38.0, -90.0, -19.0, 0.0, -62.0, 182.0, 128.0, 0.0, 34.0, -98.0, -24.0, -44.0, 0.0, 0.0, -48.0, -44.0, -24.0, 0.0, -48.0, -30.0, -142.0, 31.0, 0.0, -26.0, 0.0, 35.0, 125.0, 110.0, 0.0, 91.0, 58.0, 0.0, 0.0, 116.0, 70.0, 42.0, 104.0, -10.0, 47.0, -27.0, 155.0, 0.0, 21.0], "policy_predator_policy_reward": [3.0, 17.0, 1.0, 62.0, 0.0, 0.0, 34.0, 16.0, 13.0, 0.0, 69.0, 27.0, 111.0, 102.0, 16.0, 0.0, 0.0, 46.0, 5.0, 37.0, 0.0, 49.0, 0.0, 0.0, 3.0, 15.0, 219.0, 195.0, 0.0, 27.0, 49.0, 39.0, 226.0, 3.0, 4.0, 5.0, 0.0, 20.0, 29.0, 0.0, 0.0, 12.0, 7.0, 9.0, 7.0, 2.0, 69.0, 30.0, 27.0, 24.0, 45.0, 20.0, 0.0, 3.0, 18.0, 9.0, 0.0, 31.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 24.0, 6.0, 27.0, 0.0, 0.0, 5.0, 10.0, 9.0, 10.0, 5.0, 0.0, 4.0, 0.0, 4.0, 2.0, 5.0, 0.0, 0.0, 0.0, 27.0, 23.0, 0.0, 0.0, 17.0, 6.0, 20.0, 2.0, 36.0, 27.0, 10.0, 27.0, 11.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 7.0, 41.0, 11.0, 0.0, 14.0, 2.0, 0.0, 136.0, 126.0, 47.0, 0.0, 21.0, 11.0, 24.0, 19.0, 18.0, 48.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 17.0, 0.0, 20.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 41.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 9.0, 48.0, 18.0, 31.0, 0.0, 0.0, 1.0, 0.0, 5.0, 16.0, 100.0, 20.0, 2.0, 0.0, 24.0, 5.0, 65.0, 0.0, 24.0, 71.0, 25.0, 0.0, 0.0, 14.0, 12.0, 20.0, 3.0, 0.0, 10.0, 18.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 9.0, 33.0, 6.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.138344362136606, "mean_inference_ms": 3.0419221639356016, "mean_action_processing_ms": 0.44025680096554287, "mean_env_wait_ms": 0.4217977088583714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00832211971282959, "StateBufferConnector_ms": 0.005817294120788574, "ViewRequirementAgentConnector_ms": 0.1270371675491333}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -112.0, "episode_return_mean": 55.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.60010856816402, "num_env_steps_trained_throughput_per_sec": 241.60010856816402, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 261225.699, "restore_workers_time_ms": 0.043, "training_step_time_ms": 261225.598, "sample_time_ms": 2106.71, "learn_time_ms": 259099.037, "learn_throughput": 15.438, "synch_weights_time_ms": 16.753}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "f1691_00002", "date": "2024-08-13_19-01-48", "timestamp": 1723590108, "time_this_iter_s": 16.587186098098755, "time_total_s": 2633.4792075157166, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2633.4792075157166, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 80.03478260869566, "ram_util_percent": 83.25217391304349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4048442869767468, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 0.6361904381759583, "policy_loss": -0.0033756382815125917, "vf_loss": 0.6393308378953152, "vf_explained_var": 0.006835400364386342, "kl": 0.009409588835352293, "entropy": 1.5088641785439991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.549260679537815, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 2.7046669367759946, "policy_loss": -0.00033033214775579314, "vf_loss": 2.7049795249151805, "vf_explained_var": 0.16574136561186856, "kl": 0.002838465317758424, "entropy": 1.5204367454720553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -76.0, "episode_reward_mean": 57.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -226.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 136.0}, "policy_reward_mean": {"prey_policy": 16.79, "predator_policy": 11.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 114.0, 78.0, 25.0, 104.0, -57.0, 98.0, -46.0, 5.0, -25.0, 24.0, 173.0, 97.0, 0.0, -33.0, 45.0, 43.0, 39.0, 48.0, -7.0, 40.0, 138.0, 123.0, 3.0, -41.0, 149.0, 160.0, 97.0, 63.0, 114.0, 8.0, 148.0, 11.0, 113.0, 123.0, -14.0, 131.0, 29.0, -6.0, 50.0, 222.0, 64.0, 0.0, 35.0, 52.0, 204.0, 183.0, 6.0, 155.0, 175.0, 25.0, 0.0, 251.0, 101.0, 0.0, 0.0, 7.0, -13.0, 0.0, 24.0, -19.0, -43.0, -31.0, 311.0, 39.0, -6.0, -22.0, -24.0, 2.0, -24.0, -76.0, 31.0, 0.0, 183.0, 120.0, 170.0, 0.0, 192.0, 147.0, 79.0, 145.0, 21.0, 0.0, 17.0, 35.0, -11.0, 0.0, -1.0, 138.0, 131.0, 121.0, 0.0, 184.0, 47.0, 79.0, -11.0, 76.0, 119.0, 0.0, -18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.0, 8.0, 0.0, 85.0, 65.0, 1.0, 25.0, -16.0, 72.0, 23.0, -42.0, -114.0, 124.0, -77.0, -74.0, -37.0, 2.0, 0.0, -17.0, -35.0, -19.0, 12.0, 186.0, -30.0, 97.0, 0.0, 0.0, 0.0, -85.0, 0.0, -30.0, 42.0, 0.0, 43.0, 8.0, 16.0, 45.0, -16.0, -2.0, -10.0, -8.0, 44.0, 63.0, 69.0, 72.0, 46.0, 0.0, 3.0, -45.0, -46.0, 115.0, 34.0, 170.0, -33.0, 114.0, -39.0, -45.0, 45.0, 91.0, -14.0, -10.0, 2.0, 133.0, 9.0, 11.0, 0.0, 68.0, 38.0, 2.0, 69.0, 0.0, -28.0, 129.0, 0.0, -226.0, -7.0, 0.0, -53.0, 56.0, -38.0, 171.0, 8.0, 20.0, -22.0, 0.0, 0.0, 0.0, 22.0, 52.0, 0.0, 118.0, 46.0, 0.0, 183.0, 5.0, 0.0, 149.0, 0.0, 88.0, 70.0, 2.0, 0.0, 11.0, -22.0, 51.0, 200.0, -6.0, 104.0, 0.0, 0.0, 0.0, 0.0, -66.0, 2.0, -26.0, 0.0, 0.0, 0.0, 0.0, 24.0, -11.0, -38.0, -90.0, -19.0, 0.0, -62.0, 182.0, 128.0, 0.0, 34.0, -98.0, -24.0, -44.0, 0.0, 0.0, -48.0, -44.0, -24.0, 0.0, -48.0, -30.0, -142.0, 31.0, 0.0, -26.0, 0.0, 35.0, 125.0, 110.0, 0.0, 91.0, 58.0, 0.0, 0.0, 116.0, 70.0, 42.0, 104.0, -10.0, 47.0, -27.0, 155.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 11.0, -18.0, 0.0, -24.0, 0.0, 0.0, -2.0, 0.0, 0.0, 119.0, 88.0, 26.0, 21.0, 67.0, 0.0, 0.0, 160.0, 24.0, 5.0, 39.0, 0.0, 42.0, 0.0, -38.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, -30.0, -6.0], "policy_predator_policy_reward": [0.0, 20.0, 29.0, 0.0, 0.0, 12.0, 7.0, 9.0, 7.0, 2.0, 69.0, 30.0, 27.0, 24.0, 45.0, 20.0, 0.0, 3.0, 18.0, 9.0, 0.0, 31.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 24.0, 6.0, 27.0, 0.0, 0.0, 5.0, 10.0, 9.0, 10.0, 5.0, 0.0, 4.0, 0.0, 4.0, 2.0, 5.0, 0.0, 0.0, 0.0, 27.0, 23.0, 0.0, 0.0, 17.0, 6.0, 20.0, 2.0, 36.0, 27.0, 10.0, 27.0, 11.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 7.0, 41.0, 11.0, 0.0, 14.0, 2.0, 0.0, 136.0, 126.0, 47.0, 0.0, 21.0, 11.0, 24.0, 19.0, 18.0, 48.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 17.0, 0.0, 20.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 41.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 9.0, 48.0, 18.0, 31.0, 0.0, 0.0, 1.0, 0.0, 5.0, 16.0, 100.0, 20.0, 2.0, 0.0, 24.0, 5.0, 65.0, 0.0, 24.0, 71.0, 25.0, 0.0, 0.0, 14.0, 12.0, 20.0, 3.0, 0.0, 10.0, 18.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 9.0, 33.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 42.0, 7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 19.0, 0.0, 17.0, 29.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 37.0, 0.0, 27.0, 0.0, 1.0, 46.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1016351529974897, "mean_inference_ms": 2.9783621660025528, "mean_action_processing_ms": 0.42655879762974, "mean_env_wait_ms": 0.40625839078011927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00452113151550293, "StateBufferConnector_ms": 0.004199504852294922, "ViewRequirementAgentConnector_ms": 0.11583983898162842}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -76.0, "episode_return_mean": 57.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.94871342164424, "num_env_steps_trained_throughput_per_sec": 289.94871342164424, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 92205.077, "restore_workers_time_ms": 0.022, "training_step_time_ms": 92205.017, "sample_time_ms": 2128.307, "learn_time_ms": 90056.238, "learn_throughput": 44.417, "synch_weights_time_ms": 17.449}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "f1691_00002", "date": "2024-08-13_19-02-02", "timestamp": 1723590122, "time_this_iter_s": 13.841274976730347, "time_total_s": 2647.320482492447, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2647.320482492447, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 63.595000000000006, "ram_util_percent": 83.685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4163571245120789, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 1.3140463566969312, "policy_loss": -0.000696813093902415, "vf_loss": 1.3146571194684065, "vf_explained_var": 0.0014829260646981536, "kl": 0.0034419078988566837, "entropy": 1.4850377170497147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6829438771323235, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 2.526658298035778, "policy_loss": -0.0027671328408239537, "vf_loss": 2.529412640528704, "vf_explained_var": 0.05449987873829231, "kl": 0.004093457699944187, "entropy": 1.5255571214610306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -79.0, "episode_reward_mean": 57.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -226.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 136.0}, "policy_reward_mean": {"prey_policy": 16.88, "predator_policy": 11.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, -7.0, 40.0, 138.0, 123.0, 3.0, -41.0, 149.0, 160.0, 97.0, 63.0, 114.0, 8.0, 148.0, 11.0, 113.0, 123.0, -14.0, 131.0, 29.0, -6.0, 50.0, 222.0, 64.0, 0.0, 35.0, 52.0, 204.0, 183.0, 6.0, 155.0, 175.0, 25.0, 0.0, 251.0, 101.0, 0.0, 0.0, 7.0, -13.0, 0.0, 24.0, -19.0, -43.0, -31.0, 311.0, 39.0, -6.0, -22.0, -24.0, 2.0, -24.0, -76.0, 31.0, 0.0, 183.0, 120.0, 170.0, 0.0, 192.0, 147.0, 79.0, 145.0, 21.0, 0.0, 17.0, 35.0, -11.0, 0.0, -1.0, 138.0, 131.0, 121.0, 0.0, 184.0, 47.0, 79.0, -11.0, 76.0, 119.0, 0.0, -18.0, 47.0, 0.0, 200.0, -33.0, -11.0, 0.0, 28.0, 4.0, 76.0, 8.0, 88.0, -66.0, 47.0, -79.0, 189.0, 69.0, 79.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [45.0, -16.0, -2.0, -10.0, -8.0, 44.0, 63.0, 69.0, 72.0, 46.0, 0.0, 3.0, -45.0, -46.0, 115.0, 34.0, 170.0, -33.0, 114.0, -39.0, -45.0, 45.0, 91.0, -14.0, -10.0, 2.0, 133.0, 9.0, 11.0, 0.0, 68.0, 38.0, 2.0, 69.0, 0.0, -28.0, 129.0, 0.0, -226.0, -7.0, 0.0, -53.0, 56.0, -38.0, 171.0, 8.0, 20.0, -22.0, 0.0, 0.0, 0.0, 22.0, 52.0, 0.0, 118.0, 46.0, 0.0, 183.0, 5.0, 0.0, 149.0, 0.0, 88.0, 70.0, 2.0, 0.0, 11.0, -22.0, 51.0, 200.0, -6.0, 104.0, 0.0, 0.0, 0.0, 0.0, -66.0, 2.0, -26.0, 0.0, 0.0, 0.0, 0.0, 24.0, -11.0, -38.0, -90.0, -19.0, 0.0, -62.0, 182.0, 128.0, 0.0, 34.0, -98.0, -24.0, -44.0, 0.0, 0.0, -48.0, -44.0, -24.0, 0.0, -48.0, -30.0, -142.0, 31.0, 0.0, -26.0, 0.0, 35.0, 125.0, 110.0, 0.0, 91.0, 58.0, 0.0, 0.0, 116.0, 70.0, 42.0, 104.0, -10.0, 47.0, -27.0, 155.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 11.0, -18.0, 0.0, -24.0, 0.0, 0.0, -2.0, 0.0, 0.0, 119.0, 88.0, 26.0, 21.0, 67.0, 0.0, 0.0, 160.0, 24.0, 5.0, 39.0, 0.0, 42.0, 0.0, -38.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, -30.0, -6.0, -11.0, 41.0, 0.0, 0.0, 149.0, 36.0, 0.0, -75.0, -8.0, -21.0, 0.0, 0.0, 11.0, -45.0, 0.0, 4.0, 76.0, 0.0, -1.0, 0.0, 79.0, 0.0, 0.0, -132.0, 0.0, 47.0, -87.0, -122.0, 189.0, 0.0, 11.0, 44.0, 69.0, 0.0, 0.0, -34.0], "policy_predator_policy_reward": [9.0, 10.0, 5.0, 0.0, 4.0, 0.0, 4.0, 2.0, 5.0, 0.0, 0.0, 0.0, 27.0, 23.0, 0.0, 0.0, 17.0, 6.0, 20.0, 2.0, 36.0, 27.0, 10.0, 27.0, 11.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 7.0, 41.0, 11.0, 0.0, 14.0, 2.0, 0.0, 136.0, 126.0, 47.0, 0.0, 21.0, 11.0, 24.0, 19.0, 18.0, 48.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 17.0, 0.0, 20.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 41.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 9.0, 48.0, 18.0, 31.0, 0.0, 0.0, 1.0, 0.0, 5.0, 16.0, 100.0, 20.0, 2.0, 0.0, 24.0, 5.0, 65.0, 0.0, 24.0, 71.0, 25.0, 0.0, 0.0, 14.0, 12.0, 20.0, 3.0, 0.0, 10.0, 18.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 9.0, 33.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 42.0, 7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 19.0, 0.0, 17.0, 29.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 37.0, 0.0, 27.0, 0.0, 1.0, 46.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 17.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 42.0, 4.0, 14.0, 0.0, 0.0, 38.0, 24.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 66.0, 0.0, 0.0, 0.0, 81.0, 49.0, 0.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.073147155443906, "mean_inference_ms": 2.928903701607429, "mean_action_processing_ms": 0.41535630406356444, "mean_env_wait_ms": 0.39360330717441455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004743218421936035, "StateBufferConnector_ms": 0.004506707191467285, "ViewRequirementAgentConnector_ms": 0.11932551860809326}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -79.0, "episode_return_mean": 57.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.214223444741915, "num_env_steps_trained_throughput_per_sec": 21.214223444741915, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 109603.135, "restore_workers_time_ms": 0.021, "training_step_time_ms": 109603.076, "sample_time_ms": 1911.425, "learn_time_ms": 107670.588, "learn_throughput": 37.15, "synch_weights_time_ms": 17.867}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "f1691_00002", "date": "2024-08-13_19-05-10", "timestamp": 1723590310, "time_this_iter_s": 188.59713220596313, "time_total_s": 2835.91761469841, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2835.91761469841, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 59.02222222222221, "ram_util_percent": 83.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45005332310955043, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 0.7106041664326632, "policy_loss": -0.0033575348193860717, "vf_loss": 0.7138533753416841, "vf_explained_var": 0.003987495293692937, "kl": 0.00866602339829155, "entropy": 1.5092214672653763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3424208886251248, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 2.7807407418886823, "policy_loss": -0.007158170549307393, "vf_loss": 2.7878719290097553, "vf_explained_var": 0.13775507675276863, "kl": 0.017269056795746193, "entropy": 1.4454957034222033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -79.0, "episode_reward_mean": 56.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 118.0}, "policy_reward_mean": {"prey_policy": 17.825, "predator_policy": 10.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.0, 183.0, 6.0, 155.0, 175.0, 25.0, 0.0, 251.0, 101.0, 0.0, 0.0, 7.0, -13.0, 0.0, 24.0, -19.0, -43.0, -31.0, 311.0, 39.0, -6.0, -22.0, -24.0, 2.0, -24.0, -76.0, 31.0, 0.0, 183.0, 120.0, 170.0, 0.0, 192.0, 147.0, 79.0, 145.0, 21.0, 0.0, 17.0, 35.0, -11.0, 0.0, -1.0, 138.0, 131.0, 121.0, 0.0, 184.0, 47.0, 79.0, -11.0, 76.0, 119.0, 0.0, -18.0, 47.0, 0.0, 200.0, -33.0, -11.0, 0.0, 28.0, 4.0, 76.0, 8.0, 88.0, -66.0, 47.0, -79.0, 189.0, 69.0, 79.0, -11.0, 0.0, 46.0, 21.0, 3.0, 212.0, -9.0, 26.0, 159.0, 66.0, 202.0, 205.0, 63.0, 54.0, 22.0, 59.0, 0.0, 0.0, 180.0, 4.0, 13.0, 71.0, 3.0, 154.0, 7.0, 122.0, 0.0, 72.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [118.0, 46.0, 0.0, 183.0, 5.0, 0.0, 149.0, 0.0, 88.0, 70.0, 2.0, 0.0, 11.0, -22.0, 51.0, 200.0, -6.0, 104.0, 0.0, 0.0, 0.0, 0.0, -66.0, 2.0, -26.0, 0.0, 0.0, 0.0, 0.0, 24.0, -11.0, -38.0, -90.0, -19.0, 0.0, -62.0, 182.0, 128.0, 0.0, 34.0, -98.0, -24.0, -44.0, 0.0, 0.0, -48.0, -44.0, -24.0, 0.0, -48.0, -30.0, -142.0, 31.0, 0.0, -26.0, 0.0, 35.0, 125.0, 110.0, 0.0, 91.0, 58.0, 0.0, 0.0, 116.0, 70.0, 42.0, 104.0, -10.0, 47.0, -27.0, 155.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 11.0, -18.0, 0.0, -24.0, 0.0, 0.0, -2.0, 0.0, 0.0, 119.0, 88.0, 26.0, 21.0, 67.0, 0.0, 0.0, 160.0, 24.0, 5.0, 39.0, 0.0, 42.0, 0.0, -38.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, -30.0, -6.0, -11.0, 41.0, 0.0, 0.0, 149.0, 36.0, 0.0, -75.0, -8.0, -21.0, 0.0, 0.0, 11.0, -45.0, 0.0, 4.0, 76.0, 0.0, -1.0, 0.0, 79.0, 0.0, 0.0, -132.0, 0.0, 47.0, -87.0, -122.0, 189.0, 0.0, 11.0, 44.0, 69.0, 0.0, 0.0, -34.0, 0.0, 0.0, 46.0, 0.0, -14.0, 3.0, -40.0, -82.0, 57.0, 155.0, -18.0, 0.0, -78.0, 54.0, 136.0, 19.0, 0.0, 33.0, 199.0, 3.0, 45.0, 147.0, 47.0, 8.0, 54.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 33.0, 104.0, -2.0, -83.0, 0.0, 13.0, 35.0, 20.0, 3.0, 0.0, 0.0, 154.0, 12.0, -22.0, 0.0, 111.0, 0.0, 0.0, 0.0, 72.0], "policy_predator_policy_reward": [40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 17.0, 0.0, 20.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 41.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 9.0, 48.0, 18.0, 31.0, 0.0, 0.0, 1.0, 0.0, 5.0, 16.0, 100.0, 20.0, 2.0, 0.0, 24.0, 5.0, 65.0, 0.0, 24.0, 71.0, 25.0, 0.0, 0.0, 14.0, 12.0, 20.0, 3.0, 0.0, 10.0, 18.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 9.0, 33.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 42.0, 7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 19.0, 0.0, 17.0, 29.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 37.0, 0.0, 27.0, 0.0, 1.0, 46.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 17.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 42.0, 4.0, 14.0, 0.0, 0.0, 38.0, 24.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 66.0, 0.0, 0.0, 0.0, 81.0, 49.0, 0.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 28.0, 4.0, 118.0, 7.0, 0.0, 0.0, 9.0, 0.0, 11.0, 39.0, 4.0, 0.0, 18.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 22.0, 47.0, 42.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.038741563617809, "mean_inference_ms": 2.861610523172191, "mean_action_processing_ms": 0.40182158185521055, "mean_env_wait_ms": 0.3790638494759117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004530787467956543, "StateBufferConnector_ms": 0.003817439079284668, "ViewRequirementAgentConnector_ms": 0.11298704147338867}, "num_episodes": 27, "episode_return_max": 311.0, "episode_return_min": -79.0, "episode_return_mean": 56.09, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.83360730972794, "num_env_steps_trained_throughput_per_sec": 329.83360730972794, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 109564.204, "restore_workers_time_ms": 0.021, "training_step_time_ms": 109564.151, "sample_time_ms": 1721.44, "learn_time_ms": 107820.855, "learn_throughput": 37.099, "synch_weights_time_ms": 18.971}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "f1691_00002", "date": "2024-08-13_19-05-23", "timestamp": 1723590323, "time_this_iter_s": 12.181291103363037, "time_total_s": 2848.098905801773, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2848.098905801773, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 51.383333333333326, "ram_util_percent": 83.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4496317868017488, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 1.1521531953382744, "policy_loss": -0.0016373593165544132, "vf_loss": 1.1536675152639864, "vf_explained_var": 0.006371602211048994, "kl": 0.009843273493855678, "entropy": 1.4548965045384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5538363346425945, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 2.093602146641918, "policy_loss": -0.0038713096001643747, "vf_loss": 2.097462410333926, "vf_explained_var": 0.0748098543712071, "kl": 0.007068774345544165, "entropy": 1.4430603542025127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -79.0, "episode_reward_mean": 49.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 118.0}, "policy_reward_mean": {"prey_policy": 14.34, "predator_policy": 10.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.0, 39.0, -6.0, -22.0, -24.0, 2.0, -24.0, -76.0, 31.0, 0.0, 183.0, 120.0, 170.0, 0.0, 192.0, 147.0, 79.0, 145.0, 21.0, 0.0, 17.0, 35.0, -11.0, 0.0, -1.0, 138.0, 131.0, 121.0, 0.0, 184.0, 47.0, 79.0, -11.0, 76.0, 119.0, 0.0, -18.0, 47.0, 0.0, 200.0, -33.0, -11.0, 0.0, 28.0, 4.0, 76.0, 8.0, 88.0, -66.0, 47.0, -79.0, 189.0, 69.0, 79.0, -11.0, 0.0, 46.0, 21.0, 3.0, 212.0, -9.0, 26.0, 159.0, 66.0, 202.0, 205.0, 63.0, 54.0, 22.0, 59.0, 0.0, 0.0, 180.0, 4.0, 13.0, 71.0, 3.0, 154.0, 7.0, 122.0, 0.0, 72.0, -27.0, -27.0, -3.0, 0.0, 66.0, 10.0, 80.0, 9.0, -8.0, -2.0, 11.0, 81.0, -10.0, -67.0, -16.0, 28.0, 0.0, 268.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 128.0, 0.0, 34.0, -98.0, -24.0, -44.0, 0.0, 0.0, -48.0, -44.0, -24.0, 0.0, -48.0, -30.0, -142.0, 31.0, 0.0, -26.0, 0.0, 35.0, 125.0, 110.0, 0.0, 91.0, 58.0, 0.0, 0.0, 116.0, 70.0, 42.0, 104.0, -10.0, 47.0, -27.0, 155.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 11.0, -18.0, 0.0, -24.0, 0.0, 0.0, -2.0, 0.0, 0.0, 119.0, 88.0, 26.0, 21.0, 67.0, 0.0, 0.0, 160.0, 24.0, 5.0, 39.0, 0.0, 42.0, 0.0, -38.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, -30.0, -6.0, -11.0, 41.0, 0.0, 0.0, 149.0, 36.0, 0.0, -75.0, -8.0, -21.0, 0.0, 0.0, 11.0, -45.0, 0.0, 4.0, 76.0, 0.0, -1.0, 0.0, 79.0, 0.0, 0.0, -132.0, 0.0, 47.0, -87.0, -122.0, 189.0, 0.0, 11.0, 44.0, 69.0, 0.0, 0.0, -34.0, 0.0, 0.0, 46.0, 0.0, -14.0, 3.0, -40.0, -82.0, 57.0, 155.0, -18.0, 0.0, -78.0, 54.0, 136.0, 19.0, 0.0, 33.0, 199.0, 3.0, 45.0, 147.0, 47.0, 8.0, 54.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 33.0, 104.0, -2.0, -83.0, 0.0, 13.0, 35.0, 20.0, 3.0, 0.0, 0.0, 154.0, 12.0, -22.0, 0.0, 111.0, 0.0, 0.0, 0.0, 72.0, 0.0, -57.0, -37.0, -18.0, -6.0, 0.0, 0.0, 0.0, 66.0, 0.0, -37.0, 26.0, 0.0, 53.0, -31.0, 1.0, -34.0, 0.0, 0.0, -4.0, 11.0, 0.0, 46.0, 34.0, 7.0, -64.0, -142.0, 0.0, 0.0, -32.0, -20.0, 28.0, 0.0, 0.0, 128.0, 98.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 5.0, 16.0, 100.0, 20.0, 2.0, 0.0, 24.0, 5.0, 65.0, 0.0, 24.0, 71.0, 25.0, 0.0, 0.0, 14.0, 12.0, 20.0, 3.0, 0.0, 10.0, 18.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 9.0, 33.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 42.0, 7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 19.0, 0.0, 17.0, 29.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 37.0, 0.0, 27.0, 0.0, 1.0, 46.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 17.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 42.0, 4.0, 14.0, 0.0, 0.0, 38.0, 24.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 66.0, 0.0, 0.0, 0.0, 81.0, 49.0, 0.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 28.0, 4.0, 118.0, 7.0, 0.0, 0.0, 9.0, 0.0, 11.0, 39.0, 4.0, 0.0, 18.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 22.0, 47.0, 42.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 9.0, 19.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 27.0, 0.0, 14.0, 25.0, 0.0, 26.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 19.0, 28.0, 56.0, 19.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 17.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0187400735338046, "mean_inference_ms": 2.8289419099779853, "mean_action_processing_ms": 0.3938002746030804, "mean_env_wait_ms": 0.3694358289763555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004384160041809082, "StateBufferConnector_ms": 0.0038439035415649414, "ViewRequirementAgentConnector_ms": 0.10719990730285645}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -79.0, "episode_return_mean": 49.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.60229765239706, "num_env_steps_trained_throughput_per_sec": 309.60229765239706, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 109786.417, "restore_workers_time_ms": 0.021, "training_step_time_ms": 109786.364, "sample_time_ms": 1732.151, "learn_time_ms": 108033.024, "learn_throughput": 37.026, "synch_weights_time_ms": 18.457}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "f1691_00002", "date": "2024-08-13_19-05-36", "timestamp": 1723590336, "time_this_iter_s": 12.959890127182007, "time_total_s": 2861.058795928955, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2861.058795928955, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 53.47222222222222, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4655966348630726, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 0.6053989798067108, "policy_loss": -0.004737361390685673, "vf_loss": 0.6098957371715673, "vf_explained_var": 0.006274568719207925, "kl": 0.019248315948827737, "entropy": 1.5301875894031827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.16908320116776, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 1.7808185460706236, "policy_loss": -0.0040553953370483465, "vf_loss": 1.784866082573694, "vf_explained_var": 0.15285868979004955, "kl": 0.005028586780420491, "entropy": 1.5134696539116914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -79.0, "episode_reward_mean": 42.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 118.0}, "policy_reward_mean": {"prey_policy": 11.87, "predator_policy": 9.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 0.0, 17.0, 35.0, -11.0, 0.0, -1.0, 138.0, 131.0, 121.0, 0.0, 184.0, 47.0, 79.0, -11.0, 76.0, 119.0, 0.0, -18.0, 47.0, 0.0, 200.0, -33.0, -11.0, 0.0, 28.0, 4.0, 76.0, 8.0, 88.0, -66.0, 47.0, -79.0, 189.0, 69.0, 79.0, -11.0, 0.0, 46.0, 21.0, 3.0, 212.0, -9.0, 26.0, 159.0, 66.0, 202.0, 205.0, 63.0, 54.0, 22.0, 59.0, 0.0, 0.0, 180.0, 4.0, 13.0, 71.0, 3.0, 154.0, 7.0, 122.0, 0.0, 72.0, -27.0, -27.0, -3.0, 0.0, 66.0, 10.0, 80.0, 9.0, -8.0, -2.0, 11.0, 81.0, -10.0, -67.0, -16.0, 28.0, 0.0, 268.0, 0.0, -5.0, -35.0, 7.0, 30.0, 62.0, 5.0, 69.0, 0.0, 121.0, 53.0, 56.0, 86.0, -47.0, 44.0, 18.0, 51.0, 40.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 11.0, -18.0, 0.0, -24.0, 0.0, 0.0, -2.0, 0.0, 0.0, 119.0, 88.0, 26.0, 21.0, 67.0, 0.0, 0.0, 160.0, 24.0, 5.0, 39.0, 0.0, 42.0, 0.0, -38.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, -30.0, -6.0, -11.0, 41.0, 0.0, 0.0, 149.0, 36.0, 0.0, -75.0, -8.0, -21.0, 0.0, 0.0, 11.0, -45.0, 0.0, 4.0, 76.0, 0.0, -1.0, 0.0, 79.0, 0.0, 0.0, -132.0, 0.0, 47.0, -87.0, -122.0, 189.0, 0.0, 11.0, 44.0, 69.0, 0.0, 0.0, -34.0, 0.0, 0.0, 46.0, 0.0, -14.0, 3.0, -40.0, -82.0, 57.0, 155.0, -18.0, 0.0, -78.0, 54.0, 136.0, 19.0, 0.0, 33.0, 199.0, 3.0, 45.0, 147.0, 47.0, 8.0, 54.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 33.0, 104.0, -2.0, -83.0, 0.0, 13.0, 35.0, 20.0, 3.0, 0.0, 0.0, 154.0, 12.0, -22.0, 0.0, 111.0, 0.0, 0.0, 0.0, 72.0, 0.0, -57.0, -37.0, -18.0, -6.0, 0.0, 0.0, 0.0, 66.0, 0.0, -37.0, 26.0, 0.0, 53.0, -31.0, 1.0, -34.0, 0.0, 0.0, -4.0, 11.0, 0.0, 46.0, 34.0, 7.0, -64.0, -142.0, 0.0, 0.0, -32.0, -20.0, 28.0, 0.0, 0.0, 128.0, 98.0, 0.0, 0.0, -16.0, 3.0, -6.0, -79.0, 14.0, -14.0, 20.0, -22.0, 29.0, 19.0, 0.0, 5.0, 58.0, 11.0, 0.0, 0.0, 87.0, 34.0, 11.0, -1.0, 28.0, 23.0, 19.0, 35.0, -42.0, -26.0, 46.0, -30.0, -22.0, 28.0, 0.0, 51.0, 0.0, 6.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 42.0, 7.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 19.0, 0.0, 17.0, 29.0, 4.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 37.0, 0.0, 27.0, 0.0, 1.0, 46.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 17.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 42.0, 4.0, 14.0, 0.0, 0.0, 38.0, 24.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 66.0, 0.0, 0.0, 0.0, 81.0, 49.0, 0.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 28.0, 4.0, 118.0, 7.0, 0.0, 0.0, 9.0, 0.0, 11.0, 39.0, 4.0, 0.0, 18.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 22.0, 47.0, 42.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 9.0, 19.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 27.0, 0.0, 14.0, 25.0, 0.0, 26.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 19.0, 28.0, 56.0, 19.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 17.0, 25.0, 0.0, 0.0, 0.0, 8.0, 30.0, 20.0, 7.0, 0.0, 21.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 32.0, 5.0, 0.0, 4.0, 28.0, 0.0, 21.0, 13.0, 15.0, 12.0, 0.0, 0.0, 0.0, 34.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9977040836191904, "mean_inference_ms": 2.786373783462568, "mean_action_processing_ms": 0.3858106055886742, "mean_env_wait_ms": 0.36071546696011453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004457950592041016, "StateBufferConnector_ms": 0.0036472082138061523, "ViewRequirementAgentConnector_ms": 0.10607016086578369}, "num_episodes": 18, "episode_return_max": 268.0, "episode_return_min": -79.0, "episode_return_mean": 42.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.246647565150059, "num_env_steps_trained_throughput_per_sec": 5.246647565150059, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 109268.482, "restore_workers_time_ms": 0.021, "training_step_time_ms": 109268.386, "sample_time_ms": 1762.496, "learn_time_ms": 107465.097, "learn_throughput": 37.221, "synch_weights_time_ms": 37.292}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "f1691_00002", "date": "2024-08-13_19-18-19", "timestamp": 1723591099, "time_this_iter_s": 763.7065658569336, "time_total_s": 3624.7653617858887, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3624.7653617858887, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 63.7857142857143, "ram_util_percent": 83.73809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5714824222047966, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 0.7994731920894491, "policy_loss": -0.002007956906571669, "vf_loss": 0.801365701223492, "vf_explained_var": 0.003219315110060273, "kl": 0.009235813494180678, "entropy": 1.4756982241358076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.422451791458975, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 2.728413952910711, "policy_loss": -0.002505541807927546, "vf_loss": 2.7309047902702654, "vf_explained_var": 0.0953311182834484, "kl": 0.009407799064386697, "entropy": 1.5070800134744593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -79.0, "episode_reward_mean": 38.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 118.0}, "policy_reward_mean": {"prey_policy": 8.83, "predator_policy": 10.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.0, 47.0, 0.0, 200.0, -33.0, -11.0, 0.0, 28.0, 4.0, 76.0, 8.0, 88.0, -66.0, 47.0, -79.0, 189.0, 69.0, 79.0, -11.0, 0.0, 46.0, 21.0, 3.0, 212.0, -9.0, 26.0, 159.0, 66.0, 202.0, 205.0, 63.0, 54.0, 22.0, 59.0, 0.0, 0.0, 180.0, 4.0, 13.0, 71.0, 3.0, 154.0, 7.0, 122.0, 0.0, 72.0, -27.0, -27.0, -3.0, 0.0, 66.0, 10.0, 80.0, 9.0, -8.0, -2.0, 11.0, 81.0, -10.0, -67.0, -16.0, 28.0, 0.0, 268.0, 0.0, -5.0, -35.0, 7.0, 30.0, 62.0, 5.0, 69.0, 0.0, 121.0, 53.0, 56.0, 86.0, -47.0, 44.0, 18.0, 51.0, 40.0, -23.0, 186.0, 0.0, 143.0, 18.0, -54.0, -28.0, 1.0, 1.0, 4.0, -21.0, 130.0, -21.0, 102.0, 19.0, -37.0, 64.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.0, -6.0, -11.0, 41.0, 0.0, 0.0, 149.0, 36.0, 0.0, -75.0, -8.0, -21.0, 0.0, 0.0, 11.0, -45.0, 0.0, 4.0, 76.0, 0.0, -1.0, 0.0, 79.0, 0.0, 0.0, -132.0, 0.0, 47.0, -87.0, -122.0, 189.0, 0.0, 11.0, 44.0, 69.0, 0.0, 0.0, -34.0, 0.0, 0.0, 46.0, 0.0, -14.0, 3.0, -40.0, -82.0, 57.0, 155.0, -18.0, 0.0, -78.0, 54.0, 136.0, 19.0, 0.0, 33.0, 199.0, 3.0, 45.0, 147.0, 47.0, 8.0, 54.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 33.0, 104.0, -2.0, -83.0, 0.0, 13.0, 35.0, 20.0, 3.0, 0.0, 0.0, 154.0, 12.0, -22.0, 0.0, 111.0, 0.0, 0.0, 0.0, 72.0, 0.0, -57.0, -37.0, -18.0, -6.0, 0.0, 0.0, 0.0, 66.0, 0.0, -37.0, 26.0, 0.0, 53.0, -31.0, 1.0, -34.0, 0.0, 0.0, -4.0, 11.0, 0.0, 46.0, 34.0, 7.0, -64.0, -142.0, 0.0, 0.0, -32.0, -20.0, 28.0, 0.0, 0.0, 128.0, 98.0, 0.0, 0.0, -16.0, 3.0, -6.0, -79.0, 14.0, -14.0, 20.0, -22.0, 29.0, 19.0, 0.0, 5.0, 58.0, 11.0, 0.0, 0.0, 87.0, 34.0, 11.0, -1.0, 28.0, 23.0, 19.0, 35.0, -42.0, -26.0, 46.0, -30.0, -22.0, 28.0, 0.0, 51.0, 0.0, 6.0, -4.0, -42.0, 186.0, 0.0, -4.0, -32.0, 30.0, 83.0, 0.0, 18.0, 0.0, -122.0, -38.0, -16.0, -10.0, 5.0, -30.0, 0.0, 0.0, 3.0, -2.0, -40.0, 120.0, 10.0, 0.0, -42.0, -17.0, 19.0, 19.0, 0.0, -78.0, 0.0, 37.0, -4.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 18.0, 17.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 42.0, 4.0, 14.0, 0.0, 0.0, 38.0, 24.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 66.0, 0.0, 0.0, 0.0, 81.0, 49.0, 0.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 28.0, 4.0, 118.0, 7.0, 0.0, 0.0, 9.0, 0.0, 11.0, 39.0, 4.0, 0.0, 18.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 22.0, 47.0, 42.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 9.0, 19.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 27.0, 0.0, 14.0, 25.0, 0.0, 26.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 19.0, 28.0, 56.0, 19.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 17.0, 25.0, 0.0, 0.0, 0.0, 8.0, 30.0, 20.0, 7.0, 0.0, 21.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 32.0, 5.0, 0.0, 4.0, 28.0, 0.0, 21.0, 13.0, 15.0, 12.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 23.0, 0.0, 0.0, 34.0, 2.0, 24.0, 6.0, 0.0, 0.0, 0.0, 68.0, 16.0, 10.0, 0.0, 6.0, 31.0, 0.0, 1.0, 0.0, 1.0, 20.0, 0.0, 0.0, 21.0, 0.0, 52.0, 48.0, 0.0, 0.0, 12.0, 29.0, 12.0, 19.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9969069555545369, "mean_inference_ms": 2.7913918779641476, "mean_action_processing_ms": 0.3832487122458468, "mean_env_wait_ms": 0.35880340465947014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049591064453125, "StateBufferConnector_ms": 0.00473332405090332, "ViewRequirementAgentConnector_ms": 0.1621534824371338}, "num_episodes": 18, "episode_return_max": 268.0, "episode_return_min": -79.0, "episode_return_mean": 38.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 118.9516645492522, "num_env_steps_trained_throughput_per_sec": 118.9516645492522, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 111371.301, "restore_workers_time_ms": 0.05, "training_step_time_ms": 111371.138, "sample_time_ms": 2043.143, "learn_time_ms": 109286.123, "learn_throughput": 36.601, "synch_weights_time_ms": 38.492}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "f1691_00002", "date": "2024-08-13_19-18-55", "timestamp": 1723591135, "time_this_iter_s": 34.94649386405945, "time_total_s": 3659.711855649948, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f94e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3659.711855649948, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 92.5326530612245, "ram_util_percent": 83.8265306122449}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6201562442910419, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 3.1477739378258036, "policy_loss": -0.0037795519658300296, "vf_loss": 3.1513496340897977, "vf_explained_var": 0.00622875315171701, "kl": 0.016307809541872994, "entropy": 1.446311332498278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.145274363095483, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.986183381459069, "policy_loss": -0.00978845211519569, "vf_loss": 4.995941492741701, "vf_explained_var": 0.0771666320858809, "kl": 0.019417375070890336, "entropy": 1.443031852333634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -67.0, "episode_reward_mean": 46.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 118.0}, "policy_reward_mean": {"prey_policy": 12.58, "predator_policy": 10.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 212.0, -9.0, 26.0, 159.0, 66.0, 202.0, 205.0, 63.0, 54.0, 22.0, 59.0, 0.0, 0.0, 180.0, 4.0, 13.0, 71.0, 3.0, 154.0, 7.0, 122.0, 0.0, 72.0, -27.0, -27.0, -3.0, 0.0, 66.0, 10.0, 80.0, 9.0, -8.0, -2.0, 11.0, 81.0, -10.0, -67.0, -16.0, 28.0, 0.0, 268.0, 0.0, -5.0, -35.0, 7.0, 30.0, 62.0, 5.0, 69.0, 0.0, 121.0, 53.0, 56.0, 86.0, -47.0, 44.0, 18.0, 51.0, 40.0, -23.0, 186.0, 0.0, 143.0, 18.0, -54.0, -28.0, 1.0, 1.0, 4.0, -21.0, 130.0, -21.0, 102.0, 19.0, -37.0, 64.0, 0.0, 122.0, 14.0, 7.0, 180.0, 185.0, 129.0, 13.0, -56.0, 109.0, 115.0, -6.0, 194.0, -9.0, 136.0, 79.0, 28.0, 88.0, -25.0, 97.0, 100.0, 17.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, -82.0, 57.0, 155.0, -18.0, 0.0, -78.0, 54.0, 136.0, 19.0, 0.0, 33.0, 199.0, 3.0, 45.0, 147.0, 47.0, 8.0, 54.0, 0.0, 0.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 33.0, 104.0, -2.0, -83.0, 0.0, 13.0, 35.0, 20.0, 3.0, 0.0, 0.0, 154.0, 12.0, -22.0, 0.0, 111.0, 0.0, 0.0, 0.0, 72.0, 0.0, -57.0, -37.0, -18.0, -6.0, 0.0, 0.0, 0.0, 66.0, 0.0, -37.0, 26.0, 0.0, 53.0, -31.0, 1.0, -34.0, 0.0, 0.0, -4.0, 11.0, 0.0, 46.0, 34.0, 7.0, -64.0, -142.0, 0.0, 0.0, -32.0, -20.0, 28.0, 0.0, 0.0, 128.0, 98.0, 0.0, 0.0, -16.0, 3.0, -6.0, -79.0, 14.0, -14.0, 20.0, -22.0, 29.0, 19.0, 0.0, 5.0, 58.0, 11.0, 0.0, 0.0, 87.0, 34.0, 11.0, -1.0, 28.0, 23.0, 19.0, 35.0, -42.0, -26.0, 46.0, -30.0, -22.0, 28.0, 0.0, 51.0, 0.0, 6.0, -4.0, -42.0, 186.0, 0.0, -4.0, -32.0, 30.0, 83.0, 0.0, 18.0, 0.0, -122.0, -38.0, -16.0, -10.0, 5.0, -30.0, 0.0, 0.0, 3.0, -2.0, -40.0, 120.0, 10.0, 0.0, -42.0, -17.0, 19.0, 19.0, 0.0, -78.0, 0.0, 37.0, -4.0, 0.0, 0.0, 124.0, -4.0, 0.0, 14.0, 1.0, -16.0, 0.0, 180.0, -4.0, 143.0, 102.0, -21.0, 3.0, 0.0, -112.0, 0.0, 24.0, 38.0, 60.0, 55.0, 0.0, -61.0, 0.0, 194.0, 0.0, -18.0, -24.0, 122.0, 70.0, -36.0, 28.0, 0.0, 88.0, 0.0, -72.0, 0.0, 74.0, 16.0, 52.0, -68.0, 17.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [118.0, 7.0, 0.0, 0.0, 9.0, 0.0, 11.0, 39.0, 4.0, 0.0, 18.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 22.0, 47.0, 42.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 9.0, 19.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 27.0, 0.0, 14.0, 25.0, 0.0, 26.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 19.0, 28.0, 56.0, 19.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 17.0, 25.0, 0.0, 0.0, 0.0, 8.0, 30.0, 20.0, 7.0, 0.0, 21.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 32.0, 5.0, 0.0, 4.0, 28.0, 0.0, 21.0, 13.0, 15.0, 12.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 23.0, 0.0, 0.0, 34.0, 2.0, 24.0, 6.0, 0.0, 0.0, 0.0, 68.0, 16.0, 10.0, 0.0, 6.0, 31.0, 0.0, 1.0, 0.0, 1.0, 20.0, 0.0, 0.0, 21.0, 0.0, 52.0, 48.0, 0.0, 0.0, 12.0, 29.0, 12.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 29.0, 17.0, 0.0, 48.0, 10.0, 0.0, 56.0, 0.0, 28.0, 19.0, 0.0, 0.0, 24.0, 31.0, 0.0, 0.0, 0.0, 9.0, 38.0, 0.0, 18.0, 27.0, 0.0, 0.0, 0.0, 0.0, 11.0, 36.0, 4.0, 3.0, 60.0, 56.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0033620056639152, "mean_inference_ms": 2.8111072150608836, "mean_action_processing_ms": 0.3810916093169676, "mean_env_wait_ms": 0.36016378859945614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006023883819580078, "StateBufferConnector_ms": 0.00450587272644043, "ViewRequirementAgentConnector_ms": 0.17582345008850098}, "num_episodes": 22, "episode_return_max": 268.0, "episode_return_min": -67.0, "episode_return_mean": 46.37, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.782971993692364, "num_env_steps_trained_throughput_per_sec": 58.782971993692364, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 116949.454, "restore_workers_time_ms": 0.074, "training_step_time_ms": 116949.245, "sample_time_ms": 2120.869, "learn_time_ms": 114786.348, "learn_throughput": 34.847, "synch_weights_time_ms": 38.777}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "f1691_00002", "date": "2024-08-13_19-20-03", "timestamp": 1723591203, "time_this_iter_s": 68.1095540523529, "time_total_s": 3727.821409702301, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f94550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3727.821409702301, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 61.654545454545456, "ram_util_percent": 83.74545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7592765212886863, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 1.8021078503951824, "policy_loss": -0.004400505892508639, "vf_loss": 1.8062837425047757, "vf_explained_var": 0.0020135018245252983, "kl": 0.01796951453819891, "entropy": 1.4355471922607017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.785700209423032, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.281324096709963, "policy_loss": -0.004382471765376746, "vf_loss": 4.285684203849268, "vf_explained_var": 0.1285534593794081, "kl": 0.014309977352523776, "entropy": 1.4235344027716017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -118.0, "episode_reward_mean": 44.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -220.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 110.0}, "policy_reward_mean": {"prey_policy": 9.4, "predator_policy": 12.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, -27.0, -27.0, -3.0, 0.0, 66.0, 10.0, 80.0, 9.0, -8.0, -2.0, 11.0, 81.0, -10.0, -67.0, -16.0, 28.0, 0.0, 268.0, 0.0, -5.0, -35.0, 7.0, 30.0, 62.0, 5.0, 69.0, 0.0, 121.0, 53.0, 56.0, 86.0, -47.0, 44.0, 18.0, 51.0, 40.0, -23.0, 186.0, 0.0, 143.0, 18.0, -54.0, -28.0, 1.0, 1.0, 4.0, -21.0, 130.0, -21.0, 102.0, 19.0, -37.0, 64.0, 0.0, 122.0, 14.0, 7.0, 180.0, 185.0, 129.0, 13.0, -56.0, 109.0, 115.0, -6.0, 194.0, -9.0, 136.0, 79.0, 28.0, 88.0, -25.0, 97.0, 100.0, 17.0, 0.0, 0.0, 42.0, 117.0, 192.0, 211.0, -40.0, 133.0, -6.0, 163.0, 32.0, 180.0, 48.0, 0.0, 155.0, 8.0, 34.0, 6.0, 102.0, 40.0, 72.0, -118.0, -42.0, 82.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 72.0, 0.0, -57.0, -37.0, -18.0, -6.0, 0.0, 0.0, 0.0, 66.0, 0.0, -37.0, 26.0, 0.0, 53.0, -31.0, 1.0, -34.0, 0.0, 0.0, -4.0, 11.0, 0.0, 46.0, 34.0, 7.0, -64.0, -142.0, 0.0, 0.0, -32.0, -20.0, 28.0, 0.0, 0.0, 128.0, 98.0, 0.0, 0.0, -16.0, 3.0, -6.0, -79.0, 14.0, -14.0, 20.0, -22.0, 29.0, 19.0, 0.0, 5.0, 58.0, 11.0, 0.0, 0.0, 87.0, 34.0, 11.0, -1.0, 28.0, 23.0, 19.0, 35.0, -42.0, -26.0, 46.0, -30.0, -22.0, 28.0, 0.0, 51.0, 0.0, 6.0, -4.0, -42.0, 186.0, 0.0, -4.0, -32.0, 30.0, 83.0, 0.0, 18.0, 0.0, -122.0, -38.0, -16.0, -10.0, 5.0, -30.0, 0.0, 0.0, 3.0, -2.0, -40.0, 120.0, 10.0, 0.0, -42.0, -17.0, 19.0, 19.0, 0.0, -78.0, 0.0, 37.0, -4.0, 0.0, 0.0, 124.0, -4.0, 0.0, 14.0, 1.0, -16.0, 0.0, 180.0, -4.0, 143.0, 102.0, -21.0, 3.0, 0.0, -112.0, 0.0, 24.0, 38.0, 60.0, 55.0, 0.0, -61.0, 0.0, 194.0, 0.0, -18.0, -24.0, 122.0, 70.0, -36.0, 28.0, 0.0, 88.0, 0.0, -72.0, 0.0, 74.0, 16.0, 52.0, -68.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 134.0, -96.0, -8.0, 196.0, 37.0, 155.0, -60.0, -20.0, 37.0, 62.0, -46.0, 15.0, 139.0, -73.0, -34.0, 47.0, 0.0, 176.0, 65.0, -49.0, 0.0, 0.0, 155.0, 0.0, -119.0, 66.0, 0.0, 34.0, 6.0, 0.0, 30.0, 2.0, -220.0, 137.0, -127.0, 125.0, -88.0, -140.0, -60.0, -24.0, 45.0, -26.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 30.0, 9.0, 19.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 27.0, 0.0, 14.0, 25.0, 0.0, 26.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 19.0, 28.0, 56.0, 19.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 17.0, 25.0, 0.0, 0.0, 0.0, 8.0, 30.0, 20.0, 7.0, 0.0, 21.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 32.0, 5.0, 0.0, 4.0, 28.0, 0.0, 21.0, 13.0, 15.0, 12.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 23.0, 0.0, 0.0, 34.0, 2.0, 24.0, 6.0, 0.0, 0.0, 0.0, 68.0, 16.0, 10.0, 0.0, 6.0, 31.0, 0.0, 1.0, 0.0, 1.0, 20.0, 0.0, 0.0, 21.0, 0.0, 52.0, 48.0, 0.0, 0.0, 12.0, 29.0, 12.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 29.0, 17.0, 0.0, 48.0, 10.0, 0.0, 56.0, 0.0, 28.0, 19.0, 0.0, 0.0, 24.0, 31.0, 0.0, 0.0, 0.0, 9.0, 38.0, 0.0, 18.0, 27.0, 0.0, 0.0, 0.0, 0.0, 11.0, 36.0, 4.0, 3.0, 60.0, 56.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 79.0, 0.0, 4.0, 6.0, 13.0, 10.0, 30.0, 25.0, 9.0, 16.0, 9.0, 29.0, 68.0, 2.0, 17.0, 4.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 29.0, 0.0, 0.0, 0.0, 0.0, 45.0, 25.0, 13.0, 110.0, 64.0, 10.0, 34.0, 76.0, 42.0, 0.0, 22.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0170526261864594, "mean_inference_ms": 2.8359220160026357, "mean_action_processing_ms": 0.381236264684693, "mean_env_wait_ms": 0.3609244325592497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006967663764953613, "StateBufferConnector_ms": 0.00476837158203125, "ViewRequirementAgentConnector_ms": 0.18893957138061523}, "num_episodes": 23, "episode_return_max": 268.0, "episode_return_min": -118.0, "episode_return_mean": 44.32, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.40914807998024, "num_env_steps_trained_throughput_per_sec": 309.40914807998024, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 113305.737, "restore_workers_time_ms": 0.074, "training_step_time_ms": 113305.528, "sample_time_ms": 2178.907, "learn_time_ms": 111083.832, "learn_throughput": 36.009, "synch_weights_time_ms": 39.381}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "f1691_00002", "date": "2024-08-13_19-20-16", "timestamp": 1723591216, "time_this_iter_s": 12.992108583450317, "time_total_s": 3740.8135182857513, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3740.8135182857513, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 51.55555555555555, "ram_util_percent": 83.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6622072223810449, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 2.492747836642795, "policy_loss": -0.0011336552937608706, "vf_loss": 2.493788367667526, "vf_explained_var": -0.00026397206795909415, "kl": 0.007450426736356932, "entropy": 1.377428837491091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.146735169781895, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.462370107287453, "policy_loss": -0.003853874264541205, "vf_loss": 5.466206003118445, "vf_explained_var": 0.05947499026066412, "kl": 0.011507679718067484, "entropy": 1.3224675681855944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -118.0, "episode_reward_mean": 64.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -220.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 17.03, "predator_policy": 14.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [268.0, 0.0, -5.0, -35.0, 7.0, 30.0, 62.0, 5.0, 69.0, 0.0, 121.0, 53.0, 56.0, 86.0, -47.0, 44.0, 18.0, 51.0, 40.0, -23.0, 186.0, 0.0, 143.0, 18.0, -54.0, -28.0, 1.0, 1.0, 4.0, -21.0, 130.0, -21.0, 102.0, 19.0, -37.0, 64.0, 0.0, 122.0, 14.0, 7.0, 180.0, 185.0, 129.0, 13.0, -56.0, 109.0, 115.0, -6.0, 194.0, -9.0, 136.0, 79.0, 28.0, 88.0, -25.0, 97.0, 100.0, 17.0, 0.0, 0.0, 42.0, 117.0, 192.0, 211.0, -40.0, 133.0, -6.0, 163.0, 32.0, 180.0, 48.0, 0.0, 155.0, 8.0, 34.0, 6.0, 102.0, 40.0, 72.0, -118.0, -42.0, 82.0, 190.0, 356.0, 142.0, -38.0, 331.0, -49.0, 61.0, 165.0, 253.0, 102.0, 152.0, 233.0, -18.0, 121.0, -25.0, -9.0, 26.0, 174.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.0, 98.0, 0.0, 0.0, -16.0, 3.0, -6.0, -79.0, 14.0, -14.0, 20.0, -22.0, 29.0, 19.0, 0.0, 5.0, 58.0, 11.0, 0.0, 0.0, 87.0, 34.0, 11.0, -1.0, 28.0, 23.0, 19.0, 35.0, -42.0, -26.0, 46.0, -30.0, -22.0, 28.0, 0.0, 51.0, 0.0, 6.0, -4.0, -42.0, 186.0, 0.0, -4.0, -32.0, 30.0, 83.0, 0.0, 18.0, 0.0, -122.0, -38.0, -16.0, -10.0, 5.0, -30.0, 0.0, 0.0, 3.0, -2.0, -40.0, 120.0, 10.0, 0.0, -42.0, -17.0, 19.0, 19.0, 0.0, -78.0, 0.0, 37.0, -4.0, 0.0, 0.0, 124.0, -4.0, 0.0, 14.0, 1.0, -16.0, 0.0, 180.0, -4.0, 143.0, 102.0, -21.0, 3.0, 0.0, -112.0, 0.0, 24.0, 38.0, 60.0, 55.0, 0.0, -61.0, 0.0, 194.0, 0.0, -18.0, -24.0, 122.0, 70.0, -36.0, 28.0, 0.0, 88.0, 0.0, -72.0, 0.0, 74.0, 16.0, 52.0, -68.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 134.0, -96.0, -8.0, 196.0, 37.0, 155.0, -60.0, -20.0, 37.0, 62.0, -46.0, 15.0, 139.0, -73.0, -34.0, 47.0, 0.0, 176.0, 65.0, -49.0, 0.0, 0.0, 155.0, 0.0, -119.0, 66.0, 0.0, 34.0, 6.0, 0.0, 30.0, 2.0, -220.0, 137.0, -127.0, 125.0, -88.0, -140.0, -60.0, -24.0, 45.0, -26.0, 0.0, 185.0, 176.0, 180.0, 133.0, 0.0, 0.0, -154.0, 167.0, 132.0, 0.0, -116.0, -20.0, 57.0, 0.0, 165.0, 58.0, 132.0, 53.0, 0.0, 152.0, 0.0, 148.0, 60.0, -36.0, 0.0, 121.0, 0.0, -157.0, -118.0, 15.0, -139.0, 0.0, 26.0, 168.0, 0.0], "policy_predator_policy_reward": [17.0, 25.0, 0.0, 0.0, 0.0, 8.0, 30.0, 20.0, 7.0, 0.0, 21.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 32.0, 5.0, 0.0, 4.0, 28.0, 0.0, 21.0, 13.0, 15.0, 12.0, 0.0, 0.0, 0.0, 34.0, 0.0, 0.0, 23.0, 0.0, 0.0, 34.0, 2.0, 24.0, 6.0, 0.0, 0.0, 0.0, 68.0, 16.0, 10.0, 0.0, 6.0, 31.0, 0.0, 1.0, 0.0, 1.0, 20.0, 0.0, 0.0, 21.0, 0.0, 52.0, 48.0, 0.0, 0.0, 12.0, 29.0, 12.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 29.0, 17.0, 0.0, 48.0, 10.0, 0.0, 56.0, 0.0, 28.0, 19.0, 0.0, 0.0, 24.0, 31.0, 0.0, 0.0, 0.0, 9.0, 38.0, 0.0, 18.0, 27.0, 0.0, 0.0, 0.0, 0.0, 11.0, 36.0, 4.0, 3.0, 60.0, 56.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 79.0, 0.0, 4.0, 6.0, 13.0, 10.0, 30.0, 25.0, 9.0, 16.0, 9.0, 29.0, 68.0, 2.0, 17.0, 4.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 29.0, 0.0, 0.0, 0.0, 0.0, 45.0, 25.0, 13.0, 110.0, 64.0, 10.0, 34.0, 76.0, 42.0, 0.0, 22.0, 41.0, 5.0, 0.0, 0.0, 0.0, 0.0, 9.0, 116.0, 0.0, 16.0, 16.0, 0.0, 67.0, 0.0, 24.0, 0.0, 0.0, 61.0, 2.0, 49.0, 0.0, 0.0, 0.0, 12.0, 13.0, 18.0, 0.0, 0.0, 0.0, 163.0, 87.0, 115.0, 0.0, 0.0, 0.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0327549533589402, "mean_inference_ms": 2.8723138719804706, "mean_action_processing_ms": 0.38344287054469034, "mean_env_wait_ms": 0.36483613188631364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007046937942504883, "StateBufferConnector_ms": 0.004629611968994141, "ViewRequirementAgentConnector_ms": 0.2435131072998047}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -118.0, "episode_return_mean": 64.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.8803777576796, "num_env_steps_trained_throughput_per_sec": 295.8803777576796, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 113446.472, "restore_workers_time_ms": 0.077, "training_step_time_ms": 113446.258, "sample_time_ms": 2266.349, "learn_time_ms": 111136.478, "learn_throughput": 35.992, "synch_weights_time_ms": 39.517}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "f1691_00002", "date": "2024-08-13_19-20-30", "timestamp": 1723591230, "time_this_iter_s": 13.594117879867554, "time_total_s": 3754.407636165619, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f94e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3754.407636165619, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 54.284210526315796, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6488794675067303, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 1.8407521706409555, "policy_loss": -0.007465262277416451, "vf_loss": 1.8479414721645375, "vf_explained_var": -0.0014188782878653712, "kl": 0.022077270459351303, "entropy": 1.3653741589298956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.365921292150462, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.072969855076422, "policy_loss": -0.0017606025129290564, "vf_loss": 4.074716755826637, "vf_explained_var": 0.09435136015453036, "kl": 0.008772946412446804, "entropy": 1.3770993958705318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -174.0, "episode_reward_mean": 68.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -220.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 17.425, "predator_policy": 16.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, -23.0, 186.0, 0.0, 143.0, 18.0, -54.0, -28.0, 1.0, 1.0, 4.0, -21.0, 130.0, -21.0, 102.0, 19.0, -37.0, 64.0, 0.0, 122.0, 14.0, 7.0, 180.0, 185.0, 129.0, 13.0, -56.0, 109.0, 115.0, -6.0, 194.0, -9.0, 136.0, 79.0, 28.0, 88.0, -25.0, 97.0, 100.0, 17.0, 0.0, 0.0, 42.0, 117.0, 192.0, 211.0, -40.0, 133.0, -6.0, 163.0, 32.0, 180.0, 48.0, 0.0, 155.0, 8.0, 34.0, 6.0, 102.0, 40.0, 72.0, -118.0, -42.0, 82.0, 190.0, 356.0, 142.0, -38.0, 331.0, -49.0, 61.0, 165.0, 253.0, 102.0, 152.0, 233.0, -18.0, 121.0, -25.0, -9.0, 26.0, 174.0, 163.0, 132.0, 94.0, 0.0, 34.0, 89.0, 376.0, 278.0, -41.0, 18.0, 72.0, 38.0, 20.0, 21.0, -16.0, -174.0, 107.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 6.0, -4.0, -42.0, 186.0, 0.0, -4.0, -32.0, 30.0, 83.0, 0.0, 18.0, 0.0, -122.0, -38.0, -16.0, -10.0, 5.0, -30.0, 0.0, 0.0, 3.0, -2.0, -40.0, 120.0, 10.0, 0.0, -42.0, -17.0, 19.0, 19.0, 0.0, -78.0, 0.0, 37.0, -4.0, 0.0, 0.0, 124.0, -4.0, 0.0, 14.0, 1.0, -16.0, 0.0, 180.0, -4.0, 143.0, 102.0, -21.0, 3.0, 0.0, -112.0, 0.0, 24.0, 38.0, 60.0, 55.0, 0.0, -61.0, 0.0, 194.0, 0.0, -18.0, -24.0, 122.0, 70.0, -36.0, 28.0, 0.0, 88.0, 0.0, -72.0, 0.0, 74.0, 16.0, 52.0, -68.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 134.0, -96.0, -8.0, 196.0, 37.0, 155.0, -60.0, -20.0, 37.0, 62.0, -46.0, 15.0, 139.0, -73.0, -34.0, 47.0, 0.0, 176.0, 65.0, -49.0, 0.0, 0.0, 155.0, 0.0, -119.0, 66.0, 0.0, 34.0, 6.0, 0.0, 30.0, 2.0, -220.0, 137.0, -127.0, 125.0, -88.0, -140.0, -60.0, -24.0, 45.0, -26.0, 0.0, 185.0, 176.0, 180.0, 133.0, 0.0, 0.0, -154.0, 167.0, 132.0, 0.0, -116.0, -20.0, 57.0, 0.0, 165.0, 58.0, 132.0, 53.0, 0.0, 152.0, 0.0, 148.0, 60.0, -36.0, 0.0, 121.0, 0.0, -157.0, -118.0, 15.0, -139.0, 0.0, 26.0, 168.0, 0.0, -4.0, 162.0, 89.0, 25.0, 0.0, 41.0, 0.0, 0.0, -47.0, 0.0, 89.0, 0.0, 187.0, 186.0, 185.0, 93.0, 0.0, -82.0, 0.0, 11.0, 0.0, 49.0, -31.0, -10.0, 10.0, 3.0, 17.0, -6.0, -32.0, 0.0, -177.0, -215.0, 107.0, -82.0, 0.0, 0.0], "policy_predator_policy_reward": [34.0, 0.0, 0.0, 23.0, 0.0, 0.0, 34.0, 2.0, 24.0, 6.0, 0.0, 0.0, 0.0, 68.0, 16.0, 10.0, 0.0, 6.0, 31.0, 0.0, 1.0, 0.0, 1.0, 20.0, 0.0, 0.0, 21.0, 0.0, 52.0, 48.0, 0.0, 0.0, 12.0, 29.0, 12.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 29.0, 17.0, 0.0, 48.0, 10.0, 0.0, 56.0, 0.0, 28.0, 19.0, 0.0, 0.0, 24.0, 31.0, 0.0, 0.0, 0.0, 9.0, 38.0, 0.0, 18.0, 27.0, 0.0, 0.0, 0.0, 0.0, 11.0, 36.0, 4.0, 3.0, 60.0, 56.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 79.0, 0.0, 4.0, 6.0, 13.0, 10.0, 30.0, 25.0, 9.0, 16.0, 9.0, 29.0, 68.0, 2.0, 17.0, 4.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 29.0, 0.0, 0.0, 0.0, 0.0, 45.0, 25.0, 13.0, 110.0, 64.0, 10.0, 34.0, 76.0, 42.0, 0.0, 22.0, 41.0, 5.0, 0.0, 0.0, 0.0, 0.0, 9.0, 116.0, 0.0, 16.0, 16.0, 0.0, 67.0, 0.0, 24.0, 0.0, 0.0, 61.0, 2.0, 49.0, 0.0, 0.0, 0.0, 12.0, 13.0, 18.0, 0.0, 0.0, 0.0, 163.0, 87.0, 115.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 18.0, 0.0, 53.0, 0.0, 0.0, 80.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 41.0, 0.0, 7.0, 0.0, 23.0, 0.0, 0.0, 79.0, 6.0, 1.0, 7.0, 3.0, 0.0, 16.0, 63.0, 155.0, 42.0, 40.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0485332002995664, "mean_inference_ms": 2.9077376441623586, "mean_action_processing_ms": 0.3856561804941884, "mean_env_wait_ms": 0.368590933471261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006997346878051758, "StateBufferConnector_ms": 0.004636645317077637, "ViewRequirementAgentConnector_ms": 0.2438429594039917}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -174.0, "episode_return_mean": 68.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.52865996477885, "num_env_steps_trained_throughput_per_sec": 330.52865996477885, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 113001.026, "restore_workers_time_ms": 0.078, "training_step_time_ms": 113000.811, "sample_time_ms": 2215.489, "learn_time_ms": 110741.459, "learn_throughput": 36.12, "synch_weights_time_ms": 40.174}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "f1691_00002", "date": "2024-08-13_19-20-42", "timestamp": 1723591242, "time_this_iter_s": 12.144392967224121, "time_total_s": 3766.552029132843, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3766.552029132843, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 50.61176470588236, "ram_util_percent": 83.56470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6568859539807789, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.968719034598618, "policy_loss": -0.004991616818945481, "vf_loss": 3.9734293377588665, "vf_explained_var": 0.0012629276230221704, "kl": 0.015003784870219382, "entropy": 1.3524939309352288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.54970829075291, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.604328149714798, "policy_loss": -0.003800458353623827, "vf_loss": 6.6081085366546795, "vf_explained_var": 0.024836031185886846, "kl": 0.012834333920850687, "entropy": 1.3352016471050403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -174.0, "episode_reward_mean": 75.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -220.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 17.825, "predator_policy": 19.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 122.0, 14.0, 7.0, 180.0, 185.0, 129.0, 13.0, -56.0, 109.0, 115.0, -6.0, 194.0, -9.0, 136.0, 79.0, 28.0, 88.0, -25.0, 97.0, 100.0, 17.0, 0.0, 0.0, 42.0, 117.0, 192.0, 211.0, -40.0, 133.0, -6.0, 163.0, 32.0, 180.0, 48.0, 0.0, 155.0, 8.0, 34.0, 6.0, 102.0, 40.0, 72.0, -118.0, -42.0, 82.0, 190.0, 356.0, 142.0, -38.0, 331.0, -49.0, 61.0, 165.0, 253.0, 102.0, 152.0, 233.0, -18.0, 121.0, -25.0, -9.0, 26.0, 174.0, 163.0, 132.0, 94.0, 0.0, 34.0, 89.0, 376.0, 278.0, -41.0, 18.0, 72.0, 38.0, 20.0, 21.0, -16.0, -174.0, 107.0, 0.0, 174.0, 45.0, -18.0, 111.0, 266.0, -57.0, -27.0, 68.0, 180.0, -7.0, 45.0, -42.0, 16.0, 244.0, 76.0, 1.0, -9.0, 157.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 124.0, -4.0, 0.0, 14.0, 1.0, -16.0, 0.0, 180.0, -4.0, 143.0, 102.0, -21.0, 3.0, 0.0, -112.0, 0.0, 24.0, 38.0, 60.0, 55.0, 0.0, -61.0, 0.0, 194.0, 0.0, -18.0, -24.0, 122.0, 70.0, -36.0, 28.0, 0.0, 88.0, 0.0, -72.0, 0.0, 74.0, 16.0, 52.0, -68.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 134.0, -96.0, -8.0, 196.0, 37.0, 155.0, -60.0, -20.0, 37.0, 62.0, -46.0, 15.0, 139.0, -73.0, -34.0, 47.0, 0.0, 176.0, 65.0, -49.0, 0.0, 0.0, 155.0, 0.0, -119.0, 66.0, 0.0, 34.0, 6.0, 0.0, 30.0, 2.0, -220.0, 137.0, -127.0, 125.0, -88.0, -140.0, -60.0, -24.0, 45.0, -26.0, 0.0, 185.0, 176.0, 180.0, 133.0, 0.0, 0.0, -154.0, 167.0, 132.0, 0.0, -116.0, -20.0, 57.0, 0.0, 165.0, 58.0, 132.0, 53.0, 0.0, 152.0, 0.0, 148.0, 60.0, -36.0, 0.0, 121.0, 0.0, -157.0, -118.0, 15.0, -139.0, 0.0, 26.0, 168.0, 0.0, -4.0, 162.0, 89.0, 25.0, 0.0, 41.0, 0.0, 0.0, -47.0, 0.0, 89.0, 0.0, 187.0, 186.0, 185.0, 93.0, 0.0, -82.0, 0.0, 11.0, 0.0, 49.0, -31.0, -10.0, 10.0, 3.0, 17.0, -6.0, -32.0, 0.0, -177.0, -215.0, 107.0, -82.0, 0.0, 0.0, 13.0, 159.0, 0.0, 43.0, -20.0, -12.0, 90.0, -77.0, 30.0, 188.0, -14.0, -154.0, -85.0, -193.0, 28.0, 0.0, 173.0, -4.0, 0.0, -103.0, 0.0, 45.0, -178.0, 35.0, 0.0, 8.0, 155.0, 29.0, -58.0, 2.0, 4.0, -20.0, 0.0, -18.0, 120.0, -51.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 29.0, 17.0, 0.0, 48.0, 10.0, 0.0, 56.0, 0.0, 28.0, 19.0, 0.0, 0.0, 24.0, 31.0, 0.0, 0.0, 0.0, 9.0, 38.0, 0.0, 18.0, 27.0, 0.0, 0.0, 0.0, 0.0, 11.0, 36.0, 4.0, 3.0, 60.0, 56.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 79.0, 0.0, 4.0, 6.0, 13.0, 10.0, 30.0, 25.0, 9.0, 16.0, 9.0, 29.0, 68.0, 2.0, 17.0, 4.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 29.0, 0.0, 0.0, 0.0, 0.0, 45.0, 25.0, 13.0, 110.0, 64.0, 10.0, 34.0, 76.0, 42.0, 0.0, 22.0, 41.0, 5.0, 0.0, 0.0, 0.0, 0.0, 9.0, 116.0, 0.0, 16.0, 16.0, 0.0, 67.0, 0.0, 24.0, 0.0, 0.0, 61.0, 2.0, 49.0, 0.0, 0.0, 0.0, 12.0, 13.0, 18.0, 0.0, 0.0, 0.0, 163.0, 87.0, 115.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 18.0, 0.0, 53.0, 0.0, 0.0, 80.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 41.0, 0.0, 7.0, 0.0, 23.0, 0.0, 0.0, 79.0, 6.0, 1.0, 7.0, 3.0, 0.0, 16.0, 63.0, 155.0, 42.0, 40.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 14.0, 0.0, 54.0, 44.0, 14.0, 34.0, 111.0, 0.0, 118.0, 133.0, 0.0, 40.0, 0.0, 11.0, 53.0, 43.0, 0.0, 0.0, 9.0, 92.0, 8.0, 0.0, 0.0, 60.0, 78.0, 54.0, 0.0, 17.0, 9.0, 0.0, 56.0, 32.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0482783558424444, "mean_inference_ms": 2.90587125005728, "mean_action_processing_ms": 0.3843058795470698, "mean_env_wait_ms": 0.36748295398934855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006473660469055176, "StateBufferConnector_ms": 0.003567337989807129, "ViewRequirementAgentConnector_ms": 0.20704114437103271}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -174.0, "episode_return_mean": 75.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 119.86665101425693, "num_env_steps_trained_throughput_per_sec": 119.86665101425693, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 114958.514, "restore_workers_time_ms": 0.078, "training_step_time_ms": 114958.296, "sample_time_ms": 2236.071, "learn_time_ms": 112679.988, "learn_throughput": 35.499, "synch_weights_time_ms": 38.366}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "f1691_00002", "date": "2024-08-13_19-21-16", "timestamp": 1723591276, "time_this_iter_s": 33.3843879699707, "time_total_s": 3799.9364171028137, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f953a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3799.9364171028137, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 74.896, "ram_util_percent": 83.80799999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7654272538723138, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.946570093795736, "policy_loss": -0.00487641922158815, "vf_loss": 3.9511560163800676, "vf_explained_var": 0.0019326383790011128, "kl": 0.015492655491713834, "entropy": 1.4144302838693852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.779502258020104, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 7.662044209273404, "policy_loss": -0.0037850069769081616, "vf_loss": 7.665806652755333, "vf_explained_var": 0.14502342150955605, "kl": 0.014443671489076831, "entropy": 1.2978904794763635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -286.0, "episode_reward_mean": 89.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 18.795, "predator_policy": 25.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.0, -40.0, 133.0, -6.0, 163.0, 32.0, 180.0, 48.0, 0.0, 155.0, 8.0, 34.0, 6.0, 102.0, 40.0, 72.0, -118.0, -42.0, 82.0, 190.0, 356.0, 142.0, -38.0, 331.0, -49.0, 61.0, 165.0, 253.0, 102.0, 152.0, 233.0, -18.0, 121.0, -25.0, -9.0, 26.0, 174.0, 163.0, 132.0, 94.0, 0.0, 34.0, 89.0, 376.0, 278.0, -41.0, 18.0, 72.0, 38.0, 20.0, 21.0, -16.0, -174.0, 107.0, 0.0, 174.0, 45.0, -18.0, 111.0, 266.0, -57.0, -27.0, 68.0, 180.0, -7.0, 45.0, -42.0, 16.0, 244.0, 76.0, 1.0, -9.0, 157.0, -286.0, 98.0, 3.0, 246.0, 164.0, 343.0, 306.0, 221.0, 333.0, -38.0, 298.0, 76.0, 134.0, 225.0, 4.0, 286.0, -49.0, 162.0, 43.0, 40.0, 83.0, 383.0, 188.0, 95.0, -78.0, -46.0, 43.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [37.0, 155.0, -60.0, -20.0, 37.0, 62.0, -46.0, 15.0, 139.0, -73.0, -34.0, 47.0, 0.0, 176.0, 65.0, -49.0, 0.0, 0.0, 155.0, 0.0, -119.0, 66.0, 0.0, 34.0, 6.0, 0.0, 30.0, 2.0, -220.0, 137.0, -127.0, 125.0, -88.0, -140.0, -60.0, -24.0, 45.0, -26.0, 0.0, 185.0, 176.0, 180.0, 133.0, 0.0, 0.0, -154.0, 167.0, 132.0, 0.0, -116.0, -20.0, 57.0, 0.0, 165.0, 58.0, 132.0, 53.0, 0.0, 152.0, 0.0, 148.0, 60.0, -36.0, 0.0, 121.0, 0.0, -157.0, -118.0, 15.0, -139.0, 0.0, 26.0, 168.0, 0.0, -4.0, 162.0, 89.0, 25.0, 0.0, 41.0, 0.0, 0.0, -47.0, 0.0, 89.0, 0.0, 187.0, 186.0, 185.0, 93.0, 0.0, -82.0, 0.0, 11.0, 0.0, 49.0, -31.0, -10.0, 10.0, 3.0, 17.0, -6.0, -32.0, 0.0, -177.0, -215.0, 107.0, -82.0, 0.0, 0.0, 13.0, 159.0, 0.0, 43.0, -20.0, -12.0, 90.0, -77.0, 30.0, 188.0, -14.0, -154.0, -85.0, -193.0, 28.0, 0.0, 173.0, -4.0, 0.0, -103.0, 0.0, 45.0, -178.0, 35.0, 0.0, 8.0, 155.0, 29.0, -58.0, 2.0, 4.0, -20.0, 0.0, -18.0, 120.0, -51.0, -192.0, -293.0, 125.0, -56.0, -53.0, -55.0, 78.0, 168.0, 0.0, 164.0, 141.0, 200.0, 129.0, 177.0, 7.0, 107.0, 156.0, 146.0, 0.0, -176.0, 101.0, 170.0, 42.0, -75.0, 0.0, 109.0, 161.0, 27.0, -252.0, 33.0, 68.0, 186.0, -18.0, -192.0, 0.0, 152.0, -22.0, -29.0, -196.0, 107.0, 59.0, -2.0, 199.0, 184.0, -34.0, 133.0, 0.0, 45.0, -71.0, -107.0, -55.0, -85.0, 0.0, 10.0], "policy_predator_policy_reward": [6.0, 13.0, 10.0, 30.0, 25.0, 9.0, 16.0, 9.0, 29.0, 68.0, 2.0, 17.0, 4.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 32.0, 29.0, 0.0, 0.0, 0.0, 0.0, 45.0, 25.0, 13.0, 110.0, 64.0, 10.0, 34.0, 76.0, 42.0, 0.0, 22.0, 41.0, 5.0, 0.0, 0.0, 0.0, 0.0, 9.0, 116.0, 0.0, 16.0, 16.0, 0.0, 67.0, 0.0, 24.0, 0.0, 0.0, 61.0, 2.0, 49.0, 0.0, 0.0, 0.0, 12.0, 13.0, 18.0, 0.0, 0.0, 0.0, 163.0, 87.0, 115.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 18.0, 0.0, 53.0, 0.0, 0.0, 80.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 41.0, 0.0, 7.0, 0.0, 23.0, 0.0, 0.0, 79.0, 6.0, 1.0, 7.0, 3.0, 0.0, 16.0, 63.0, 155.0, 42.0, 40.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 14.0, 0.0, 54.0, 44.0, 14.0, 34.0, 111.0, 0.0, 118.0, 133.0, 0.0, 40.0, 0.0, 11.0, 53.0, 43.0, 0.0, 0.0, 9.0, 92.0, 8.0, 0.0, 0.0, 60.0, 78.0, 54.0, 0.0, 17.0, 9.0, 0.0, 56.0, 32.0, 141.0, 58.0, 29.0, 0.0, 0.0, 111.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 59.0, 48.0, 28.0, 3.0, 88.0, 50.0, 27.0, 0.0, 40.0, 69.0, 17.0, 8.0, 0.0, 37.0, 106.0, 117.0, 29.0, 3.0, 65.0, 96.0, 0.0, 10.0, 69.0, 25.0, 31.0, 98.0, 1.0, 25.0, 0.0, 0.0, 9.0, 80.0, 48.0, 2.0, 54.0, 46.0, 9.0, 85.0, 25.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0348377467411394, "mean_inference_ms": 2.872082879467772, "mean_action_processing_ms": 0.38070405831924164, "mean_env_wait_ms": 0.3629845001026283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005059242248535156, "StateBufferConnector_ms": 0.0036591291427612305, "ViewRequirementAgentConnector_ms": 0.16415107250213623}, "num_episodes": 27, "episode_return_max": 383.0, "episode_return_min": -286.0, "episode_return_mean": 89.38, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.72807489948866, "num_env_steps_trained_throughput_per_sec": 320.72807489948866, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 97350.403, "restore_workers_time_ms": 0.078, "training_step_time_ms": 97350.185, "sample_time_ms": 2193.067, "learn_time_ms": 95115.036, "learn_throughput": 42.054, "synch_weights_time_ms": 38.319}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "f1691_00002", "date": "2024-08-13_19-21-28", "timestamp": 1723591288, "time_this_iter_s": 12.503628015518188, "time_total_s": 3812.440045118332, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fd9550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3812.440045118332, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 53.294117647058826, "ram_util_percent": 81.6705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8964623563622356, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.785487446835432, "policy_loss": -0.008933527351519656, "vf_loss": 3.7941614943206625, "vf_explained_var": 0.004266688054200833, "kl": 0.013838844267163461, "entropy": 1.393562514189059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.809402509609228, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.656260237365803, "policy_loss": -0.0034742741163071027, "vf_loss": 6.659718332845698, "vf_explained_var": 0.2198148614199704, "kl": 0.01034930228678255, "entropy": 1.3251089471988577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -286.0, "episode_reward_mean": 95.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 163.0}, "policy_reward_mean": {"prey_policy": 19.65, "predator_policy": 27.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.0, 190.0, 356.0, 142.0, -38.0, 331.0, -49.0, 61.0, 165.0, 253.0, 102.0, 152.0, 233.0, -18.0, 121.0, -25.0, -9.0, 26.0, 174.0, 163.0, 132.0, 94.0, 0.0, 34.0, 89.0, 376.0, 278.0, -41.0, 18.0, 72.0, 38.0, 20.0, 21.0, -16.0, -174.0, 107.0, 0.0, 174.0, 45.0, -18.0, 111.0, 266.0, -57.0, -27.0, 68.0, 180.0, -7.0, 45.0, -42.0, 16.0, 244.0, 76.0, 1.0, -9.0, 157.0, -286.0, 98.0, 3.0, 246.0, 164.0, 343.0, 306.0, 221.0, 333.0, -38.0, 298.0, 76.0, 134.0, 225.0, 4.0, 286.0, -49.0, 162.0, 43.0, 40.0, 83.0, 383.0, 188.0, 95.0, -78.0, -46.0, 43.0, 155.0, 77.0, -1.0, 141.0, 69.0, -64.0, 143.0, -164.0, -6.0, 371.0, 0.0, 98.0, -13.0, 20.0, 136.0, 84.0, 216.0, 293.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [45.0, -26.0, 0.0, 185.0, 176.0, 180.0, 133.0, 0.0, 0.0, -154.0, 167.0, 132.0, 0.0, -116.0, -20.0, 57.0, 0.0, 165.0, 58.0, 132.0, 53.0, 0.0, 152.0, 0.0, 148.0, 60.0, -36.0, 0.0, 121.0, 0.0, -157.0, -118.0, 15.0, -139.0, 0.0, 26.0, 168.0, 0.0, -4.0, 162.0, 89.0, 25.0, 0.0, 41.0, 0.0, 0.0, -47.0, 0.0, 89.0, 0.0, 187.0, 186.0, 185.0, 93.0, 0.0, -82.0, 0.0, 11.0, 0.0, 49.0, -31.0, -10.0, 10.0, 3.0, 17.0, -6.0, -32.0, 0.0, -177.0, -215.0, 107.0, -82.0, 0.0, 0.0, 13.0, 159.0, 0.0, 43.0, -20.0, -12.0, 90.0, -77.0, 30.0, 188.0, -14.0, -154.0, -85.0, -193.0, 28.0, 0.0, 173.0, -4.0, 0.0, -103.0, 0.0, 45.0, -178.0, 35.0, 0.0, 8.0, 155.0, 29.0, -58.0, 2.0, 4.0, -20.0, 0.0, -18.0, 120.0, -51.0, -192.0, -293.0, 125.0, -56.0, -53.0, -55.0, 78.0, 168.0, 0.0, 164.0, 141.0, 200.0, 129.0, 177.0, 7.0, 107.0, 156.0, 146.0, 0.0, -176.0, 101.0, 170.0, 42.0, -75.0, 0.0, 109.0, 161.0, 27.0, -252.0, 33.0, 68.0, 186.0, -18.0, -192.0, 0.0, 152.0, -22.0, -29.0, -196.0, 107.0, 59.0, -2.0, 199.0, 184.0, -34.0, 133.0, 0.0, 45.0, -71.0, -107.0, -55.0, -85.0, 0.0, 10.0, -40.0, 93.0, 0.0, 47.0, 0.0, -2.0, -19.0, 104.0, 0.0, 14.0, -88.0, -101.0, 61.0, 11.0, -106.0, -120.0, 0.0, -129.0, 191.0, 174.0, 0.0, 0.0, 12.0, -1.0, -72.0, -34.0, 0.0, -53.0, 0.0, 104.0, 8.0, 14.0, 148.0, -1.0, 200.0, -16.0], "policy_predator_policy_reward": [22.0, 41.0, 5.0, 0.0, 0.0, 0.0, 0.0, 9.0, 116.0, 0.0, 16.0, 16.0, 0.0, 67.0, 0.0, 24.0, 0.0, 0.0, 61.0, 2.0, 49.0, 0.0, 0.0, 0.0, 12.0, 13.0, 18.0, 0.0, 0.0, 0.0, 163.0, 87.0, 115.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 18.0, 0.0, 53.0, 0.0, 0.0, 80.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 41.0, 0.0, 7.0, 0.0, 23.0, 0.0, 0.0, 79.0, 6.0, 1.0, 7.0, 3.0, 0.0, 16.0, 63.0, 155.0, 42.0, 40.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 14.0, 0.0, 54.0, 44.0, 14.0, 34.0, 111.0, 0.0, 118.0, 133.0, 0.0, 40.0, 0.0, 11.0, 53.0, 43.0, 0.0, 0.0, 9.0, 92.0, 8.0, 0.0, 0.0, 60.0, 78.0, 54.0, 0.0, 17.0, 9.0, 0.0, 56.0, 32.0, 141.0, 58.0, 29.0, 0.0, 0.0, 111.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 59.0, 48.0, 28.0, 3.0, 88.0, 50.0, 27.0, 0.0, 40.0, 69.0, 17.0, 8.0, 0.0, 37.0, 106.0, 117.0, 29.0, 3.0, 65.0, 96.0, 0.0, 10.0, 69.0, 25.0, 31.0, 98.0, 1.0, 25.0, 0.0, 0.0, 9.0, 80.0, 48.0, 2.0, 54.0, 46.0, 9.0, 85.0, 25.0, 8.0, 63.0, 39.0, 0.0, 30.0, 1.0, 0.0, 19.0, 37.0, 0.0, 55.0, 35.0, 90.0, 41.0, 30.0, 62.0, 0.0, 61.0, 62.0, 6.0, 0.0, 0.0, 0.0, 45.0, 42.0, 38.0, 55.0, 19.0, 54.0, 32.0, 0.0, 62.0, 0.0, 0.0, 69.0, 55.0, 54.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0270697561298383, "mean_inference_ms": 2.866484581393121, "mean_action_processing_ms": 0.3783235445569994, "mean_env_wait_ms": 0.3598514861781094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005084633827209473, "StateBufferConnector_ms": 0.003587484359741211, "ViewRequirementAgentConnector_ms": 0.15784049034118652}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -286.0, "episode_return_mean": 95.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.45727539353425, "num_env_steps_trained_throughput_per_sec": 322.45727539353425, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 97378.144, "restore_workers_time_ms": 0.079, "training_step_time_ms": 97377.926, "sample_time_ms": 2201.303, "learn_time_ms": 95135.593, "learn_throughput": 42.045, "synch_weights_time_ms": 37.235}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "f1691_00002", "date": "2024-08-13_19-21-41", "timestamp": 1723591301, "time_this_iter_s": 12.452901124954224, "time_total_s": 3824.892946243286, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fd9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3824.892946243286, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 51.45555555555555, "ram_util_percent": 82.42777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0226452255138645, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.9903590868389798, "policy_loss": -0.0028916387127037283, "vf_loss": 3.992982928336613, "vf_explained_var": 0.024393558880639456, "kl": 0.014281908305238067, "entropy": 1.4536235034781158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.50261366290075, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 7.189211298170544, "policy_loss": -0.004456244474868217, "vf_loss": 7.193648079715708, "vf_explained_var": 0.08445800672132502, "kl": 0.012451958064410011, "entropy": 1.2810087496010716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -286.0, "episode_reward_mean": 89.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 13.22, "predator_policy": 31.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 163.0, 132.0, 94.0, 0.0, 34.0, 89.0, 376.0, 278.0, -41.0, 18.0, 72.0, 38.0, 20.0, 21.0, -16.0, -174.0, 107.0, 0.0, 174.0, 45.0, -18.0, 111.0, 266.0, -57.0, -27.0, 68.0, 180.0, -7.0, 45.0, -42.0, 16.0, 244.0, 76.0, 1.0, -9.0, 157.0, -286.0, 98.0, 3.0, 246.0, 164.0, 343.0, 306.0, 221.0, 333.0, -38.0, 298.0, 76.0, 134.0, 225.0, 4.0, 286.0, -49.0, 162.0, 43.0, 40.0, 83.0, 383.0, 188.0, 95.0, -78.0, -46.0, 43.0, 155.0, 77.0, -1.0, 141.0, 69.0, -64.0, 143.0, -164.0, -6.0, 371.0, 0.0, 98.0, -13.0, 20.0, 136.0, 84.0, 216.0, 293.0, 42.0, 109.0, 121.0, 81.0, 13.0, 207.0, 18.0, -253.0, 33.0, 165.0, 129.0, 40.0, 349.0, 116.0, -72.0, 153.0, 26.0, 198.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [168.0, 0.0, -4.0, 162.0, 89.0, 25.0, 0.0, 41.0, 0.0, 0.0, -47.0, 0.0, 89.0, 0.0, 187.0, 186.0, 185.0, 93.0, 0.0, -82.0, 0.0, 11.0, 0.0, 49.0, -31.0, -10.0, 10.0, 3.0, 17.0, -6.0, -32.0, 0.0, -177.0, -215.0, 107.0, -82.0, 0.0, 0.0, 13.0, 159.0, 0.0, 43.0, -20.0, -12.0, 90.0, -77.0, 30.0, 188.0, -14.0, -154.0, -85.0, -193.0, 28.0, 0.0, 173.0, -4.0, 0.0, -103.0, 0.0, 45.0, -178.0, 35.0, 0.0, 8.0, 155.0, 29.0, -58.0, 2.0, 4.0, -20.0, 0.0, -18.0, 120.0, -51.0, -192.0, -293.0, 125.0, -56.0, -53.0, -55.0, 78.0, 168.0, 0.0, 164.0, 141.0, 200.0, 129.0, 177.0, 7.0, 107.0, 156.0, 146.0, 0.0, -176.0, 101.0, 170.0, 42.0, -75.0, 0.0, 109.0, 161.0, 27.0, -252.0, 33.0, 68.0, 186.0, -18.0, -192.0, 0.0, 152.0, -22.0, -29.0, -196.0, 107.0, 59.0, -2.0, 199.0, 184.0, -34.0, 133.0, 0.0, 45.0, -71.0, -107.0, -55.0, -85.0, 0.0, 10.0, -40.0, 93.0, 0.0, 47.0, 0.0, -2.0, -19.0, 104.0, 0.0, 14.0, -88.0, -101.0, 61.0, 11.0, -106.0, -120.0, 0.0, -129.0, 191.0, 174.0, 0.0, 0.0, 12.0, -1.0, -72.0, -34.0, 0.0, -53.0, 0.0, 104.0, 8.0, 14.0, 148.0, -1.0, 200.0, -16.0, -58.0, 30.0, 44.0, -76.0, 64.0, -61.0, -7.0, 14.0, -138.0, 61.0, 52.0, 113.0, -18.0, 27.0, -166.0, -219.0, -104.0, 45.0, 153.0, 0.0, 58.0, -46.0, -46.0, -17.0, 155.0, 187.0, -36.0, 60.0, -69.0, -160.0, 135.0, 0.0, -160.0, -62.0, 198.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 5.0, 0.0, 18.0, 0.0, 53.0, 0.0, 0.0, 80.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 41.0, 0.0, 7.0, 0.0, 23.0, 0.0, 0.0, 79.0, 6.0, 1.0, 7.0, 3.0, 0.0, 16.0, 63.0, 155.0, 42.0, 40.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 14.0, 0.0, 54.0, 44.0, 14.0, 34.0, 111.0, 0.0, 118.0, 133.0, 0.0, 40.0, 0.0, 11.0, 53.0, 43.0, 0.0, 0.0, 9.0, 92.0, 8.0, 0.0, 0.0, 60.0, 78.0, 54.0, 0.0, 17.0, 9.0, 0.0, 56.0, 32.0, 141.0, 58.0, 29.0, 0.0, 0.0, 111.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 59.0, 48.0, 28.0, 3.0, 88.0, 50.0, 27.0, 0.0, 40.0, 69.0, 17.0, 8.0, 0.0, 37.0, 106.0, 117.0, 29.0, 3.0, 65.0, 96.0, 0.0, 10.0, 69.0, 25.0, 31.0, 98.0, 1.0, 25.0, 0.0, 0.0, 9.0, 80.0, 48.0, 2.0, 54.0, 46.0, 9.0, 85.0, 25.0, 8.0, 63.0, 39.0, 0.0, 30.0, 1.0, 0.0, 19.0, 37.0, 0.0, 55.0, 35.0, 90.0, 41.0, 30.0, 62.0, 0.0, 61.0, 62.0, 6.0, 0.0, 0.0, 0.0, 45.0, 42.0, 38.0, 55.0, 19.0, 54.0, 32.0, 0.0, 62.0, 0.0, 0.0, 69.0, 55.0, 54.0, 0.0, 70.0, 77.0, 64.0, 30.0, 88.0, 39.0, 35.0, 69.0, 21.0, 38.0, 4.0, 9.0, 0.0, 110.0, 22.0, 24.0, 68.0, 12.0, 0.0, 67.0, 50.0, 74.0, 29.0, 0.0, 7.0, 4.0, 88.0, 98.0, 59.0, 10.0, 8.0, 133.0, 115.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0152310035521435, "mean_inference_ms": 2.8406500634270424, "mean_action_processing_ms": 0.3743589383918993, "mean_env_wait_ms": 0.35549929394648655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054929256439208984, "StateBufferConnector_ms": 0.0036689043045043945, "ViewRequirementAgentConnector_ms": 0.10557031631469727}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -286.0, "episode_return_mean": 89.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.75608872436754, "num_env_steps_trained_throughput_per_sec": 293.75608872436754, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 97447.839, "restore_workers_time_ms": 0.079, "training_step_time_ms": 97447.619, "sample_time_ms": 2246.382, "learn_time_ms": 95159.56, "learn_throughput": 42.035, "synch_weights_time_ms": 37.026}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "f1691_00002", "date": "2024-08-13_19-21-54", "timestamp": 1723591314, "time_this_iter_s": 13.662888050079346, "time_total_s": 3838.5558342933655, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f94550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3838.5558342933655, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 59.735000000000014, "ram_util_percent": 83.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9559515108901356, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 5.051181812765737, "policy_loss": -0.00423563988435836, "vf_loss": 5.055211645837814, "vf_explained_var": 0.008772197696897719, "kl": 0.010976654185928733, "entropy": 1.4639460708729173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.66314322568437, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.071935393570592, "policy_loss": -0.0020641641229361533, "vf_loss": 6.073981015139787, "vf_explained_var": -0.014905224306873544, "kl": 0.011884592896826938, "entropy": 1.3141254137432765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -286.0, "episode_reward_mean": 87.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 141.0}, "policy_reward_mean": {"prey_policy": 8.98, "predator_policy": 34.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 174.0, 45.0, -18.0, 111.0, 266.0, -57.0, -27.0, 68.0, 180.0, -7.0, 45.0, -42.0, 16.0, 244.0, 76.0, 1.0, -9.0, 157.0, -286.0, 98.0, 3.0, 246.0, 164.0, 343.0, 306.0, 221.0, 333.0, -38.0, 298.0, 76.0, 134.0, 225.0, 4.0, 286.0, -49.0, 162.0, 43.0, 40.0, 83.0, 383.0, 188.0, 95.0, -78.0, -46.0, 43.0, 155.0, 77.0, -1.0, 141.0, 69.0, -64.0, 143.0, -164.0, -6.0, 371.0, 0.0, 98.0, -13.0, 20.0, 136.0, 84.0, 216.0, 293.0, 42.0, 109.0, 121.0, 81.0, 13.0, 207.0, 18.0, -253.0, 33.0, 165.0, 129.0, 40.0, 349.0, 116.0, -72.0, 153.0, 26.0, 198.0, 217.0, 22.0, 91.0, -1.0, 113.0, 259.0, -48.0, -42.0, 114.0, -11.0, 111.0, 107.0, -83.0, 57.0, 109.0, 181.0, 94.0, -97.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 13.0, 159.0, 0.0, 43.0, -20.0, -12.0, 90.0, -77.0, 30.0, 188.0, -14.0, -154.0, -85.0, -193.0, 28.0, 0.0, 173.0, -4.0, 0.0, -103.0, 0.0, 45.0, -178.0, 35.0, 0.0, 8.0, 155.0, 29.0, -58.0, 2.0, 4.0, -20.0, 0.0, -18.0, 120.0, -51.0, -192.0, -293.0, 125.0, -56.0, -53.0, -55.0, 78.0, 168.0, 0.0, 164.0, 141.0, 200.0, 129.0, 177.0, 7.0, 107.0, 156.0, 146.0, 0.0, -176.0, 101.0, 170.0, 42.0, -75.0, 0.0, 109.0, 161.0, 27.0, -252.0, 33.0, 68.0, 186.0, -18.0, -192.0, 0.0, 152.0, -22.0, -29.0, -196.0, 107.0, 59.0, -2.0, 199.0, 184.0, -34.0, 133.0, 0.0, 45.0, -71.0, -107.0, -55.0, -85.0, 0.0, 10.0, -40.0, 93.0, 0.0, 47.0, 0.0, -2.0, -19.0, 104.0, 0.0, 14.0, -88.0, -101.0, 61.0, 11.0, -106.0, -120.0, 0.0, -129.0, 191.0, 174.0, 0.0, 0.0, 12.0, -1.0, -72.0, -34.0, 0.0, -53.0, 0.0, 104.0, 8.0, 14.0, 148.0, -1.0, 200.0, -16.0, -58.0, 30.0, 44.0, -76.0, 64.0, -61.0, -7.0, 14.0, -138.0, 61.0, 52.0, 113.0, -18.0, 27.0, -166.0, -219.0, -104.0, 45.0, 153.0, 0.0, 58.0, -46.0, -46.0, -17.0, 155.0, 187.0, -36.0, 60.0, -69.0, -160.0, 135.0, 0.0, -160.0, -62.0, 198.0, 0.0, 186.0, 31.0, -91.0, -37.0, 131.0, -126.0, 0.0, -2.0, 64.0, 9.0, 135.0, 89.0, -116.0, 0.0, 0.0, -88.0, 107.0, 0.0, -21.0, -149.0, 0.0, 47.0, 133.0, -143.0, 0.0, -185.0, -52.0, -18.0, 108.0, -52.0, -4.0, 114.0, 133.0, -98.0, 0.0, -217.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 14.0, 0.0, 54.0, 44.0, 14.0, 34.0, 111.0, 0.0, 118.0, 133.0, 0.0, 40.0, 0.0, 11.0, 53.0, 43.0, 0.0, 0.0, 9.0, 92.0, 8.0, 0.0, 0.0, 60.0, 78.0, 54.0, 0.0, 17.0, 9.0, 0.0, 56.0, 32.0, 141.0, 58.0, 29.0, 0.0, 0.0, 111.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 59.0, 48.0, 28.0, 3.0, 88.0, 50.0, 27.0, 0.0, 40.0, 69.0, 17.0, 8.0, 0.0, 37.0, 106.0, 117.0, 29.0, 3.0, 65.0, 96.0, 0.0, 10.0, 69.0, 25.0, 31.0, 98.0, 1.0, 25.0, 0.0, 0.0, 9.0, 80.0, 48.0, 2.0, 54.0, 46.0, 9.0, 85.0, 25.0, 8.0, 63.0, 39.0, 0.0, 30.0, 1.0, 0.0, 19.0, 37.0, 0.0, 55.0, 35.0, 90.0, 41.0, 30.0, 62.0, 0.0, 61.0, 62.0, 6.0, 0.0, 0.0, 0.0, 45.0, 42.0, 38.0, 55.0, 19.0, 54.0, 32.0, 0.0, 62.0, 0.0, 0.0, 69.0, 55.0, 54.0, 0.0, 70.0, 77.0, 64.0, 30.0, 88.0, 39.0, 35.0, 69.0, 21.0, 38.0, 4.0, 9.0, 0.0, 110.0, 22.0, 24.0, 68.0, 12.0, 0.0, 67.0, 50.0, 74.0, 29.0, 0.0, 7.0, 4.0, 88.0, 98.0, 59.0, 10.0, 8.0, 133.0, 115.0, 0.0, 0.0, 0.0, 0.0, 64.0, 86.0, 23.0, 63.0, 1.0, 0.0, 32.0, 8.0, 35.0, 0.0, 1.0, 67.0, 0.0, 46.0, 0.0, 7.0, 107.0, 52.0, 40.0, 24.0, 72.0, 45.0, 102.0, 0.0, 55.0, 72.0, 0.0, 53.0, 0.0, 71.0, 49.0, 10.0, 19.0, 101.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0040504091140687, "mean_inference_ms": 2.8168426984767616, "mean_action_processing_ms": 0.3706575293435456, "mean_env_wait_ms": 0.3515607924912554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013045430183410645, "StateBufferConnector_ms": 0.003621816635131836, "ViewRequirementAgentConnector_ms": 0.10360753536224365}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -286.0, "episode_return_mean": 87.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.7090267094496, "num_env_steps_trained_throughput_per_sec": 322.7090267094496, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 22448.185, "restore_workers_time_ms": 0.096, "training_step_time_ms": 22447.987, "sample_time_ms": 2237.075, "learn_time_ms": 20188.784, "learn_throughput": 198.13, "synch_weights_time_ms": 18.153}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "f1691_00002", "date": "2024-08-13_19-22-07", "timestamp": 1723591327, "time_this_iter_s": 12.425057172775269, "time_total_s": 3850.9808914661407, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f949d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3850.9808914661407, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 54.60588235294117, "ram_util_percent": 83.41764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.169106377763723, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 5.591152240864184, "policy_loss": -0.003566660843272176, "vf_loss": 5.594494631176903, "vf_explained_var": -0.002070227375736943, "kl": 0.011960664586058366, "entropy": 1.46259781588953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.968122086165444, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.331153503549162, "policy_loss": -0.00324697947011344, "vf_loss": 6.334377788109754, "vf_explained_var": -0.01398902623741715, "kl": 0.014528677200859052, "entropy": 1.2904697014541222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -426.0, "episode_reward_mean": 85.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 161.0}, "policy_reward_mean": {"prey_policy": 4.925, "predator_policy": 37.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.0, 164.0, 343.0, 306.0, 221.0, 333.0, -38.0, 298.0, 76.0, 134.0, 225.0, 4.0, 286.0, -49.0, 162.0, 43.0, 40.0, 83.0, 383.0, 188.0, 95.0, -78.0, -46.0, 43.0, 155.0, 77.0, -1.0, 141.0, 69.0, -64.0, 143.0, -164.0, -6.0, 371.0, 0.0, 98.0, -13.0, 20.0, 136.0, 84.0, 216.0, 293.0, 42.0, 109.0, 121.0, 81.0, 13.0, 207.0, 18.0, -253.0, 33.0, 165.0, 129.0, 40.0, 349.0, 116.0, -72.0, 153.0, 26.0, 198.0, 217.0, 22.0, 91.0, -1.0, 113.0, 259.0, -48.0, -42.0, 114.0, -11.0, 111.0, 107.0, -83.0, 57.0, 109.0, 181.0, 94.0, -97.0, 106.0, 20.0, 63.0, 32.0, 148.0, -1.0, 189.0, 193.0, -29.0, 0.0, 182.0, 162.0, -7.0, -94.0, 93.0, 65.0, -426.0, 289.0, 3.0, -4.0, -16.0, -126.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [78.0, 168.0, 0.0, 164.0, 141.0, 200.0, 129.0, 177.0, 7.0, 107.0, 156.0, 146.0, 0.0, -176.0, 101.0, 170.0, 42.0, -75.0, 0.0, 109.0, 161.0, 27.0, -252.0, 33.0, 68.0, 186.0, -18.0, -192.0, 0.0, 152.0, -22.0, -29.0, -196.0, 107.0, 59.0, -2.0, 199.0, 184.0, -34.0, 133.0, 0.0, 45.0, -71.0, -107.0, -55.0, -85.0, 0.0, 10.0, -40.0, 93.0, 0.0, 47.0, 0.0, -2.0, -19.0, 104.0, 0.0, 14.0, -88.0, -101.0, 61.0, 11.0, -106.0, -120.0, 0.0, -129.0, 191.0, 174.0, 0.0, 0.0, 12.0, -1.0, -72.0, -34.0, 0.0, -53.0, 0.0, 104.0, 8.0, 14.0, 148.0, -1.0, 200.0, -16.0, -58.0, 30.0, 44.0, -76.0, 64.0, -61.0, -7.0, 14.0, -138.0, 61.0, 52.0, 113.0, -18.0, 27.0, -166.0, -219.0, -104.0, 45.0, 153.0, 0.0, 58.0, -46.0, -46.0, -17.0, 155.0, 187.0, -36.0, 60.0, -69.0, -160.0, 135.0, 0.0, -160.0, -62.0, 198.0, 0.0, 186.0, 31.0, -91.0, -37.0, 131.0, -126.0, 0.0, -2.0, 64.0, 9.0, 135.0, 89.0, -116.0, 0.0, 0.0, -88.0, 107.0, 0.0, -21.0, -149.0, 0.0, 47.0, 133.0, -143.0, 0.0, -185.0, -52.0, -18.0, 108.0, -52.0, -4.0, 114.0, 133.0, -98.0, 0.0, -217.0, 17.0, -23.0, 9.0, -11.0, -177.0, 68.0, -103.0, -47.0, 134.0, 0.0, -2.0, 0.0, 0.0, 187.0, -148.0, 191.0, -150.0, -16.0, 0.0, 0.0, 59.0, 59.0, 143.0, 0.0, -14.0, 0.0, -251.0, -12.0, -17.0, -19.0, -106.0, 0.0, -342.0, -298.0, 173.0, 100.0, -98.0, 0.0, -44.0, 0.0, -114.0, 0.0, -233.0, -115.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 59.0, 48.0, 28.0, 3.0, 88.0, 50.0, 27.0, 0.0, 40.0, 69.0, 17.0, 8.0, 0.0, 37.0, 106.0, 117.0, 29.0, 3.0, 65.0, 96.0, 0.0, 10.0, 69.0, 25.0, 31.0, 98.0, 1.0, 25.0, 0.0, 0.0, 9.0, 80.0, 48.0, 2.0, 54.0, 46.0, 9.0, 85.0, 25.0, 8.0, 63.0, 39.0, 0.0, 30.0, 1.0, 0.0, 19.0, 37.0, 0.0, 55.0, 35.0, 90.0, 41.0, 30.0, 62.0, 0.0, 61.0, 62.0, 6.0, 0.0, 0.0, 0.0, 45.0, 42.0, 38.0, 55.0, 19.0, 54.0, 32.0, 0.0, 62.0, 0.0, 0.0, 69.0, 55.0, 54.0, 0.0, 70.0, 77.0, 64.0, 30.0, 88.0, 39.0, 35.0, 69.0, 21.0, 38.0, 4.0, 9.0, 0.0, 110.0, 22.0, 24.0, 68.0, 12.0, 0.0, 67.0, 50.0, 74.0, 29.0, 0.0, 7.0, 4.0, 88.0, 98.0, 59.0, 10.0, 8.0, 133.0, 115.0, 0.0, 0.0, 0.0, 0.0, 64.0, 86.0, 23.0, 63.0, 1.0, 0.0, 32.0, 8.0, 35.0, 0.0, 1.0, 67.0, 0.0, 46.0, 0.0, 7.0, 107.0, 52.0, 40.0, 24.0, 72.0, 45.0, 102.0, 0.0, 55.0, 72.0, 0.0, 53.0, 0.0, 71.0, 49.0, 10.0, 19.0, 101.0, 61.0, 51.0, 22.0, 0.0, 124.0, 48.0, 81.0, 101.0, 0.0, 14.0, 1.0, 0.0, 1.0, 1.0, 44.0, 106.0, 62.0, 75.0, 0.0, 0.0, 18.0, 46.0, 19.0, 0.0, 7.0, 0.0, 124.0, 45.0, 67.0, 62.0, 74.0, 97.0, 132.0, 82.0, 7.0, 9.0, 26.0, 75.0, 18.0, 22.0, 0.0, 98.0, 61.0, 161.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9903027136079612, "mean_inference_ms": 2.794634610387392, "mean_action_processing_ms": 0.36675937612237447, "mean_env_wait_ms": 0.34848963511402503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082120895385742, "StateBufferConnector_ms": 0.0036638975143432617, "ViewRequirementAgentConnector_ms": 0.10549390316009521}, "num_episodes": 22, "episode_return_max": 383.0, "episode_return_min": -426.0, "episode_return_mean": 85.27, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.16677484880245, "num_env_steps_trained_throughput_per_sec": 319.16677484880245, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 20338.703, "restore_workers_time_ms": 0.067, "training_step_time_ms": 20338.552, "sample_time_ms": 1932.862, "learn_time_ms": 18384.527, "learn_throughput": 217.574, "synch_weights_time_ms": 17.016}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "f1691_00002", "date": "2024-08-13_19-22-19", "timestamp": 1723591339, "time_this_iter_s": 12.563171863555908, "time_total_s": 3863.5440633296967, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f95040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3863.5440633296967, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 54.349999999999994, "ram_util_percent": 83.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0820623085927712, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 4.1605457647767645, "policy_loss": -0.00627708114269707, "vf_loss": 4.166545609317759, "vf_explained_var": -0.0025144647984277632, "kl": 0.014786129056393267, "entropy": 1.4655154574485052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.616652009269547, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.178781867405725, "policy_loss": -0.0020196421999513865, "vf_loss": 6.180780823520882, "vf_explained_var": 0.004629583459682566, "kl": 0.01324122908586246, "entropy": 1.2456736009587686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 371.0, "episode_reward_min": -426.0, "episode_reward_mean": 63.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 161.0}, "policy_reward_mean": {"prey_policy": -9.205, "predator_policy": 41.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 155.0, 77.0, -1.0, 141.0, 69.0, -64.0, 143.0, -164.0, -6.0, 371.0, 0.0, 98.0, -13.0, 20.0, 136.0, 84.0, 216.0, 293.0, 42.0, 109.0, 121.0, 81.0, 13.0, 207.0, 18.0, -253.0, 33.0, 165.0, 129.0, 40.0, 349.0, 116.0, -72.0, 153.0, 26.0, 198.0, 217.0, 22.0, 91.0, -1.0, 113.0, 259.0, -48.0, -42.0, 114.0, -11.0, 111.0, 107.0, -83.0, 57.0, 109.0, 181.0, 94.0, -97.0, 106.0, 20.0, 63.0, 32.0, 148.0, -1.0, 189.0, 193.0, -29.0, 0.0, 182.0, 162.0, -7.0, -94.0, 93.0, 65.0, -426.0, 289.0, 3.0, -4.0, -16.0, -126.0, 352.0, 176.0, 190.0, 63.0, -22.0, -32.0, 121.0, 102.0, 137.0, 125.0, 117.0, -29.0, -76.0, 0.0, -50.0, 74.0, -111.0, 0.0, -4.0, 34.0, -6.0, 28.0, 73.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 10.0, -40.0, 93.0, 0.0, 47.0, 0.0, -2.0, -19.0, 104.0, 0.0, 14.0, -88.0, -101.0, 61.0, 11.0, -106.0, -120.0, 0.0, -129.0, 191.0, 174.0, 0.0, 0.0, 12.0, -1.0, -72.0, -34.0, 0.0, -53.0, 0.0, 104.0, 8.0, 14.0, 148.0, -1.0, 200.0, -16.0, -58.0, 30.0, 44.0, -76.0, 64.0, -61.0, -7.0, 14.0, -138.0, 61.0, 52.0, 113.0, -18.0, 27.0, -166.0, -219.0, -104.0, 45.0, 153.0, 0.0, 58.0, -46.0, -46.0, -17.0, 155.0, 187.0, -36.0, 60.0, -69.0, -160.0, 135.0, 0.0, -160.0, -62.0, 198.0, 0.0, 186.0, 31.0, -91.0, -37.0, 131.0, -126.0, 0.0, -2.0, 64.0, 9.0, 135.0, 89.0, -116.0, 0.0, 0.0, -88.0, 107.0, 0.0, -21.0, -149.0, 0.0, 47.0, 133.0, -143.0, 0.0, -185.0, -52.0, -18.0, 108.0, -52.0, -4.0, 114.0, 133.0, -98.0, 0.0, -217.0, 17.0, -23.0, 9.0, -11.0, -177.0, 68.0, -103.0, -47.0, 134.0, 0.0, -2.0, 0.0, 0.0, 187.0, -148.0, 191.0, -150.0, -16.0, 0.0, 0.0, 59.0, 59.0, 143.0, 0.0, -14.0, 0.0, -251.0, -12.0, -17.0, -19.0, -106.0, 0.0, -342.0, -298.0, 173.0, 100.0, -98.0, 0.0, -44.0, 0.0, -114.0, 0.0, -233.0, -115.0, 188.0, 164.0, 176.0, 0.0, -16.0, 107.0, -100.0, 13.0, -106.0, -36.0, 0.0, -226.0, 116.0, -118.0, -227.0, 151.0, -151.0, 118.0, 125.0, 0.0, 128.0, -28.0, -28.0, -125.0, 0.0, -268.0, 0.0, 0.0, -44.0, -154.0, 65.0, -148.0, -80.0, -226.0, 0.0, 0.0, -9.0, 0.0, -61.0, 0.0, 0.0, -101.0, 28.0, 0.0, -32.0, 14.0], "policy_predator_policy_reward": [25.0, 8.0, 63.0, 39.0, 0.0, 30.0, 1.0, 0.0, 19.0, 37.0, 0.0, 55.0, 35.0, 90.0, 41.0, 30.0, 62.0, 0.0, 61.0, 62.0, 6.0, 0.0, 0.0, 0.0, 45.0, 42.0, 38.0, 55.0, 19.0, 54.0, 32.0, 0.0, 62.0, 0.0, 0.0, 69.0, 55.0, 54.0, 0.0, 70.0, 77.0, 64.0, 30.0, 88.0, 39.0, 35.0, 69.0, 21.0, 38.0, 4.0, 9.0, 0.0, 110.0, 22.0, 24.0, 68.0, 12.0, 0.0, 67.0, 50.0, 74.0, 29.0, 0.0, 7.0, 4.0, 88.0, 98.0, 59.0, 10.0, 8.0, 133.0, 115.0, 0.0, 0.0, 0.0, 0.0, 64.0, 86.0, 23.0, 63.0, 1.0, 0.0, 32.0, 8.0, 35.0, 0.0, 1.0, 67.0, 0.0, 46.0, 0.0, 7.0, 107.0, 52.0, 40.0, 24.0, 72.0, 45.0, 102.0, 0.0, 55.0, 72.0, 0.0, 53.0, 0.0, 71.0, 49.0, 10.0, 19.0, 101.0, 61.0, 51.0, 22.0, 0.0, 124.0, 48.0, 81.0, 101.0, 0.0, 14.0, 1.0, 0.0, 1.0, 1.0, 44.0, 106.0, 62.0, 75.0, 0.0, 0.0, 18.0, 46.0, 19.0, 0.0, 7.0, 0.0, 124.0, 45.0, 67.0, 62.0, 74.0, 97.0, 132.0, 82.0, 7.0, 9.0, 26.0, 75.0, 18.0, 22.0, 0.0, 98.0, 61.0, 161.0, 0.0, 0.0, 0.0, 0.0, 45.0, 54.0, 58.0, 92.0, 72.0, 48.0, 96.0, 98.0, 10.0, 113.0, 107.0, 71.0, 100.0, 70.0, 0.0, 0.0, 3.0, 14.0, 72.0, 52.0, 60.0, 132.0, 0.0, 0.0, 42.0, 106.0, 63.0, 94.0, 113.0, 82.0, 0.0, 0.0, 0.0, 5.0, 31.0, 64.0, 15.0, 80.0, 0.0, 0.0, 0.0, 91.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9816138527173094, "mean_inference_ms": 2.771588537415579, "mean_action_processing_ms": 0.3636279170012844, "mean_env_wait_ms": 0.34425513009049696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016589641571044922, "StateBufferConnector_ms": 0.003981471061706543, "ViewRequirementAgentConnector_ms": 0.10931146144866943}, "num_episodes": 23, "episode_return_max": 371.0, "episode_return_min": -426.0, "episode_return_mean": 63.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.35131405695523, "num_env_steps_trained_throughput_per_sec": 278.35131405695523, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14971.032, "restore_workers_time_ms": 0.036, "training_step_time_ms": 14970.933, "sample_time_ms": 1848.914, "learn_time_ms": 13100.194, "learn_throughput": 305.339, "synch_weights_time_ms": 17.517}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "f1691_00002", "date": "2024-08-13_19-22-34", "timestamp": 1723591354, "time_this_iter_s": 14.412088632583618, "time_total_s": 3877.9561519622803, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3877.9561519622803, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 63.976190476190474, "ram_util_percent": 83.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1126910516193935, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 6.324343985602969, "policy_loss": -0.004329916774221356, "vf_loss": 6.328405739769103, "vf_explained_var": 0.0038833853428956694, "kl": 0.014301438550495394, "entropy": 1.4382031536606885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.383532212572124, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.857985914321173, "policy_loss": -0.0010617729415624308, "vf_loss": 6.85903207082597, "vf_explained_var": -0.13020309146749912, "kl": 0.009986964888790738, "entropy": 1.217815768655646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -426.0, "episode_reward_mean": 56.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -354.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -20.605, "predator_policy": 48.745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.0, 42.0, 109.0, 121.0, 81.0, 13.0, 207.0, 18.0, -253.0, 33.0, 165.0, 129.0, 40.0, 349.0, 116.0, -72.0, 153.0, 26.0, 198.0, 217.0, 22.0, 91.0, -1.0, 113.0, 259.0, -48.0, -42.0, 114.0, -11.0, 111.0, 107.0, -83.0, 57.0, 109.0, 181.0, 94.0, -97.0, 106.0, 20.0, 63.0, 32.0, 148.0, -1.0, 189.0, 193.0, -29.0, 0.0, 182.0, 162.0, -7.0, -94.0, 93.0, 65.0, -426.0, 289.0, 3.0, -4.0, -16.0, -126.0, 352.0, 176.0, 190.0, 63.0, -22.0, -32.0, 121.0, 102.0, 137.0, 125.0, 117.0, -29.0, -76.0, 0.0, -50.0, 74.0, -111.0, 0.0, -4.0, 34.0, -6.0, 28.0, 73.0, 33.0, -81.0, 59.0, -140.0, 69.0, 78.0, -80.0, 45.0, 177.0, 111.0, -28.0, 48.0, 11.0, 115.0, -194.0, -17.0, -26.0, 383.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -16.0, -58.0, 30.0, 44.0, -76.0, 64.0, -61.0, -7.0, 14.0, -138.0, 61.0, 52.0, 113.0, -18.0, 27.0, -166.0, -219.0, -104.0, 45.0, 153.0, 0.0, 58.0, -46.0, -46.0, -17.0, 155.0, 187.0, -36.0, 60.0, -69.0, -160.0, 135.0, 0.0, -160.0, -62.0, 198.0, 0.0, 186.0, 31.0, -91.0, -37.0, 131.0, -126.0, 0.0, -2.0, 64.0, 9.0, 135.0, 89.0, -116.0, 0.0, 0.0, -88.0, 107.0, 0.0, -21.0, -149.0, 0.0, 47.0, 133.0, -143.0, 0.0, -185.0, -52.0, -18.0, 108.0, -52.0, -4.0, 114.0, 133.0, -98.0, 0.0, -217.0, 17.0, -23.0, 9.0, -11.0, -177.0, 68.0, -103.0, -47.0, 134.0, 0.0, -2.0, 0.0, 0.0, 187.0, -148.0, 191.0, -150.0, -16.0, 0.0, 0.0, 59.0, 59.0, 143.0, 0.0, -14.0, 0.0, -251.0, -12.0, -17.0, -19.0, -106.0, 0.0, -342.0, -298.0, 173.0, 100.0, -98.0, 0.0, -44.0, 0.0, -114.0, 0.0, -233.0, -115.0, 188.0, 164.0, 176.0, 0.0, -16.0, 107.0, -100.0, 13.0, -106.0, -36.0, 0.0, -226.0, 116.0, -118.0, -227.0, 151.0, -151.0, 118.0, 125.0, 0.0, 128.0, -28.0, -28.0, -125.0, 0.0, -268.0, 0.0, 0.0, -44.0, -154.0, 65.0, -148.0, -80.0, -226.0, 0.0, 0.0, -9.0, 0.0, -61.0, 0.0, 0.0, -101.0, 28.0, 0.0, -32.0, 14.0, -317.0, 189.0, -238.0, 0.0, -6.0, 62.0, -130.0, -292.0, -94.0, 91.0, -2.0, 0.0, 0.0, -278.0, 200.0, -332.0, -28.0, 191.0, 98.0, -273.0, -12.0, -280.0, 0.0, -28.0, -18.0, -116.0, 84.0, -68.0, -208.0, -197.0, 0.0, -354.0, -98.0, 22.0, 177.0, 200.0], "policy_predator_policy_reward": [55.0, 54.0, 0.0, 70.0, 77.0, 64.0, 30.0, 88.0, 39.0, 35.0, 69.0, 21.0, 38.0, 4.0, 9.0, 0.0, 110.0, 22.0, 24.0, 68.0, 12.0, 0.0, 67.0, 50.0, 74.0, 29.0, 0.0, 7.0, 4.0, 88.0, 98.0, 59.0, 10.0, 8.0, 133.0, 115.0, 0.0, 0.0, 0.0, 0.0, 64.0, 86.0, 23.0, 63.0, 1.0, 0.0, 32.0, 8.0, 35.0, 0.0, 1.0, 67.0, 0.0, 46.0, 0.0, 7.0, 107.0, 52.0, 40.0, 24.0, 72.0, 45.0, 102.0, 0.0, 55.0, 72.0, 0.0, 53.0, 0.0, 71.0, 49.0, 10.0, 19.0, 101.0, 61.0, 51.0, 22.0, 0.0, 124.0, 48.0, 81.0, 101.0, 0.0, 14.0, 1.0, 0.0, 1.0, 1.0, 44.0, 106.0, 62.0, 75.0, 0.0, 0.0, 18.0, 46.0, 19.0, 0.0, 7.0, 0.0, 124.0, 45.0, 67.0, 62.0, 74.0, 97.0, 132.0, 82.0, 7.0, 9.0, 26.0, 75.0, 18.0, 22.0, 0.0, 98.0, 61.0, 161.0, 0.0, 0.0, 0.0, 0.0, 45.0, 54.0, 58.0, 92.0, 72.0, 48.0, 96.0, 98.0, 10.0, 113.0, 107.0, 71.0, 100.0, 70.0, 0.0, 0.0, 3.0, 14.0, 72.0, 52.0, 60.0, 132.0, 0.0, 0.0, 42.0, 106.0, 63.0, 94.0, 113.0, 82.0, 0.0, 0.0, 0.0, 5.0, 31.0, 64.0, 15.0, 80.0, 0.0, 0.0, 0.0, 91.0, 161.0, 0.0, 140.0, 17.0, 0.0, 3.0, 137.0, 145.0, 28.0, 44.0, 47.0, 33.0, 117.0, 81.0, 177.0, 0.0, 14.0, 0.0, 169.0, 117.0, 127.0, 137.0, 76.0, 0.0, 96.0, 49.0, 88.0, 11.0, 70.0, 141.0, 167.0, 170.0, 1.0, 49.0, 1.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9744671154142833, "mean_inference_ms": 2.7591292384919432, "mean_action_processing_ms": 0.3619046424417, "mean_env_wait_ms": 0.3423959994501151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016509532928466797, "StateBufferConnector_ms": 0.004229187965393066, "ViewRequirementAgentConnector_ms": 0.12127256393432617}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -426.0, "episode_return_mean": 56.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.5947582754872, "num_env_steps_trained_throughput_per_sec": 308.5947582754872, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14974.444, "restore_workers_time_ms": 0.036, "training_step_time_ms": 14974.344, "sample_time_ms": 1831.623, "learn_time_ms": 13121.263, "learn_throughput": 304.849, "synch_weights_time_ms": 16.926}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "f1691_00002", "date": "2024-08-13_19-22-47", "timestamp": 1723591367, "time_this_iter_s": 13.003344058990479, "time_total_s": 3890.9594960212708, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f94430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3890.9594960212708, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 58.92222222222222, "ram_util_percent": 83.5611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.162301960863449, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 5.877834722478553, "policy_loss": -0.004963640858562141, "vf_loss": 5.882565768055184, "vf_explained_var": 0.0008275280553827841, "kl": 0.012404971883660961, "entropy": 1.4190576210223809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.195974464075906, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.624011972089293, "policy_loss": -0.0017890515872745444, "vf_loss": 5.625772717137816, "vf_explained_var": -0.22071067176798664, "kl": 0.018108150379884384, "entropy": 1.2374720442862737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -426.0, "episode_reward_mean": 40.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -34.16, "predator_policy": 54.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.0, 217.0, 22.0, 91.0, -1.0, 113.0, 259.0, -48.0, -42.0, 114.0, -11.0, 111.0, 107.0, -83.0, 57.0, 109.0, 181.0, 94.0, -97.0, 106.0, 20.0, 63.0, 32.0, 148.0, -1.0, 189.0, 193.0, -29.0, 0.0, 182.0, 162.0, -7.0, -94.0, 93.0, 65.0, -426.0, 289.0, 3.0, -4.0, -16.0, -126.0, 352.0, 176.0, 190.0, 63.0, -22.0, -32.0, 121.0, 102.0, 137.0, 125.0, 117.0, -29.0, -76.0, 0.0, -50.0, 74.0, -111.0, 0.0, -4.0, 34.0, -6.0, 28.0, 73.0, 33.0, -81.0, 59.0, -140.0, 69.0, 78.0, -80.0, 45.0, 177.0, 111.0, -28.0, 48.0, 11.0, 115.0, -194.0, -17.0, -26.0, 383.0, 183.0, -4.0, -71.0, 93.0, 15.0, 21.0, -127.0, -28.0, -342.0, -21.0, -110.0, 120.0, 6.0, -76.0, 125.0, 87.0, 78.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [198.0, 0.0, 186.0, 31.0, -91.0, -37.0, 131.0, -126.0, 0.0, -2.0, 64.0, 9.0, 135.0, 89.0, -116.0, 0.0, 0.0, -88.0, 107.0, 0.0, -21.0, -149.0, 0.0, 47.0, 133.0, -143.0, 0.0, -185.0, -52.0, -18.0, 108.0, -52.0, -4.0, 114.0, 133.0, -98.0, 0.0, -217.0, 17.0, -23.0, 9.0, -11.0, -177.0, 68.0, -103.0, -47.0, 134.0, 0.0, -2.0, 0.0, 0.0, 187.0, -148.0, 191.0, -150.0, -16.0, 0.0, 0.0, 59.0, 59.0, 143.0, 0.0, -14.0, 0.0, -251.0, -12.0, -17.0, -19.0, -106.0, 0.0, -342.0, -298.0, 173.0, 100.0, -98.0, 0.0, -44.0, 0.0, -114.0, 0.0, -233.0, -115.0, 188.0, 164.0, 176.0, 0.0, -16.0, 107.0, -100.0, 13.0, -106.0, -36.0, 0.0, -226.0, 116.0, -118.0, -227.0, 151.0, -151.0, 118.0, 125.0, 0.0, 128.0, -28.0, -28.0, -125.0, 0.0, -268.0, 0.0, 0.0, -44.0, -154.0, 65.0, -148.0, -80.0, -226.0, 0.0, 0.0, -9.0, 0.0, -61.0, 0.0, 0.0, -101.0, 28.0, 0.0, -32.0, 14.0, -317.0, 189.0, -238.0, 0.0, -6.0, 62.0, -130.0, -292.0, -94.0, 91.0, -2.0, 0.0, 0.0, -278.0, 200.0, -332.0, -28.0, 191.0, 98.0, -273.0, -12.0, -280.0, 0.0, -28.0, -18.0, -116.0, 84.0, -68.0, -208.0, -197.0, 0.0, -354.0, -98.0, 22.0, 177.0, 200.0, -20.0, 193.0, 0.0, -8.0, 0.0, -400.0, 2.0, 48.0, -18.0, -61.0, -16.0, -49.0, -91.0, -200.0, -238.0, 0.0, -227.0, -282.0, -161.0, -42.0, 0.0, -265.0, -346.0, 143.0, 0.0, -326.0, -375.0, 0.0, 93.0, 0.0, 61.0, -12.0, 170.0, -343.0, -2.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 64.0, 86.0, 23.0, 63.0, 1.0, 0.0, 32.0, 8.0, 35.0, 0.0, 1.0, 67.0, 0.0, 46.0, 0.0, 7.0, 107.0, 52.0, 40.0, 24.0, 72.0, 45.0, 102.0, 0.0, 55.0, 72.0, 0.0, 53.0, 0.0, 71.0, 49.0, 10.0, 19.0, 101.0, 61.0, 51.0, 22.0, 0.0, 124.0, 48.0, 81.0, 101.0, 0.0, 14.0, 1.0, 0.0, 1.0, 1.0, 44.0, 106.0, 62.0, 75.0, 0.0, 0.0, 18.0, 46.0, 19.0, 0.0, 7.0, 0.0, 124.0, 45.0, 67.0, 62.0, 74.0, 97.0, 132.0, 82.0, 7.0, 9.0, 26.0, 75.0, 18.0, 22.0, 0.0, 98.0, 61.0, 161.0, 0.0, 0.0, 0.0, 0.0, 45.0, 54.0, 58.0, 92.0, 72.0, 48.0, 96.0, 98.0, 10.0, 113.0, 107.0, 71.0, 100.0, 70.0, 0.0, 0.0, 3.0, 14.0, 72.0, 52.0, 60.0, 132.0, 0.0, 0.0, 42.0, 106.0, 63.0, 94.0, 113.0, 82.0, 0.0, 0.0, 0.0, 5.0, 31.0, 64.0, 15.0, 80.0, 0.0, 0.0, 0.0, 91.0, 161.0, 0.0, 140.0, 17.0, 0.0, 3.0, 137.0, 145.0, 28.0, 44.0, 47.0, 33.0, 117.0, 81.0, 177.0, 0.0, 14.0, 0.0, 169.0, 117.0, 127.0, 137.0, 76.0, 0.0, 96.0, 49.0, 88.0, 11.0, 70.0, 141.0, 167.0, 170.0, 1.0, 49.0, 1.0, 5.0, 10.0, 0.0, 4.0, 0.0, 189.0, 140.0, 3.0, 40.0, 94.0, 0.0, 86.0, 0.0, 164.0, 0.0, 84.0, 126.0, 167.0, 0.0, 107.0, 75.0, 150.0, 5.0, 171.0, 152.0, 162.0, 170.0, 171.0, 128.0, 28.0, 4.0, 12.0, 26.0, 162.0, 89.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9678121302297586, "mean_inference_ms": 2.748148747115325, "mean_action_processing_ms": 0.3601932025024533, "mean_env_wait_ms": 0.3405602641887897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018210291862487793, "StateBufferConnector_ms": 0.004713892936706543, "ViewRequirementAgentConnector_ms": 0.12362480163574219}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -426.0, "episode_return_mean": 40.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.15322901343507, "num_env_steps_trained_throughput_per_sec": 204.15322901343507, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 15581.859, "restore_workers_time_ms": 0.033, "training_step_time_ms": 15581.762, "sample_time_ms": 1765.834, "learn_time_ms": 13792.646, "learn_throughput": 290.01, "synch_weights_time_ms": 18.583}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "f1691_00002", "date": "2024-08-13_19-23-07", "timestamp": 1723591387, "time_this_iter_s": 19.705058813095093, "time_total_s": 3910.664554834366, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3e30790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3910.664554834366, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 76.78214285714286, "ram_util_percent": 83.89642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2050581388530277, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 5.535110986548126, "policy_loss": -0.0039718687071134805, "vf_loss": 5.538798778019254, "vf_explained_var": 0.001279021287090564, "kl": 0.015150726882653925, "entropy": 1.4184123484545914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.203434025602682, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.818807190309757, "policy_loss": -0.002663165260175312, "vf_loss": 4.821457154536374, "vf_explained_var": -0.15858871425901142, "kl": 0.008450703077660599, "entropy": 1.248399469398317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -426.0, "episode_reward_mean": 26.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -47.7, "predator_policy": 61.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.0, 106.0, 20.0, 63.0, 32.0, 148.0, -1.0, 189.0, 193.0, -29.0, 0.0, 182.0, 162.0, -7.0, -94.0, 93.0, 65.0, -426.0, 289.0, 3.0, -4.0, -16.0, -126.0, 352.0, 176.0, 190.0, 63.0, -22.0, -32.0, 121.0, 102.0, 137.0, 125.0, 117.0, -29.0, -76.0, 0.0, -50.0, 74.0, -111.0, 0.0, -4.0, 34.0, -6.0, 28.0, 73.0, 33.0, -81.0, 59.0, -140.0, 69.0, 78.0, -80.0, 45.0, 177.0, 111.0, -28.0, 48.0, 11.0, 115.0, -194.0, -17.0, -26.0, 383.0, 183.0, -4.0, -71.0, 93.0, 15.0, 21.0, -127.0, -28.0, -342.0, -21.0, -110.0, 120.0, 6.0, -76.0, 125.0, 87.0, 78.0, -1.0, 0.0, 146.0, -4.0, 96.0, 129.0, -25.0, -50.0, -350.0, -114.0, 118.0, 12.0, 0.0, -68.0, 139.0, -59.0, 64.0, 76.0, 58.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -217.0, 17.0, -23.0, 9.0, -11.0, -177.0, 68.0, -103.0, -47.0, 134.0, 0.0, -2.0, 0.0, 0.0, 187.0, -148.0, 191.0, -150.0, -16.0, 0.0, 0.0, 59.0, 59.0, 143.0, 0.0, -14.0, 0.0, -251.0, -12.0, -17.0, -19.0, -106.0, 0.0, -342.0, -298.0, 173.0, 100.0, -98.0, 0.0, -44.0, 0.0, -114.0, 0.0, -233.0, -115.0, 188.0, 164.0, 176.0, 0.0, -16.0, 107.0, -100.0, 13.0, -106.0, -36.0, 0.0, -226.0, 116.0, -118.0, -227.0, 151.0, -151.0, 118.0, 125.0, 0.0, 128.0, -28.0, -28.0, -125.0, 0.0, -268.0, 0.0, 0.0, -44.0, -154.0, 65.0, -148.0, -80.0, -226.0, 0.0, 0.0, -9.0, 0.0, -61.0, 0.0, 0.0, -101.0, 28.0, 0.0, -32.0, 14.0, -317.0, 189.0, -238.0, 0.0, -6.0, 62.0, -130.0, -292.0, -94.0, 91.0, -2.0, 0.0, 0.0, -278.0, 200.0, -332.0, -28.0, 191.0, 98.0, -273.0, -12.0, -280.0, 0.0, -28.0, -18.0, -116.0, 84.0, -68.0, -208.0, -197.0, 0.0, -354.0, -98.0, 22.0, 177.0, 200.0, -20.0, 193.0, 0.0, -8.0, 0.0, -400.0, 2.0, 48.0, -18.0, -61.0, -16.0, -49.0, -91.0, -200.0, -238.0, 0.0, -227.0, -282.0, -161.0, -42.0, 0.0, -265.0, -346.0, 143.0, 0.0, -326.0, -375.0, 0.0, 93.0, 0.0, 61.0, -12.0, 170.0, -343.0, -2.0, 0.0, 0.0, 0.0, 125.0, 0.0, -283.0, 50.0, 38.0, -4.0, 0.0, 108.0, -379.0, 0.0, -386.0, 0.0, -250.0, -287.0, 0.0, -355.0, 77.0, 0.0, -135.0, 27.0, 0.0, 0.0, 0.0, -325.0, -18.0, 122.0, 0.0, -265.0, 156.0, -380.0, 20.0, -18.0, -43.0, 0.0], "policy_predator_policy_reward": [19.0, 101.0, 61.0, 51.0, 22.0, 0.0, 124.0, 48.0, 81.0, 101.0, 0.0, 14.0, 1.0, 0.0, 1.0, 1.0, 44.0, 106.0, 62.0, 75.0, 0.0, 0.0, 18.0, 46.0, 19.0, 0.0, 7.0, 0.0, 124.0, 45.0, 67.0, 62.0, 74.0, 97.0, 132.0, 82.0, 7.0, 9.0, 26.0, 75.0, 18.0, 22.0, 0.0, 98.0, 61.0, 161.0, 0.0, 0.0, 0.0, 0.0, 45.0, 54.0, 58.0, 92.0, 72.0, 48.0, 96.0, 98.0, 10.0, 113.0, 107.0, 71.0, 100.0, 70.0, 0.0, 0.0, 3.0, 14.0, 72.0, 52.0, 60.0, 132.0, 0.0, 0.0, 42.0, 106.0, 63.0, 94.0, 113.0, 82.0, 0.0, 0.0, 0.0, 5.0, 31.0, 64.0, 15.0, 80.0, 0.0, 0.0, 0.0, 91.0, 161.0, 0.0, 140.0, 17.0, 0.0, 3.0, 137.0, 145.0, 28.0, 44.0, 47.0, 33.0, 117.0, 81.0, 177.0, 0.0, 14.0, 0.0, 169.0, 117.0, 127.0, 137.0, 76.0, 0.0, 96.0, 49.0, 88.0, 11.0, 70.0, 141.0, 167.0, 170.0, 1.0, 49.0, 1.0, 5.0, 10.0, 0.0, 4.0, 0.0, 189.0, 140.0, 3.0, 40.0, 94.0, 0.0, 86.0, 0.0, 164.0, 0.0, 84.0, 126.0, 167.0, 0.0, 107.0, 75.0, 150.0, 5.0, 171.0, 152.0, 162.0, 170.0, 171.0, 128.0, 28.0, 4.0, 12.0, 26.0, 162.0, 89.0, 1.0, 0.0, 0.0, 0.0, 16.0, 5.0, 129.0, 100.0, 50.0, 12.0, 21.0, 0.0, 192.0, 162.0, 164.0, 172.0, 0.0, 187.0, 62.0, 179.0, 21.0, 20.0, 10.0, 110.0, 0.0, 0.0, 131.0, 126.0, 26.0, 9.0, 146.0, 60.0, 161.0, 127.0, 18.0, 56.0, 49.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9690991643998145, "mean_inference_ms": 2.767253229514996, "mean_action_processing_ms": 0.36312856751107403, "mean_env_wait_ms": 0.34268952331423125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01172018051147461, "StateBufferConnector_ms": 0.008831977844238281, "ViewRequirementAgentConnector_ms": 0.29305028915405273}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -426.0, "episode_return_mean": 26.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.14895777193257, "num_env_steps_trained_throughput_per_sec": 213.14895777193257, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 16248.3, "restore_workers_time_ms": 0.033, "training_step_time_ms": 16248.201, "sample_time_ms": 2135.063, "learn_time_ms": 14089.246, "learn_throughput": 283.904, "synch_weights_time_ms": 18.894}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "f1691_00002", "date": "2024-08-13_19-23-26", "timestamp": 1723591406, "time_this_iter_s": 18.819045066833496, "time_total_s": 3929.4835999011993, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3929.4835999011993, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 77.38461538461539, "ram_util_percent": 83.8423076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2199701483997087, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.648916809268729, "policy_loss": -0.004396075078177823, "vf_loss": 3.6530373389128026, "vf_explained_var": 0.0008324256649723759, "kl": 0.014695329353142168, "entropy": 1.4366414941177166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.587826025178508, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 3.9476137900478627, "policy_loss": -0.002192976044752098, "vf_loss": 3.949794458964514, "vf_explained_var": -0.07653692065092621, "kl": 0.007876930818634892, "entropy": 1.2671830867964125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -350.0, "episode_reward_mean": 18.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -51.555, "predator_policy": 60.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, -32.0, 121.0, 102.0, 137.0, 125.0, 117.0, -29.0, -76.0, 0.0, -50.0, 74.0, -111.0, 0.0, -4.0, 34.0, -6.0, 28.0, 73.0, 33.0, -81.0, 59.0, -140.0, 69.0, 78.0, -80.0, 45.0, 177.0, 111.0, -28.0, 48.0, 11.0, 115.0, -194.0, -17.0, -26.0, 383.0, 183.0, -4.0, -71.0, 93.0, 15.0, 21.0, -127.0, -28.0, -342.0, -21.0, -110.0, 120.0, 6.0, -76.0, 125.0, 87.0, 78.0, -1.0, 0.0, 146.0, -4.0, 96.0, 129.0, -25.0, -50.0, -350.0, -114.0, 118.0, 12.0, 0.0, -68.0, 139.0, -59.0, 64.0, 76.0, 58.0, -122.0, -3.0, 223.0, -27.0, 44.0, -7.0, -14.0, 0.0, 192.0, 0.0, -40.0, -4.0, 188.0, 199.0, 0.0, 12.0, 25.0, 0.0, -15.0, 101.0, 0.0, -292.0, 59.0, -6.0, 74.0, 47.0, 29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-106.0, -36.0, 0.0, -226.0, 116.0, -118.0, -227.0, 151.0, -151.0, 118.0, 125.0, 0.0, 128.0, -28.0, -28.0, -125.0, 0.0, -268.0, 0.0, 0.0, -44.0, -154.0, 65.0, -148.0, -80.0, -226.0, 0.0, 0.0, -9.0, 0.0, -61.0, 0.0, 0.0, -101.0, 28.0, 0.0, -32.0, 14.0, -317.0, 189.0, -238.0, 0.0, -6.0, 62.0, -130.0, -292.0, -94.0, 91.0, -2.0, 0.0, 0.0, -278.0, 200.0, -332.0, -28.0, 191.0, 98.0, -273.0, -12.0, -280.0, 0.0, -28.0, -18.0, -116.0, 84.0, -68.0, -208.0, -197.0, 0.0, -354.0, -98.0, 22.0, 177.0, 200.0, -20.0, 193.0, 0.0, -8.0, 0.0, -400.0, 2.0, 48.0, -18.0, -61.0, -16.0, -49.0, -91.0, -200.0, -238.0, 0.0, -227.0, -282.0, -161.0, -42.0, 0.0, -265.0, -346.0, 143.0, 0.0, -326.0, -375.0, 0.0, 93.0, 0.0, 61.0, -12.0, 170.0, -343.0, -2.0, 0.0, 0.0, 0.0, 125.0, 0.0, -283.0, 50.0, 38.0, -4.0, 0.0, 108.0, -379.0, 0.0, -386.0, 0.0, -250.0, -287.0, 0.0, -355.0, 77.0, 0.0, -135.0, 27.0, 0.0, 0.0, 0.0, -325.0, -18.0, 122.0, 0.0, -265.0, 156.0, -380.0, 20.0, -18.0, -43.0, 0.0, -331.0, 0.0, -112.0, -4.0, 59.0, 80.0, 0.0, -54.0, -161.0, 2.0, -4.0, -10.0, 0.0, -28.0, 0.0, 0.0, 192.0, -248.0, 0.0, 0.0, 0.0, -160.0, -8.0, 0.0, 0.0, 182.0, 199.0, 0.0, 0.0, 0.0, -2.0, -358.0, -144.0, 0.0, 0.0, 0.0, -4.0, -25.0, 0.0, 60.0, 0.0, 0.0, -276.0, -268.0, 0.0, 52.0, 0.0, -12.0, 42.0, -151.0, -41.0, 0.0, -123.0, 0.0], "policy_predator_policy_reward": [72.0, 48.0, 96.0, 98.0, 10.0, 113.0, 107.0, 71.0, 100.0, 70.0, 0.0, 0.0, 3.0, 14.0, 72.0, 52.0, 60.0, 132.0, 0.0, 0.0, 42.0, 106.0, 63.0, 94.0, 113.0, 82.0, 0.0, 0.0, 0.0, 5.0, 31.0, 64.0, 15.0, 80.0, 0.0, 0.0, 0.0, 91.0, 161.0, 0.0, 140.0, 17.0, 0.0, 3.0, 137.0, 145.0, 28.0, 44.0, 47.0, 33.0, 117.0, 81.0, 177.0, 0.0, 14.0, 0.0, 169.0, 117.0, 127.0, 137.0, 76.0, 0.0, 96.0, 49.0, 88.0, 11.0, 70.0, 141.0, 167.0, 170.0, 1.0, 49.0, 1.0, 5.0, 10.0, 0.0, 4.0, 0.0, 189.0, 140.0, 3.0, 40.0, 94.0, 0.0, 86.0, 0.0, 164.0, 0.0, 84.0, 126.0, 167.0, 0.0, 107.0, 75.0, 150.0, 5.0, 171.0, 152.0, 162.0, 170.0, 171.0, 128.0, 28.0, 4.0, 12.0, 26.0, 162.0, 89.0, 1.0, 0.0, 0.0, 0.0, 16.0, 5.0, 129.0, 100.0, 50.0, 12.0, 21.0, 0.0, 192.0, 162.0, 164.0, 172.0, 0.0, 187.0, 62.0, 179.0, 21.0, 20.0, 10.0, 110.0, 0.0, 0.0, 131.0, 126.0, 26.0, 9.0, 146.0, 60.0, 161.0, 127.0, 18.0, 56.0, 49.0, 52.0, 158.0, 51.0, 54.0, 59.0, 49.0, 35.0, 27.0, 0.0, 95.0, 108.0, 2.0, 5.0, 0.0, 14.0, 0.0, 0.0, 113.0, 135.0, 0.0, 0.0, 0.0, 120.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 184.0, 188.0, 86.0, 83.0, 0.0, 0.0, 0.0, 14.0, 0.0, 41.0, 0.0, 0.0, 158.0, 94.0, 7.0, 0.0, 6.0, 0.0, 89.0, 94.0, 40.0, 48.0, 94.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9704675186522006, "mean_inference_ms": 2.78391546801256, "mean_action_processing_ms": 0.36725336607792725, "mean_env_wait_ms": 0.34535705585748455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011238694190979004, "StateBufferConnector_ms": 0.009336352348327637, "ViewRequirementAgentConnector_ms": 0.3173872232437134}, "num_episodes": 27, "episode_return_max": 383.0, "episode_return_min": -350.0, "episode_return_mean": 18.23, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.7128939430276, "num_env_steps_trained_throughput_per_sec": 269.7128939430276, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 14394.316, "restore_workers_time_ms": 0.032, "training_step_time_ms": 14394.22, "sample_time_ms": 2147.498, "learn_time_ms": 12223.208, "learn_throughput": 327.246, "synch_weights_time_ms": 18.699}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "f1691_00002", "date": "2024-08-13_19-23-40", "timestamp": 1723591420, "time_this_iter_s": 14.85487699508667, "time_total_s": 3944.338476896286, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3944.338476896286, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 69.44545454545455, "ram_util_percent": 83.76363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1752454971865056, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 4.64308251060506, "policy_loss": -0.005806536043910359, "vf_loss": 4.648527341166501, "vf_explained_var": 0.00026496314497851824, "kl": 0.019291303568382306, "entropy": 1.3773729675030582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.448202377762744, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.307726382830786, "policy_loss": -0.005793085519874853, "vf_loss": 5.3135035083407445, "vf_explained_var": -0.08502423968264665, "kl": 0.010209497449070223, "entropy": 1.2265344322043121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -350.0, "episode_reward_mean": 20.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -50.795, "predator_policy": 61.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0, 33.0, -81.0, 59.0, -140.0, 69.0, 78.0, -80.0, 45.0, 177.0, 111.0, -28.0, 48.0, 11.0, 115.0, -194.0, -17.0, -26.0, 383.0, 183.0, -4.0, -71.0, 93.0, 15.0, 21.0, -127.0, -28.0, -342.0, -21.0, -110.0, 120.0, 6.0, -76.0, 125.0, 87.0, 78.0, -1.0, 0.0, 146.0, -4.0, 96.0, 129.0, -25.0, -50.0, -350.0, -114.0, 118.0, 12.0, 0.0, -68.0, 139.0, -59.0, 64.0, 76.0, 58.0, -122.0, -3.0, 223.0, -27.0, 44.0, -7.0, -14.0, 0.0, 192.0, 0.0, -40.0, -4.0, 188.0, 199.0, 0.0, 12.0, 25.0, 0.0, -15.0, 101.0, 0.0, -292.0, 59.0, -6.0, 74.0, 47.0, 29.0, 14.0, 69.0, 113.0, 250.0, -29.0, -12.0, 184.0, -5.0, 99.0, -40.0, -57.0, -35.0, 15.0, 165.0, -33.0, 97.0, -112.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.0, 14.0, -317.0, 189.0, -238.0, 0.0, -6.0, 62.0, -130.0, -292.0, -94.0, 91.0, -2.0, 0.0, 0.0, -278.0, 200.0, -332.0, -28.0, 191.0, 98.0, -273.0, -12.0, -280.0, 0.0, -28.0, -18.0, -116.0, 84.0, -68.0, -208.0, -197.0, 0.0, -354.0, -98.0, 22.0, 177.0, 200.0, -20.0, 193.0, 0.0, -8.0, 0.0, -400.0, 2.0, 48.0, -18.0, -61.0, -16.0, -49.0, -91.0, -200.0, -238.0, 0.0, -227.0, -282.0, -161.0, -42.0, 0.0, -265.0, -346.0, 143.0, 0.0, -326.0, -375.0, 0.0, 93.0, 0.0, 61.0, -12.0, 170.0, -343.0, -2.0, 0.0, 0.0, 0.0, 125.0, 0.0, -283.0, 50.0, 38.0, -4.0, 0.0, 108.0, -379.0, 0.0, -386.0, 0.0, -250.0, -287.0, 0.0, -355.0, 77.0, 0.0, -135.0, 27.0, 0.0, 0.0, 0.0, -325.0, -18.0, 122.0, 0.0, -265.0, 156.0, -380.0, 20.0, -18.0, -43.0, 0.0, -331.0, 0.0, -112.0, -4.0, 59.0, 80.0, 0.0, -54.0, -161.0, 2.0, -4.0, -10.0, 0.0, -28.0, 0.0, 0.0, 192.0, -248.0, 0.0, 0.0, 0.0, -160.0, -8.0, 0.0, 0.0, 182.0, 199.0, 0.0, 0.0, 0.0, -2.0, -358.0, -144.0, 0.0, 0.0, 0.0, -4.0, -25.0, 0.0, 60.0, 0.0, 0.0, -276.0, -268.0, 0.0, 52.0, 0.0, -12.0, 42.0, -151.0, -41.0, 0.0, -123.0, 0.0, -10.0, 16.0, -164.0, 77.0, 111.0, 0.0, 148.0, 44.0, -125.0, -110.0, -24.0, 0.0, 0.0, 177.0, -36.0, -91.0, 0.0, 99.0, -106.0, -74.0, -193.0, -115.0, -70.0, 0.0, 0.0, -182.0, 113.0, -123.0, -44.0, -22.0, -70.0, -107.0, -136.0, -236.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 91.0, 161.0, 0.0, 140.0, 17.0, 0.0, 3.0, 137.0, 145.0, 28.0, 44.0, 47.0, 33.0, 117.0, 81.0, 177.0, 0.0, 14.0, 0.0, 169.0, 117.0, 127.0, 137.0, 76.0, 0.0, 96.0, 49.0, 88.0, 11.0, 70.0, 141.0, 167.0, 170.0, 1.0, 49.0, 1.0, 5.0, 10.0, 0.0, 4.0, 0.0, 189.0, 140.0, 3.0, 40.0, 94.0, 0.0, 86.0, 0.0, 164.0, 0.0, 84.0, 126.0, 167.0, 0.0, 107.0, 75.0, 150.0, 5.0, 171.0, 152.0, 162.0, 170.0, 171.0, 128.0, 28.0, 4.0, 12.0, 26.0, 162.0, 89.0, 1.0, 0.0, 0.0, 0.0, 16.0, 5.0, 129.0, 100.0, 50.0, 12.0, 21.0, 0.0, 192.0, 162.0, 164.0, 172.0, 0.0, 187.0, 62.0, 179.0, 21.0, 20.0, 10.0, 110.0, 0.0, 0.0, 131.0, 126.0, 26.0, 9.0, 146.0, 60.0, 161.0, 127.0, 18.0, 56.0, 49.0, 52.0, 158.0, 51.0, 54.0, 59.0, 49.0, 35.0, 27.0, 0.0, 95.0, 108.0, 2.0, 5.0, 0.0, 14.0, 0.0, 0.0, 113.0, 135.0, 0.0, 0.0, 0.0, 120.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 184.0, 188.0, 86.0, 83.0, 0.0, 0.0, 0.0, 14.0, 0.0, 41.0, 0.0, 0.0, 158.0, 94.0, 7.0, 0.0, 6.0, 0.0, 89.0, 94.0, 40.0, 48.0, 94.0, 58.0, 6.0, 2.0, 75.0, 81.0, 2.0, 0.0, 49.0, 9.0, 82.0, 124.0, 10.0, 2.0, 7.0, 0.0, 67.0, 55.0, 0.0, 0.0, 92.0, 48.0, 123.0, 128.0, 35.0, 0.0, 95.0, 102.0, 88.0, 87.0, 11.0, 22.0, 154.0, 120.0, 169.0, 91.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.979216055494662, "mean_inference_ms": 2.8282139027835864, "mean_action_processing_ms": 0.3722652696441236, "mean_env_wait_ms": 0.3490322573630754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01020824909210205, "StateBufferConnector_ms": 0.009376883506774902, "ViewRequirementAgentConnector_ms": 0.3412731885910034}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -350.0, "episode_return_mean": 20.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.82625198716272, "num_env_steps_trained_throughput_per_sec": 202.82625198716272, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 15119.285, "restore_workers_time_ms": 0.032, "training_step_time_ms": 15119.188, "sample_time_ms": 2383.817, "learn_time_ms": 12708.972, "learn_throughput": 314.738, "synch_weights_time_ms": 21.602}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "f1691_00002", "date": "2024-08-13_19-24-00", "timestamp": 1723591440, "time_this_iter_s": 19.793477058410645, "time_total_s": 3964.1319539546967, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3964.1319539546967, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 81.33928571428574, "ram_util_percent": 83.90357142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.386499247443739, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.4540831791660773, "policy_loss": -0.007570276025525004, "vf_loss": 3.4612951021345837, "vf_explained_var": 0.002189209126921558, "kl": 0.01911230888303055, "entropy": 1.301029929786763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.25948969554649, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.953351510391034, "policy_loss": -0.005034549968691651, "vf_loss": 4.958373368101776, "vf_explained_var": 0.28420643692924863, "kl": 0.008120235758339906, "entropy": 1.1879574551784173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 383.0, "episode_reward_min": -350.0, "episode_reward_mean": 33.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -36.825, "predator_policy": 53.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.0, 183.0, -4.0, -71.0, 93.0, 15.0, 21.0, -127.0, -28.0, -342.0, -21.0, -110.0, 120.0, 6.0, -76.0, 125.0, 87.0, 78.0, -1.0, 0.0, 146.0, -4.0, 96.0, 129.0, -25.0, -50.0, -350.0, -114.0, 118.0, 12.0, 0.0, -68.0, 139.0, -59.0, 64.0, 76.0, 58.0, -122.0, -3.0, 223.0, -27.0, 44.0, -7.0, -14.0, 0.0, 192.0, 0.0, -40.0, -4.0, 188.0, 199.0, 0.0, 12.0, 25.0, 0.0, -15.0, 101.0, 0.0, -292.0, 59.0, -6.0, 74.0, 47.0, 29.0, 14.0, 69.0, 113.0, 250.0, -29.0, -12.0, 184.0, -5.0, 99.0, -40.0, -57.0, -35.0, 15.0, 165.0, -33.0, 97.0, -112.0, 0.0, -12.0, 165.0, 184.0, 99.0, 154.0, 178.0, 105.0, 133.0, 256.0, -24.0, -28.0, 0.0, 0.0, 62.0, 60.0, 7.0, 118.0, 67.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.0, 200.0, -20.0, 193.0, 0.0, -8.0, 0.0, -400.0, 2.0, 48.0, -18.0, -61.0, -16.0, -49.0, -91.0, -200.0, -238.0, 0.0, -227.0, -282.0, -161.0, -42.0, 0.0, -265.0, -346.0, 143.0, 0.0, -326.0, -375.0, 0.0, 93.0, 0.0, 61.0, -12.0, 170.0, -343.0, -2.0, 0.0, 0.0, 0.0, 125.0, 0.0, -283.0, 50.0, 38.0, -4.0, 0.0, 108.0, -379.0, 0.0, -386.0, 0.0, -250.0, -287.0, 0.0, -355.0, 77.0, 0.0, -135.0, 27.0, 0.0, 0.0, 0.0, -325.0, -18.0, 122.0, 0.0, -265.0, 156.0, -380.0, 20.0, -18.0, -43.0, 0.0, -331.0, 0.0, -112.0, -4.0, 59.0, 80.0, 0.0, -54.0, -161.0, 2.0, -4.0, -10.0, 0.0, -28.0, 0.0, 0.0, 192.0, -248.0, 0.0, 0.0, 0.0, -160.0, -8.0, 0.0, 0.0, 182.0, 199.0, 0.0, 0.0, 0.0, -2.0, -358.0, -144.0, 0.0, 0.0, 0.0, -4.0, -25.0, 0.0, 60.0, 0.0, 0.0, -276.0, -268.0, 0.0, 52.0, 0.0, -12.0, 42.0, -151.0, -41.0, 0.0, -123.0, 0.0, -10.0, 16.0, -164.0, 77.0, 111.0, 0.0, 148.0, 44.0, -125.0, -110.0, -24.0, 0.0, 0.0, 177.0, -36.0, -91.0, 0.0, 99.0, -106.0, -74.0, -193.0, -115.0, -70.0, 0.0, 0.0, -182.0, 113.0, -123.0, -44.0, -22.0, -70.0, -107.0, -136.0, -236.0, 0.0, 0.0, -2.0, -22.0, 0.0, 148.0, 179.0, 0.0, -2.0, 7.0, -2.0, 143.0, 31.0, 84.0, 0.0, 39.0, 98.0, 0.0, 195.0, -8.0, -56.0, -106.0, -41.0, -128.0, 0.0, 0.0, 0.0, 0.0, -51.0, -49.0, -120.0, 21.0, -18.0, 0.0, 20.0, 9.0, 0.0, -25.0], "policy_predator_policy_reward": [1.0, 5.0, 10.0, 0.0, 4.0, 0.0, 189.0, 140.0, 3.0, 40.0, 94.0, 0.0, 86.0, 0.0, 164.0, 0.0, 84.0, 126.0, 167.0, 0.0, 107.0, 75.0, 150.0, 5.0, 171.0, 152.0, 162.0, 170.0, 171.0, 128.0, 28.0, 4.0, 12.0, 26.0, 162.0, 89.0, 1.0, 0.0, 0.0, 0.0, 16.0, 5.0, 129.0, 100.0, 50.0, 12.0, 21.0, 0.0, 192.0, 162.0, 164.0, 172.0, 0.0, 187.0, 62.0, 179.0, 21.0, 20.0, 10.0, 110.0, 0.0, 0.0, 131.0, 126.0, 26.0, 9.0, 146.0, 60.0, 161.0, 127.0, 18.0, 56.0, 49.0, 52.0, 158.0, 51.0, 54.0, 59.0, 49.0, 35.0, 27.0, 0.0, 95.0, 108.0, 2.0, 5.0, 0.0, 14.0, 0.0, 0.0, 113.0, 135.0, 0.0, 0.0, 0.0, 120.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 184.0, 188.0, 86.0, 83.0, 0.0, 0.0, 0.0, 14.0, 0.0, 41.0, 0.0, 0.0, 158.0, 94.0, 7.0, 0.0, 6.0, 0.0, 89.0, 94.0, 40.0, 48.0, 94.0, 58.0, 6.0, 2.0, 75.0, 81.0, 2.0, 0.0, 49.0, 9.0, 82.0, 124.0, 10.0, 2.0, 7.0, 0.0, 67.0, 55.0, 0.0, 0.0, 92.0, 48.0, 123.0, 128.0, 35.0, 0.0, 95.0, 102.0, 88.0, 87.0, 11.0, 22.0, 154.0, 120.0, 169.0, 91.0, 0.0, 0.0, 1.0, 11.0, 12.0, 5.0, 5.0, 0.0, 60.0, 34.0, 0.0, 13.0, 30.0, 33.0, 33.0, 33.0, 20.0, 15.0, 9.0, 60.0, 38.0, 100.0, 58.0, 83.0, 0.0, 0.0, 0.0, 0.0, 60.0, 102.0, 84.0, 75.0, 0.0, 25.0, 25.0, 64.0, 34.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9877450443461919, "mean_inference_ms": 2.8618857295447993, "mean_action_processing_ms": 0.3771642696381777, "mean_env_wait_ms": 0.35221997636190394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010232329368591309, "StateBufferConnector_ms": 0.008818507194519043, "ViewRequirementAgentConnector_ms": 0.3298203945159912}, "num_episodes": 18, "episode_return_max": 383.0, "episode_return_min": -350.0, "episode_return_mean": 33.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.7871506480901, "num_env_steps_trained_throughput_per_sec": 249.7871506480901, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 15480.174, "restore_workers_time_ms": 0.037, "training_step_time_ms": 15480.073, "sample_time_ms": 2482.797, "learn_time_ms": 12970.639, "learn_throughput": 308.389, "synch_weights_time_ms": 21.809}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "f1691_00002", "date": "2024-08-13_19-24-16", "timestamp": 1723591456, "time_this_iter_s": 16.06021499633789, "time_total_s": 3980.1921689510345, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef80d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3980.1921689510345, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 66.77391304347827, "ram_util_percent": 83.36521739130433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4006119406254833, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.8499305394591476, "policy_loss": -0.008505016558916953, "vf_loss": 3.858173984320706, "vf_explained_var": -0.006293564814108389, "kl": 0.013949122704767431, "entropy": 1.2809655960905488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.446012134022183, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 3.9778135872391798, "policy_loss": -0.0029745720969956545, "vf_loss": 3.9807755270962994, "vf_explained_var": 0.005291748299169793, "kl": 0.008084250901183528, "entropy": 1.2123375721078702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -350.0, "episode_reward_mean": 40.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -23.525, "predator_policy": 43.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.0, 146.0, -4.0, 96.0, 129.0, -25.0, -50.0, -350.0, -114.0, 118.0, 12.0, 0.0, -68.0, 139.0, -59.0, 64.0, 76.0, 58.0, -122.0, -3.0, 223.0, -27.0, 44.0, -7.0, -14.0, 0.0, 192.0, 0.0, -40.0, -4.0, 188.0, 199.0, 0.0, 12.0, 25.0, 0.0, -15.0, 101.0, 0.0, -292.0, 59.0, -6.0, 74.0, 47.0, 29.0, 14.0, 69.0, 113.0, 250.0, -29.0, -12.0, 184.0, -5.0, 99.0, -40.0, -57.0, -35.0, 15.0, 165.0, -33.0, 97.0, -112.0, 0.0, -12.0, 165.0, 184.0, 99.0, 154.0, 178.0, 105.0, 133.0, 256.0, -24.0, -28.0, 0.0, 0.0, 62.0, 60.0, 7.0, 118.0, 67.0, 97.0, 2.0, 182.0, -4.0, 0.0, -2.0, 90.0, 0.0, 163.0, 0.0, 88.0, 27.0, -14.0, 9.0, 21.0, 340.0, 31.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 0.0, 0.0, 0.0, 125.0, 0.0, -283.0, 50.0, 38.0, -4.0, 0.0, 108.0, -379.0, 0.0, -386.0, 0.0, -250.0, -287.0, 0.0, -355.0, 77.0, 0.0, -135.0, 27.0, 0.0, 0.0, 0.0, -325.0, -18.0, 122.0, 0.0, -265.0, 156.0, -380.0, 20.0, -18.0, -43.0, 0.0, -331.0, 0.0, -112.0, -4.0, 59.0, 80.0, 0.0, -54.0, -161.0, 2.0, -4.0, -10.0, 0.0, -28.0, 0.0, 0.0, 192.0, -248.0, 0.0, 0.0, 0.0, -160.0, -8.0, 0.0, 0.0, 182.0, 199.0, 0.0, 0.0, 0.0, -2.0, -358.0, -144.0, 0.0, 0.0, 0.0, -4.0, -25.0, 0.0, 60.0, 0.0, 0.0, -276.0, -268.0, 0.0, 52.0, 0.0, -12.0, 42.0, -151.0, -41.0, 0.0, -123.0, 0.0, -10.0, 16.0, -164.0, 77.0, 111.0, 0.0, 148.0, 44.0, -125.0, -110.0, -24.0, 0.0, 0.0, 177.0, -36.0, -91.0, 0.0, 99.0, -106.0, -74.0, -193.0, -115.0, -70.0, 0.0, 0.0, -182.0, 113.0, -123.0, -44.0, -22.0, -70.0, -107.0, -136.0, -236.0, 0.0, 0.0, -2.0, -22.0, 0.0, 148.0, 179.0, 0.0, -2.0, 7.0, -2.0, 143.0, 31.0, 84.0, 0.0, 39.0, 98.0, 0.0, 195.0, -8.0, -56.0, -106.0, -41.0, -128.0, 0.0, 0.0, 0.0, 0.0, -51.0, -49.0, -120.0, 21.0, -18.0, 0.0, 20.0, 9.0, 0.0, -25.0, 0.0, 21.0, 2.0, 0.0, 128.0, 22.0, 0.0, -12.0, 0.0, 0.0, -46.0, -100.0, 0.0, 18.0, 0.0, 0.0, 163.0, 0.0, 0.0, 0.0, 88.0, 0.0, -34.0, -34.0, 0.0, -28.0, -2.0, -86.0, -59.0, 0.0, 189.0, 151.0, 0.0, 31.0, 0.0, -145.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 16.0, 5.0, 129.0, 100.0, 50.0, 12.0, 21.0, 0.0, 192.0, 162.0, 164.0, 172.0, 0.0, 187.0, 62.0, 179.0, 21.0, 20.0, 10.0, 110.0, 0.0, 0.0, 131.0, 126.0, 26.0, 9.0, 146.0, 60.0, 161.0, 127.0, 18.0, 56.0, 49.0, 52.0, 158.0, 51.0, 54.0, 59.0, 49.0, 35.0, 27.0, 0.0, 95.0, 108.0, 2.0, 5.0, 0.0, 14.0, 0.0, 0.0, 113.0, 135.0, 0.0, 0.0, 0.0, 120.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 184.0, 188.0, 86.0, 83.0, 0.0, 0.0, 0.0, 14.0, 0.0, 41.0, 0.0, 0.0, 158.0, 94.0, 7.0, 0.0, 6.0, 0.0, 89.0, 94.0, 40.0, 48.0, 94.0, 58.0, 6.0, 2.0, 75.0, 81.0, 2.0, 0.0, 49.0, 9.0, 82.0, 124.0, 10.0, 2.0, 7.0, 0.0, 67.0, 55.0, 0.0, 0.0, 92.0, 48.0, 123.0, 128.0, 35.0, 0.0, 95.0, 102.0, 88.0, 87.0, 11.0, 22.0, 154.0, 120.0, 169.0, 91.0, 0.0, 0.0, 1.0, 11.0, 12.0, 5.0, 5.0, 0.0, 60.0, 34.0, 0.0, 13.0, 30.0, 33.0, 33.0, 33.0, 20.0, 15.0, 9.0, 60.0, 38.0, 100.0, 58.0, 83.0, 0.0, 0.0, 0.0, 0.0, 60.0, 102.0, 84.0, 75.0, 0.0, 25.0, 25.0, 64.0, 34.0, 58.0, 34.0, 42.0, 0.0, 0.0, 32.0, 0.0, 0.0, 8.0, 0.0, 0.0, 101.0, 43.0, 50.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 66.0, 0.0, 14.0, 65.0, 32.0, 66.0, 14.0, 0.0, 0.0, 0.0, 0.0, 43.0, 106.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.995679344749733, "mean_inference_ms": 2.8918755217915684, "mean_action_processing_ms": 0.3817973531985167, "mean_env_wait_ms": 0.3550620923251229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008041620254516602, "StateBufferConnector_ms": 0.008151650428771973, "ViewRequirementAgentConnector_ms": 0.3339458703994751}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -350.0, "episode_return_mean": 40.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.39820440574306, "num_env_steps_trained_throughput_per_sec": 304.39820440574306, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 15432.569, "restore_workers_time_ms": 0.036, "training_step_time_ms": 15432.467, "sample_time_ms": 2452.495, "learn_time_ms": 12954.072, "learn_throughput": 308.783, "synch_weights_time_ms": 21.966}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "f1691_00002", "date": "2024-08-13_19-24-30", "timestamp": 1723591470, "time_this_iter_s": 13.205485105514526, "time_total_s": 3993.397654056549, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3993.397654056549, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 59.3888888888889, "ram_util_percent": 83.54444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3791734162540663, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 4.1606618226520595, "policy_loss": -0.006932223764637475, "vf_loss": 4.167299326134737, "vf_explained_var": -0.003840533703092545, "kl": 0.015718893275955548, "entropy": 1.2390921315818868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.87968862078808, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.085532134298294, "policy_loss": -0.004240653363534461, "vf_loss": 5.089754565052255, "vf_explained_var": -0.031848834967487076, "kl": 0.011652924130870317, "entropy": 1.2678791275100103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -295.0, "episode_reward_mean": 39.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -532.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 374.0}, "policy_reward_mean": {"prey_policy": -20.225, "predator_policy": 39.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.0, 44.0, -7.0, -14.0, 0.0, 192.0, 0.0, -40.0, -4.0, 188.0, 199.0, 0.0, 12.0, 25.0, 0.0, -15.0, 101.0, 0.0, -292.0, 59.0, -6.0, 74.0, 47.0, 29.0, 14.0, 69.0, 113.0, 250.0, -29.0, -12.0, 184.0, -5.0, 99.0, -40.0, -57.0, -35.0, 15.0, 165.0, -33.0, 97.0, -112.0, 0.0, -12.0, 165.0, 184.0, 99.0, 154.0, 178.0, 105.0, 133.0, 256.0, -24.0, -28.0, 0.0, 0.0, 62.0, 60.0, 7.0, 118.0, 67.0, 97.0, 2.0, 182.0, -4.0, 0.0, -2.0, 90.0, 0.0, 163.0, 0.0, 88.0, 27.0, -14.0, 9.0, 21.0, 340.0, 31.0, 4.0, 77.0, -33.0, 10.0, 107.0, 65.0, -47.0, 121.0, 197.0, 46.0, 19.0, -295.0, -31.0, -69.0, 11.0, 70.0, 12.0, 85.0, -9.0, -110.0, 1.0, -14.0, -85.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -54.0, -161.0, 2.0, -4.0, -10.0, 0.0, -28.0, 0.0, 0.0, 192.0, -248.0, 0.0, 0.0, 0.0, -160.0, -8.0, 0.0, 0.0, 182.0, 199.0, 0.0, 0.0, 0.0, -2.0, -358.0, -144.0, 0.0, 0.0, 0.0, -4.0, -25.0, 0.0, 60.0, 0.0, 0.0, -276.0, -268.0, 0.0, 52.0, 0.0, -12.0, 42.0, -151.0, -41.0, 0.0, -123.0, 0.0, -10.0, 16.0, -164.0, 77.0, 111.0, 0.0, 148.0, 44.0, -125.0, -110.0, -24.0, 0.0, 0.0, 177.0, -36.0, -91.0, 0.0, 99.0, -106.0, -74.0, -193.0, -115.0, -70.0, 0.0, 0.0, -182.0, 113.0, -123.0, -44.0, -22.0, -70.0, -107.0, -136.0, -236.0, 0.0, 0.0, -2.0, -22.0, 0.0, 148.0, 179.0, 0.0, -2.0, 7.0, -2.0, 143.0, 31.0, 84.0, 0.0, 39.0, 98.0, 0.0, 195.0, -8.0, -56.0, -106.0, -41.0, -128.0, 0.0, 0.0, 0.0, 0.0, -51.0, -49.0, -120.0, 21.0, -18.0, 0.0, 20.0, 9.0, 0.0, -25.0, 0.0, 21.0, 2.0, 0.0, 128.0, 22.0, 0.0, -12.0, 0.0, 0.0, -46.0, -100.0, 0.0, 18.0, 0.0, 0.0, 163.0, 0.0, 0.0, 0.0, 88.0, 0.0, -34.0, -34.0, 0.0, -28.0, -2.0, -86.0, -59.0, 0.0, 189.0, 151.0, 0.0, 31.0, 0.0, -145.0, 6.0, -8.0, -33.0, -151.0, -8.0, -89.0, 2.0, 25.0, -18.0, -43.0, -80.0, -61.0, 85.0, 0.0, 142.0, -39.0, -13.0, 0.0, 0.0, -44.0, -532.0, -146.0, -44.0, -28.0, -107.0, -155.0, -61.0, -99.0, 2.0, 15.0, -150.0, 47.0, 37.0, -2.0, 0.0, -59.0, -108.0, -108.0, 1.0, 0.0, 3.0, -64.0, -120.0, -50.0], "policy_predator_policy_reward": [27.0, 0.0, 95.0, 108.0, 2.0, 5.0, 0.0, 14.0, 0.0, 0.0, 113.0, 135.0, 0.0, 0.0, 0.0, 120.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 184.0, 188.0, 86.0, 83.0, 0.0, 0.0, 0.0, 14.0, 0.0, 41.0, 0.0, 0.0, 158.0, 94.0, 7.0, 0.0, 6.0, 0.0, 89.0, 94.0, 40.0, 48.0, 94.0, 58.0, 6.0, 2.0, 75.0, 81.0, 2.0, 0.0, 49.0, 9.0, 82.0, 124.0, 10.0, 2.0, 7.0, 0.0, 67.0, 55.0, 0.0, 0.0, 92.0, 48.0, 123.0, 128.0, 35.0, 0.0, 95.0, 102.0, 88.0, 87.0, 11.0, 22.0, 154.0, 120.0, 169.0, 91.0, 0.0, 0.0, 1.0, 11.0, 12.0, 5.0, 5.0, 0.0, 60.0, 34.0, 0.0, 13.0, 30.0, 33.0, 33.0, 33.0, 20.0, 15.0, 9.0, 60.0, 38.0, 100.0, 58.0, 83.0, 0.0, 0.0, 0.0, 0.0, 60.0, 102.0, 84.0, 75.0, 0.0, 25.0, 25.0, 64.0, 34.0, 58.0, 34.0, 42.0, 0.0, 0.0, 32.0, 0.0, 0.0, 8.0, 0.0, 0.0, 101.0, 43.0, 50.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 66.0, 0.0, 14.0, 65.0, 32.0, 66.0, 14.0, 0.0, 0.0, 0.0, 0.0, 43.0, 106.0, 37.0, 42.0, 89.0, 62.0, 21.0, 86.0, 22.0, 58.0, 58.0, 68.0, 41.0, 53.0, 11.0, 25.0, 41.0, 53.0, 24.0, 35.0, 28.0, 35.0, 374.0, 9.0, 22.0, 19.0, 128.0, 65.0, 83.0, 88.0, 26.0, 27.0, 73.0, 42.0, 14.0, 36.0, 50.0, 0.0, 52.0, 54.0, 0.0, 0.0, 46.0, 1.0, 0.0, 85.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9965538949081093, "mean_inference_ms": 2.8989272491105966, "mean_action_processing_ms": 0.3828489219363991, "mean_env_wait_ms": 0.3553673434036797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006245970726013184, "StateBufferConnector_ms": 0.0040247440338134766, "ViewRequirementAgentConnector_ms": 0.1716364622116089}, "num_episodes": 22, "episode_return_max": 340.0, "episode_return_min": -295.0, "episode_return_mean": 39.34, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.76047286691625, "num_env_steps_trained_throughput_per_sec": 308.76047286691625, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 15488.564, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15488.484, "sample_time_ms": 2489.863, "learn_time_ms": 12973.003, "learn_throughput": 308.333, "synch_weights_time_ms": 21.848}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "f1691_00002", "date": "2024-08-13_19-24-43", "timestamp": 1723591483, "time_this_iter_s": 12.986776113510132, "time_total_s": 4006.384430170059, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f94550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4006.384430170059, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 56.70526315789473, "ram_util_percent": 83.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4925122559464798, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.3014696285207434, "policy_loss": -0.0032860965620746057, "vf_loss": 3.304589175925684, "vf_explained_var": -0.0017181430544172015, "kl": 0.008882957348109514, "entropy": 1.233213446443043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.89537016257407, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.495529477684586, "policy_loss": -0.0037719766852056615, "vf_loss": 4.499286018477546, "vf_explained_var": -0.064518167449053, "kl": 0.009881168243637637, "entropy": 1.226643053375224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -295.0, "episode_reward_mean": 39.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -532.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 374.0}, "policy_reward_mean": {"prey_policy": -20.58, "predator_policy": 40.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 14.0, 69.0, 113.0, 250.0, -29.0, -12.0, 184.0, -5.0, 99.0, -40.0, -57.0, -35.0, 15.0, 165.0, -33.0, 97.0, -112.0, 0.0, -12.0, 165.0, 184.0, 99.0, 154.0, 178.0, 105.0, 133.0, 256.0, -24.0, -28.0, 0.0, 0.0, 62.0, 60.0, 7.0, 118.0, 67.0, 97.0, 2.0, 182.0, -4.0, 0.0, -2.0, 90.0, 0.0, 163.0, 0.0, 88.0, 27.0, -14.0, 9.0, 21.0, 340.0, 31.0, 4.0, 77.0, -33.0, 10.0, 107.0, 65.0, -47.0, 121.0, 197.0, 46.0, 19.0, -295.0, -31.0, -69.0, 11.0, 70.0, 12.0, 85.0, -9.0, -110.0, 1.0, -14.0, -85.0, -16.0, 37.0, 19.0, 85.0, -129.0, 98.0, -19.0, 33.0, -16.0, -40.0, -12.0, 0.0, 69.0, 113.0, -31.0, 85.0, 282.0, -15.0, -74.0, -24.0, 93.0, 0.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-123.0, 0.0, -10.0, 16.0, -164.0, 77.0, 111.0, 0.0, 148.0, 44.0, -125.0, -110.0, -24.0, 0.0, 0.0, 177.0, -36.0, -91.0, 0.0, 99.0, -106.0, -74.0, -193.0, -115.0, -70.0, 0.0, 0.0, -182.0, 113.0, -123.0, -44.0, -22.0, -70.0, -107.0, -136.0, -236.0, 0.0, 0.0, -2.0, -22.0, 0.0, 148.0, 179.0, 0.0, -2.0, 7.0, -2.0, 143.0, 31.0, 84.0, 0.0, 39.0, 98.0, 0.0, 195.0, -8.0, -56.0, -106.0, -41.0, -128.0, 0.0, 0.0, 0.0, 0.0, -51.0, -49.0, -120.0, 21.0, -18.0, 0.0, 20.0, 9.0, 0.0, -25.0, 0.0, 21.0, 2.0, 0.0, 128.0, 22.0, 0.0, -12.0, 0.0, 0.0, -46.0, -100.0, 0.0, 18.0, 0.0, 0.0, 163.0, 0.0, 0.0, 0.0, 88.0, 0.0, -34.0, -34.0, 0.0, -28.0, -2.0, -86.0, -59.0, 0.0, 189.0, 151.0, 0.0, 31.0, 0.0, -145.0, 6.0, -8.0, -33.0, -151.0, -8.0, -89.0, 2.0, 25.0, -18.0, -43.0, -80.0, -61.0, 85.0, 0.0, 142.0, -39.0, -13.0, 0.0, 0.0, -44.0, -532.0, -146.0, -44.0, -28.0, -107.0, -155.0, -61.0, -99.0, 2.0, 15.0, -150.0, 47.0, 37.0, -2.0, 0.0, -59.0, -108.0, -108.0, 1.0, 0.0, 3.0, -64.0, -120.0, -50.0, -11.0, -16.0, 38.0, -35.0, -236.0, 55.0, 13.0, -55.0, -258.0, -181.0, 56.0, 42.0, -46.0, -250.0, 33.0, 0.0, -32.0, 0.0, -135.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 1.0, 88.0, -54.0, -142.0, 0.0, 0.0, 85.0, 143.0, 130.0, -59.0, -78.0, -355.0, -59.0, 0.0, -49.0, 93.0, 0.0, 0.0, 0.0, 0.0, 4.0], "policy_predator_policy_reward": [94.0, 58.0, 6.0, 2.0, 75.0, 81.0, 2.0, 0.0, 49.0, 9.0, 82.0, 124.0, 10.0, 2.0, 7.0, 0.0, 67.0, 55.0, 0.0, 0.0, 92.0, 48.0, 123.0, 128.0, 35.0, 0.0, 95.0, 102.0, 88.0, 87.0, 11.0, 22.0, 154.0, 120.0, 169.0, 91.0, 0.0, 0.0, 1.0, 11.0, 12.0, 5.0, 5.0, 0.0, 60.0, 34.0, 0.0, 13.0, 30.0, 33.0, 33.0, 33.0, 20.0, 15.0, 9.0, 60.0, 38.0, 100.0, 58.0, 83.0, 0.0, 0.0, 0.0, 0.0, 60.0, 102.0, 84.0, 75.0, 0.0, 25.0, 25.0, 64.0, 34.0, 58.0, 34.0, 42.0, 0.0, 0.0, 32.0, 0.0, 0.0, 8.0, 0.0, 0.0, 101.0, 43.0, 50.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 66.0, 0.0, 14.0, 65.0, 32.0, 66.0, 14.0, 0.0, 0.0, 0.0, 0.0, 43.0, 106.0, 37.0, 42.0, 89.0, 62.0, 21.0, 86.0, 22.0, 58.0, 58.0, 68.0, 41.0, 53.0, 11.0, 25.0, 41.0, 53.0, 24.0, 35.0, 28.0, 35.0, 374.0, 9.0, 22.0, 19.0, 128.0, 65.0, 83.0, 88.0, 26.0, 27.0, 73.0, 42.0, 14.0, 36.0, 50.0, 0.0, 52.0, 54.0, 0.0, 0.0, 46.0, 1.0, 0.0, 85.0, 11.0, 0.0, 0.0, 34.0, 107.0, 93.0, 94.0, 33.0, 232.0, 78.0, 0.0, 0.0, 118.0, 159.0, 0.0, 0.0, 16.0, 0.0, 35.0, 60.0, 0.0, 12.0, 0.0, 0.0, 36.0, 34.0, 47.0, 32.0, 26.0, 85.0, 0.0, 0.0, 9.0, 0.0, 56.0, 66.0, 227.0, 113.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9988601314189958, "mean_inference_ms": 2.8997504470701836, "mean_action_processing_ms": 0.38317774496614504, "mean_env_wait_ms": 0.35387221130063795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005539417266845703, "StateBufferConnector_ms": 0.003826737403869629, "ViewRequirementAgentConnector_ms": 0.15529108047485352}, "num_episodes": 23, "episode_return_max": 340.0, "episode_return_min": -295.0, "episode_return_mean": 39.4, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.1501069875413, "num_env_steps_trained_throughput_per_sec": 298.1501069875413, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 15576.907, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15576.85, "sample_time_ms": 2476.422, "learn_time_ms": 13075.024, "learn_throughput": 305.927, "synch_weights_time_ms": 21.711}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "f1691_00002", "date": "2024-08-13_19-24-56", "timestamp": 1723591496, "time_this_iter_s": 13.474730968475342, "time_total_s": 4019.8591611385345, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f95040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4019.8591611385345, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 59.40526315789473, "ram_util_percent": 83.93157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.65615496375258, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 5.42042333032719, "policy_loss": -0.005510524208731358, "vf_loss": 5.425570474856745, "vf_explained_var": 0.0018015371113227158, "kl": 0.019380273299948857, "entropy": 1.2389816374375076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.1594823999222, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.191545428422393, "policy_loss": -0.0035775664994227036, "vf_loss": 6.195108959914515, "vf_explained_var": 0.029387873852694476, "kl": 0.00898548323781786, "entropy": 1.2556894655580875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -876.0, "episode_reward_mean": 5.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1150.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 1194.0}, "policy_reward_mean": {"prey_policy": -59.135, "predator_policy": 61.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -12.0, 165.0, 184.0, 99.0, 154.0, 178.0, 105.0, 133.0, 256.0, -24.0, -28.0, 0.0, 0.0, 62.0, 60.0, 7.0, 118.0, 67.0, 97.0, 2.0, 182.0, -4.0, 0.0, -2.0, 90.0, 0.0, 163.0, 0.0, 88.0, 27.0, -14.0, 9.0, 21.0, 340.0, 31.0, 4.0, 77.0, -33.0, 10.0, 107.0, 65.0, -47.0, 121.0, 197.0, 46.0, 19.0, -295.0, -31.0, -69.0, 11.0, 70.0, 12.0, 85.0, -9.0, -110.0, 1.0, -14.0, -85.0, -16.0, 37.0, 19.0, 85.0, -129.0, 98.0, -19.0, 33.0, -16.0, -40.0, -12.0, 0.0, 69.0, 113.0, -31.0, 85.0, 282.0, -15.0, -74.0, -24.0, 93.0, 0.0, 4.0, -79.0, 40.0, -46.0, 0.0, -4.0, -177.0, 100.0, -114.0, -59.0, -703.0, 1.0, 4.0, -33.0, -47.0, -100.0, 1.0, -876.0, -587.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -2.0, -22.0, 0.0, 148.0, 179.0, 0.0, -2.0, 7.0, -2.0, 143.0, 31.0, 84.0, 0.0, 39.0, 98.0, 0.0, 195.0, -8.0, -56.0, -106.0, -41.0, -128.0, 0.0, 0.0, 0.0, 0.0, -51.0, -49.0, -120.0, 21.0, -18.0, 0.0, 20.0, 9.0, 0.0, -25.0, 0.0, 21.0, 2.0, 0.0, 128.0, 22.0, 0.0, -12.0, 0.0, 0.0, -46.0, -100.0, 0.0, 18.0, 0.0, 0.0, 163.0, 0.0, 0.0, 0.0, 88.0, 0.0, -34.0, -34.0, 0.0, -28.0, -2.0, -86.0, -59.0, 0.0, 189.0, 151.0, 0.0, 31.0, 0.0, -145.0, 6.0, -8.0, -33.0, -151.0, -8.0, -89.0, 2.0, 25.0, -18.0, -43.0, -80.0, -61.0, 85.0, 0.0, 142.0, -39.0, -13.0, 0.0, 0.0, -44.0, -532.0, -146.0, -44.0, -28.0, -107.0, -155.0, -61.0, -99.0, 2.0, 15.0, -150.0, 47.0, 37.0, -2.0, 0.0, -59.0, -108.0, -108.0, 1.0, 0.0, 3.0, -64.0, -120.0, -50.0, -11.0, -16.0, 38.0, -35.0, -236.0, 55.0, 13.0, -55.0, -258.0, -181.0, 56.0, 42.0, -46.0, -250.0, 33.0, 0.0, -32.0, 0.0, -135.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 1.0, 88.0, -54.0, -142.0, 0.0, 0.0, 85.0, 143.0, 130.0, -59.0, -78.0, -355.0, -59.0, 0.0, -49.0, 93.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -243.0, 40.0, 0.0, -48.0, -57.0, 0.0, 0.0, -4.0, -3.0, -242.0, -130.0, 0.0, 100.0, 0.0, -340.0, -1032.0, -36.0, -978.0, -792.0, 0.0, -116.0, 0.0, -81.0, -162.0, -68.0, -13.0, -898.0, 0.0, -335.0, -25.0, 0.0, -920.0, -1150.0, -980.0, -574.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 11.0, 12.0, 5.0, 5.0, 0.0, 60.0, 34.0, 0.0, 13.0, 30.0, 33.0, 33.0, 33.0, 20.0, 15.0, 9.0, 60.0, 38.0, 100.0, 58.0, 83.0, 0.0, 0.0, 0.0, 0.0, 60.0, 102.0, 84.0, 75.0, 0.0, 25.0, 25.0, 64.0, 34.0, 58.0, 34.0, 42.0, 0.0, 0.0, 32.0, 0.0, 0.0, 8.0, 0.0, 0.0, 101.0, 43.0, 50.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 66.0, 0.0, 14.0, 65.0, 32.0, 66.0, 14.0, 0.0, 0.0, 0.0, 0.0, 43.0, 106.0, 37.0, 42.0, 89.0, 62.0, 21.0, 86.0, 22.0, 58.0, 58.0, 68.0, 41.0, 53.0, 11.0, 25.0, 41.0, 53.0, 24.0, 35.0, 28.0, 35.0, 374.0, 9.0, 22.0, 19.0, 128.0, 65.0, 83.0, 88.0, 26.0, 27.0, 73.0, 42.0, 14.0, 36.0, 50.0, 0.0, 52.0, 54.0, 0.0, 0.0, 46.0, 1.0, 0.0, 85.0, 11.0, 0.0, 0.0, 34.0, 107.0, 93.0, 94.0, 33.0, 232.0, 78.0, 0.0, 0.0, 118.0, 159.0, 0.0, 0.0, 16.0, 0.0, 35.0, 60.0, 0.0, 12.0, 0.0, 0.0, 36.0, 34.0, 47.0, 32.0, 26.0, 85.0, 0.0, 0.0, 9.0, 0.0, 56.0, 66.0, 227.0, 113.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 127.0, 0.0, 0.0, 39.0, 20.0, 0.0, 0.0, 3.0, 0.0, 16.0, 179.0, 0.0, 0.0, 136.0, 90.0, 941.0, 68.0, 0.0, 1067.0, 43.0, 74.0, 39.0, 46.0, 92.0, 105.0, 81.0, 783.0, 115.0, 120.0, 0.0, 26.0, 0.0, 1194.0, 940.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9947767450731786, "mean_inference_ms": 2.889001794639796, "mean_action_processing_ms": 0.3818101133836951, "mean_env_wait_ms": 0.3521708798473868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004854321479797363, "StateBufferConnector_ms": 0.0036656856536865234, "ViewRequirementAgentConnector_ms": 0.13108479976654053}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -876.0, "episode_return_mean": 5.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.998902931728, "num_env_steps_trained_throughput_per_sec": 277.998902931728, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15578.729, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15578.672, "sample_time_ms": 2463.656, "learn_time_ms": 13089.843, "learn_throughput": 305.58, "synch_weights_time_ms": 21.561}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "f1691_00002", "date": "2024-08-13_19-25-11", "timestamp": 1723591511, "time_this_iter_s": 14.449186086654663, "time_total_s": 4034.308347225189, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4034.308347225189, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 61.065, "ram_util_percent": 83.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6393443228233429, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 0.00010000000000000003, "total_loss": 6.183088423209216, "policy_loss": -0.009282163462340438, "vf_loss": 6.191730258578346, "vf_explained_var": 0.00805959666847552, "kl": 0.03415141074256952, "entropy": 1.1495415119897752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.95003750737382, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 7.635591862693666, "policy_loss": -0.0017379398726261955, "vf_loss": 7.637306598128465, "vf_explained_var": 0.07050877122021226, "kl": 0.01484536739968599, "entropy": 1.2619154693588377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 603.0, "episode_reward_min": -876.0, "episode_reward_mean": -25.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1150.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 1194.0}, "policy_reward_mean": {"prey_policy": -112.21, "predator_policy": 99.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.0, 97.0, 2.0, 182.0, -4.0, 0.0, -2.0, 90.0, 0.0, 163.0, 0.0, 88.0, 27.0, -14.0, 9.0, 21.0, 340.0, 31.0, 4.0, 77.0, -33.0, 10.0, 107.0, 65.0, -47.0, 121.0, 197.0, 46.0, 19.0, -295.0, -31.0, -69.0, 11.0, 70.0, 12.0, 85.0, -9.0, -110.0, 1.0, -14.0, -85.0, -16.0, 37.0, 19.0, 85.0, -129.0, 98.0, -19.0, 33.0, -16.0, -40.0, -12.0, 0.0, 69.0, 113.0, -31.0, 85.0, 282.0, -15.0, -74.0, -24.0, 93.0, 0.0, 4.0, -79.0, 40.0, -46.0, 0.0, -4.0, -177.0, 100.0, -114.0, -59.0, -703.0, 1.0, 4.0, -33.0, -47.0, -100.0, 1.0, -876.0, -587.0, -80.0, 603.0, -290.0, -119.0, -206.0, -53.0, -172.0, -202.0, -51.0, -792.0, -236.0, 28.0, 61.0, 48.0, 46.0, -21.0, -191.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -25.0, 0.0, 21.0, 2.0, 0.0, 128.0, 22.0, 0.0, -12.0, 0.0, 0.0, -46.0, -100.0, 0.0, 18.0, 0.0, 0.0, 163.0, 0.0, 0.0, 0.0, 88.0, 0.0, -34.0, -34.0, 0.0, -28.0, -2.0, -86.0, -59.0, 0.0, 189.0, 151.0, 0.0, 31.0, 0.0, -145.0, 6.0, -8.0, -33.0, -151.0, -8.0, -89.0, 2.0, 25.0, -18.0, -43.0, -80.0, -61.0, 85.0, 0.0, 142.0, -39.0, -13.0, 0.0, 0.0, -44.0, -532.0, -146.0, -44.0, -28.0, -107.0, -155.0, -61.0, -99.0, 2.0, 15.0, -150.0, 47.0, 37.0, -2.0, 0.0, -59.0, -108.0, -108.0, 1.0, 0.0, 3.0, -64.0, -120.0, -50.0, -11.0, -16.0, 38.0, -35.0, -236.0, 55.0, 13.0, -55.0, -258.0, -181.0, 56.0, 42.0, -46.0, -250.0, 33.0, 0.0, -32.0, 0.0, -135.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 1.0, 88.0, -54.0, -142.0, 0.0, 0.0, 85.0, 143.0, 130.0, -59.0, -78.0, -355.0, -59.0, 0.0, -49.0, 93.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -243.0, 40.0, 0.0, -48.0, -57.0, 0.0, 0.0, -4.0, -3.0, -242.0, -130.0, 0.0, 100.0, 0.0, -340.0, -1032.0, -36.0, -978.0, -792.0, 0.0, -116.0, 0.0, -81.0, -162.0, -68.0, -13.0, -898.0, 0.0, -335.0, -25.0, 0.0, -920.0, -1150.0, -980.0, -574.0, -67.0, -670.0, 147.0, -656.0, -273.0, -234.0, -135.0, -83.0, -227.0, -652.0, -155.0, 0.0, -141.0, -221.0, -546.0, -212.0, -32.0, -524.0, -962.0, -858.0, -319.0, -553.0, -81.0, -4.0, -97.0, -64.0, 5.0, -30.0, 70.0, -520.0, -22.0, -88.0, -187.0, -844.0, -1080.0, 69.0], "policy_predator_policy_reward": [34.0, 58.0, 34.0, 42.0, 0.0, 0.0, 32.0, 0.0, 0.0, 8.0, 0.0, 0.0, 101.0, 43.0, 50.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 66.0, 0.0, 14.0, 65.0, 32.0, 66.0, 14.0, 0.0, 0.0, 0.0, 0.0, 43.0, 106.0, 37.0, 42.0, 89.0, 62.0, 21.0, 86.0, 22.0, 58.0, 58.0, 68.0, 41.0, 53.0, 11.0, 25.0, 41.0, 53.0, 24.0, 35.0, 28.0, 35.0, 374.0, 9.0, 22.0, 19.0, 128.0, 65.0, 83.0, 88.0, 26.0, 27.0, 73.0, 42.0, 14.0, 36.0, 50.0, 0.0, 52.0, 54.0, 0.0, 0.0, 46.0, 1.0, 0.0, 85.0, 11.0, 0.0, 0.0, 34.0, 107.0, 93.0, 94.0, 33.0, 232.0, 78.0, 0.0, 0.0, 118.0, 159.0, 0.0, 0.0, 16.0, 0.0, 35.0, 60.0, 0.0, 12.0, 0.0, 0.0, 36.0, 34.0, 47.0, 32.0, 26.0, 85.0, 0.0, 0.0, 9.0, 0.0, 56.0, 66.0, 227.0, 113.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 127.0, 0.0, 0.0, 39.0, 20.0, 0.0, 0.0, 3.0, 0.0, 16.0, 179.0, 0.0, 0.0, 136.0, 90.0, 941.0, 68.0, 0.0, 1067.0, 43.0, 74.0, 39.0, 46.0, 92.0, 105.0, 81.0, 783.0, 115.0, 120.0, 0.0, 26.0, 0.0, 1194.0, 940.0, 27.0, 72.0, 585.0, 574.0, 538.0, 99.0, 118.0, 59.0, 40.0, 127.0, 546.0, 45.0, 57.0, 94.0, 96.0, 523.0, 33.0, 73.0, 432.0, 4.0, 1024.0, 567.0, 69.0, 60.0, 53.0, 79.0, 143.0, 38.0, 35.0, 16.0, 480.0, 53.0, 36.0, 784.0, 56.0, 27.0, 970.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9907492218115803, "mean_inference_ms": 2.87997794828981, "mean_action_processing_ms": 0.38042786506111326, "mean_env_wait_ms": 0.350526099880748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070035457611083984, "StateBufferConnector_ms": 0.0034945011138916016, "ViewRequirementAgentConnector_ms": 0.16828477382659912}, "num_episodes": 18, "episode_return_max": 603.0, "episode_return_min": -876.0, "episode_return_mean": -25.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.82323318003506, "num_env_steps_trained_throughput_per_sec": 266.82323318003506, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 15781.65, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15781.593, "sample_time_ms": 2529.666, "learn_time_ms": 13226.05, "learn_throughput": 302.433, "synch_weights_time_ms": 22.136}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "f1691_00002", "date": "2024-08-13_19-25-26", "timestamp": 1723591526, "time_this_iter_s": 15.036717176437378, "time_total_s": 4049.3450644016266, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41734c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4049.3450644016266, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 65.20454545454547, "ram_util_percent": 83.96818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4912440226506936, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 6.737185574334765, "policy_loss": -0.0024715130745861973, "vf_loss": 6.739358057546868, "vf_explained_var": 0.0036986491352162033, "kl": 0.010631815094922555, "entropy": 1.1097936158457762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.993000017823995, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 7.799846716532632, "policy_loss": -0.001802577964207601, "vf_loss": 7.801635621842884, "vf_explained_var": 0.056141440231333335, "kl": 0.008763530797558284, "entropy": 1.2604591458562822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 858.0, "episode_reward_min": -876.0, "episode_reward_mean": -50.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.0, "predator_policy": 1323.0}, "policy_reward_mean": {"prey_policy": -184.8, "predator_policy": 159.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.0, 65.0, -47.0, 121.0, 197.0, 46.0, 19.0, -295.0, -31.0, -69.0, 11.0, 70.0, 12.0, 85.0, -9.0, -110.0, 1.0, -14.0, -85.0, -16.0, 37.0, 19.0, 85.0, -129.0, 98.0, -19.0, 33.0, -16.0, -40.0, -12.0, 0.0, 69.0, 113.0, -31.0, 85.0, 282.0, -15.0, -74.0, -24.0, 93.0, 0.0, 4.0, -79.0, 40.0, -46.0, 0.0, -4.0, -177.0, 100.0, -114.0, -59.0, -703.0, 1.0, 4.0, -33.0, -47.0, -100.0, 1.0, -876.0, -587.0, -80.0, 603.0, -290.0, -119.0, -206.0, -53.0, -172.0, -202.0, -51.0, -792.0, -236.0, 28.0, 61.0, 48.0, 46.0, -21.0, -191.0, -14.0, 182.0, -479.0, -357.0, -146.0, 272.0, -98.0, -83.0, 858.0, -495.0, 19.0, -84.0, 94.0, 11.0, -301.0, -36.0, -78.0, 77.0, -17.0, -196.0, -409.0, 72.0, -114.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 25.0, -18.0, -43.0, -80.0, -61.0, 85.0, 0.0, 142.0, -39.0, -13.0, 0.0, 0.0, -44.0, -532.0, -146.0, -44.0, -28.0, -107.0, -155.0, -61.0, -99.0, 2.0, 15.0, -150.0, 47.0, 37.0, -2.0, 0.0, -59.0, -108.0, -108.0, 1.0, 0.0, 3.0, -64.0, -120.0, -50.0, -11.0, -16.0, 38.0, -35.0, -236.0, 55.0, 13.0, -55.0, -258.0, -181.0, 56.0, 42.0, -46.0, -250.0, 33.0, 0.0, -32.0, 0.0, -135.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 1.0, 88.0, -54.0, -142.0, 0.0, 0.0, 85.0, 143.0, 130.0, -59.0, -78.0, -355.0, -59.0, 0.0, -49.0, 93.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -243.0, 40.0, 0.0, -48.0, -57.0, 0.0, 0.0, -4.0, -3.0, -242.0, -130.0, 0.0, 100.0, 0.0, -340.0, -1032.0, -36.0, -978.0, -792.0, 0.0, -116.0, 0.0, -81.0, -162.0, -68.0, -13.0, -898.0, 0.0, -335.0, -25.0, 0.0, -920.0, -1150.0, -980.0, -574.0, -67.0, -670.0, 147.0, -656.0, -273.0, -234.0, -135.0, -83.0, -227.0, -652.0, -155.0, 0.0, -141.0, -221.0, -546.0, -212.0, -32.0, -524.0, -962.0, -858.0, -319.0, -553.0, -81.0, -4.0, -97.0, -64.0, 5.0, -30.0, 70.0, -520.0, -22.0, -88.0, -187.0, -844.0, -1080.0, 69.0, -1284.0, -860.0, -606.0, -1166.0, -365.0, -300.0, -328.0, -28.0, 116.0, -91.0, -332.0, -6.0, -710.0, -87.0, 123.0, -914.0, -588.0, -854.0, -45.0, -15.0, 0.0, -281.0, 0.0, -40.0, -80.0, -476.0, -245.0, -305.0, -107.0, -44.0, -1228.0, -35.0, 0.0, 69.0, -628.0, 8.0, -809.0, -140.0, -706.0, -502.0, 63.0, -481.0, -74.0, -178.0], "policy_predator_policy_reward": [22.0, 58.0, 58.0, 68.0, 41.0, 53.0, 11.0, 25.0, 41.0, 53.0, 24.0, 35.0, 28.0, 35.0, 374.0, 9.0, 22.0, 19.0, 128.0, 65.0, 83.0, 88.0, 26.0, 27.0, 73.0, 42.0, 14.0, 36.0, 50.0, 0.0, 52.0, 54.0, 0.0, 0.0, 46.0, 1.0, 0.0, 85.0, 11.0, 0.0, 0.0, 34.0, 107.0, 93.0, 94.0, 33.0, 232.0, 78.0, 0.0, 0.0, 118.0, 159.0, 0.0, 0.0, 16.0, 0.0, 35.0, 60.0, 0.0, 12.0, 0.0, 0.0, 36.0, 34.0, 47.0, 32.0, 26.0, 85.0, 0.0, 0.0, 9.0, 0.0, 56.0, 66.0, 227.0, 113.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 127.0, 0.0, 0.0, 39.0, 20.0, 0.0, 0.0, 3.0, 0.0, 16.0, 179.0, 0.0, 0.0, 136.0, 90.0, 941.0, 68.0, 0.0, 1067.0, 43.0, 74.0, 39.0, 46.0, 92.0, 105.0, 81.0, 783.0, 115.0, 120.0, 0.0, 26.0, 0.0, 1194.0, 940.0, 27.0, 72.0, 585.0, 574.0, 538.0, 99.0, 118.0, 59.0, 40.0, 127.0, 546.0, 45.0, 57.0, 94.0, 96.0, 523.0, 33.0, 73.0, 432.0, 4.0, 1024.0, 567.0, 69.0, 60.0, 53.0, 79.0, 143.0, 38.0, 35.0, 16.0, 480.0, 53.0, 36.0, 784.0, 56.0, 27.0, 970.0, 1003.0, 1323.0, 0.0, 1293.0, 190.0, 118.0, 126.0, 84.0, 128.0, 119.0, 97.0, 143.0, 640.0, 74.0, 802.0, 847.0, 932.0, 15.0, 33.0, 46.0, 76.0, 121.0, 72.0, 62.0, 511.0, 56.0, 89.0, 160.0, 77.0, 38.0, 51.0, 1134.0, 0.0, 8.0, 34.0, 569.0, 0.0, 753.0, 0.0, 799.0, 452.0, 38.0, 70.0, 68.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9849579888824757, "mean_inference_ms": 2.8706348604272898, "mean_action_processing_ms": 0.37859305991292347, "mean_env_wait_ms": 0.34948000030050336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006513357162475586, "StateBufferConnector_ms": 0.0047005414962768555, "ViewRequirementAgentConnector_ms": 0.17272067070007324}, "num_episodes": 22, "episode_return_max": 858.0, "episode_return_min": -876.0, "episode_return_mean": -50.12, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.7897130265556, "num_env_steps_trained_throughput_per_sec": 275.7897130265556, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 15272.718, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15272.66, "sample_time_ms": 2478.795, "learn_time_ms": 12769.634, "learn_throughput": 313.243, "synch_weights_time_ms": 21.021}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "f1691_00002", "date": "2024-08-13_19-25-40", "timestamp": 1723591540, "time_this_iter_s": 14.556627988815308, "time_total_s": 4063.901692390442, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4063.901692390442, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 58.78499999999999, "ram_util_percent": 83.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4122757061448679, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 7.29379182416926, "policy_loss": -0.0016187031758288857, "vf_loss": 7.295093799268127, "vf_explained_var": 0.0008270781191568527, "kl": 0.011261701886191768, "entropy": 1.0966996983876305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.339387910801268, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 8.166211032110548, "policy_loss": -0.0043535348885352645, "vf_loss": 8.170547067046796, "vf_explained_var": 0.07536076332526233, "kl": 0.01120416619509747, "entropy": 1.25221838168997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 937.0, "episode_reward_min": -876.0, "episode_reward_mean": -40.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.0, "predator_policy": 1323.0}, "policy_reward_mean": {"prey_policy": -225.885, "predator_policy": 205.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.0, 98.0, -19.0, 33.0, -16.0, -40.0, -12.0, 0.0, 69.0, 113.0, -31.0, 85.0, 282.0, -15.0, -74.0, -24.0, 93.0, 0.0, 4.0, -79.0, 40.0, -46.0, 0.0, -4.0, -177.0, 100.0, -114.0, -59.0, -703.0, 1.0, 4.0, -33.0, -47.0, -100.0, 1.0, -876.0, -587.0, -80.0, 603.0, -290.0, -119.0, -206.0, -53.0, -172.0, -202.0, -51.0, -792.0, -236.0, 28.0, 61.0, 48.0, 46.0, -21.0, -191.0, -14.0, 182.0, -479.0, -357.0, -146.0, 272.0, -98.0, -83.0, 858.0, -495.0, 19.0, -84.0, 94.0, 11.0, -301.0, -36.0, -78.0, 77.0, -17.0, -196.0, -409.0, 72.0, -114.0, 937.0, 89.0, -136.0, 421.0, 227.0, -485.0, -119.0, -134.0, -196.0, 52.0, 340.0, -10.0, -21.0, -30.0, 0.0, -97.0, -129.0, -28.0, -104.0, -104.0, -99.0, 818.0, -36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-258.0, -181.0, 56.0, 42.0, -46.0, -250.0, 33.0, 0.0, -32.0, 0.0, -135.0, 0.0, -24.0, 0.0, 0.0, 0.0, -2.0, 1.0, 88.0, -54.0, -142.0, 0.0, 0.0, 85.0, 143.0, 130.0, -59.0, -78.0, -355.0, -59.0, 0.0, -49.0, 93.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -243.0, 40.0, 0.0, -48.0, -57.0, 0.0, 0.0, -4.0, -3.0, -242.0, -130.0, 0.0, 100.0, 0.0, -340.0, -1032.0, -36.0, -978.0, -792.0, 0.0, -116.0, 0.0, -81.0, -162.0, -68.0, -13.0, -898.0, 0.0, -335.0, -25.0, 0.0, -920.0, -1150.0, -980.0, -574.0, -67.0, -670.0, 147.0, -656.0, -273.0, -234.0, -135.0, -83.0, -227.0, -652.0, -155.0, 0.0, -141.0, -221.0, -546.0, -212.0, -32.0, -524.0, -962.0, -858.0, -319.0, -553.0, -81.0, -4.0, -97.0, -64.0, 5.0, -30.0, 70.0, -520.0, -22.0, -88.0, -187.0, -844.0, -1080.0, 69.0, -1284.0, -860.0, -606.0, -1166.0, -365.0, -300.0, -328.0, -28.0, 116.0, -91.0, -332.0, -6.0, -710.0, -87.0, 123.0, -914.0, -588.0, -854.0, -45.0, -15.0, 0.0, -281.0, 0.0, -40.0, -80.0, -476.0, -245.0, -305.0, -107.0, -44.0, -1228.0, -35.0, 0.0, 69.0, -628.0, 8.0, -809.0, -140.0, -706.0, -502.0, 63.0, -481.0, -74.0, -178.0, 100.0, -1088.0, 15.0, 15.0, -159.0, -680.0, 126.0, -276.0, 116.0, 111.0, -1024.0, -568.0, -28.0, -247.0, -326.0, -57.0, -1142.0, -287.0, 5.0, 0.0, 122.0, -152.0, -73.0, -622.0, -141.0, 0.0, -6.0, -866.0, 0.0, 0.0, -215.0, -45.0, -127.0, -613.0, -76.0, -47.0, -418.0, -156.0, -121.0, -77.0, -18.0, -324.0, -904.0, 109.0, -72.0, 0.0], "policy_predator_policy_reward": [232.0, 78.0, 0.0, 0.0, 118.0, 159.0, 0.0, 0.0, 16.0, 0.0, 35.0, 60.0, 0.0, 12.0, 0.0, 0.0, 36.0, 34.0, 47.0, 32.0, 26.0, 85.0, 0.0, 0.0, 9.0, 0.0, 56.0, 66.0, 227.0, 113.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 127.0, 0.0, 0.0, 39.0, 20.0, 0.0, 0.0, 3.0, 0.0, 16.0, 179.0, 0.0, 0.0, 136.0, 90.0, 941.0, 68.0, 0.0, 1067.0, 43.0, 74.0, 39.0, 46.0, 92.0, 105.0, 81.0, 783.0, 115.0, 120.0, 0.0, 26.0, 0.0, 1194.0, 940.0, 27.0, 72.0, 585.0, 574.0, 538.0, 99.0, 118.0, 59.0, 40.0, 127.0, 546.0, 45.0, 57.0, 94.0, 96.0, 523.0, 33.0, 73.0, 432.0, 4.0, 1024.0, 567.0, 69.0, 60.0, 53.0, 79.0, 143.0, 38.0, 35.0, 16.0, 480.0, 53.0, 36.0, 784.0, 56.0, 27.0, 970.0, 1003.0, 1323.0, 0.0, 1293.0, 190.0, 118.0, 126.0, 84.0, 128.0, 119.0, 97.0, 143.0, 640.0, 74.0, 802.0, 847.0, 932.0, 15.0, 33.0, 46.0, 76.0, 121.0, 72.0, 62.0, 511.0, 56.0, 89.0, 160.0, 77.0, 38.0, 51.0, 1134.0, 0.0, 8.0, 34.0, 569.0, 0.0, 753.0, 0.0, 799.0, 452.0, 38.0, 70.0, 68.0, 931.0, 994.0, 0.0, 59.0, 103.0, 600.0, 296.0, 275.0, 0.0, 0.0, 0.0, 1107.0, 66.0, 90.0, 113.0, 136.0, 1081.0, 152.0, 28.0, 19.0, 185.0, 185.0, 86.0, 599.0, 63.0, 57.0, 39.0, 803.0, 0.0, 0.0, 55.0, 108.0, 600.0, 11.0, 95.0, 0.0, 369.0, 101.0, 94.0, 0.0, 86.0, 157.0, 791.0, 822.0, 27.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9809407997913933, "mean_inference_ms": 2.8470236637188107, "mean_action_processing_ms": 0.37694968219684566, "mean_env_wait_ms": 0.34716014641708276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006584286689758301, "StateBufferConnector_ms": 0.004676699638366699, "ViewRequirementAgentConnector_ms": 0.16722047328948975}, "num_episodes": 23, "episode_return_max": 937.0, "episode_return_min": -876.0, "episode_return_mean": -40.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.6991165903841, "num_env_steps_trained_throughput_per_sec": 313.6991165903841, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 14671.201, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14671.146, "sample_time_ms": 2169.529, "learn_time_ms": 12478.754, "learn_throughput": 320.545, "synch_weights_time_ms": 19.93}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "f1691_00002", "date": "2024-08-13_19-25-53", "timestamp": 1723591553, "time_this_iter_s": 12.809671878814697, "time_total_s": 4076.7113642692566, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f948b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4076.7113642692566, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.099999999999994, "ram_util_percent": 78.3157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1712137850188704, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 5.350950376697318, "policy_loss": -0.0031679288166323824, "vf_loss": 5.353739795104536, "vf_explained_var": 0.0005197725598774259, "kl": 0.01345805686832188, "entropy": 1.06298527370685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.594254231232185, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 7.296619980675834, "policy_loss": -0.001278813527995553, "vf_loss": 7.297883021137702, "vf_explained_var": 0.037191926739203233, "kl": 0.010089785339621394, "entropy": 1.3518296521176736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 937.0, "episode_reward_min": -876.0, "episode_reward_mean": -59.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.0, "predator_policy": 1323.0}, "policy_reward_mean": {"prey_policy": -256.62, "predator_policy": 226.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -79.0, 40.0, -46.0, 0.0, -4.0, -177.0, 100.0, -114.0, -59.0, -703.0, 1.0, 4.0, -33.0, -47.0, -100.0, 1.0, -876.0, -587.0, -80.0, 603.0, -290.0, -119.0, -206.0, -53.0, -172.0, -202.0, -51.0, -792.0, -236.0, 28.0, 61.0, 48.0, 46.0, -21.0, -191.0, -14.0, 182.0, -479.0, -357.0, -146.0, 272.0, -98.0, -83.0, 858.0, -495.0, 19.0, -84.0, 94.0, 11.0, -301.0, -36.0, -78.0, 77.0, -17.0, -196.0, -409.0, 72.0, -114.0, 937.0, 89.0, -136.0, 421.0, 227.0, -485.0, -119.0, -134.0, -196.0, 52.0, 340.0, -10.0, -21.0, -30.0, 0.0, -97.0, -129.0, -28.0, -104.0, -104.0, -99.0, 818.0, -36.0, -46.0, -313.0, -75.0, 0.0, -124.0, -2.0, 0.0, 3.0, 37.0, 111.0, -187.0, -503.0, -190.0, -105.0, 12.0, -47.0, -83.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 4.0, 0.0, -243.0, 40.0, 0.0, -48.0, -57.0, 0.0, 0.0, -4.0, -3.0, -242.0, -130.0, 0.0, 100.0, 0.0, -340.0, -1032.0, -36.0, -978.0, -792.0, 0.0, -116.0, 0.0, -81.0, -162.0, -68.0, -13.0, -898.0, 0.0, -335.0, -25.0, 0.0, -920.0, -1150.0, -980.0, -574.0, -67.0, -670.0, 147.0, -656.0, -273.0, -234.0, -135.0, -83.0, -227.0, -652.0, -155.0, 0.0, -141.0, -221.0, -546.0, -212.0, -32.0, -524.0, -962.0, -858.0, -319.0, -553.0, -81.0, -4.0, -97.0, -64.0, 5.0, -30.0, 70.0, -520.0, -22.0, -88.0, -187.0, -844.0, -1080.0, 69.0, -1284.0, -860.0, -606.0, -1166.0, -365.0, -300.0, -328.0, -28.0, 116.0, -91.0, -332.0, -6.0, -710.0, -87.0, 123.0, -914.0, -588.0, -854.0, -45.0, -15.0, 0.0, -281.0, 0.0, -40.0, -80.0, -476.0, -245.0, -305.0, -107.0, -44.0, -1228.0, -35.0, 0.0, 69.0, -628.0, 8.0, -809.0, -140.0, -706.0, -502.0, 63.0, -481.0, -74.0, -178.0, 100.0, -1088.0, 15.0, 15.0, -159.0, -680.0, 126.0, -276.0, 116.0, 111.0, -1024.0, -568.0, -28.0, -247.0, -326.0, -57.0, -1142.0, -287.0, 5.0, 0.0, 122.0, -152.0, -73.0, -622.0, -141.0, 0.0, -6.0, -866.0, 0.0, 0.0, -215.0, -45.0, -127.0, -613.0, -76.0, -47.0, -418.0, -156.0, -121.0, -77.0, -18.0, -324.0, -904.0, 109.0, -72.0, 0.0, -434.0, -38.0, -686.0, -408.0, -174.0, -152.0, 0.0, 0.0, -62.0, -240.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, -20.0, 11.0, -832.0, -268.0, -158.0, -185.0, -976.0, -544.0, -808.0, -209.0, -135.0, -92.0, -98.0, 2.0, -43.0, -346.0, -74.0, -148.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 37.0, 127.0, 0.0, 0.0, 39.0, 20.0, 0.0, 0.0, 3.0, 0.0, 16.0, 179.0, 0.0, 0.0, 136.0, 90.0, 941.0, 68.0, 0.0, 1067.0, 43.0, 74.0, 39.0, 46.0, 92.0, 105.0, 81.0, 783.0, 115.0, 120.0, 0.0, 26.0, 0.0, 1194.0, 940.0, 27.0, 72.0, 585.0, 574.0, 538.0, 99.0, 118.0, 59.0, 40.0, 127.0, 546.0, 45.0, 57.0, 94.0, 96.0, 523.0, 33.0, 73.0, 432.0, 4.0, 1024.0, 567.0, 69.0, 60.0, 53.0, 79.0, 143.0, 38.0, 35.0, 16.0, 480.0, 53.0, 36.0, 784.0, 56.0, 27.0, 970.0, 1003.0, 1323.0, 0.0, 1293.0, 190.0, 118.0, 126.0, 84.0, 128.0, 119.0, 97.0, 143.0, 640.0, 74.0, 802.0, 847.0, 932.0, 15.0, 33.0, 46.0, 76.0, 121.0, 72.0, 62.0, 511.0, 56.0, 89.0, 160.0, 77.0, 38.0, 51.0, 1134.0, 0.0, 8.0, 34.0, 569.0, 0.0, 753.0, 0.0, 799.0, 452.0, 38.0, 70.0, 68.0, 931.0, 994.0, 0.0, 59.0, 103.0, 600.0, 296.0, 275.0, 0.0, 0.0, 0.0, 1107.0, 66.0, 90.0, 113.0, 136.0, 1081.0, 152.0, 28.0, 19.0, 185.0, 185.0, 86.0, 599.0, 63.0, 57.0, 39.0, 803.0, 0.0, 0.0, 55.0, 108.0, 600.0, 11.0, 95.0, 0.0, 369.0, 101.0, 94.0, 0.0, 86.0, 157.0, 791.0, 822.0, 27.0, 9.0, 59.0, 367.0, 0.0, 781.0, 119.0, 132.0, 0.0, 0.0, 85.0, 93.0, 2.0, 0.0, 0.0, 0.0, 54.0, 28.0, 46.0, 0.0, 785.0, 426.0, 83.0, 73.0, 991.0, 26.0, 123.0, 704.0, 0.0, 122.0, 60.0, 48.0, 35.0, 307.0, 37.0, 102.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9791251699999622, "mean_inference_ms": 2.8553894059521956, "mean_action_processing_ms": 0.3762061645629454, "mean_env_wait_ms": 0.3457368049515306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006595492362976074, "StateBufferConnector_ms": 0.004494309425354004, "ViewRequirementAgentConnector_ms": 0.16254329681396484}, "num_episodes": 18, "episode_return_max": 937.0, "episode_return_min": -876.0, "episode_return_mean": -59.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.0934564776025, "num_env_steps_trained_throughput_per_sec": 324.0934564776025, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 14422.355, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14422.297, "sample_time_ms": 2141.812, "learn_time_ms": 12257.337, "learn_throughput": 326.335, "synch_weights_time_ms": 20.258}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "f1691_00002", "date": "2024-08-13_19-26-06", "timestamp": 1723591566, "time_this_iter_s": 12.346888065338135, "time_total_s": 4089.0582523345947, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fd9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4089.0582523345947, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 51.61176470588236, "ram_util_percent": 76.67647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.183941894974658, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 5.203603336672304, "policy_loss": -0.0022907101153765643, "vf_loss": 5.205633123968013, "vf_explained_var": -8.43732129959833e-05, "kl": 0.009277434018920979, "entropy": 1.034001782331517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.041984211941244, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.63566712551016, "policy_loss": -0.003762715434897001, "vf_loss": 6.6394152038311836, "vf_explained_var": -0.016680895556848516, "kl": 0.00936972944853779, "entropy": 1.3575457847938335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 937.0, "episode_reward_min": -792.0, "episode_reward_mean": -54.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.0, "predator_policy": 1323.0}, "policy_reward_mean": {"prey_policy": -246.055, "predator_policy": 218.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-587.0, -80.0, 603.0, -290.0, -119.0, -206.0, -53.0, -172.0, -202.0, -51.0, -792.0, -236.0, 28.0, 61.0, 48.0, 46.0, -21.0, -191.0, -14.0, 182.0, -479.0, -357.0, -146.0, 272.0, -98.0, -83.0, 858.0, -495.0, 19.0, -84.0, 94.0, 11.0, -301.0, -36.0, -78.0, 77.0, -17.0, -196.0, -409.0, 72.0, -114.0, 937.0, 89.0, -136.0, 421.0, 227.0, -485.0, -119.0, -134.0, -196.0, 52.0, 340.0, -10.0, -21.0, -30.0, 0.0, -97.0, -129.0, -28.0, -104.0, -104.0, -99.0, 818.0, -36.0, -46.0, -313.0, -75.0, 0.0, -124.0, -2.0, 0.0, 3.0, 37.0, 111.0, -187.0, -503.0, -190.0, -105.0, 12.0, -47.0, -83.0, 0.0, 82.0, -2.0, -42.0, -97.0, -130.0, -94.0, -148.0, -18.0, -36.0, 0.0, -359.0, -7.0, -105.0, -56.0, -432.0, 118.0, -200.0, -25.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-980.0, -574.0, -67.0, -670.0, 147.0, -656.0, -273.0, -234.0, -135.0, -83.0, -227.0, -652.0, -155.0, 0.0, -141.0, -221.0, -546.0, -212.0, -32.0, -524.0, -962.0, -858.0, -319.0, -553.0, -81.0, -4.0, -97.0, -64.0, 5.0, -30.0, 70.0, -520.0, -22.0, -88.0, -187.0, -844.0, -1080.0, 69.0, -1284.0, -860.0, -606.0, -1166.0, -365.0, -300.0, -328.0, -28.0, 116.0, -91.0, -332.0, -6.0, -710.0, -87.0, 123.0, -914.0, -588.0, -854.0, -45.0, -15.0, 0.0, -281.0, 0.0, -40.0, -80.0, -476.0, -245.0, -305.0, -107.0, -44.0, -1228.0, -35.0, 0.0, 69.0, -628.0, 8.0, -809.0, -140.0, -706.0, -502.0, 63.0, -481.0, -74.0, -178.0, 100.0, -1088.0, 15.0, 15.0, -159.0, -680.0, 126.0, -276.0, 116.0, 111.0, -1024.0, -568.0, -28.0, -247.0, -326.0, -57.0, -1142.0, -287.0, 5.0, 0.0, 122.0, -152.0, -73.0, -622.0, -141.0, 0.0, -6.0, -866.0, 0.0, 0.0, -215.0, -45.0, -127.0, -613.0, -76.0, -47.0, -418.0, -156.0, -121.0, -77.0, -18.0, -324.0, -904.0, 109.0, -72.0, 0.0, -434.0, -38.0, -686.0, -408.0, -174.0, -152.0, 0.0, 0.0, -62.0, -240.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, -20.0, 11.0, -832.0, -268.0, -158.0, -185.0, -976.0, -544.0, -808.0, -209.0, -135.0, -92.0, -98.0, 2.0, -43.0, -346.0, -74.0, -148.0, 0.0, 0.0, 69.0, -25.0, -164.0, 80.0, 0.0, -92.0, -322.0, -27.0, -35.0, -612.0, -262.0, 28.0, -520.0, -124.0, -42.0, -2.0, -96.0, -19.0, 0.0, 0.0, -516.0, -554.0, -121.0, 28.0, -157.0, -85.0, 0.0, -357.0, -306.0, -298.0, 67.0, 41.0, -169.0, -674.0, -10.0, -140.0], "policy_predator_policy_reward": [940.0, 27.0, 72.0, 585.0, 574.0, 538.0, 99.0, 118.0, 59.0, 40.0, 127.0, 546.0, 45.0, 57.0, 94.0, 96.0, 523.0, 33.0, 73.0, 432.0, 4.0, 1024.0, 567.0, 69.0, 60.0, 53.0, 79.0, 143.0, 38.0, 35.0, 16.0, 480.0, 53.0, 36.0, 784.0, 56.0, 27.0, 970.0, 1003.0, 1323.0, 0.0, 1293.0, 190.0, 118.0, 126.0, 84.0, 128.0, 119.0, 97.0, 143.0, 640.0, 74.0, 802.0, 847.0, 932.0, 15.0, 33.0, 46.0, 76.0, 121.0, 72.0, 62.0, 511.0, 56.0, 89.0, 160.0, 77.0, 38.0, 51.0, 1134.0, 0.0, 8.0, 34.0, 569.0, 0.0, 753.0, 0.0, 799.0, 452.0, 38.0, 70.0, 68.0, 931.0, 994.0, 0.0, 59.0, 103.0, 600.0, 296.0, 275.0, 0.0, 0.0, 0.0, 1107.0, 66.0, 90.0, 113.0, 136.0, 1081.0, 152.0, 28.0, 19.0, 185.0, 185.0, 86.0, 599.0, 63.0, 57.0, 39.0, 803.0, 0.0, 0.0, 55.0, 108.0, 600.0, 11.0, 95.0, 0.0, 369.0, 101.0, 94.0, 0.0, 86.0, 157.0, 791.0, 822.0, 27.0, 9.0, 59.0, 367.0, 0.0, 781.0, 119.0, 132.0, 0.0, 0.0, 85.0, 93.0, 2.0, 0.0, 0.0, 0.0, 54.0, 28.0, 46.0, 0.0, 785.0, 426.0, 83.0, 73.0, 991.0, 26.0, 123.0, 704.0, 0.0, 122.0, 60.0, 48.0, 35.0, 307.0, 37.0, 102.0, 0.0, 0.0, 38.0, 0.0, 30.0, 52.0, 0.0, 50.0, 138.0, 114.0, 51.0, 466.0, 0.0, 140.0, 76.0, 420.0, 0.0, 26.0, 23.0, 56.0, 0.0, 0.0, 0.0, 711.0, 61.0, 25.0, 135.0, 2.0, 129.0, 172.0, 0.0, 172.0, 10.0, 0.0, 547.0, 96.0, 62.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9755715067180827, "mean_inference_ms": 2.8476098206373344, "mean_action_processing_ms": 0.37499180040113245, "mean_env_wait_ms": 0.3442715685042414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006594061851501465, "StateBufferConnector_ms": 0.004541158676147461, "ViewRequirementAgentConnector_ms": 0.17854809761047363}, "num_episodes": 18, "episode_return_max": 937.0, "episode_return_min": -792.0, "episode_return_mean": -54.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.60451101593344, "num_env_steps_trained_throughput_per_sec": 337.60451101593344, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 13635.042, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13634.984, "sample_time_ms": 1895.338, "learn_time_ms": 11720.088, "learn_throughput": 341.294, "synch_weights_time_ms": 16.796}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "f1691_00002", "date": "2024-08-13_19-26-17", "timestamp": 1723591577, "time_this_iter_s": 11.899702072143555, "time_total_s": 4100.957954406738, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef81f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4100.957954406738, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 49.58235294117647, "ram_util_percent": 76.67647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4086047932663293, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 4.975566009995799, "policy_loss": -0.0008130443635983047, "vf_loss": 4.976149319340943, "vf_explained_var": -0.0006981389232413479, "kl": 0.008168266246962732, "entropy": 0.9650150166617499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.613665472562351, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.5633433657348474, "policy_loss": -0.0016225105979376369, "vf_loss": 6.564947689904107, "vf_explained_var": -0.07086750918595248, "kl": 0.011636473601864131, "entropy": 1.4099118466730471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 937.0, "episode_reward_min": -503.0, "episode_reward_mean": -43.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 126.0, "predator_policy": 1323.0}, "policy_reward_mean": {"prey_policy": -208.495, "predator_policy": 186.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, 182.0, -479.0, -357.0, -146.0, 272.0, -98.0, -83.0, 858.0, -495.0, 19.0, -84.0, 94.0, 11.0, -301.0, -36.0, -78.0, 77.0, -17.0, -196.0, -409.0, 72.0, -114.0, 937.0, 89.0, -136.0, 421.0, 227.0, -485.0, -119.0, -134.0, -196.0, 52.0, 340.0, -10.0, -21.0, -30.0, 0.0, -97.0, -129.0, -28.0, -104.0, -104.0, -99.0, 818.0, -36.0, -46.0, -313.0, -75.0, 0.0, -124.0, -2.0, 0.0, 3.0, 37.0, 111.0, -187.0, -503.0, -190.0, -105.0, 12.0, -47.0, -83.0, 0.0, 82.0, -2.0, -42.0, -97.0, -130.0, -94.0, -148.0, -18.0, -36.0, 0.0, -359.0, -7.0, -105.0, -56.0, -432.0, 118.0, -200.0, -25.0, 13.0, -95.0, -44.0, -49.0, -73.0, 34.0, -47.0, -108.0, 92.0, -18.0, 0.0, -174.0, -82.0, -27.0, -185.0, -175.0, -13.0, -211.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1080.0, 69.0, -1284.0, -860.0, -606.0, -1166.0, -365.0, -300.0, -328.0, -28.0, 116.0, -91.0, -332.0, -6.0, -710.0, -87.0, 123.0, -914.0, -588.0, -854.0, -45.0, -15.0, 0.0, -281.0, 0.0, -40.0, -80.0, -476.0, -245.0, -305.0, -107.0, -44.0, -1228.0, -35.0, 0.0, 69.0, -628.0, 8.0, -809.0, -140.0, -706.0, -502.0, 63.0, -481.0, -74.0, -178.0, 100.0, -1088.0, 15.0, 15.0, -159.0, -680.0, 126.0, -276.0, 116.0, 111.0, -1024.0, -568.0, -28.0, -247.0, -326.0, -57.0, -1142.0, -287.0, 5.0, 0.0, 122.0, -152.0, -73.0, -622.0, -141.0, 0.0, -6.0, -866.0, 0.0, 0.0, -215.0, -45.0, -127.0, -613.0, -76.0, -47.0, -418.0, -156.0, -121.0, -77.0, -18.0, -324.0, -904.0, 109.0, -72.0, 0.0, -434.0, -38.0, -686.0, -408.0, -174.0, -152.0, 0.0, 0.0, -62.0, -240.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, -20.0, 11.0, -832.0, -268.0, -158.0, -185.0, -976.0, -544.0, -808.0, -209.0, -135.0, -92.0, -98.0, 2.0, -43.0, -346.0, -74.0, -148.0, 0.0, 0.0, 69.0, -25.0, -164.0, 80.0, 0.0, -92.0, -322.0, -27.0, -35.0, -612.0, -262.0, 28.0, -520.0, -124.0, -42.0, -2.0, -96.0, -19.0, 0.0, 0.0, -516.0, -554.0, -121.0, 28.0, -157.0, -85.0, 0.0, -357.0, -306.0, -298.0, 67.0, 41.0, -169.0, -674.0, -10.0, -140.0, 0.0, -19.0, -73.0, -177.0, -26.0, -88.0, -239.0, -20.0, -31.0, -165.0, 16.0, 11.0, -52.0, -65.0, -85.0, -164.0, -318.0, 50.0, 37.0, -113.0, 0.0, 0.0, -107.0, -292.0, -113.0, -44.0, -24.0, -45.0, -107.0, -198.0, -238.0, -146.0, -7.0, -65.0, -278.0, -92.0], "policy_predator_policy_reward": [27.0, 970.0, 1003.0, 1323.0, 0.0, 1293.0, 190.0, 118.0, 126.0, 84.0, 128.0, 119.0, 97.0, 143.0, 640.0, 74.0, 802.0, 847.0, 932.0, 15.0, 33.0, 46.0, 76.0, 121.0, 72.0, 62.0, 511.0, 56.0, 89.0, 160.0, 77.0, 38.0, 51.0, 1134.0, 0.0, 8.0, 34.0, 569.0, 0.0, 753.0, 0.0, 799.0, 452.0, 38.0, 70.0, 68.0, 931.0, 994.0, 0.0, 59.0, 103.0, 600.0, 296.0, 275.0, 0.0, 0.0, 0.0, 1107.0, 66.0, 90.0, 113.0, 136.0, 1081.0, 152.0, 28.0, 19.0, 185.0, 185.0, 86.0, 599.0, 63.0, 57.0, 39.0, 803.0, 0.0, 0.0, 55.0, 108.0, 600.0, 11.0, 95.0, 0.0, 369.0, 101.0, 94.0, 0.0, 86.0, 157.0, 791.0, 822.0, 27.0, 9.0, 59.0, 367.0, 0.0, 781.0, 119.0, 132.0, 0.0, 0.0, 85.0, 93.0, 2.0, 0.0, 0.0, 0.0, 54.0, 28.0, 46.0, 0.0, 785.0, 426.0, 83.0, 73.0, 991.0, 26.0, 123.0, 704.0, 0.0, 122.0, 60.0, 48.0, 35.0, 307.0, 37.0, 102.0, 0.0, 0.0, 38.0, 0.0, 30.0, 52.0, 0.0, 50.0, 138.0, 114.0, 51.0, 466.0, 0.0, 140.0, 76.0, 420.0, 0.0, 26.0, 23.0, 56.0, 0.0, 0.0, 0.0, 711.0, 61.0, 25.0, 135.0, 2.0, 129.0, 172.0, 0.0, 172.0, 10.0, 0.0, 547.0, 96.0, 62.0, 63.0, 31.0, 1.0, 58.0, 97.0, 70.0, 0.0, 75.0, 135.0, 0.0, 123.0, 5.0, 2.0, 44.0, 26.0, 66.0, 75.0, 189.0, 171.0, 0.0, 58.0, 0.0, 0.0, 171.0, 54.0, 0.0, 75.0, 8.0, 34.0, 5.0, 115.0, 100.0, 109.0, 19.0, 40.0, 0.0, 159.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9699674908316819, "mean_inference_ms": 2.833819702443588, "mean_action_processing_ms": 0.3729984203655613, "mean_env_wait_ms": 0.3422774485376708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004334807395935059, "StateBufferConnector_ms": 0.004445075988769531, "ViewRequirementAgentConnector_ms": 0.13539326190948486}, "num_episodes": 18, "episode_return_max": 937.0, "episode_return_min": -503.0, "episode_return_mean": -43.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.4056923270306, "num_env_steps_trained_throughput_per_sec": 308.4056923270306, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 13330.671, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13330.618, "sample_time_ms": 1777.663, "learn_time_ms": 11533.598, "learn_throughput": 346.813, "synch_weights_time_ms": 16.637}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "f1691_00002", "date": "2024-08-13_19-26-31", "timestamp": 1723591591, "time_this_iter_s": 13.002424955368042, "time_total_s": 4113.960379362106, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f6040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4113.960379362106, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 48.95789473684211, "ram_util_percent": 78.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6091766907266838, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 4.0818352052143645, "policy_loss": -0.0031149466896538067, "vf_loss": 4.084717757992013, "vf_explained_var": 0.002104344569816791, "kl": 0.008262576063467475, "entropy": 0.973039784286388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.561751352684207, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.103764778722531, "policy_loss": 0.000490042411170348, "vf_loss": 4.103250596132228, "vf_explained_var": -0.06876315127604853, "kl": 0.015444756203684303, "entropy": 1.4678370433509664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 937.0, "episode_reward_min": -503.0, "episode_reward_mean": -36.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 126.0, "predator_policy": 1107.0}, "policy_reward_mean": {"prey_policy": -141.56, "predator_policy": 123.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.0, 937.0, 89.0, -136.0, 421.0, 227.0, -485.0, -119.0, -134.0, -196.0, 52.0, 340.0, -10.0, -21.0, -30.0, 0.0, -97.0, -129.0, -28.0, -104.0, -104.0, -99.0, 818.0, -36.0, -46.0, -313.0, -75.0, 0.0, -124.0, -2.0, 0.0, 3.0, 37.0, 111.0, -187.0, -503.0, -190.0, -105.0, 12.0, -47.0, -83.0, 0.0, 82.0, -2.0, -42.0, -97.0, -130.0, -94.0, -148.0, -18.0, -36.0, 0.0, -359.0, -7.0, -105.0, -56.0, -432.0, 118.0, -200.0, -25.0, 13.0, -95.0, -44.0, -49.0, -73.0, 34.0, -47.0, -108.0, 92.0, -18.0, 0.0, -174.0, -82.0, -27.0, -185.0, -175.0, -13.0, -211.0, -32.0, -21.0, -52.0, 45.0, 42.0, 0.0, -34.0, -3.0, 23.0, -72.0, -40.0, -51.0, -56.0, 7.0, -181.0, -71.0, 2.0, -8.0, 69.0, 0.0, -50.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-74.0, -178.0, 100.0, -1088.0, 15.0, 15.0, -159.0, -680.0, 126.0, -276.0, 116.0, 111.0, -1024.0, -568.0, -28.0, -247.0, -326.0, -57.0, -1142.0, -287.0, 5.0, 0.0, 122.0, -152.0, -73.0, -622.0, -141.0, 0.0, -6.0, -866.0, 0.0, 0.0, -215.0, -45.0, -127.0, -613.0, -76.0, -47.0, -418.0, -156.0, -121.0, -77.0, -18.0, -324.0, -904.0, 109.0, -72.0, 0.0, -434.0, -38.0, -686.0, -408.0, -174.0, -152.0, 0.0, 0.0, -62.0, -240.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, -20.0, 11.0, -832.0, -268.0, -158.0, -185.0, -976.0, -544.0, -808.0, -209.0, -135.0, -92.0, -98.0, 2.0, -43.0, -346.0, -74.0, -148.0, 0.0, 0.0, 69.0, -25.0, -164.0, 80.0, 0.0, -92.0, -322.0, -27.0, -35.0, -612.0, -262.0, 28.0, -520.0, -124.0, -42.0, -2.0, -96.0, -19.0, 0.0, 0.0, -516.0, -554.0, -121.0, 28.0, -157.0, -85.0, 0.0, -357.0, -306.0, -298.0, 67.0, 41.0, -169.0, -674.0, -10.0, -140.0, 0.0, -19.0, -73.0, -177.0, -26.0, -88.0, -239.0, -20.0, -31.0, -165.0, 16.0, 11.0, -52.0, -65.0, -85.0, -164.0, -318.0, 50.0, 37.0, -113.0, 0.0, 0.0, -107.0, -292.0, -113.0, -44.0, -24.0, -45.0, -107.0, -198.0, -238.0, -146.0, -7.0, -65.0, -278.0, -92.0, -95.0, -9.0, 0.0, -86.0, -71.0, -144.0, 13.0, 16.0, 3.0, -7.0, 0.0, -42.0, -14.0, -89.0, -18.0, -54.0, -61.0, 5.0, 24.0, -193.0, -12.0, -132.0, -73.0, -73.0, -23.0, -124.0, 0.0, -70.0, -297.0, -38.0, -29.0, -98.0, -2.0, 3.0, 19.0, -57.0, 45.0, 24.0, 0.0, 0.0, -87.0, -66.0, 0.0, -19.0], "policy_predator_policy_reward": [70.0, 68.0, 931.0, 994.0, 0.0, 59.0, 103.0, 600.0, 296.0, 275.0, 0.0, 0.0, 0.0, 1107.0, 66.0, 90.0, 113.0, 136.0, 1081.0, 152.0, 28.0, 19.0, 185.0, 185.0, 86.0, 599.0, 63.0, 57.0, 39.0, 803.0, 0.0, 0.0, 55.0, 108.0, 600.0, 11.0, 95.0, 0.0, 369.0, 101.0, 94.0, 0.0, 86.0, 157.0, 791.0, 822.0, 27.0, 9.0, 59.0, 367.0, 0.0, 781.0, 119.0, 132.0, 0.0, 0.0, 85.0, 93.0, 2.0, 0.0, 0.0, 0.0, 54.0, 28.0, 46.0, 0.0, 785.0, 426.0, 83.0, 73.0, 991.0, 26.0, 123.0, 704.0, 0.0, 122.0, 60.0, 48.0, 35.0, 307.0, 37.0, 102.0, 0.0, 0.0, 38.0, 0.0, 30.0, 52.0, 0.0, 50.0, 138.0, 114.0, 51.0, 466.0, 0.0, 140.0, 76.0, 420.0, 0.0, 26.0, 23.0, 56.0, 0.0, 0.0, 0.0, 711.0, 61.0, 25.0, 135.0, 2.0, 129.0, 172.0, 0.0, 172.0, 10.0, 0.0, 547.0, 96.0, 62.0, 63.0, 31.0, 1.0, 58.0, 97.0, 70.0, 0.0, 75.0, 135.0, 0.0, 123.0, 5.0, 2.0, 44.0, 26.0, 66.0, 75.0, 189.0, 171.0, 0.0, 58.0, 0.0, 0.0, 171.0, 54.0, 0.0, 75.0, 8.0, 34.0, 5.0, 115.0, 100.0, 109.0, 19.0, 40.0, 0.0, 159.0, 72.0, 0.0, 12.0, 53.0, 50.0, 113.0, 0.0, 16.0, 16.0, 30.0, 21.0, 21.0, 7.0, 62.0, 0.0, 69.0, 41.0, 38.0, 0.0, 97.0, 70.0, 34.0, 35.0, 60.0, 55.0, 36.0, 39.0, 38.0, 154.0, 0.0, 56.0, 0.0, 0.0, 1.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 36.0, 67.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9629536433551732, "mean_inference_ms": 2.815608952895992, "mean_action_processing_ms": 0.37046112990080515, "mean_env_wait_ms": 0.33974145568133624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004340410232543945, "StateBufferConnector_ms": 0.004039168357849121, "ViewRequirementAgentConnector_ms": 0.12400352954864502}, "num_episodes": 22, "episode_return_max": 937.0, "episode_return_min": -503.0, "episode_return_mean": -36.73, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.78330487013847, "num_env_steps_trained_throughput_per_sec": 325.78330487013847, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 13244.413, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13244.36, "sample_time_ms": 1755.597, "learn_time_ms": 11469.48, "learn_throughput": 348.752, "synch_weights_time_ms": 16.673}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "f1691_00002", "date": "2024-08-13_19-26-43", "timestamp": 1723591603, "time_this_iter_s": 12.317978858947754, "time_total_s": 4126.278358221054, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4126.278358221054, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 48.33529411764706, "ram_util_percent": 80.94117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6107676927138257, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.5261989970686574, "policy_loss": -0.001657990357597117, "vf_loss": 3.5276635607714377, "vf_explained_var": 0.001895953612352805, "kl": 0.006877037512414991, "entropy": 0.9537454295410681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.653270170037393, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 4.562030864771081, "policy_loss": -0.009714761938746999, "vf_loss": 4.571701437203342, "vf_explained_var": -0.039742803952050584, "kl": 0.02828835673006391, "entropy": 1.4433965677306766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 118.0, "episode_reward_min": -503.0, "episode_reward_mean": -61.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -976.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 80.0, "predator_policy": 991.0}, "policy_reward_mean": {"prey_policy": -104.16, "predator_policy": 73.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.0, -46.0, -313.0, -75.0, 0.0, -124.0, -2.0, 0.0, 3.0, 37.0, 111.0, -187.0, -503.0, -190.0, -105.0, 12.0, -47.0, -83.0, 0.0, 82.0, -2.0, -42.0, -97.0, -130.0, -94.0, -148.0, -18.0, -36.0, 0.0, -359.0, -7.0, -105.0, -56.0, -432.0, 118.0, -200.0, -25.0, 13.0, -95.0, -44.0, -49.0, -73.0, 34.0, -47.0, -108.0, 92.0, -18.0, 0.0, -174.0, -82.0, -27.0, -185.0, -175.0, -13.0, -211.0, -32.0, -21.0, -52.0, 45.0, 42.0, 0.0, -34.0, -3.0, 23.0, -72.0, -40.0, -51.0, -56.0, 7.0, -181.0, -71.0, 2.0, -8.0, 69.0, 0.0, -50.0, -7.0, -116.0, 54.0, -6.0, -170.0, 0.0, -169.0, -63.0, -84.0, -21.0, 0.0, -96.0, -2.0, -227.0, 17.0, 0.0, -8.0, -102.0, -111.0, -24.0, -77.0, -8.0, -137.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.0, 0.0, -434.0, -38.0, -686.0, -408.0, -174.0, -152.0, 0.0, 0.0, -62.0, -240.0, 0.0, -4.0, 0.0, 0.0, -79.0, 0.0, -20.0, 11.0, -832.0, -268.0, -158.0, -185.0, -976.0, -544.0, -808.0, -209.0, -135.0, -92.0, -98.0, 2.0, -43.0, -346.0, -74.0, -148.0, 0.0, 0.0, 69.0, -25.0, -164.0, 80.0, 0.0, -92.0, -322.0, -27.0, -35.0, -612.0, -262.0, 28.0, -520.0, -124.0, -42.0, -2.0, -96.0, -19.0, 0.0, 0.0, -516.0, -554.0, -121.0, 28.0, -157.0, -85.0, 0.0, -357.0, -306.0, -298.0, 67.0, 41.0, -169.0, -674.0, -10.0, -140.0, 0.0, -19.0, -73.0, -177.0, -26.0, -88.0, -239.0, -20.0, -31.0, -165.0, 16.0, 11.0, -52.0, -65.0, -85.0, -164.0, -318.0, 50.0, 37.0, -113.0, 0.0, 0.0, -107.0, -292.0, -113.0, -44.0, -24.0, -45.0, -107.0, -198.0, -238.0, -146.0, -7.0, -65.0, -278.0, -92.0, -95.0, -9.0, 0.0, -86.0, -71.0, -144.0, 13.0, 16.0, 3.0, -7.0, 0.0, -42.0, -14.0, -89.0, -18.0, -54.0, -61.0, 5.0, 24.0, -193.0, -12.0, -132.0, -73.0, -73.0, -23.0, -124.0, 0.0, -70.0, -297.0, -38.0, -29.0, -98.0, -2.0, 3.0, 19.0, -57.0, 45.0, 24.0, 0.0, 0.0, -87.0, -66.0, 0.0, -19.0, -215.0, -84.0, 36.0, 5.0, 2.0, -28.0, -88.0, -217.0, 0.0, 0.0, -68.0, -268.0, -72.0, -66.0, -74.0, -67.0, 0.0, -46.0, 0.0, 0.0, -192.0, 0.0, 29.0, -64.0, -158.0, -310.0, 24.0, -24.0, 0.0, 0.0, -72.0, -8.0, -153.0, -43.0, -94.0, -136.0, 0.0, -49.0, -22.0, -130.0, 0.0, -22.0, -123.0, -97.0, -42.0, 0.0], "policy_predator_policy_reward": [27.0, 9.0, 59.0, 367.0, 0.0, 781.0, 119.0, 132.0, 0.0, 0.0, 85.0, 93.0, 2.0, 0.0, 0.0, 0.0, 54.0, 28.0, 46.0, 0.0, 785.0, 426.0, 83.0, 73.0, 991.0, 26.0, 123.0, 704.0, 0.0, 122.0, 60.0, 48.0, 35.0, 307.0, 37.0, 102.0, 0.0, 0.0, 38.0, 0.0, 30.0, 52.0, 0.0, 50.0, 138.0, 114.0, 51.0, 466.0, 0.0, 140.0, 76.0, 420.0, 0.0, 26.0, 23.0, 56.0, 0.0, 0.0, 0.0, 711.0, 61.0, 25.0, 135.0, 2.0, 129.0, 172.0, 0.0, 172.0, 10.0, 0.0, 547.0, 96.0, 62.0, 63.0, 31.0, 1.0, 58.0, 97.0, 70.0, 0.0, 75.0, 135.0, 0.0, 123.0, 5.0, 2.0, 44.0, 26.0, 66.0, 75.0, 189.0, 171.0, 0.0, 58.0, 0.0, 0.0, 171.0, 54.0, 0.0, 75.0, 8.0, 34.0, 5.0, 115.0, 100.0, 109.0, 19.0, 40.0, 0.0, 159.0, 72.0, 0.0, 12.0, 53.0, 50.0, 113.0, 0.0, 16.0, 16.0, 30.0, 21.0, 21.0, 7.0, 62.0, 0.0, 69.0, 41.0, 38.0, 0.0, 97.0, 70.0, 34.0, 35.0, 60.0, 55.0, 36.0, 39.0, 38.0, 154.0, 0.0, 56.0, 0.0, 0.0, 1.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 36.0, 67.0, 0.0, 12.0, 73.0, 110.0, 7.0, 6.0, 1.0, 19.0, 135.0, 0.0, 0.0, 0.0, 32.0, 135.0, 17.0, 58.0, 57.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 33.0, 128.0, 113.0, 17.0, 0.0, 0.0, 0.0, 31.0, 41.0, 0.0, 94.0, 109.0, 10.0, 2.0, 23.0, 75.0, 0.0, 0.0, 14.0, 0.0, 83.0, 0.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9538763091260598, "mean_inference_ms": 2.7944139538860653, "mean_action_processing_ms": 0.3674631154002458, "mean_env_wait_ms": 0.33666455698927555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675626754760742, "StateBufferConnector_ms": 0.0038819313049316406, "ViewRequirementAgentConnector_ms": 0.11611056327819824}, "num_episodes": 23, "episode_return_max": 118.0, "episode_return_min": -503.0, "episode_return_mean": -61.16, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.81779911319614, "num_env_steps_trained_throughput_per_sec": 264.81779911319614, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 13459.382, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13459.331, "sample_time_ms": 1719.837, "learn_time_ms": 11719.707, "learn_throughput": 341.305, "synch_weights_time_ms": 16.961}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "f1691_00002", "date": "2024-08-13_19-26-58", "timestamp": 1723591618, "time_this_iter_s": 15.157886981964111, "time_total_s": 4141.436245203018, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f6940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4141.436245203018, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 62.87272727272727, "ram_util_percent": 82.88181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.685217534486579, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 2.0695316678632505, "policy_loss": -0.0030866076226134308, "vf_loss": 2.0723661193771967, "vf_explained_var": 0.007779758380203651, "kl": 0.008965468986030184, "entropy": 0.9414173912749719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3446841752403, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 0.00010000000000000003, "total_loss": 1.9803842838794465, "policy_loss": -0.0017560127810895363, "vf_loss": 1.9821043214154621, "vf_explained_var": -0.02302549610692988, "kl": 0.015349343258170197, "entropy": 1.4826372345919332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 118.0, "episode_reward_min": -432.0, "episode_reward_mean": -49.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -674.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 80.0, "predator_policy": 711.0}, "policy_reward_mean": {"prey_policy": -73.31, "predator_policy": 48.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 82.0, -2.0, -42.0, -97.0, -130.0, -94.0, -148.0, -18.0, -36.0, 0.0, -359.0, -7.0, -105.0, -56.0, -432.0, 118.0, -200.0, -25.0, 13.0, -95.0, -44.0, -49.0, -73.0, 34.0, -47.0, -108.0, 92.0, -18.0, 0.0, -174.0, -82.0, -27.0, -185.0, -175.0, -13.0, -211.0, -32.0, -21.0, -52.0, 45.0, 42.0, 0.0, -34.0, -3.0, 23.0, -72.0, -40.0, -51.0, -56.0, 7.0, -181.0, -71.0, 2.0, -8.0, 69.0, 0.0, -50.0, -7.0, -116.0, 54.0, -6.0, -170.0, 0.0, -169.0, -63.0, -84.0, -21.0, 0.0, -96.0, -2.0, -227.0, 17.0, 0.0, -8.0, -102.0, -111.0, -24.0, -77.0, -8.0, -137.0, -15.0, -60.0, 5.0, -62.0, 0.0, 8.0, -43.0, -29.0, -16.0, 13.0, -35.0, -22.0, -3.0, -26.0, -5.0, -11.0, 0.0, -51.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 69.0, -25.0, -164.0, 80.0, 0.0, -92.0, -322.0, -27.0, -35.0, -612.0, -262.0, 28.0, -520.0, -124.0, -42.0, -2.0, -96.0, -19.0, 0.0, 0.0, -516.0, -554.0, -121.0, 28.0, -157.0, -85.0, 0.0, -357.0, -306.0, -298.0, 67.0, 41.0, -169.0, -674.0, -10.0, -140.0, 0.0, -19.0, -73.0, -177.0, -26.0, -88.0, -239.0, -20.0, -31.0, -165.0, 16.0, 11.0, -52.0, -65.0, -85.0, -164.0, -318.0, 50.0, 37.0, -113.0, 0.0, 0.0, -107.0, -292.0, -113.0, -44.0, -24.0, -45.0, -107.0, -198.0, -238.0, -146.0, -7.0, -65.0, -278.0, -92.0, -95.0, -9.0, 0.0, -86.0, -71.0, -144.0, 13.0, 16.0, 3.0, -7.0, 0.0, -42.0, -14.0, -89.0, -18.0, -54.0, -61.0, 5.0, 24.0, -193.0, -12.0, -132.0, -73.0, -73.0, -23.0, -124.0, 0.0, -70.0, -297.0, -38.0, -29.0, -98.0, -2.0, 3.0, 19.0, -57.0, 45.0, 24.0, 0.0, 0.0, -87.0, -66.0, 0.0, -19.0, -215.0, -84.0, 36.0, 5.0, 2.0, -28.0, -88.0, -217.0, 0.0, 0.0, -68.0, -268.0, -72.0, -66.0, -74.0, -67.0, 0.0, -46.0, 0.0, 0.0, -192.0, 0.0, 29.0, -64.0, -158.0, -310.0, 24.0, -24.0, 0.0, 0.0, -72.0, -8.0, -153.0, -43.0, -94.0, -136.0, 0.0, -49.0, -22.0, -130.0, 0.0, -22.0, -123.0, -97.0, -42.0, 0.0, -77.0, -50.0, -18.0, 14.0, -61.0, -53.0, 0.0, 0.0, -32.0, 15.0, -86.0, 0.0, -129.0, -42.0, 0.0, -37.0, 7.0, 0.0, -16.0, -76.0, -18.0, -31.0, 0.0, -10.0, 0.0, -72.0, -2.0, -29.0, -116.0, 0.0, 0.0, 0.0, -78.0, -20.0, -36.0, -49.0], "policy_predator_policy_reward": [0.0, 0.0, 38.0, 0.0, 30.0, 52.0, 0.0, 50.0, 138.0, 114.0, 51.0, 466.0, 0.0, 140.0, 76.0, 420.0, 0.0, 26.0, 23.0, 56.0, 0.0, 0.0, 0.0, 711.0, 61.0, 25.0, 135.0, 2.0, 129.0, 172.0, 0.0, 172.0, 10.0, 0.0, 547.0, 96.0, 62.0, 63.0, 31.0, 1.0, 58.0, 97.0, 70.0, 0.0, 75.0, 135.0, 0.0, 123.0, 5.0, 2.0, 44.0, 26.0, 66.0, 75.0, 189.0, 171.0, 0.0, 58.0, 0.0, 0.0, 171.0, 54.0, 0.0, 75.0, 8.0, 34.0, 5.0, 115.0, 100.0, 109.0, 19.0, 40.0, 0.0, 159.0, 72.0, 0.0, 12.0, 53.0, 50.0, 113.0, 0.0, 16.0, 16.0, 30.0, 21.0, 21.0, 7.0, 62.0, 0.0, 69.0, 41.0, 38.0, 0.0, 97.0, 70.0, 34.0, 35.0, 60.0, 55.0, 36.0, 39.0, 38.0, 154.0, 0.0, 56.0, 0.0, 0.0, 1.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 36.0, 67.0, 0.0, 12.0, 73.0, 110.0, 7.0, 6.0, 1.0, 19.0, 135.0, 0.0, 0.0, 0.0, 32.0, 135.0, 17.0, 58.0, 57.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 33.0, 128.0, 113.0, 17.0, 0.0, 0.0, 0.0, 31.0, 41.0, 0.0, 94.0, 109.0, 10.0, 2.0, 23.0, 75.0, 0.0, 0.0, 14.0, 0.0, 83.0, 0.0, 27.0, 42.0, 25.0, 9.0, 0.0, 52.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 43.0, 45.0, 97.0, 2.0, 19.0, 6.0, 0.0, 13.0, 44.0, 27.0, 0.0, 5.0, 2.0, 22.0, 24.0, 25.0, 1.0, 50.0, 55.0, 0.0, 0.0, 0.0, 47.0, 36.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9478334002151627, "mean_inference_ms": 2.780338457378868, "mean_action_processing_ms": 0.3654576537399173, "mean_env_wait_ms": 0.33453354551686926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005125522613525391, "StateBufferConnector_ms": 0.0040187835693359375, "ViewRequirementAgentConnector_ms": 0.11846613883972168}, "num_episodes": 18, "episode_return_max": 118.0, "episode_return_min": -432.0, "episode_return_mean": -49.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.07469173020127, "num_env_steps_trained_throughput_per_sec": 303.07469173020127, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 13437.583, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13437.531, "sample_time_ms": 1747.829, "learn_time_ms": 11668.96, "learn_throughput": 342.79, "synch_weights_time_ms": 17.972}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "f1691_00002", "date": "2024-08-13_19-27-11", "timestamp": 1723591631, "time_this_iter_s": 13.254514217376709, "time_total_s": 4154.690759420395, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4154.690759420395, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 54.13157894736842, "ram_util_percent": 81.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.647918106268638, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 2.2190001251205564, "policy_loss": -0.0033155952013595395, "vf_loss": 2.222106334015175, "vf_explained_var": 0.014880263111578725, "kl": 0.007444991139923259, "entropy": 0.9762729576655796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2151642295142646, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 0.00010000000000000003, "total_loss": 1.8392054461297536, "policy_loss": -0.005573551465077178, "vf_loss": 1.8447436364554854, "vf_explained_var": -0.026317484795101105, "kl": 0.015084788463007124, "entropy": 1.4657537805340277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 92.0, "episode_reward_min": -227.0, "episode_reward_mean": -35.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -49.745, "predator_policy": 31.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0, 13.0, -95.0, -44.0, -49.0, -73.0, 34.0, -47.0, -108.0, 92.0, -18.0, 0.0, -174.0, -82.0, -27.0, -185.0, -175.0, -13.0, -211.0, -32.0, -21.0, -52.0, 45.0, 42.0, 0.0, -34.0, -3.0, 23.0, -72.0, -40.0, -51.0, -56.0, 7.0, -181.0, -71.0, 2.0, -8.0, 69.0, 0.0, -50.0, -7.0, -116.0, 54.0, -6.0, -170.0, 0.0, -169.0, -63.0, -84.0, -21.0, 0.0, -96.0, -2.0, -227.0, 17.0, 0.0, -8.0, -102.0, -111.0, -24.0, -77.0, -8.0, -137.0, -15.0, -60.0, 5.0, -62.0, 0.0, 8.0, -43.0, -29.0, -16.0, 13.0, -35.0, -22.0, -3.0, -26.0, -5.0, -11.0, 0.0, -51.0, -49.0, 0.0, -19.0, 15.0, -7.0, -26.0, 2.0, -7.0, -7.0, 16.0, -27.0, 0.0, -29.0, -14.0, 0.0, 21.0, -8.0, -26.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -140.0, 0.0, -19.0, -73.0, -177.0, -26.0, -88.0, -239.0, -20.0, -31.0, -165.0, 16.0, 11.0, -52.0, -65.0, -85.0, -164.0, -318.0, 50.0, 37.0, -113.0, 0.0, 0.0, -107.0, -292.0, -113.0, -44.0, -24.0, -45.0, -107.0, -198.0, -238.0, -146.0, -7.0, -65.0, -278.0, -92.0, -95.0, -9.0, 0.0, -86.0, -71.0, -144.0, 13.0, 16.0, 3.0, -7.0, 0.0, -42.0, -14.0, -89.0, -18.0, -54.0, -61.0, 5.0, 24.0, -193.0, -12.0, -132.0, -73.0, -73.0, -23.0, -124.0, 0.0, -70.0, -297.0, -38.0, -29.0, -98.0, -2.0, 3.0, 19.0, -57.0, 45.0, 24.0, 0.0, 0.0, -87.0, -66.0, 0.0, -19.0, -215.0, -84.0, 36.0, 5.0, 2.0, -28.0, -88.0, -217.0, 0.0, 0.0, -68.0, -268.0, -72.0, -66.0, -74.0, -67.0, 0.0, -46.0, 0.0, 0.0, -192.0, 0.0, 29.0, -64.0, -158.0, -310.0, 24.0, -24.0, 0.0, 0.0, -72.0, -8.0, -153.0, -43.0, -94.0, -136.0, 0.0, -49.0, -22.0, -130.0, 0.0, -22.0, -123.0, -97.0, -42.0, 0.0, -77.0, -50.0, -18.0, 14.0, -61.0, -53.0, 0.0, 0.0, -32.0, 15.0, -86.0, 0.0, -129.0, -42.0, 0.0, -37.0, 7.0, 0.0, -16.0, -76.0, -18.0, -31.0, 0.0, -10.0, 0.0, -72.0, -2.0, -29.0, -116.0, 0.0, 0.0, 0.0, -78.0, -20.0, -36.0, -49.0, 0.0, 0.0, -35.0, -19.0, 7.0, -37.0, 0.0, -33.0, -8.0, -64.0, 0.0, -12.0, 0.0, -14.0, -38.0, 2.0, 0.0, 15.0, -36.0, -14.0, 0.0, 0.0, -48.0, -24.0, -8.0, -30.0, 0.0, 0.0, 0.0, 9.0, -20.0, 2.0, -60.0, -72.0, -16.0, 0.0], "policy_predator_policy_reward": [62.0, 63.0, 31.0, 1.0, 58.0, 97.0, 70.0, 0.0, 75.0, 135.0, 0.0, 123.0, 5.0, 2.0, 44.0, 26.0, 66.0, 75.0, 189.0, 171.0, 0.0, 58.0, 0.0, 0.0, 171.0, 54.0, 0.0, 75.0, 8.0, 34.0, 5.0, 115.0, 100.0, 109.0, 19.0, 40.0, 0.0, 159.0, 72.0, 0.0, 12.0, 53.0, 50.0, 113.0, 0.0, 16.0, 16.0, 30.0, 21.0, 21.0, 7.0, 62.0, 0.0, 69.0, 41.0, 38.0, 0.0, 97.0, 70.0, 34.0, 35.0, 60.0, 55.0, 36.0, 39.0, 38.0, 154.0, 0.0, 56.0, 0.0, 0.0, 1.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 36.0, 67.0, 0.0, 12.0, 73.0, 110.0, 7.0, 6.0, 1.0, 19.0, 135.0, 0.0, 0.0, 0.0, 32.0, 135.0, 17.0, 58.0, 57.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 33.0, 128.0, 113.0, 17.0, 0.0, 0.0, 0.0, 31.0, 41.0, 0.0, 94.0, 109.0, 10.0, 2.0, 23.0, 75.0, 0.0, 0.0, 14.0, 0.0, 83.0, 0.0, 27.0, 42.0, 25.0, 9.0, 0.0, 52.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 43.0, 45.0, 97.0, 2.0, 19.0, 6.0, 0.0, 13.0, 44.0, 27.0, 0.0, 5.0, 2.0, 22.0, 24.0, 25.0, 1.0, 50.0, 55.0, 0.0, 0.0, 0.0, 47.0, 36.0, 0.0, 0.0, 0.0, 0.0, 35.0, 24.0, 21.0, 9.0, 17.0, 46.0, 0.0, 14.0, 0.0, 0.0, 7.0, 12.0, 17.0, 0.0, 1.0, 18.0, 5.0, 0.0, 0.0, 30.0, 13.0, 15.0, 9.0, 0.0, 0.0, 7.0, 5.0, 0.0, 10.0, 43.0, 63.0, 2.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.945552168483411, "mean_inference_ms": 2.777939362479639, "mean_action_processing_ms": 0.36514988720023434, "mean_env_wait_ms": 0.3336280162985625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006246447563171387, "StateBufferConnector_ms": 0.004541635513305664, "ViewRequirementAgentConnector_ms": 0.1129755973815918}, "num_episodes": 18, "episode_return_max": 92.0, "episode_return_min": -227.0, "episode_return_mean": -35.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.51556557939506, "num_env_steps_trained_throughput_per_sec": 263.51556557939506, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 13516.665, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13516.609, "sample_time_ms": 1962.163, "learn_time_ms": 11533.654, "learn_throughput": 346.811, "synch_weights_time_ms": 17.602}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "f1691_00002", "date": "2024-08-13_19-27-27", "timestamp": 1723591647, "time_this_iter_s": 15.251411199569702, "time_total_s": 4169.942170619965, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f951f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4169.942170619965, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 59.55238095238095, "ram_util_percent": 82.44761904761904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.505334530892984, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.5569770073370328, "policy_loss": -0.0038924256886636453, "vf_loss": 0.5605377425612122, "vf_explained_var": 0.008144483585206289, "kl": 0.01179339207766833, "entropy": 0.9557050183021202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7504748766384428, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 0.00010000000000000003, "total_loss": 0.7063029583691368, "policy_loss": -0.006804941715943632, "vf_loss": 0.7130726664083167, "vf_explained_var": -0.0022343204450355003, "kl": 0.015033675713072315, "entropy": 1.4603305129777817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -227.0, "episode_reward_mean": -23.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.0, "predator_policy": 154.0}, "policy_reward_mean": {"prey_policy": -32.59, "predator_policy": 20.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 42.0, 0.0, -34.0, -3.0, 23.0, -72.0, -40.0, -51.0, -56.0, 7.0, -181.0, -71.0, 2.0, -8.0, 69.0, 0.0, -50.0, -7.0, -116.0, 54.0, -6.0, -170.0, 0.0, -169.0, -63.0, -84.0, -21.0, 0.0, -96.0, -2.0, -227.0, 17.0, 0.0, -8.0, -102.0, -111.0, -24.0, -77.0, -8.0, -137.0, -15.0, -60.0, 5.0, -62.0, 0.0, 8.0, -43.0, -29.0, -16.0, 13.0, -35.0, -22.0, -3.0, -26.0, -5.0, -11.0, 0.0, -51.0, -49.0, 0.0, -19.0, 15.0, -7.0, -26.0, 2.0, -7.0, -7.0, 16.0, -27.0, 0.0, -29.0, -14.0, 0.0, 21.0, -8.0, -26.0, -6.0, -5.0, -7.0, -5.0, -59.0, 6.0, 21.0, -11.0, -12.0, -2.0, -28.0, -47.0, 5.0, -11.0, 0.0, 0.0, 0.0, -3.0, 0.0, 41.0, 3.0, 17.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 16.0, 3.0, -7.0, 0.0, -42.0, -14.0, -89.0, -18.0, -54.0, -61.0, 5.0, 24.0, -193.0, -12.0, -132.0, -73.0, -73.0, -23.0, -124.0, 0.0, -70.0, -297.0, -38.0, -29.0, -98.0, -2.0, 3.0, 19.0, -57.0, 45.0, 24.0, 0.0, 0.0, -87.0, -66.0, 0.0, -19.0, -215.0, -84.0, 36.0, 5.0, 2.0, -28.0, -88.0, -217.0, 0.0, 0.0, -68.0, -268.0, -72.0, -66.0, -74.0, -67.0, 0.0, -46.0, 0.0, 0.0, -192.0, 0.0, 29.0, -64.0, -158.0, -310.0, 24.0, -24.0, 0.0, 0.0, -72.0, -8.0, -153.0, -43.0, -94.0, -136.0, 0.0, -49.0, -22.0, -130.0, 0.0, -22.0, -123.0, -97.0, -42.0, 0.0, -77.0, -50.0, -18.0, 14.0, -61.0, -53.0, 0.0, 0.0, -32.0, 15.0, -86.0, 0.0, -129.0, -42.0, 0.0, -37.0, 7.0, 0.0, -16.0, -76.0, -18.0, -31.0, 0.0, -10.0, 0.0, -72.0, -2.0, -29.0, -116.0, 0.0, 0.0, 0.0, -78.0, -20.0, -36.0, -49.0, 0.0, 0.0, -35.0, -19.0, 7.0, -37.0, 0.0, -33.0, -8.0, -64.0, 0.0, -12.0, 0.0, -14.0, -38.0, 2.0, 0.0, 15.0, -36.0, -14.0, 0.0, 0.0, -48.0, -24.0, -8.0, -30.0, 0.0, 0.0, 0.0, 9.0, -20.0, 2.0, -60.0, -72.0, -16.0, 0.0, -10.0, 0.0, 1.0, -32.0, -15.0, 1.0, -99.0, -40.0, 6.0, 0.0, 17.0, 3.0, 0.0, -22.0, -6.0, -18.0, 0.0, -14.0, -48.0, -26.0, -30.0, -77.0, 0.0, -4.0, -31.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 21.0, 5.0, 4.0, -2.0, 11.0, 0.0, -22.0, 35.0], "policy_predator_policy_reward": [0.0, 16.0, 16.0, 30.0, 21.0, 21.0, 7.0, 62.0, 0.0, 69.0, 41.0, 38.0, 0.0, 97.0, 70.0, 34.0, 35.0, 60.0, 55.0, 36.0, 39.0, 38.0, 154.0, 0.0, 56.0, 0.0, 0.0, 1.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 36.0, 67.0, 0.0, 12.0, 73.0, 110.0, 7.0, 6.0, 1.0, 19.0, 135.0, 0.0, 0.0, 0.0, 32.0, 135.0, 17.0, 58.0, 57.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 33.0, 128.0, 113.0, 17.0, 0.0, 0.0, 0.0, 31.0, 41.0, 0.0, 94.0, 109.0, 10.0, 2.0, 23.0, 75.0, 0.0, 0.0, 14.0, 0.0, 83.0, 0.0, 27.0, 42.0, 25.0, 9.0, 0.0, 52.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 43.0, 45.0, 97.0, 2.0, 19.0, 6.0, 0.0, 13.0, 44.0, 27.0, 0.0, 5.0, 2.0, 22.0, 24.0, 25.0, 1.0, 50.0, 55.0, 0.0, 0.0, 0.0, 47.0, 36.0, 0.0, 0.0, 0.0, 0.0, 35.0, 24.0, 21.0, 9.0, 17.0, 46.0, 0.0, 14.0, 0.0, 0.0, 7.0, 12.0, 17.0, 0.0, 1.0, 18.0, 5.0, 0.0, 0.0, 30.0, 13.0, 15.0, 9.0, 0.0, 0.0, 7.0, 5.0, 0.0, 10.0, 43.0, 63.0, 2.0, 8.0, 5.0, 0.0, 8.0, 16.0, 9.0, 0.0, 49.0, 31.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 12.0, 0.0, 5.0, 7.0, 12.0, 34.0, 26.0, 34.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 8.0, 1.0, 0.0, 4.0, 2.0, 4.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9432942276237765, "mean_inference_ms": 2.7805385606947515, "mean_action_processing_ms": 0.36538144349268736, "mean_env_wait_ms": 0.33375571771085155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016973257064819336, "StateBufferConnector_ms": 0.0046842098236083984, "ViewRequirementAgentConnector_ms": 0.1564100980758667}, "num_episodes": 22, "episode_return_max": 69.0, "episode_return_min": -227.0, "episode_return_mean": -23.27, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.6946014596138, "num_env_steps_trained_throughput_per_sec": 293.6946014596138, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 13379.505, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13379.449, "sample_time_ms": 1910.09, "learn_time_ms": 11448.409, "learn_throughput": 349.394, "synch_weights_time_ms": 18.098}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "f1691_00002", "date": "2024-08-13_19-27-40", "timestamp": 1723591660, "time_this_iter_s": 13.677386045455933, "time_total_s": 4183.6195566654205, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4183.6195566654205, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 58.74499999999999, "ram_util_percent": 82.21000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6641465246677398, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.5317333145589425, "policy_loss": -0.003672705170397878, "vf_loss": 0.5352212555982448, "vf_explained_var": 0.004143876058083994, "kl": 0.006569358307709698, "entropy": 0.9687732858001871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6994157018642577, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 0.00010000000000000003, "total_loss": 0.759531390418609, "policy_loss": -0.01029437501500878, "vf_loss": 0.7697764217774704, "vf_explained_var": -0.031061069328318196, "kl": 0.02105418678370123, "entropy": 1.3873213712500516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -227.0, "episode_reward_mean": -17.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.0, "predator_policy": 135.0}, "policy_reward_mean": {"prey_policy": -23.415, "predator_policy": 14.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -169.0, -63.0, -84.0, -21.0, 0.0, -96.0, -2.0, -227.0, 17.0, 0.0, -8.0, -102.0, -111.0, -24.0, -77.0, -8.0, -137.0, -15.0, -60.0, 5.0, -62.0, 0.0, 8.0, -43.0, -29.0, -16.0, 13.0, -35.0, -22.0, -3.0, -26.0, -5.0, -11.0, 0.0, -51.0, -49.0, 0.0, -19.0, 15.0, -7.0, -26.0, 2.0, -7.0, -7.0, 16.0, -27.0, 0.0, -29.0, -14.0, 0.0, 21.0, -8.0, -26.0, -6.0, -5.0, -7.0, -5.0, -59.0, 6.0, 21.0, -11.0, -12.0, -2.0, -28.0, -47.0, 5.0, -11.0, 0.0, 0.0, 0.0, -3.0, 0.0, 41.0, 3.0, 17.0, 28.0, 5.0, 3.0, 0.0, 4.0, 0.0, 1.0, 0.0, -1.0, -19.0, -10.0, -5.0, 12.0, 26.0, 0.0, -10.0, -3.0, -8.0, 0.0, 25.0, -17.0, 0.0, -8.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -68.0, -268.0, -72.0, -66.0, -74.0, -67.0, 0.0, -46.0, 0.0, 0.0, -192.0, 0.0, 29.0, -64.0, -158.0, -310.0, 24.0, -24.0, 0.0, 0.0, -72.0, -8.0, -153.0, -43.0, -94.0, -136.0, 0.0, -49.0, -22.0, -130.0, 0.0, -22.0, -123.0, -97.0, -42.0, 0.0, -77.0, -50.0, -18.0, 14.0, -61.0, -53.0, 0.0, 0.0, -32.0, 15.0, -86.0, 0.0, -129.0, -42.0, 0.0, -37.0, 7.0, 0.0, -16.0, -76.0, -18.0, -31.0, 0.0, -10.0, 0.0, -72.0, -2.0, -29.0, -116.0, 0.0, 0.0, 0.0, -78.0, -20.0, -36.0, -49.0, 0.0, 0.0, -35.0, -19.0, 7.0, -37.0, 0.0, -33.0, -8.0, -64.0, 0.0, -12.0, 0.0, -14.0, -38.0, 2.0, 0.0, 15.0, -36.0, -14.0, 0.0, 0.0, -48.0, -24.0, -8.0, -30.0, 0.0, 0.0, 0.0, 9.0, -20.0, 2.0, -60.0, -72.0, -16.0, 0.0, -10.0, 0.0, 1.0, -32.0, -15.0, 1.0, -99.0, -40.0, 6.0, 0.0, 17.0, 3.0, 0.0, -22.0, -6.0, -18.0, 0.0, -14.0, -48.0, -26.0, -30.0, -77.0, 0.0, -4.0, -31.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 21.0, 5.0, 4.0, -2.0, 11.0, 0.0, -22.0, 35.0, -47.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -21.0, -8.0, 0.0, 0.0, -4.0, 1.0, -42.0, 0.0, -18.0, -2.0, -18.0, 0.0, 16.0, -8.0, 27.0, -2.0, 0.0, 0.0, -16.0, -8.0, -12.0, 3.0, 0.0, -16.0, 0.0, 0.0, 11.0, -19.0, -57.0, -6.0, 0.0, 0.0, 0.0, -16.0, -6.0, -39.0], "policy_predator_policy_reward": [0.0, 0.0, 32.0, 135.0, 17.0, 58.0, 57.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 33.0, 128.0, 113.0, 17.0, 0.0, 0.0, 0.0, 31.0, 41.0, 0.0, 94.0, 109.0, 10.0, 2.0, 23.0, 75.0, 0.0, 0.0, 14.0, 0.0, 83.0, 0.0, 27.0, 42.0, 25.0, 9.0, 0.0, 52.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 43.0, 45.0, 97.0, 2.0, 19.0, 6.0, 0.0, 13.0, 44.0, 27.0, 0.0, 5.0, 2.0, 22.0, 24.0, 25.0, 1.0, 50.0, 55.0, 0.0, 0.0, 0.0, 47.0, 36.0, 0.0, 0.0, 0.0, 0.0, 35.0, 24.0, 21.0, 9.0, 17.0, 46.0, 0.0, 14.0, 0.0, 0.0, 7.0, 12.0, 17.0, 0.0, 1.0, 18.0, 5.0, 0.0, 0.0, 30.0, 13.0, 15.0, 9.0, 0.0, 0.0, 7.0, 5.0, 0.0, 10.0, 43.0, 63.0, 2.0, 8.0, 5.0, 0.0, 8.0, 16.0, 9.0, 0.0, 49.0, 31.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 12.0, 0.0, 5.0, 7.0, 12.0, 34.0, 26.0, 34.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 8.0, 1.0, 0.0, 4.0, 2.0, 4.0, 11.0, 28.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 21.0, 2.0, 1.0, 9.0, 13.0, 0.0, 0.0, 4.0, 0.0, 1.0, 0.0, 0.0, 4.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 17.0, 16.0, 16.0, 30.0, 0.0, 0.0, 8.0, 0.0, 26.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9427628451081033, "mean_inference_ms": 2.7701833905478077, "mean_action_processing_ms": 0.3655659904748927, "mean_env_wait_ms": 0.33270438922703316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017870783805847168, "StateBufferConnector_ms": 0.004047274589538574, "ViewRequirementAgentConnector_ms": 0.1643303632736206}, "num_episodes": 23, "episode_return_max": 41.0, "episode_return_min": -227.0, "episode_return_mean": -17.25, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.17097365586403, "num_env_steps_trained_throughput_per_sec": 195.17097365586403, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 13978.609, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13978.553, "sample_time_ms": 1922.068, "learn_time_ms": 12034.897, "learn_throughput": 332.367, "synch_weights_time_ms": 18.497}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "f1691_00002", "date": "2024-08-13_19-28-01", "timestamp": 1723591681, "time_this_iter_s": 20.544040203094482, "time_total_s": 4204.163596868515, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4204.163596868515, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 87.84482758620692, "ram_util_percent": 83.77241379310345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1995606397628469, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.16492089712893757, "policy_loss": -0.002587859376417424, "vf_loss": 0.1672611647945824, "vf_explained_var": 0.047458830460038764, "kl": 0.008803251392611325, "entropy": 0.9752906246475441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6699651323850193, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.35413723657888274, "policy_loss": -0.00667869441997181, "vf_loss": 0.3607563646863801, "vf_explained_var": 0.020353357754056417, "kl": 0.01694304201395283, "entropy": 1.412836587555194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -62.0, "episode_reward_mean": -5.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -129.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.0, "predator_policy": 97.0}, "policy_reward_mean": {"prey_policy": -12.425, "predator_policy": 9.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -60.0, 5.0, -62.0, 0.0, 8.0, -43.0, -29.0, -16.0, 13.0, -35.0, -22.0, -3.0, -26.0, -5.0, -11.0, 0.0, -51.0, -49.0, 0.0, -19.0, 15.0, -7.0, -26.0, 2.0, -7.0, -7.0, 16.0, -27.0, 0.0, -29.0, -14.0, 0.0, 21.0, -8.0, -26.0, -6.0, -5.0, -7.0, -5.0, -59.0, 6.0, 21.0, -11.0, -12.0, -2.0, -28.0, -47.0, 5.0, -11.0, 0.0, 0.0, 0.0, -3.0, 0.0, 41.0, 3.0, 17.0, 28.0, 5.0, 3.0, 0.0, 4.0, 0.0, 1.0, 0.0, -1.0, -19.0, -10.0, -5.0, 12.0, 26.0, 0.0, -10.0, -3.0, -8.0, 0.0, 25.0, -17.0, 0.0, -8.0, -16.0, -18.0, 28.0, 18.0, 8.0, 7.0, -17.0, 0.0, -3.0, 0.0, 0.0, -14.0, 6.0, -7.0, 11.0, 0.0, 3.0, -8.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, 0.0, -77.0, -50.0, -18.0, 14.0, -61.0, -53.0, 0.0, 0.0, -32.0, 15.0, -86.0, 0.0, -129.0, -42.0, 0.0, -37.0, 7.0, 0.0, -16.0, -76.0, -18.0, -31.0, 0.0, -10.0, 0.0, -72.0, -2.0, -29.0, -116.0, 0.0, 0.0, 0.0, -78.0, -20.0, -36.0, -49.0, 0.0, 0.0, -35.0, -19.0, 7.0, -37.0, 0.0, -33.0, -8.0, -64.0, 0.0, -12.0, 0.0, -14.0, -38.0, 2.0, 0.0, 15.0, -36.0, -14.0, 0.0, 0.0, -48.0, -24.0, -8.0, -30.0, 0.0, 0.0, 0.0, 9.0, -20.0, 2.0, -60.0, -72.0, -16.0, 0.0, -10.0, 0.0, 1.0, -32.0, -15.0, 1.0, -99.0, -40.0, 6.0, 0.0, 17.0, 3.0, 0.0, -22.0, -6.0, -18.0, 0.0, -14.0, -48.0, -26.0, -30.0, -77.0, 0.0, -4.0, -31.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 21.0, 5.0, 4.0, -2.0, 11.0, 0.0, -22.0, 35.0, -47.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -21.0, -8.0, 0.0, 0.0, -4.0, 1.0, -42.0, 0.0, -18.0, -2.0, -18.0, 0.0, 16.0, -8.0, 27.0, -2.0, 0.0, 0.0, -16.0, -8.0, -12.0, 3.0, 0.0, -16.0, 0.0, 0.0, 11.0, -19.0, -57.0, -6.0, 0.0, 0.0, 0.0, -16.0, -6.0, -39.0, 0.0, -45.0, 0.0, 28.0, 13.0, 5.0, 1.0, 7.0, 18.0, -22.0, -13.0, -12.0, 0.0, 0.0, -8.0, 1.0, 0.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 6.0, -14.0, 0.0, 6.0, 5.0, 0.0, -3.0, 3.0, 0.0, -65.0, 10.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 27.0, 42.0, 25.0, 9.0, 0.0, 52.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 43.0, 45.0, 97.0, 2.0, 19.0, 6.0, 0.0, 13.0, 44.0, 27.0, 0.0, 5.0, 2.0, 22.0, 24.0, 25.0, 1.0, 50.0, 55.0, 0.0, 0.0, 0.0, 47.0, 36.0, 0.0, 0.0, 0.0, 0.0, 35.0, 24.0, 21.0, 9.0, 17.0, 46.0, 0.0, 14.0, 0.0, 0.0, 7.0, 12.0, 17.0, 0.0, 1.0, 18.0, 5.0, 0.0, 0.0, 30.0, 13.0, 15.0, 9.0, 0.0, 0.0, 7.0, 5.0, 0.0, 10.0, 43.0, 63.0, 2.0, 8.0, 5.0, 0.0, 8.0, 16.0, 9.0, 0.0, 49.0, 31.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 12.0, 0.0, 5.0, 7.0, 12.0, 34.0, 26.0, 34.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 8.0, 1.0, 0.0, 4.0, 2.0, 4.0, 11.0, 28.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 21.0, 2.0, 1.0, 9.0, 13.0, 0.0, 0.0, 4.0, 0.0, 1.0, 0.0, 0.0, 4.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 17.0, 16.0, 16.0, 30.0, 0.0, 0.0, 8.0, 0.0, 26.0, 3.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 23.0, 24.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9454599567785321, "mean_inference_ms": 2.7907638401403743, "mean_action_processing_ms": 0.36682137735309667, "mean_env_wait_ms": 0.33284437935325956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01789689064025879, "StateBufferConnector_ms": 0.0046634674072265625, "ViewRequirementAgentConnector_ms": 0.17452406883239746}, "num_episodes": 18, "episode_return_max": 41.0, "episode_return_min": -62.0, "episode_return_mean": -5.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.67872968619804, "num_env_steps_trained_throughput_per_sec": 263.67872968619804, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 14220.499, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14220.443, "sample_time_ms": 1939.112, "learn_time_ms": 12259.602, "learn_throughput": 326.275, "synch_weights_time_ms": 18.955}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "f1691_00002", "date": "2024-08-13_19-28-16", "timestamp": 1723591696, "time_this_iter_s": 15.235873222351074, "time_total_s": 4219.399470090866, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4219.399470090866, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.219047619047615, "ram_util_percent": 83.94761904761904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3614789606520423, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.31809055429917793, "policy_loss": -0.0022729328722648676, "vf_loss": 0.3200472057192148, "vf_explained_var": 0.0036623090978652713, "kl": 0.01124557887964488, "entropy": 0.9477244107180802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.413816601173982, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.6203438341760485, "policy_loss": -0.003790575852395878, "vf_loss": 0.6241173243810417, "vf_explained_var": -0.05143126788593474, "kl": 0.004859412657063645, "entropy": 1.4014998567167414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 42.0, "episode_reward_min": -59.0, "episode_reward_mean": -2.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.0, "predator_policy": 63.0}, "policy_reward_mean": {"prey_policy": -7.64, "predator_policy": 6.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, 0.0, -19.0, 15.0, -7.0, -26.0, 2.0, -7.0, -7.0, 16.0, -27.0, 0.0, -29.0, -14.0, 0.0, 21.0, -8.0, -26.0, -6.0, -5.0, -7.0, -5.0, -59.0, 6.0, 21.0, -11.0, -12.0, -2.0, -28.0, -47.0, 5.0, -11.0, 0.0, 0.0, 0.0, -3.0, 0.0, 41.0, 3.0, 17.0, 28.0, 5.0, 3.0, 0.0, 4.0, 0.0, 1.0, 0.0, -1.0, -19.0, -10.0, -5.0, 12.0, 26.0, 0.0, -10.0, -3.0, -8.0, 0.0, 25.0, -17.0, 0.0, -8.0, -16.0, -18.0, 28.0, 18.0, 8.0, 7.0, -17.0, 0.0, -3.0, 0.0, 0.0, -14.0, 6.0, -7.0, 11.0, 0.0, 3.0, -8.0, 0.0, 0.0, -3.0, 7.0, -38.0, -15.0, 0.0, 13.0, 42.0, 0.0, 4.0, 6.0, -23.0, 8.0, 10.0, 0.0, 8.0, -4.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-36.0, -49.0, 0.0, 0.0, -35.0, -19.0, 7.0, -37.0, 0.0, -33.0, -8.0, -64.0, 0.0, -12.0, 0.0, -14.0, -38.0, 2.0, 0.0, 15.0, -36.0, -14.0, 0.0, 0.0, -48.0, -24.0, -8.0, -30.0, 0.0, 0.0, 0.0, 9.0, -20.0, 2.0, -60.0, -72.0, -16.0, 0.0, -10.0, 0.0, 1.0, -32.0, -15.0, 1.0, -99.0, -40.0, 6.0, 0.0, 17.0, 3.0, 0.0, -22.0, -6.0, -18.0, 0.0, -14.0, -48.0, -26.0, -30.0, -77.0, 0.0, -4.0, -31.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 21.0, 5.0, 4.0, -2.0, 11.0, 0.0, -22.0, 35.0, -47.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -21.0, -8.0, 0.0, 0.0, -4.0, 1.0, -42.0, 0.0, -18.0, -2.0, -18.0, 0.0, 16.0, -8.0, 27.0, -2.0, 0.0, 0.0, -16.0, -8.0, -12.0, 3.0, 0.0, -16.0, 0.0, 0.0, 11.0, -19.0, -57.0, -6.0, 0.0, 0.0, 0.0, -16.0, -6.0, -39.0, 0.0, -45.0, 0.0, 28.0, 13.0, 5.0, 1.0, 7.0, 18.0, -22.0, -13.0, -12.0, 0.0, 0.0, -8.0, 1.0, 0.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 6.0, -14.0, 0.0, 6.0, 5.0, 0.0, -3.0, 3.0, 0.0, -65.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 7.0, -39.0, -20.0, -8.0, -14.0, 0.0, 0.0, 20.0, -14.0, 42.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, -56.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, -29.0, 19.0, 0.0, -18.0, 0.0, -9.0], "policy_predator_policy_reward": [36.0, 0.0, 0.0, 0.0, 0.0, 35.0, 24.0, 21.0, 9.0, 17.0, 46.0, 0.0, 14.0, 0.0, 0.0, 7.0, 12.0, 17.0, 0.0, 1.0, 18.0, 5.0, 0.0, 0.0, 30.0, 13.0, 15.0, 9.0, 0.0, 0.0, 7.0, 5.0, 0.0, 10.0, 43.0, 63.0, 2.0, 8.0, 5.0, 0.0, 8.0, 16.0, 9.0, 0.0, 49.0, 31.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 12.0, 0.0, 5.0, 7.0, 12.0, 34.0, 26.0, 34.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 8.0, 1.0, 0.0, 4.0, 2.0, 4.0, 11.0, 28.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 21.0, 2.0, 1.0, 9.0, 13.0, 0.0, 0.0, 4.0, 0.0, 1.0, 0.0, 0.0, 4.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 17.0, 16.0, 16.0, 30.0, 0.0, 0.0, 8.0, 0.0, 26.0, 3.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 23.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 14.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9465968846978204, "mean_inference_ms": 2.7978479567310246, "mean_action_processing_ms": 0.3677743605182415, "mean_env_wait_ms": 0.3331292116853268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747918128967285, "StateBufferConnector_ms": 0.004615306854248047, "ViewRequirementAgentConnector_ms": 0.19234776496887207}, "num_episodes": 18, "episode_return_max": 42.0, "episode_return_min": -59.0, "episode_return_mean": -2.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.9392808213575, "num_env_steps_trained_throughput_per_sec": 288.9392808213575, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14370.662, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14370.595, "sample_time_ms": 1994.152, "learn_time_ms": 12353.44, "learn_throughput": 323.796, "synch_weights_time_ms": 19.886}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "f1691_00002", "date": "2024-08-13_19-28-30", "timestamp": 1723591710, "time_this_iter_s": 13.896859884262085, "time_total_s": 4233.296329975128, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4233.296329975128, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 65.50500000000001, "ram_util_percent": 83.97}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5992477775211371, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.3471083731799529, "policy_loss": -0.0016966253336735818, "vf_loss": 0.34863013151698014, "vf_explained_var": 0.002952283368539558, "kl": 0.006217455537354052, "entropy": 0.9724137098385544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8233503485482836, "cur_kl_coeff": 0.0017578125000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.5407911532816894, "policy_loss": -0.0034480910694039374, "vf_loss": 0.5442087724652122, "vf_explained_var": 0.0014250480939471532, "kl": 0.0173348270930989, "entropy": 1.312931167322492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 42.0, "episode_reward_min": -59.0, "episode_reward_mean": -0.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -99.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.0, "predator_policy": 49.0}, "policy_reward_mean": {"prey_policy": -5.075, "predator_policy": 4.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -5.0, -7.0, -5.0, -59.0, 6.0, 21.0, -11.0, -12.0, -2.0, -28.0, -47.0, 5.0, -11.0, 0.0, 0.0, 0.0, -3.0, 0.0, 41.0, 3.0, 17.0, 28.0, 5.0, 3.0, 0.0, 4.0, 0.0, 1.0, 0.0, -1.0, -19.0, -10.0, -5.0, 12.0, 26.0, 0.0, -10.0, -3.0, -8.0, 0.0, 25.0, -17.0, 0.0, -8.0, -16.0, -18.0, 28.0, 18.0, 8.0, 7.0, -17.0, 0.0, -3.0, 0.0, 0.0, -14.0, 6.0, -7.0, 11.0, 0.0, 3.0, -8.0, 0.0, 0.0, -3.0, 7.0, -38.0, -15.0, 0.0, 13.0, 42.0, 0.0, 4.0, 6.0, -23.0, 8.0, 10.0, 0.0, 8.0, -4.0, -2.0, 25.0, 25.0, -9.0, 0.0, -2.0, -12.0, 1.0, 29.0, 0.0, -7.0, 0.0, 0.0, 0.0, -6.0, -7.0, 0.0, -17.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, 0.0, -10.0, 0.0, 1.0, -32.0, -15.0, 1.0, -99.0, -40.0, 6.0, 0.0, 17.0, 3.0, 0.0, -22.0, -6.0, -18.0, 0.0, -14.0, -48.0, -26.0, -30.0, -77.0, 0.0, -4.0, -31.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 21.0, 5.0, 4.0, -2.0, 11.0, 0.0, -22.0, 35.0, -47.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -21.0, -8.0, 0.0, 0.0, -4.0, 1.0, -42.0, 0.0, -18.0, -2.0, -18.0, 0.0, 16.0, -8.0, 27.0, -2.0, 0.0, 0.0, -16.0, -8.0, -12.0, 3.0, 0.0, -16.0, 0.0, 0.0, 11.0, -19.0, -57.0, -6.0, 0.0, 0.0, 0.0, -16.0, -6.0, -39.0, 0.0, -45.0, 0.0, 28.0, 13.0, 5.0, 1.0, 7.0, 18.0, -22.0, -13.0, -12.0, 0.0, 0.0, -8.0, 1.0, 0.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 6.0, -14.0, 0.0, 6.0, 5.0, 0.0, -3.0, 3.0, 0.0, -65.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 7.0, -39.0, -20.0, -8.0, -14.0, 0.0, 0.0, 20.0, -14.0, 42.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, -56.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, -29.0, 19.0, 0.0, -18.0, 0.0, -9.0, 0.0, 23.0, 5.0, 20.0, -18.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, -26.0, 1.0, 0.0, 29.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, -36.0, 7.0, 0.0, 0.0, -9.0, -44.0, 0.0, -14.0], "policy_predator_policy_reward": [2.0, 8.0, 5.0, 0.0, 8.0, 16.0, 9.0, 0.0, 49.0, 31.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 12.0, 0.0, 5.0, 7.0, 12.0, 34.0, 26.0, 34.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 8.0, 1.0, 0.0, 4.0, 2.0, 4.0, 11.0, 28.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 21.0, 2.0, 1.0, 9.0, 13.0, 0.0, 0.0, 4.0, 0.0, 1.0, 0.0, 0.0, 4.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 17.0, 16.0, 16.0, 30.0, 0.0, 0.0, 8.0, 0.0, 26.0, 3.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 23.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 14.0, 0.0, 7.0, 1.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 13.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 22.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9449589214809998, "mean_inference_ms": 2.79589312410241, "mean_action_processing_ms": 0.3674334784175538, "mean_env_wait_ms": 0.33250733602350396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01657867431640625, "StateBufferConnector_ms": 0.004161357879638672, "ViewRequirementAgentConnector_ms": 0.18065130710601807}, "num_episodes": 18, "episode_return_max": 42.0, "episode_return_min": -59.0, "episode_return_mean": -0.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.58463027377695, "num_env_steps_trained_throughput_per_sec": 285.58463027377695, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 14586.479, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14586.412, "sample_time_ms": 2024.61, "learn_time_ms": 12537.261, "learn_throughput": 319.049, "synch_weights_time_ms": 20.995}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "f1691_00002", "date": "2024-08-13_19-28-44", "timestamp": 1723591724, "time_this_iter_s": 14.053973913192749, "time_total_s": 4247.350303888321, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fd9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4247.350303888321, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.19500000000001, "ram_util_percent": 83.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.452350513901187, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.22569165599665472, "policy_loss": -0.00475903430697385, "vf_loss": 0.23008203839676247, "vf_explained_var": 0.0037987758873631716, "kl": 0.013107636264714645, "entropy": 0.997175706442071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2464656250541486, "cur_kl_coeff": 0.0017578125000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.6521291334812761, "policy_loss": -0.0029596359280514577, "vf_loss": 0.6550729933167714, "vf_explained_var": 0.016036256248988804, "kl": 0.008974988687328747, "entropy": 1.2041605027895126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 42.0, "episode_reward_min": -85.0, "episode_reward_mean": 0.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -66.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": -3.79, "predator_policy": 3.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 5.0, 3.0, 0.0, 4.0, 0.0, 1.0, 0.0, -1.0, -19.0, -10.0, -5.0, 12.0, 26.0, 0.0, -10.0, -3.0, -8.0, 0.0, 25.0, -17.0, 0.0, -8.0, -16.0, -18.0, 28.0, 18.0, 8.0, 7.0, -17.0, 0.0, -3.0, 0.0, 0.0, -14.0, 6.0, -7.0, 11.0, 0.0, 3.0, -8.0, 0.0, 0.0, -3.0, 7.0, -38.0, -15.0, 0.0, 13.0, 42.0, 0.0, 4.0, 6.0, -23.0, 8.0, 10.0, 0.0, 8.0, -4.0, -2.0, 25.0, 25.0, -9.0, 0.0, -2.0, -12.0, 1.0, 29.0, 0.0, -7.0, 0.0, 0.0, 0.0, -6.0, -7.0, 0.0, -17.0, -7.0, -11.0, 33.0, 0.0, 0.0, -14.0, 17.0, 18.0, -2.0, -85.0, -7.0, 6.0, -4.0, 2.0, 11.0, 0.0, -3.0, 0.0, -3.0, 0.0, -2.0, -16.0, 19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 35.0, -47.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -21.0, -8.0, 0.0, 0.0, -4.0, 1.0, -42.0, 0.0, -18.0, -2.0, -18.0, 0.0, 16.0, -8.0, 27.0, -2.0, 0.0, 0.0, -16.0, -8.0, -12.0, 3.0, 0.0, -16.0, 0.0, 0.0, 11.0, -19.0, -57.0, -6.0, 0.0, 0.0, 0.0, -16.0, -6.0, -39.0, 0.0, -45.0, 0.0, 28.0, 13.0, 5.0, 1.0, 7.0, 18.0, -22.0, -13.0, -12.0, 0.0, 0.0, -8.0, 1.0, 0.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 6.0, -14.0, 0.0, 6.0, 5.0, 0.0, -3.0, 3.0, 0.0, -65.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 7.0, -39.0, -20.0, -8.0, -14.0, 0.0, 0.0, 20.0, -14.0, 42.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, -56.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, -29.0, 19.0, 0.0, -18.0, 0.0, -9.0, 0.0, 23.0, 5.0, 20.0, -18.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, -26.0, 1.0, 0.0, 29.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, -36.0, 7.0, 0.0, 0.0, -9.0, -44.0, 0.0, -14.0, 0.0, -22.0, -5.0, 31.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 17.0, 0.0, 0.0, 10.0, 0.0, -4.0, -52.0, -66.0, 0.0, -14.0, 0.0, 4.0, 0.0, -8.0, 1.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -6.0, -2.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -5.0, -32.0, 0.0, 27.0, -24.0], "policy_predator_policy_reward": [4.0, 11.0, 28.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 21.0, 2.0, 1.0, 9.0, 13.0, 0.0, 0.0, 4.0, 0.0, 1.0, 0.0, 0.0, 4.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 17.0, 16.0, 16.0, 30.0, 0.0, 0.0, 8.0, 0.0, 26.0, 3.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 23.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 14.0, 0.0, 7.0, 1.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 13.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 22.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 7.0, 2.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 33.0, 0.0, 0.0, 7.0, 1.0, 1.0, 4.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 1.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 16.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9422006581496065, "mean_inference_ms": 2.7906316328930996, "mean_action_processing_ms": 0.36667130455314906, "mean_env_wait_ms": 0.33160897426105945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006011366844177246, "StateBufferConnector_ms": 0.004103660583496094, "ViewRequirementAgentConnector_ms": 0.14187824726104736}, "num_episodes": 22, "episode_return_max": 42.0, "episode_return_min": -85.0, "episode_return_mean": 0.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.3412590762898, "num_env_steps_trained_throughput_per_sec": 294.3412590762898, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 14648.453, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14648.386, "sample_time_ms": 2048.968, "learn_time_ms": 12574.832, "learn_throughput": 318.096, "synch_weights_time_ms": 21.121}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "f1691_00002", "date": "2024-08-13_19-28-58", "timestamp": 1723591738, "time_this_iter_s": 13.632627010345459, "time_total_s": 4260.982930898666, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ef8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4260.982930898666, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 63.15, "ram_util_percent": 82.855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.554843855061859, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.3204333766348778, "policy_loss": -0.00530551269344946, "vf_loss": 0.3253653134508539, "vf_explained_var": 0.004901650437602291, "kl": 0.013282690520993281, "entropy": 0.9692940606326653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4136947099099713, "cur_kl_coeff": 0.0017578125000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.5865964285912307, "policy_loss": -0.006684272565568487, "vf_loss": 0.5932546216344077, "vf_explained_var": -0.021494557460149128, "kl": 0.014835771354433475, "entropy": 1.0977196979144264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 42.0, "episode_reward_min": -85.0, "episode_reward_mean": 0.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -66.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 42.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": -2.975, "predator_policy": 3.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, -18.0, 28.0, 18.0, 8.0, 7.0, -17.0, 0.0, -3.0, 0.0, 0.0, -14.0, 6.0, -7.0, 11.0, 0.0, 3.0, -8.0, 0.0, 0.0, -3.0, 7.0, -38.0, -15.0, 0.0, 13.0, 42.0, 0.0, 4.0, 6.0, -23.0, 8.0, 10.0, 0.0, 8.0, -4.0, -2.0, 25.0, 25.0, -9.0, 0.0, -2.0, -12.0, 1.0, 29.0, 0.0, -7.0, 0.0, 0.0, 0.0, -6.0, -7.0, 0.0, -17.0, -7.0, -11.0, 33.0, 0.0, 0.0, -14.0, 17.0, 18.0, -2.0, -85.0, -7.0, 6.0, -4.0, 2.0, 11.0, 0.0, -3.0, 0.0, -3.0, 0.0, -2.0, -16.0, 19.0, -3.0, 0.0, 0.0, -8.0, 0.0, 5.0, -7.0, -13.0, -10.0, 0.0, 11.0, 0.0, -20.0, 22.0, 26.0, 23.0, 3.0, -1.0, 0.0, 30.0, 29.0, 20.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -39.0, 0.0, -45.0, 0.0, 28.0, 13.0, 5.0, 1.0, 7.0, 18.0, -22.0, -13.0, -12.0, 0.0, 0.0, -8.0, 1.0, 0.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, 6.0, -14.0, 0.0, 6.0, 5.0, 0.0, -3.0, 3.0, 0.0, -65.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 7.0, -39.0, -20.0, -8.0, -14.0, 0.0, 0.0, 20.0, -14.0, 42.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, -56.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, -29.0, 19.0, 0.0, -18.0, 0.0, -9.0, 0.0, 23.0, 5.0, 20.0, -18.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, -26.0, 1.0, 0.0, 29.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, -36.0, 7.0, 0.0, 0.0, -9.0, -44.0, 0.0, -14.0, 0.0, -22.0, -5.0, 31.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 17.0, 0.0, 0.0, 10.0, 0.0, -4.0, -52.0, -66.0, 0.0, -14.0, 0.0, 4.0, 0.0, -8.0, 1.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -6.0, -2.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -5.0, -32.0, 0.0, 27.0, -24.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -10.0, 0.0, -19.0, 0.0, -26.0, -22.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -53.0, 0.0, 3.0, 19.0, 6.0, 20.0, 0.0, 23.0, -22.0, 7.0, -2.0, 0.0, 0.0, 0.0, 30.0, 0.0, -22.0, 23.0, 0.0, 18.0, -21.0, 0.0], "policy_predator_policy_reward": [26.0, 3.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 23.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 14.0, 0.0, 7.0, 1.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 13.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 22.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 7.0, 2.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 33.0, 0.0, 0.0, 7.0, 1.0, 1.0, 4.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 1.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 12.0, 0.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 24.0, 0.0, 2.0, 1.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9389996105876677, "mean_inference_ms": 2.7836201040828916, "mean_action_processing_ms": 0.365607993513086, "mean_env_wait_ms": 0.3305851676635632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004966378211975098, "StateBufferConnector_ms": 0.00408780574798584, "ViewRequirementAgentConnector_ms": 0.14060187339782715}, "num_episodes": 23, "episode_return_max": 42.0, "episode_return_min": -85.0, "episode_return_mean": 0.83, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.5580027182893, "num_env_steps_trained_throughput_per_sec": 285.5580027182893, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 14821.41, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14821.339, "sample_time_ms": 2051.49, "learn_time_ms": 12744.856, "learn_throughput": 313.852, "synch_weights_time_ms": 21.153}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "f1691_00002", "date": "2024-08-13_19-29-12", "timestamp": 1723591752, "time_this_iter_s": 14.07406997680664, "time_total_s": 4275.057000875473, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4173b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4275.057000875473, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 61.64, "ram_util_percent": 83.045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.253355674668358, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.2168606103274715, "policy_loss": -0.007082162655658389, "vf_loss": 0.22345808300931283, "vf_explained_var": -0.0008086655821119036, "kl": 0.017233405492836373, "entropy": 0.9747590224578898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6370950822398145, "cur_kl_coeff": 0.0017578125000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.5764067425693153, "policy_loss": -0.0016002351383644121, "vf_loss": 0.5779783539961846, "vf_explained_var": 0.029685823658786754, "kl": 0.016284715681257618, "entropy": 1.1794489442986786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 51.0, "episode_reward_min": -85.0, "episode_reward_mean": 1.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -66.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 54.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": -2.69, "predator_policy": 3.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -3.0, 7.0, -38.0, -15.0, 0.0, 13.0, 42.0, 0.0, 4.0, 6.0, -23.0, 8.0, 10.0, 0.0, 8.0, -4.0, -2.0, 25.0, 25.0, -9.0, 0.0, -2.0, -12.0, 1.0, 29.0, 0.0, -7.0, 0.0, 0.0, 0.0, -6.0, -7.0, 0.0, -17.0, -7.0, -11.0, 33.0, 0.0, 0.0, -14.0, 17.0, 18.0, -2.0, -85.0, -7.0, 6.0, -4.0, 2.0, 11.0, 0.0, -3.0, 0.0, -3.0, 0.0, -2.0, -16.0, 19.0, -3.0, 0.0, 0.0, -8.0, 0.0, 5.0, -7.0, -13.0, -10.0, 0.0, 11.0, 0.0, -20.0, 22.0, 26.0, 23.0, 3.0, -1.0, 0.0, 30.0, 29.0, 20.0, -7.0, -13.0, 4.0, 3.0, 14.0, 0.0, -2.0, 11.0, 17.0, 17.0, -20.0, 14.0, 0.0, -18.0, -16.0, 51.0, 3.0, -6.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 7.0, -39.0, -20.0, -8.0, -14.0, 0.0, 0.0, 20.0, -14.0, 42.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, -56.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, -29.0, 19.0, 0.0, -18.0, 0.0, -9.0, 0.0, 23.0, 5.0, 20.0, -18.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, -26.0, 1.0, 0.0, 29.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, -36.0, 7.0, 0.0, 0.0, -9.0, -44.0, 0.0, -14.0, 0.0, -22.0, -5.0, 31.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 17.0, 0.0, 0.0, 10.0, 0.0, -4.0, -52.0, -66.0, 0.0, -14.0, 0.0, 4.0, 0.0, -8.0, 1.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -6.0, -2.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -5.0, -32.0, 0.0, 27.0, -24.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -10.0, 0.0, -19.0, 0.0, -26.0, -22.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -53.0, 0.0, 3.0, 19.0, 6.0, 20.0, 0.0, 23.0, -22.0, 7.0, -2.0, 0.0, 0.0, 0.0, 30.0, 0.0, -22.0, 23.0, 0.0, 18.0, -21.0, 0.0, -26.0, 0.0, 0.0, 4.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, -26.0, -5.0, 7.0, 13.0, 4.0, 17.0, 0.0, -12.0, -22.0, 14.0, 0.0, 0.0, 0.0, -36.0, 0.0, -39.0, 0.0, -10.0, 54.0, -10.0, 0.0, -4.0, -20.0, 0.0, -14.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 21.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 14.0, 0.0, 7.0, 1.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 13.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 22.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 7.0, 2.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 33.0, 0.0, 0.0, 7.0, 1.0, 1.0, 4.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 1.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 12.0, 0.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 24.0, 0.0, 2.0, 1.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 23.0, 7.0, 0.0, 9.0, 4.0, 2.0, 16.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9381722589349689, "mean_inference_ms": 2.783302039818746, "mean_action_processing_ms": 0.36544178588970316, "mean_env_wait_ms": 0.3308337083099899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004644036293029785, "StateBufferConnector_ms": 0.0037366151809692383, "ViewRequirementAgentConnector_ms": 0.15492820739746094}, "num_episodes": 18, "episode_return_max": 51.0, "episode_return_min": -85.0, "episode_return_mean": 1.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.39009442123665, "num_env_steps_trained_throughput_per_sec": 263.39009442123665, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14829.597, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14829.527, "sample_time_ms": 2259.587, "learn_time_ms": 12544.929, "learn_throughput": 318.854, "synch_weights_time_ms": 21.462}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "f1691_00002", "date": "2024-08-13_19-29-27", "timestamp": 1723591767, "time_this_iter_s": 15.238105058670044, "time_total_s": 4290.295105934143, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36ff160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4290.295105934143, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 64.32380952380952, "ram_util_percent": 76.17619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5781846572442975, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.5532139376121223, "policy_loss": -0.0010979692279188722, "vf_loss": 0.554085188594563, "vf_explained_var": 0.00084603608600677, "kl": 0.008061068291449626, "entropy": 0.9696976758184888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8418069615723596, "cur_kl_coeff": 0.0017578125000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.7551480115721465, "policy_loss": -0.0034736298012335307, "vf_loss": 0.7585860875509088, "vf_explained_var": -0.03119907253002994, "kl": 0.02022655340432713, "entropy": 1.1462023357865672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 65.0, "episode_reward_min": -85.0, "episode_reward_mean": 0.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 66.0, "predator_policy": 58.0}, "policy_reward_mean": {"prey_policy": -3.735, "predator_policy": 4.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 25.0, 25.0, -9.0, 0.0, -2.0, -12.0, 1.0, 29.0, 0.0, -7.0, 0.0, 0.0, 0.0, -6.0, -7.0, 0.0, -17.0, -7.0, -11.0, 33.0, 0.0, 0.0, -14.0, 17.0, 18.0, -2.0, -85.0, -7.0, 6.0, -4.0, 2.0, 11.0, 0.0, -3.0, 0.0, -3.0, 0.0, -2.0, -16.0, 19.0, -3.0, 0.0, 0.0, -8.0, 0.0, 5.0, -7.0, -13.0, -10.0, 0.0, 11.0, 0.0, -20.0, 22.0, 26.0, 23.0, 3.0, -1.0, 0.0, 30.0, 29.0, 20.0, -7.0, -13.0, 4.0, 3.0, 14.0, 0.0, -2.0, 11.0, 17.0, 17.0, -20.0, 14.0, 0.0, -18.0, -16.0, 51.0, 3.0, -6.0, -7.0, -31.0, -15.0, 65.0, -49.0, 0.0, -1.0, 35.0, 8.0, 4.0, -10.0, -8.0, -62.0, 0.0, 3.0, 26.0, 0.0, 15.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -9.0, 0.0, 23.0, 5.0, 20.0, -18.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, -26.0, 1.0, 0.0, 29.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, -36.0, 7.0, 0.0, 0.0, -9.0, -44.0, 0.0, -14.0, 0.0, -22.0, -5.0, 31.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 17.0, 0.0, 0.0, 10.0, 0.0, -4.0, -52.0, -66.0, 0.0, -14.0, 0.0, 4.0, 0.0, -8.0, 1.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -6.0, -2.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -5.0, -32.0, 0.0, 27.0, -24.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -10.0, 0.0, -19.0, 0.0, -26.0, -22.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -53.0, 0.0, 3.0, 19.0, 6.0, 20.0, 0.0, 23.0, -22.0, 7.0, -2.0, 0.0, 0.0, 0.0, 30.0, 0.0, -22.0, 23.0, 0.0, 18.0, -21.0, 0.0, -26.0, 0.0, 0.0, 4.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, -26.0, -5.0, 7.0, 13.0, 4.0, 17.0, 0.0, -12.0, -22.0, 14.0, 0.0, 0.0, 0.0, -36.0, 0.0, -39.0, 0.0, -10.0, 54.0, -10.0, 0.0, -4.0, -20.0, 0.0, -14.0, 0.0, -68.0, 28.0, -86.0, -2.0, 66.0, 0.0, -98.0, 0.0, 0.0, -2.0, 0.0, 7.0, 28.0, 3.0, 0.0, 1.0, 3.0, -42.0, 11.0, -32.0, 8.0, -8.0, -116.0, 0.0, 0.0, -16.0, 11.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, -34.0, 0.0], "policy_predator_policy_reward": [0.0, 7.0, 1.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 13.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 3.0, 22.0, 0.0, 0.0, 0.0, 36.0, 0.0, 0.0, 7.0, 2.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 33.0, 0.0, 0.0, 7.0, 1.0, 1.0, 4.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 1.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 12.0, 0.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 24.0, 0.0, 2.0, 1.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 23.0, 7.0, 0.0, 9.0, 4.0, 2.0, 16.0, 7.0, 0.0, 34.0, 3.0, 4.0, 39.0, 1.0, 0.0, 49.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 21.0, 0.0, 16.0, 0.0, 4.0, 58.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9386173675161755, "mean_inference_ms": 2.7856955541071455, "mean_action_processing_ms": 0.3657984189277229, "mean_env_wait_ms": 0.3316716262308009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007925748825073242, "StateBufferConnector_ms": 0.00365602970123291, "ViewRequirementAgentConnector_ms": 0.15671908855438232}, "num_episodes": 18, "episode_return_max": 65.0, "episode_return_min": -85.0, "episode_return_mean": 0.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.62653699688912, "num_env_steps_trained_throughput_per_sec": 200.62653699688912, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 15503.544, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15503.475, "sample_time_ms": 2352.914, "learn_time_ms": 13124.325, "learn_throughput": 304.778, "synch_weights_time_ms": 22.578}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "f1691_00002", "date": "2024-08-13_19-29-47", "timestamp": 1723591787, "time_this_iter_s": 20.037646055221558, "time_total_s": 4310.332751989365, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4310.332751989365, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 87.19310344827586, "ram_util_percent": 81.73103448275863}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4455742477345719, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.1402757171118908, "policy_loss": -0.0028261136926375527, "vf_loss": 0.14263654569220585, "vf_explained_var": 0.029377794454968166, "kl": 0.01654346633149079, "entropy": 0.914473423093715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.880191190260901, "cur_kl_coeff": 0.00263671875, "cur_lr": 0.00010000000000000003, "total_loss": 0.38904687989128645, "policy_loss": -0.004213180704622544, "vf_loss": 0.393194325171687, "vf_explained_var": 0.08416430675794208, "kl": 0.02493037316079026, "entropy": 1.0008071278138135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 65.0, "episode_reward_min": -85.0, "episode_reward_mean": 1.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 66.0, "predator_policy": 58.0}, "policy_reward_mean": {"prey_policy": -3.53, "predator_policy": 4.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -14.0, 17.0, 18.0, -2.0, -85.0, -7.0, 6.0, -4.0, 2.0, 11.0, 0.0, -3.0, 0.0, -3.0, 0.0, -2.0, -16.0, 19.0, -3.0, 0.0, 0.0, -8.0, 0.0, 5.0, -7.0, -13.0, -10.0, 0.0, 11.0, 0.0, -20.0, 22.0, 26.0, 23.0, 3.0, -1.0, 0.0, 30.0, 29.0, 20.0, -7.0, -13.0, 4.0, 3.0, 14.0, 0.0, -2.0, 11.0, 17.0, 17.0, -20.0, 14.0, 0.0, -18.0, -16.0, 51.0, 3.0, -6.0, -7.0, -31.0, -15.0, 65.0, -49.0, 0.0, -1.0, 35.0, 8.0, 4.0, -10.0, -8.0, -62.0, 0.0, 3.0, 26.0, 0.0, 15.0, -4.0, 8.0, 0.0, 0.0, -5.0, -6.0, -2.0, 0.0, -2.0, -4.0, -11.0, -9.0, 0.0, 0.0, 14.0, 0.0, -5.0, 8.0, 26.0, -2.0, 0.0, 0.0, 47.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -28.0, 0.0, 17.0, 0.0, 0.0, 10.0, 0.0, -4.0, -52.0, -66.0, 0.0, -14.0, 0.0, 4.0, 0.0, -8.0, 1.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -6.0, -2.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -5.0, -32.0, 0.0, 27.0, -24.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -10.0, 0.0, -19.0, 0.0, -26.0, -22.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -53.0, 0.0, 3.0, 19.0, 6.0, 20.0, 0.0, 23.0, -22.0, 7.0, -2.0, 0.0, 0.0, 0.0, 30.0, 0.0, -22.0, 23.0, 0.0, 18.0, -21.0, 0.0, -26.0, 0.0, 0.0, 4.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, -26.0, -5.0, 7.0, 13.0, 4.0, 17.0, 0.0, -12.0, -22.0, 14.0, 0.0, 0.0, 0.0, -36.0, 0.0, -39.0, 0.0, -10.0, 54.0, -10.0, 0.0, -4.0, -20.0, 0.0, -14.0, 0.0, -68.0, 28.0, -86.0, -2.0, 66.0, 0.0, -98.0, 0.0, 0.0, -2.0, 0.0, 7.0, 28.0, 3.0, 0.0, 1.0, 3.0, -42.0, 11.0, -32.0, 8.0, -8.0, -116.0, 0.0, 0.0, -16.0, 11.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, -34.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -12.0, 4.0, -15.0, 0.0, 0.0, -4.0, 0.0, 6.0, -20.0, -24.0, 0.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -2.0, -40.0, -4.0, 5.0, 26.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 27.0], "policy_predator_policy_reward": [0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 2.0, 33.0, 0.0, 0.0, 7.0, 1.0, 1.0, 4.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 1.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 12.0, 0.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 24.0, 0.0, 2.0, 1.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 23.0, 7.0, 0.0, 9.0, 4.0, 2.0, 16.0, 7.0, 0.0, 34.0, 3.0, 4.0, 39.0, 1.0, 0.0, 49.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 21.0, 0.0, 16.0, 0.0, 4.0, 58.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 20.0, 2.0, 5.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9404583898602172, "mean_inference_ms": 2.7956254289260953, "mean_action_processing_ms": 0.3670931021439367, "mean_env_wait_ms": 0.3338203597973643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008223414421081543, "StateBufferConnector_ms": 0.003774404525756836, "ViewRequirementAgentConnector_ms": 0.20370197296142578}, "num_episodes": 22, "episode_return_max": 65.0, "episode_return_min": -85.0, "episode_return_mean": 1.22, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.0798024318681, "num_env_steps_trained_throughput_per_sec": 295.0798024318681, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 15341.173, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15341.107, "sample_time_ms": 2264.854, "learn_time_ms": 13049.056, "learn_throughput": 306.536, "synch_weights_time_ms": 24.104}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "f1691_00002", "date": "2024-08-13_19-30-01", "timestamp": 1723591801, "time_this_iter_s": 13.579432249069214, "time_total_s": 4323.912184238434, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ea8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4323.912184238434, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 56.27368421052632, "ram_util_percent": 76.90526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.891033823567408, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.43691992343418184, "policy_loss": -0.0030088561982478178, "vf_loss": 0.43956168382059013, "vf_explained_var": 0.0248675353627987, "kl": 0.013052256425857117, "entropy": 0.958901438479701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.885925094262948, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 0.00010000000000000003, "total_loss": 1.0389220660483396, "policy_loss": -0.003501668084467017, "vf_loss": 1.0423901982408352, "vf_explained_var": 0.01653904719327493, "kl": 0.008479430365999482, "entropy": 0.9361591620104653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 65.0, "episode_reward_min": -62.0, "episode_reward_mean": 2.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 66.0, "predator_policy": 58.0}, "policy_reward_mean": {"prey_policy": -2.855, "predator_policy": 4.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, -3.0, 0.0, 0.0, -8.0, 0.0, 5.0, -7.0, -13.0, -10.0, 0.0, 11.0, 0.0, -20.0, 22.0, 26.0, 23.0, 3.0, -1.0, 0.0, 30.0, 29.0, 20.0, -7.0, -13.0, 4.0, 3.0, 14.0, 0.0, -2.0, 11.0, 17.0, 17.0, -20.0, 14.0, 0.0, -18.0, -16.0, 51.0, 3.0, -6.0, -7.0, -31.0, -15.0, 65.0, -49.0, 0.0, -1.0, 35.0, 8.0, 4.0, -10.0, -8.0, -62.0, 0.0, 3.0, 26.0, 0.0, 15.0, -4.0, 8.0, 0.0, 0.0, -5.0, -6.0, -2.0, 0.0, -2.0, -4.0, -11.0, -9.0, 0.0, 0.0, 14.0, 0.0, -5.0, 8.0, 26.0, -2.0, 0.0, 0.0, 47.0, 5.0, 31.0, 4.0, 7.0, -11.0, 6.0, -3.0, 12.0, 0.0, -2.0, -10.0, 21.0, 27.0, 0.0, 0.0, -14.0, 0.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.0, -24.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -10.0, 0.0, -19.0, 0.0, -26.0, -22.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, -53.0, 0.0, 3.0, 19.0, 6.0, 20.0, 0.0, 23.0, -22.0, 7.0, -2.0, 0.0, 0.0, 0.0, 30.0, 0.0, -22.0, 23.0, 0.0, 18.0, -21.0, 0.0, -26.0, 0.0, 0.0, 4.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, -26.0, -5.0, 7.0, 13.0, 4.0, 17.0, 0.0, -12.0, -22.0, 14.0, 0.0, 0.0, 0.0, -36.0, 0.0, -39.0, 0.0, -10.0, 54.0, -10.0, 0.0, -4.0, -20.0, 0.0, -14.0, 0.0, -68.0, 28.0, -86.0, -2.0, 66.0, 0.0, -98.0, 0.0, 0.0, -2.0, 0.0, 7.0, 28.0, 3.0, 0.0, 1.0, 3.0, -42.0, 11.0, -32.0, 8.0, -8.0, -116.0, 0.0, 0.0, -16.0, 11.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, -34.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -12.0, 4.0, -15.0, 0.0, 0.0, -4.0, 0.0, 6.0, -20.0, -24.0, 0.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -2.0, -40.0, -4.0, 5.0, 26.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 27.0, 5.0, 0.0, -1.0, 22.0, 4.0, 0.0, 7.0, 0.0, 0.0, -22.0, 6.0, 0.0, -37.0, 4.0, -15.0, -7.0, 0.0, 0.0, 0.0, -4.0, -6.0, -8.0, 11.0, 10.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 6.0, -16.0], "policy_predator_policy_reward": [16.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 12.0, 0.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 24.0, 0.0, 2.0, 1.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 23.0, 7.0, 0.0, 9.0, 4.0, 2.0, 16.0, 7.0, 0.0, 34.0, 3.0, 4.0, 39.0, 1.0, 0.0, 49.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 21.0, 0.0, 16.0, 0.0, 4.0, 58.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 20.0, 2.0, 5.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 14.0, 20.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 5.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9443720537623318, "mean_inference_ms": 2.8061432047224093, "mean_action_processing_ms": 0.36874344754564525, "mean_env_wait_ms": 0.3351683398844896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00865793228149414, "StateBufferConnector_ms": 0.004756808280944824, "ViewRequirementAgentConnector_ms": 0.2217113971710205}, "num_episodes": 18, "episode_return_max": 65.0, "episode_return_min": -62.0, "episode_return_mean": 2.79, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.90300015542323, "num_env_steps_trained_throughput_per_sec": 226.90300015542323, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 15742.093, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15741.993, "sample_time_ms": 2316.905, "learn_time_ms": 13392.703, "learn_throughput": 298.67, "synch_weights_time_ms": 28.753}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "f1691_00002", "date": "2024-08-13_19-30-19", "timestamp": 1723591819, "time_this_iter_s": 17.80690026283264, "time_total_s": 4341.7190845012665, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4173af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4341.7190845012665, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 68.6625, "ram_util_percent": 77.10833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8046133631988177, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.3987648774155233, "policy_loss": -0.0026319847851203233, "vf_loss": 0.40104625523016446, "vf_explained_var": 0.015338934003991425, "kl": 0.01246604691738475, "entropy": 0.9428340071723574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0106669837520235, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 0.00010000000000000003, "total_loss": 0.6026076535462702, "policy_loss": -0.0032933765541880377, "vf_loss": 0.6058557279407978, "vf_explained_var": -0.011009945377470956, "kl": 0.011454133446305465, "entropy": 0.8242876894890316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 65.0, "episode_reward_min": -62.0, "episode_reward_mean": 1.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 66.0, "predator_policy": 58.0}, "policy_reward_mean": {"prey_policy": -3.495, "predator_policy": 4.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -13.0, 4.0, 3.0, 14.0, 0.0, -2.0, 11.0, 17.0, 17.0, -20.0, 14.0, 0.0, -18.0, -16.0, 51.0, 3.0, -6.0, -7.0, -31.0, -15.0, 65.0, -49.0, 0.0, -1.0, 35.0, 8.0, 4.0, -10.0, -8.0, -62.0, 0.0, 3.0, 26.0, 0.0, 15.0, -4.0, 8.0, 0.0, 0.0, -5.0, -6.0, -2.0, 0.0, -2.0, -4.0, -11.0, -9.0, 0.0, 0.0, 14.0, 0.0, -5.0, 8.0, 26.0, -2.0, 0.0, 0.0, 47.0, 5.0, 31.0, 4.0, 7.0, -11.0, 6.0, -3.0, 12.0, 0.0, -2.0, -10.0, 21.0, 27.0, 0.0, 0.0, -14.0, 0.0, 2.0, 2.0, 0.0, -43.0, -1.0, 0.0, 4.0, 4.0, 10.0, -4.0, 4.0, -11.0, -1.0, -26.0, 12.0, 9.0, 0.0, 0.0, 16.0, 0.0, -7.0, 11.0, 7.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.0, 0.0, -26.0, 0.0, 0.0, 4.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, -26.0, -5.0, 7.0, 13.0, 4.0, 17.0, 0.0, -12.0, -22.0, 14.0, 0.0, 0.0, 0.0, -36.0, 0.0, -39.0, 0.0, -10.0, 54.0, -10.0, 0.0, -4.0, -20.0, 0.0, -14.0, 0.0, -68.0, 28.0, -86.0, -2.0, 66.0, 0.0, -98.0, 0.0, 0.0, -2.0, 0.0, 7.0, 28.0, 3.0, 0.0, 1.0, 3.0, -42.0, 11.0, -32.0, 8.0, -8.0, -116.0, 0.0, 0.0, -16.0, 11.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, -34.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -12.0, 4.0, -15.0, 0.0, 0.0, -4.0, 0.0, 6.0, -20.0, -24.0, 0.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -2.0, -40.0, -4.0, 5.0, 26.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 27.0, 5.0, 0.0, -1.0, 22.0, 4.0, 0.0, 7.0, 0.0, 0.0, -22.0, 6.0, 0.0, -37.0, 4.0, -15.0, -7.0, 0.0, 0.0, 0.0, -4.0, -6.0, -8.0, 11.0, 10.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 6.0, -16.0, 0.0, -2.0, 0.0, 0.0, -46.0, -30.0, -14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 4.0, 7.0, 0.0, -10.0, 0.0, 0.0, 4.0, -39.0, 0.0, -2.0, 0.0, 0.0, -52.0, 12.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, -18.0, 16.0, -10.0, 6.0, -6.0, 0.0, 0.0], "policy_predator_policy_reward": [1.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 23.0, 7.0, 0.0, 9.0, 4.0, 2.0, 16.0, 7.0, 0.0, 34.0, 3.0, 4.0, 39.0, 1.0, 0.0, 49.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 21.0, 0.0, 16.0, 0.0, 4.0, 58.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 20.0, 2.0, 5.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 14.0, 20.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 4.0, 0.0, 0.0, 33.0, 0.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 19.0, 9.0, 1.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9509762958035062, "mean_inference_ms": 2.832151401937618, "mean_action_processing_ms": 0.37227551710897994, "mean_env_wait_ms": 0.33950235747824953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01080024242401123, "StateBufferConnector_ms": 0.00798177719116211, "ViewRequirementAgentConnector_ms": 0.27179789543151855}, "num_episodes": 23, "episode_return_max": 65.0, "episode_return_min": -62.0, "episode_return_mean": 1.39, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.1520210048671, "num_env_steps_trained_throughput_per_sec": 247.1520210048671, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 15311.047, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15310.945, "sample_time_ms": 2502.733, "learn_time_ms": 12776.345, "learn_throughput": 313.079, "synch_weights_time_ms": 28.192}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "f1691_00002", "date": "2024-08-13_19-30-35", "timestamp": 1723591835, "time_this_iter_s": 16.24795699119568, "time_total_s": 4357.967041492462, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4357.967041492462, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 65.47826086956522, "ram_util_percent": 83.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.171975395327838, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.9081543907128945, "policy_loss": -0.004439972334901098, "vf_loss": 0.9122048562244763, "vf_explained_var": 0.02114247831087264, "kl": 0.013849148406913469, "entropy": 0.9723204137471618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5873977414554075, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 0.00010000000000000003, "total_loss": 1.1847286157034063, "policy_loss": -0.007093848130621371, "vf_loss": 1.1917697331577382, "vf_explained_var": -0.0116129770165398, "kl": 0.013331767131114183, "entropy": 0.7099845629205148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 65.0, "episode_reward_min": -62.0, "episode_reward_mean": 1.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 66.0, "predator_policy": 58.0}, "policy_reward_mean": {"prey_policy": -3.805, "predator_policy": 4.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -31.0, -15.0, 65.0, -49.0, 0.0, -1.0, 35.0, 8.0, 4.0, -10.0, -8.0, -62.0, 0.0, 3.0, 26.0, 0.0, 15.0, -4.0, 8.0, 0.0, 0.0, -5.0, -6.0, -2.0, 0.0, -2.0, -4.0, -11.0, -9.0, 0.0, 0.0, 14.0, 0.0, -5.0, 8.0, 26.0, -2.0, 0.0, 0.0, 47.0, 5.0, 31.0, 4.0, 7.0, -11.0, 6.0, -3.0, 12.0, 0.0, -2.0, -10.0, 21.0, 27.0, 0.0, 0.0, -14.0, 0.0, 2.0, 2.0, 0.0, -43.0, -1.0, 0.0, 4.0, 4.0, 10.0, -4.0, 4.0, -11.0, -1.0, -26.0, 12.0, 9.0, 0.0, 0.0, 16.0, 0.0, -7.0, 11.0, 7.0, 0.0, -6.0, 26.0, 0.0, 12.0, 19.0, -14.0, -24.0, 2.0, 29.0, -7.0, -1.0, 30.0, 42.0, -22.0, -9.0, -6.0, 6.0, 20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -14.0, 0.0, -68.0, 28.0, -86.0, -2.0, 66.0, 0.0, -98.0, 0.0, 0.0, -2.0, 0.0, 7.0, 28.0, 3.0, 0.0, 1.0, 3.0, -42.0, 11.0, -32.0, 8.0, -8.0, -116.0, 0.0, 0.0, -16.0, 11.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, -34.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -12.0, 4.0, -15.0, 0.0, 0.0, -4.0, 0.0, 6.0, -20.0, -24.0, 0.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -2.0, -40.0, -4.0, 5.0, 26.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 27.0, 5.0, 0.0, -1.0, 22.0, 4.0, 0.0, 7.0, 0.0, 0.0, -22.0, 6.0, 0.0, -37.0, 4.0, -15.0, -7.0, 0.0, 0.0, 0.0, -4.0, -6.0, -8.0, 11.0, 10.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 6.0, -16.0, 0.0, -2.0, 0.0, 0.0, -46.0, -30.0, -14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 4.0, 7.0, 0.0, -10.0, 0.0, 0.0, 4.0, -39.0, 0.0, -2.0, 0.0, 0.0, -52.0, 12.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, -18.0, 16.0, -10.0, 6.0, -6.0, 0.0, 0.0, -12.0, 0.0, -3.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 19.0, -41.0, 0.0, -27.0, -12.0, 6.0, -17.0, 0.0, 29.0, 0.0, -20.0, 0.0, -84.0, 30.0, 0.0, 0.0, 42.0, 0.0, -80.0, -18.0, 0.0, 1.0, -14.0, 15.0, -22.0, 20.0, 0.0], "policy_predator_policy_reward": [7.0, 0.0, 34.0, 3.0, 4.0, 39.0, 1.0, 0.0, 49.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 21.0, 0.0, 16.0, 0.0, 4.0, 58.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 20.0, 2.0, 5.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 14.0, 20.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 4.0, 0.0, 0.0, 33.0, 0.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 19.0, 9.0, 1.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 3.0, 0.0, 0.0, 0.0, 6.0, 7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 5.0, 8.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 13.0, 39.0, 44.0, 0.0, 0.0, 0.0, 0.0, 36.0, 22.0, 0.0, 9.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9539244154552238, "mean_inference_ms": 2.84650792101364, "mean_action_processing_ms": 0.3741457550395373, "mean_env_wait_ms": 0.3418805815691684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011003613471984863, "StateBufferConnector_ms": 0.00899052619934082, "ViewRequirementAgentConnector_ms": 0.2779104709625244}, "num_episodes": 18, "episode_return_max": 65.0, "episode_return_min": -62.0, "episode_return_mean": 1.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.81269095659394, "num_env_steps_trained_throughput_per_sec": 297.81269095659394, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 15137.176, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15137.073, "sample_time_ms": 2468.507, "learn_time_ms": 12636.624, "learn_throughput": 316.54, "synch_weights_time_ms": 27.93}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "f1691_00002", "date": "2024-08-13_19-30-49", "timestamp": 1723591849, "time_this_iter_s": 13.473474740982056, "time_total_s": 4371.440516233444, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4371.440516233444, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 57.247368421052634, "ram_util_percent": 82.16842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1227265466536793, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.7952530955038374, "policy_loss": -0.003795133994044687, "vf_loss": 0.7986592584580341, "vf_explained_var": 0.013633310637146076, "kl": 0.013830037148979726, "entropy": 0.9639672626578618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6308908761966796, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 0.00010000000000000003, "total_loss": 1.3170163107612145, "policy_loss": -0.00222948604736418, "vf_loss": 1.3192285363951688, "vf_explained_var": -0.005293805542446318, "kl": 0.00436344982973669, "entropy": 0.6195136824612895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 47.0, "episode_reward_min": -100.0, "episode_reward_mean": 2.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 59.0}, "policy_reward_mean": {"prey_policy": -3.645, "predator_policy": 4.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 8.0, 0.0, 0.0, -5.0, -6.0, -2.0, 0.0, -2.0, -4.0, -11.0, -9.0, 0.0, 0.0, 14.0, 0.0, -5.0, 8.0, 26.0, -2.0, 0.0, 0.0, 47.0, 5.0, 31.0, 4.0, 7.0, -11.0, 6.0, -3.0, 12.0, 0.0, -2.0, -10.0, 21.0, 27.0, 0.0, 0.0, -14.0, 0.0, 2.0, 2.0, 0.0, -43.0, -1.0, 0.0, 4.0, 4.0, 10.0, -4.0, 4.0, -11.0, -1.0, -26.0, 12.0, 9.0, 0.0, 0.0, 16.0, 0.0, -7.0, 11.0, 7.0, 0.0, -6.0, 26.0, 0.0, 12.0, 19.0, -14.0, -24.0, 2.0, 29.0, -7.0, -1.0, 30.0, 42.0, -22.0, -9.0, -6.0, 6.0, 20.0, 25.0, 22.0, -46.0, 32.0, 0.0, 15.0, 6.0, 0.0, -100.0, 40.0, 45.0, -13.0, 10.0, -9.0, 40.0, -13.0, 0.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -12.0, 4.0, -15.0, 0.0, 0.0, -4.0, 0.0, 6.0, -20.0, -24.0, 0.0, -18.0, -8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, -2.0, -40.0, -4.0, 5.0, 26.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 27.0, 5.0, 0.0, -1.0, 22.0, 4.0, 0.0, 7.0, 0.0, 0.0, -22.0, 6.0, 0.0, -37.0, 4.0, -15.0, -7.0, 0.0, 0.0, 0.0, -4.0, -6.0, -8.0, 11.0, 10.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 6.0, -16.0, 0.0, -2.0, 0.0, 0.0, -46.0, -30.0, -14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 4.0, 7.0, 0.0, -10.0, 0.0, 0.0, 4.0, -39.0, 0.0, -2.0, 0.0, 0.0, -52.0, 12.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, -18.0, 16.0, -10.0, 6.0, -6.0, 0.0, 0.0, -12.0, 0.0, -3.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 19.0, -41.0, 0.0, -27.0, -12.0, 6.0, -17.0, 0.0, 29.0, 0.0, -20.0, 0.0, -84.0, 30.0, 0.0, 0.0, 42.0, 0.0, -80.0, -18.0, 0.0, 1.0, -14.0, 15.0, -22.0, 20.0, 0.0, 25.0, 0.0, 19.0, -5.0, -118.0, 10.0, 7.0, 25.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -36.0, -135.0, -12.0, 43.0, 38.0, 1.0, 33.0, -96.0, -11.0, 0.0, -12.0, -6.0, 25.0, 14.0, -31.0, 0.0, 0.0, 0.0, -6.0, -12.0], "policy_predator_policy_reward": [0.0, 30.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 13.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 20.0, 2.0, 5.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 14.0, 20.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 4.0, 0.0, 0.0, 33.0, 0.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 19.0, 9.0, 1.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 3.0, 0.0, 0.0, 0.0, 6.0, 7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 5.0, 8.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 13.0, 39.0, 44.0, 0.0, 0.0, 0.0, 0.0, 36.0, 22.0, 0.0, 9.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 59.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 22.0, 0.0, 0.0, 31.0, 40.0, 0.0, 9.0, 0.0, 6.0, 48.0, 2.0, 21.0, 0.0, 6.0, 3.0, 0.0, 1.0, 18.0, 0.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9552189332308474, "mean_inference_ms": 2.8556839065226054, "mean_action_processing_ms": 0.37519058245461906, "mean_env_wait_ms": 0.3432667202240563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007645964622497559, "StateBufferConnector_ms": 0.00888371467590332, "ViewRequirementAgentConnector_ms": 0.2549244165420532}, "num_episodes": 18, "episode_return_max": 47.0, "episode_return_min": -100.0, "episode_return_mean": 2.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.92114737135216, "num_env_steps_trained_throughput_per_sec": 252.92114737135216, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 15334.322, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15334.233, "sample_time_ms": 2413.683, "learn_time_ms": 12886.974, "learn_throughput": 310.391, "synch_weights_time_ms": 29.229}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "f1691_00002", "date": "2024-08-13_19-31-05", "timestamp": 1723591865, "time_this_iter_s": 15.89048981666565, "time_total_s": 4387.33100605011, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41159d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4387.33100605011, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 67.09545454545456, "ram_util_percent": 83.07727272727276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.175307156484594, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.3102037085427178, "policy_loss": -0.0025578792533706676, "vf_loss": 1.3124184475689338, "vf_explained_var": 0.004069763201254385, "kl": 0.012200573148792837, "entropy": 0.9703403876887428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.42701567889206, "cur_kl_coeff": 0.0019775390624999995, "cur_lr": 0.00010000000000000003, "total_loss": 1.9315520671940354, "policy_loss": -0.003196324016677127, "vf_loss": 1.9347389016517256, "vf_explained_var": 0.01003115177154541, "kl": 0.00479703626706124, "entropy": 0.6684425457129403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 107.0, "episode_reward_min": -259.0, "episode_reward_mean": 0.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -282.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 100.0, "predator_policy": 141.0}, "policy_reward_mean": {"prey_policy": -6.91, "predator_policy": 7.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 5.0, 31.0, 4.0, 7.0, -11.0, 6.0, -3.0, 12.0, 0.0, -2.0, -10.0, 21.0, 27.0, 0.0, 0.0, -14.0, 0.0, 2.0, 2.0, 0.0, -43.0, -1.0, 0.0, 4.0, 4.0, 10.0, -4.0, 4.0, -11.0, -1.0, -26.0, 12.0, 9.0, 0.0, 0.0, 16.0, 0.0, -7.0, 11.0, 7.0, 0.0, -6.0, 26.0, 0.0, 12.0, 19.0, -14.0, -24.0, 2.0, 29.0, -7.0, -1.0, 30.0, 42.0, -22.0, -9.0, -6.0, 6.0, 20.0, 25.0, 22.0, -46.0, 32.0, 0.0, 15.0, 6.0, 0.0, -100.0, 40.0, 45.0, -13.0, 10.0, -9.0, 40.0, -13.0, 0.0, -12.0, 0.0, -141.0, -24.0, -5.0, 6.0, -26.0, -20.0, 107.0, -259.0, 40.0, 3.0, -11.0, 0.0, -47.0, 0.0, 104.0, 16.0, -5.0, 11.0, 0.0, 0.0, 33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 27.0, 5.0, 0.0, -1.0, 22.0, 4.0, 0.0, 7.0, 0.0, 0.0, -22.0, 6.0, 0.0, -37.0, 4.0, -15.0, -7.0, 0.0, 0.0, 0.0, -4.0, -6.0, -8.0, 11.0, 10.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 6.0, -16.0, 0.0, -2.0, 0.0, 0.0, -46.0, -30.0, -14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 4.0, 7.0, 0.0, -10.0, 0.0, 0.0, 4.0, -39.0, 0.0, -2.0, 0.0, 0.0, -52.0, 12.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, -18.0, 16.0, -10.0, 6.0, -6.0, 0.0, 0.0, -12.0, 0.0, -3.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 19.0, -41.0, 0.0, -27.0, -12.0, 6.0, -17.0, 0.0, 29.0, 0.0, -20.0, 0.0, -84.0, 30.0, 0.0, 0.0, 42.0, 0.0, -80.0, -18.0, 0.0, 1.0, -14.0, 15.0, -22.0, 20.0, 0.0, 25.0, 0.0, 19.0, -5.0, -118.0, 10.0, 7.0, 25.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -36.0, -135.0, -12.0, 43.0, 38.0, 1.0, 33.0, -96.0, -11.0, 0.0, -12.0, -6.0, 25.0, 14.0, -31.0, 0.0, 0.0, 0.0, -6.0, -12.0, 0.0, 0.0, 0.0, -282.0, -78.0, 0.0, -10.0, 0.0, 0.0, 6.0, 0.0, -52.0, -28.0, -38.0, 51.0, 56.0, -152.0, -214.0, 6.0, 34.0, -1.0, 0.0, 0.0, -48.0, 0.0, 0.0, 19.0, -132.0, 0.0, 0.0, 100.0, 0.0, -18.0, -4.0, -35.0, -12.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 14.0, 20.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 4.0, 0.0, 0.0, 33.0, 0.0, 7.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 19.0, 9.0, 1.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 3.0, 0.0, 0.0, 0.0, 6.0, 7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 5.0, 8.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 13.0, 39.0, 44.0, 0.0, 0.0, 0.0, 0.0, 36.0, 22.0, 0.0, 9.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 59.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 22.0, 0.0, 0.0, 31.0, 40.0, 0.0, 9.0, 0.0, 6.0, 48.0, 2.0, 21.0, 0.0, 6.0, 3.0, 0.0, 1.0, 18.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 141.0, 0.0, 44.0, 10.0, 0.0, 5.0, 0.0, 0.0, 26.0, 0.0, 19.0, 27.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 0.0, 4.0, 0.0, 37.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 38.0, 16.0, 26.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9551202691711015, "mean_inference_ms": 2.8622572408305667, "mean_action_processing_ms": 0.375662573400323, "mean_env_wait_ms": 0.3444499024041032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010626912117004395, "StateBufferConnector_ms": 0.00903022289276123, "ViewRequirementAgentConnector_ms": 0.2389892339706421}, "num_episodes": 22, "episode_return_max": 107.0, "episode_return_min": -259.0, "episode_return_mean": 0.29, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.8015369555641, "num_env_steps_trained_throughput_per_sec": 206.8015369555641, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 15867.908, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15867.82, "sample_time_ms": 2438.853, "learn_time_ms": 13395.732, "learn_throughput": 298.603, "synch_weights_time_ms": 29.212}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "f1691_00002", "date": "2024-08-13_19-31-24", "timestamp": 1723591884, "time_this_iter_s": 19.488667011260986, "time_total_s": 4406.819673061371, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4406.819673061371, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 88.46296296296295, "ram_util_percent": 83.87037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2975137707969497, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.8978678831032345, "policy_loss": -0.004377848468967295, "vf_loss": 1.9019093471229391, "vf_explained_var": 0.004011763561339606, "kl": 0.011960349493032204, "entropy": 0.9342653687668856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.956343540951373, "cur_kl_coeff": 0.0009887695312499997, "cur_lr": 0.00010000000000000003, "total_loss": 2.495342018080767, "policy_loss": -0.0060552985089579745, "vf_loss": 2.5013896279234102, "vf_explained_var": -0.010332896091319897, "kl": 0.007780969657406682, "entropy": 0.6517545429802446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 107.0, "episode_reward_min": -259.0, "episode_reward_mean": -0.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -282.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 100.0, "predator_policy": 141.0}, "policy_reward_mean": {"prey_policy": -10.285, "predator_policy": 9.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4.0, 4.0, 10.0, -4.0, 4.0, -11.0, -1.0, -26.0, 12.0, 9.0, 0.0, 0.0, 16.0, 0.0, -7.0, 11.0, 7.0, 0.0, -6.0, 26.0, 0.0, 12.0, 19.0, -14.0, -24.0, 2.0, 29.0, -7.0, -1.0, 30.0, 42.0, -22.0, -9.0, -6.0, 6.0, 20.0, 25.0, 22.0, -46.0, 32.0, 0.0, 15.0, 6.0, 0.0, -100.0, 40.0, 45.0, -13.0, 10.0, -9.0, 40.0, -13.0, 0.0, -12.0, 0.0, -141.0, -24.0, -5.0, 6.0, -26.0, -20.0, 107.0, -259.0, 40.0, 3.0, -11.0, 0.0, -47.0, 0.0, 104.0, 16.0, -5.0, 11.0, 0.0, 0.0, 33.0, 3.0, -6.0, -54.0, -5.0, -126.0, -19.0, 0.0, 20.0, 17.0, 30.0, 13.0, -1.0, -27.0, -149.0, 0.0, 107.0, 28.0, 0.0, 28.0, -1.0, 42.0, 34.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 4.0, 0.0, 4.0, 7.0, 0.0, -10.0, 0.0, 0.0, 4.0, -39.0, 0.0, -2.0, 0.0, 0.0, -52.0, 12.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, -18.0, 16.0, -10.0, 6.0, -6.0, 0.0, 0.0, -12.0, 0.0, -3.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 19.0, -41.0, 0.0, -27.0, -12.0, 6.0, -17.0, 0.0, 29.0, 0.0, -20.0, 0.0, -84.0, 30.0, 0.0, 0.0, 42.0, 0.0, -80.0, -18.0, 0.0, 1.0, -14.0, 15.0, -22.0, 20.0, 0.0, 25.0, 0.0, 19.0, -5.0, -118.0, 10.0, 7.0, 25.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -36.0, -135.0, -12.0, 43.0, 38.0, 1.0, 33.0, -96.0, -11.0, 0.0, -12.0, -6.0, 25.0, 14.0, -31.0, 0.0, 0.0, 0.0, -6.0, -12.0, 0.0, 0.0, 0.0, -282.0, -78.0, 0.0, -10.0, 0.0, 0.0, 6.0, 0.0, -52.0, -28.0, -38.0, 51.0, 56.0, -152.0, -214.0, 6.0, 34.0, -1.0, 0.0, 0.0, -48.0, 0.0, 0.0, 19.0, -132.0, 0.0, 0.0, 100.0, 0.0, -18.0, -4.0, -35.0, -12.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 0.0, -13.0, -4.0, -4.0, -206.0, 48.0, 2.0, -14.0, -61.0, -130.0, -38.0, 0.0, 0.0, 0.0, 13.0, -45.0, 12.0, 5.0, 21.0, 0.0, -33.0, 0.0, 0.0, -34.0, -54.0, 0.0, -129.0, -216.0, 0.0, 0.0, 63.0, -17.0, 43.0, -30.0, 0.0, 0.0, 0.0, 20.0, -2.0, 0.0, -84.0, 78.0, 19.0, -4.0, 0.0, 24.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 19.0, 9.0, 1.0, 0.0, 26.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 4.0, 3.0, 0.0, 0.0, 0.0, 6.0, 7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 5.0, 8.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 13.0, 39.0, 44.0, 0.0, 0.0, 0.0, 0.0, 36.0, 22.0, 0.0, 9.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 59.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 22.0, 0.0, 0.0, 31.0, 40.0, 0.0, 9.0, 0.0, 6.0, 48.0, 2.0, 21.0, 0.0, 6.0, 3.0, 0.0, 1.0, 18.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 141.0, 0.0, 44.0, 10.0, 0.0, 5.0, 0.0, 0.0, 26.0, 0.0, 19.0, 27.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 0.0, 4.0, 0.0, 37.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 38.0, 16.0, 26.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 103.0, 1.0, 7.0, 0.0, 65.0, 0.0, 19.0, 0.0, 0.0, 0.0, 29.0, 23.0, 0.0, 0.0, 4.0, 5.0, 46.0, 0.0, 11.0, 22.0, 27.0, 0.0, 108.0, 88.0, 0.0, 0.0, 61.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 42.0, 6.0, 0.0, 19.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9545082018256135, "mean_inference_ms": 2.8532326529197487, "mean_action_processing_ms": 0.37573481224786803, "mean_env_wait_ms": 0.34488501168385255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011041641235351562, "StateBufferConnector_ms": 0.007833480834960938, "ViewRequirementAgentConnector_ms": 0.24573993682861328}, "num_episodes": 23, "episode_return_max": 107.0, "episode_return_min": -259.0, "episode_return_mean": -0.89, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.26473094105785, "num_env_steps_trained_throughput_per_sec": 250.26473094105785, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 16107.252, "restore_workers_time_ms": 0.12, "training_step_time_ms": 16107.046, "sample_time_ms": 2575.835, "learn_time_ms": 13497.463, "learn_throughput": 296.352, "synch_weights_time_ms": 29.409}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "f1691_00002", "date": "2024-08-13_19-31-40", "timestamp": 1723591900, "time_this_iter_s": 16.02072501182556, "time_total_s": 4422.840398073196, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f95d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4422.840398073196, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 70.35652173913044, "ram_util_percent": 83.80434782608698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.555697363615036, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.7240012189698597, "policy_loss": -0.0011974267723166912, "vf_loss": 1.7249397331760044, "vf_explained_var": 0.004372462772187733, "kl": 0.009205830576105523, "entropy": 0.9086661887547326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.459547293966725, "cur_kl_coeff": 0.0009887695312499997, "cur_lr": 0.00010000000000000003, "total_loss": 2.713379145930053, "policy_loss": -0.001525342386097662, "vf_loss": 2.7149013118769125, "vf_explained_var": 0.01347291072209676, "kl": 0.003217312619182858, "entropy": 0.7092389826106016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 183.0, "episode_reward_min": -259.0, "episode_reward_mean": -0.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -13.17, "predator_policy": 12.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -6.0, 26.0, 0.0, 12.0, 19.0, -14.0, -24.0, 2.0, 29.0, -7.0, -1.0, 30.0, 42.0, -22.0, -9.0, -6.0, 6.0, 20.0, 25.0, 22.0, -46.0, 32.0, 0.0, 15.0, 6.0, 0.0, -100.0, 40.0, 45.0, -13.0, 10.0, -9.0, 40.0, -13.0, 0.0, -12.0, 0.0, -141.0, -24.0, -5.0, 6.0, -26.0, -20.0, 107.0, -259.0, 40.0, 3.0, -11.0, 0.0, -47.0, 0.0, 104.0, 16.0, -5.0, 11.0, 0.0, 0.0, 33.0, 3.0, -6.0, -54.0, -5.0, -126.0, -19.0, 0.0, 20.0, 17.0, 30.0, 13.0, -1.0, -27.0, -149.0, 0.0, 107.0, 28.0, 0.0, 28.0, -1.0, 42.0, 34.0, 28.0, 3.0, 22.0, -57.0, -75.0, 47.0, -2.0, 8.0, -139.0, 0.0, 24.0, -11.0, 3.0, 183.0, 10.0, 99.0, -153.0, 73.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -12.0, 0.0, -3.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 19.0, -41.0, 0.0, -27.0, -12.0, 6.0, -17.0, 0.0, 29.0, 0.0, -20.0, 0.0, -84.0, 30.0, 0.0, 0.0, 42.0, 0.0, -80.0, -18.0, 0.0, 1.0, -14.0, 15.0, -22.0, 20.0, 0.0, 25.0, 0.0, 19.0, -5.0, -118.0, 10.0, 7.0, 25.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -36.0, -135.0, -12.0, 43.0, 38.0, 1.0, 33.0, -96.0, -11.0, 0.0, -12.0, -6.0, 25.0, 14.0, -31.0, 0.0, 0.0, 0.0, -6.0, -12.0, 0.0, 0.0, 0.0, -282.0, -78.0, 0.0, -10.0, 0.0, 0.0, 6.0, 0.0, -52.0, -28.0, -38.0, 51.0, 56.0, -152.0, -214.0, 6.0, 34.0, -1.0, 0.0, 0.0, -48.0, 0.0, 0.0, 19.0, -132.0, 0.0, 0.0, 100.0, 0.0, -18.0, -4.0, -35.0, -12.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 0.0, -13.0, -4.0, -4.0, -206.0, 48.0, 2.0, -14.0, -61.0, -130.0, -38.0, 0.0, 0.0, 0.0, 13.0, -45.0, 12.0, 5.0, 21.0, 0.0, -33.0, 0.0, 0.0, -34.0, -54.0, 0.0, -129.0, -216.0, 0.0, 0.0, 63.0, -17.0, 43.0, -30.0, 0.0, 0.0, 0.0, 20.0, -2.0, 0.0, -84.0, 78.0, 19.0, -4.0, 0.0, 24.0, 3.0, 0.0, 0.0, 22.0, -103.0, -6.0, -23.0, -136.0, -194.0, 138.0, 0.0, -12.0, 7.0, 1.0, -340.0, 31.0, 0.0, 0.0, -8.0, 24.0, -8.0, -14.0, 3.0, 0.0, -8.0, 187.0, 0.0, 10.0, 90.0, -10.0, 0.0, -306.0, 21.0, -21.0, 0.0, 4.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 6.0, 7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 5.0, 8.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 13.0, 39.0, 44.0, 0.0, 0.0, 0.0, 0.0, 36.0, 22.0, 0.0, 9.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 59.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 22.0, 0.0, 0.0, 31.0, 40.0, 0.0, 9.0, 0.0, 6.0, 48.0, 2.0, 21.0, 0.0, 6.0, 3.0, 0.0, 1.0, 18.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 141.0, 0.0, 44.0, 10.0, 0.0, 5.0, 0.0, 0.0, 26.0, 0.0, 19.0, 27.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 0.0, 4.0, 0.0, 37.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 38.0, 16.0, 26.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 103.0, 1.0, 7.0, 0.0, 65.0, 0.0, 19.0, 0.0, 0.0, 0.0, 29.0, 23.0, 0.0, 0.0, 4.0, 5.0, 46.0, 0.0, 11.0, 22.0, 27.0, 0.0, 108.0, 88.0, 0.0, 0.0, 61.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 42.0, 6.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 0.0, 84.0, 6.0, 97.0, 5.0, 5.0, 0.0, 0.0, 170.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 13.0, 6.0, 0.0, 153.0, 70.0, 3.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9547715799895468, "mean_inference_ms": 2.8668019274002545, "mean_action_processing_ms": 0.37642113780365705, "mean_env_wait_ms": 0.34541567681594293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008886575698852539, "StateBufferConnector_ms": 0.004958391189575195, "ViewRequirementAgentConnector_ms": 0.19770288467407227}, "num_episodes": 18, "episode_return_max": 183.0, "episode_return_min": -259.0, "episode_return_mean": -0.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.54344704259705, "num_env_steps_trained_throughput_per_sec": 282.54344704259705, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 16122.198, "restore_workers_time_ms": 0.119, "training_step_time_ms": 16121.994, "sample_time_ms": 2641.871, "learn_time_ms": 13446.016, "learn_throughput": 297.486, "synch_weights_time_ms": 29.636}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "f1691_00002", "date": "2024-08-13_19-31-55", "timestamp": 1723591915, "time_this_iter_s": 14.194562911987305, "time_total_s": 4437.034960985184, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4437.034960985184, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 63.995000000000005, "ram_util_percent": 78.365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.627321927005021, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.9909572247474914, "policy_loss": -0.001973933062181074, "vf_loss": 1.9927519411637038, "vf_explained_var": 0.0010843377264719161, "kl": 0.006372254351247999, "entropy": 0.8948906561684987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5097924086624985, "cur_kl_coeff": 0.0004943847656249999, "cur_lr": 0.00010000000000000003, "total_loss": 2.547766950458446, "policy_loss": -0.0021445199019379086, "vf_loss": 2.5499095167432513, "vf_explained_var": 0.0010908307852568449, "kl": 0.003954747522350209, "entropy": 0.6619347535428547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 183.0, "episode_reward_min": -525.0, "episode_reward_mean": -10.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -21.4, "predator_policy": 16.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 25.0, 22.0, -46.0, 32.0, 0.0, 15.0, 6.0, 0.0, -100.0, 40.0, 45.0, -13.0, 10.0, -9.0, 40.0, -13.0, 0.0, -12.0, 0.0, -141.0, -24.0, -5.0, 6.0, -26.0, -20.0, 107.0, -259.0, 40.0, 3.0, -11.0, 0.0, -47.0, 0.0, 104.0, 16.0, -5.0, 11.0, 0.0, 0.0, 33.0, 3.0, -6.0, -54.0, -5.0, -126.0, -19.0, 0.0, 20.0, 17.0, 30.0, 13.0, -1.0, -27.0, -149.0, 0.0, 107.0, 28.0, 0.0, 28.0, -1.0, 42.0, 34.0, 28.0, 3.0, 22.0, -57.0, -75.0, 47.0, -2.0, 8.0, -139.0, 0.0, 24.0, -11.0, 3.0, 183.0, 10.0, 99.0, -153.0, 73.0, 10.0, 0.0, 62.0, -294.0, -138.0, 14.0, -27.0, 16.0, 119.0, 0.0, 26.0, -89.0, -5.0, -9.0, -120.0, 22.0, 1.0, -525.0, 47.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.0, 0.0, 25.0, 0.0, 19.0, -5.0, -118.0, 10.0, 7.0, 25.0, 0.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, -36.0, -135.0, -12.0, 43.0, 38.0, 1.0, 33.0, -96.0, -11.0, 0.0, -12.0, -6.0, 25.0, 14.0, -31.0, 0.0, 0.0, 0.0, -6.0, -12.0, 0.0, 0.0, 0.0, -282.0, -78.0, 0.0, -10.0, 0.0, 0.0, 6.0, 0.0, -52.0, -28.0, -38.0, 51.0, 56.0, -152.0, -214.0, 6.0, 34.0, -1.0, 0.0, 0.0, -48.0, 0.0, 0.0, 19.0, -132.0, 0.0, 0.0, 100.0, 0.0, -18.0, -4.0, -35.0, -12.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 0.0, -13.0, -4.0, -4.0, -206.0, 48.0, 2.0, -14.0, -61.0, -130.0, -38.0, 0.0, 0.0, 0.0, 13.0, -45.0, 12.0, 5.0, 21.0, 0.0, -33.0, 0.0, 0.0, -34.0, -54.0, 0.0, -129.0, -216.0, 0.0, 0.0, 63.0, -17.0, 43.0, -30.0, 0.0, 0.0, 0.0, 20.0, -2.0, 0.0, -84.0, 78.0, 19.0, -4.0, 0.0, 24.0, 3.0, 0.0, 0.0, 22.0, -103.0, -6.0, -23.0, -136.0, -194.0, 138.0, 0.0, -12.0, 7.0, 1.0, -340.0, 31.0, 0.0, 0.0, -8.0, 24.0, -8.0, -14.0, 3.0, 0.0, -8.0, 187.0, 0.0, 10.0, 90.0, -10.0, 0.0, -306.0, 21.0, -21.0, 0.0, 4.0, 0.0, 0.0, 49.0, -8.0, -174.0, -240.0, -136.0, -100.0, -14.0, 15.0, -69.0, 0.0, 0.0, -2.0, 9.0, 60.0, 0.0, 0.0, 6.0, -15.0, -318.0, 69.0, 0.0, -11.0, -7.0, -14.0, 0.0, -240.0, -50.0, 26.0, 1.0, 0.0, -336.0, -378.0, 3.0, 44.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 59.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 22.0, 0.0, 0.0, 31.0, 40.0, 0.0, 9.0, 0.0, 6.0, 48.0, 2.0, 21.0, 0.0, 6.0, 3.0, 0.0, 1.0, 18.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 141.0, 0.0, 44.0, 10.0, 0.0, 5.0, 0.0, 0.0, 26.0, 0.0, 19.0, 27.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 0.0, 4.0, 0.0, 37.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 38.0, 16.0, 26.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 103.0, 1.0, 7.0, 0.0, 65.0, 0.0, 19.0, 0.0, 0.0, 0.0, 29.0, 23.0, 0.0, 0.0, 4.0, 5.0, 46.0, 0.0, 11.0, 22.0, 27.0, 0.0, 108.0, 88.0, 0.0, 0.0, 61.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 42.0, 6.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 0.0, 84.0, 6.0, 97.0, 5.0, 5.0, 0.0, 0.0, 170.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 13.0, 6.0, 0.0, 153.0, 70.0, 3.0, 0.0, 6.0, 0.0, 0.0, 1.0, 20.0, 120.0, 0.0, 98.0, 0.0, 6.0, 7.0, 42.0, 0.0, 9.0, 9.0, 6.0, 44.0, 0.0, 0.0, 16.0, 19.0, 160.0, 0.0, 6.0, 0.0, 5.0, 7.0, 120.0, 0.0, 21.0, 25.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9544266888865135, "mean_inference_ms": 2.866996437871105, "mean_action_processing_ms": 0.3764340207703117, "mean_env_wait_ms": 0.3453536471345497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008830070495605469, "StateBufferConnector_ms": 0.004034876823425293, "ViewRequirementAgentConnector_ms": 0.1916261911392212}, "num_episodes": 18, "episode_return_max": 183.0, "episode_return_min": -525.0, "episode_return_mean": -10.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.03707887100427, "num_env_steps_trained_throughput_per_sec": 290.03707887100427, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 15982.671, "restore_workers_time_ms": 0.119, "training_step_time_ms": 15982.467, "sample_time_ms": 2511.663, "learn_time_ms": 13435.492, "learn_throughput": 297.719, "synch_weights_time_ms": 29.916}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "f1691_00002", "date": "2024-08-13_19-32-08", "timestamp": 1723591928, "time_this_iter_s": 13.888535976409912, "time_total_s": 4450.923496961594, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4115a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4450.923496961594, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 63.454999999999984, "ram_util_percent": 80.19500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.665587351136107, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 2.846380333105723, "policy_loss": -0.00226263122130481, "vf_loss": 2.848409303723189, "vf_explained_var": -0.0001356418801363183, "kl": 0.008308051941402791, "entropy": 0.8872853018619397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.627051172362118, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 3.1702986731731073, "policy_loss": -0.0030619636097942633, "vf_loss": 3.1733585782152005, "vf_explained_var": 0.025261260498137702, "kl": 0.008324597347335075, "entropy": 0.6870885117028757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 187.0, "episode_reward_min": -525.0, "episode_reward_mean": -6.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -23.86, "predator_policy": 20.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 6.0, -26.0, -20.0, 107.0, -259.0, 40.0, 3.0, -11.0, 0.0, -47.0, 0.0, 104.0, 16.0, -5.0, 11.0, 0.0, 0.0, 33.0, 3.0, -6.0, -54.0, -5.0, -126.0, -19.0, 0.0, 20.0, 17.0, 30.0, 13.0, -1.0, -27.0, -149.0, 0.0, 107.0, 28.0, 0.0, 28.0, -1.0, 42.0, 34.0, 28.0, 3.0, 22.0, -57.0, -75.0, 47.0, -2.0, 8.0, -139.0, 0.0, 24.0, -11.0, 3.0, 183.0, 10.0, 99.0, -153.0, 73.0, 10.0, 0.0, 62.0, -294.0, -138.0, 14.0, -27.0, 16.0, 119.0, 0.0, 26.0, -89.0, -5.0, -9.0, -120.0, 22.0, 1.0, -525.0, 47.0, -9.0, 143.0, -175.0, 0.0, -5.0, 0.0, 95.0, 119.0, 117.0, 0.0, 68.0, 34.0, -9.0, -5.0, 0.0, 96.0, -17.0, 140.0, -472.0, 187.0, -61.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, 0.0, 0.0, 6.0, 0.0, -52.0, -28.0, -38.0, 51.0, 56.0, -152.0, -214.0, 6.0, 34.0, -1.0, 0.0, 0.0, -48.0, 0.0, 0.0, 19.0, -132.0, 0.0, 0.0, 100.0, 0.0, -18.0, -4.0, -35.0, -12.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 0.0, -13.0, -4.0, -4.0, -206.0, 48.0, 2.0, -14.0, -61.0, -130.0, -38.0, 0.0, 0.0, 0.0, 13.0, -45.0, 12.0, 5.0, 21.0, 0.0, -33.0, 0.0, 0.0, -34.0, -54.0, 0.0, -129.0, -216.0, 0.0, 0.0, 63.0, -17.0, 43.0, -30.0, 0.0, 0.0, 0.0, 20.0, -2.0, 0.0, -84.0, 78.0, 19.0, -4.0, 0.0, 24.0, 3.0, 0.0, 0.0, 22.0, -103.0, -6.0, -23.0, -136.0, -194.0, 138.0, 0.0, -12.0, 7.0, 1.0, -340.0, 31.0, 0.0, 0.0, -8.0, 24.0, -8.0, -14.0, 3.0, 0.0, -8.0, 187.0, 0.0, 10.0, 90.0, -10.0, 0.0, -306.0, 21.0, -21.0, 0.0, 4.0, 0.0, 0.0, 49.0, -8.0, -174.0, -240.0, -136.0, -100.0, -14.0, 15.0, -69.0, 0.0, 0.0, -2.0, 9.0, 60.0, 0.0, 0.0, 6.0, -15.0, -318.0, 69.0, 0.0, -11.0, -7.0, -14.0, 0.0, -240.0, -50.0, 26.0, 1.0, 0.0, -336.0, -378.0, 3.0, 44.0, -18.0, 0.0, 119.0, 0.0, -342.0, -8.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 95.0, 0.0, 55.0, 0.0, 17.0, 27.0, 0.0, -2.0, -190.0, 12.0, 0.0, 27.0, -166.0, -8.0, 0.0, -10.0, 0.0, 0.0, 48.0, 0.0, -14.0, -14.0, 0.0, 140.0, -315.0, -316.0, 0.0, 187.0, -370.0, 0.0, -26.0, 0.0], "policy_predator_policy_reward": [0.0, 5.0, 0.0, 0.0, 26.0, 0.0, 19.0, 27.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 0.0, 4.0, 0.0, 37.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 38.0, 16.0, 26.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 103.0, 1.0, 7.0, 0.0, 65.0, 0.0, 19.0, 0.0, 0.0, 0.0, 29.0, 23.0, 0.0, 0.0, 4.0, 5.0, 46.0, 0.0, 11.0, 22.0, 27.0, 0.0, 108.0, 88.0, 0.0, 0.0, 61.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 42.0, 6.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 0.0, 84.0, 6.0, 97.0, 5.0, 5.0, 0.0, 0.0, 170.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 13.0, 6.0, 0.0, 153.0, 70.0, 3.0, 0.0, 6.0, 0.0, 0.0, 1.0, 20.0, 120.0, 0.0, 98.0, 0.0, 6.0, 7.0, 42.0, 0.0, 9.0, 9.0, 6.0, 44.0, 0.0, 0.0, 16.0, 19.0, 160.0, 0.0, 6.0, 0.0, 5.0, 7.0, 120.0, 0.0, 21.0, 25.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 0.0, 171.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 25.0, 39.0, 22.0, 51.0, 0.0, 2.0, 135.0, 111.0, 0.0, 7.0, 80.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 48.0, 4.0, 7.0, 0.0, 0.0, 159.0, 0.0, 0.0, 0.0, 180.0, 129.0, 22.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9549328693357042, "mean_inference_ms": 2.870736376137686, "mean_action_processing_ms": 0.3767121689723934, "mean_env_wait_ms": 0.3460151106116412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009359955787658691, "StateBufferConnector_ms": 0.004708409309387207, "ViewRequirementAgentConnector_ms": 0.18813753128051758}, "num_episodes": 22, "episode_return_max": 187.0, "episode_return_min": -525.0, "episode_return_mean": -6.78, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.5108135812328, "num_env_steps_trained_throughput_per_sec": 292.5108135812328, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 15356.389, "restore_workers_time_ms": 0.12, "training_step_time_ms": 15356.163, "sample_time_ms": 2448.744, "learn_time_ms": 12873.974, "learn_throughput": 310.704, "synch_weights_time_ms": 28.09}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "f1691_00002", "date": "2024-08-13_19-32-22", "timestamp": 1723591942, "time_this_iter_s": 13.750752210617065, "time_total_s": 4464.674249172211, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41158b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4464.674249172211, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 63.494736842105254, "ram_util_percent": 82.99473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7178249317502217, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.8098699501267186, "policy_loss": -0.002354998958282291, "vf_loss": 1.8119493625466785, "vf_explained_var": -0.0007014580189235627, "kl": 0.009798590128433543, "entropy": 0.9439647700105395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.219999860171918, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 3.313315662820503, "policy_loss": -0.0008588306499871785, "vf_loss": 3.314173115750469, "vf_explained_var": 0.047535586230969304, "kl": 0.005539979072122856, "entropy": 0.6548642126340715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 228.0, "episode_reward_min": -525.0, "episode_reward_mean": 2.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -20.32, "predator_policy": 21.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 3.0, -6.0, -54.0, -5.0, -126.0, -19.0, 0.0, 20.0, 17.0, 30.0, 13.0, -1.0, -27.0, -149.0, 0.0, 107.0, 28.0, 0.0, 28.0, -1.0, 42.0, 34.0, 28.0, 3.0, 22.0, -57.0, -75.0, 47.0, -2.0, 8.0, -139.0, 0.0, 24.0, -11.0, 3.0, 183.0, 10.0, 99.0, -153.0, 73.0, 10.0, 0.0, 62.0, -294.0, -138.0, 14.0, -27.0, 16.0, 119.0, 0.0, 26.0, -89.0, -5.0, -9.0, -120.0, 22.0, 1.0, -525.0, 47.0, -9.0, 143.0, -175.0, 0.0, -5.0, 0.0, 95.0, 119.0, 117.0, 0.0, 68.0, 34.0, -9.0, -5.0, 0.0, 96.0, -17.0, 140.0, -472.0, 187.0, -61.0, 22.0, -6.0, 0.0, 167.0, 228.0, 138.0, -5.0, 79.0, -8.0, 0.0, 0.0, 86.0, 163.0, 33.0, 0.0, -59.0, -156.0, 34.0, 181.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [33.0, 0.0, 0.0, -13.0, -4.0, -4.0, -206.0, 48.0, 2.0, -14.0, -61.0, -130.0, -38.0, 0.0, 0.0, 0.0, 13.0, -45.0, 12.0, 5.0, 21.0, 0.0, -33.0, 0.0, 0.0, -34.0, -54.0, 0.0, -129.0, -216.0, 0.0, 0.0, 63.0, -17.0, 43.0, -30.0, 0.0, 0.0, 0.0, 20.0, -2.0, 0.0, -84.0, 78.0, 19.0, -4.0, 0.0, 24.0, 3.0, 0.0, 0.0, 22.0, -103.0, -6.0, -23.0, -136.0, -194.0, 138.0, 0.0, -12.0, 7.0, 1.0, -340.0, 31.0, 0.0, 0.0, -8.0, 24.0, -8.0, -14.0, 3.0, 0.0, -8.0, 187.0, 0.0, 10.0, 90.0, -10.0, 0.0, -306.0, 21.0, -21.0, 0.0, 4.0, 0.0, 0.0, 49.0, -8.0, -174.0, -240.0, -136.0, -100.0, -14.0, 15.0, -69.0, 0.0, 0.0, -2.0, 9.0, 60.0, 0.0, 0.0, 6.0, -15.0, -318.0, 69.0, 0.0, -11.0, -7.0, -14.0, 0.0, -240.0, -50.0, 26.0, 1.0, 0.0, -336.0, -378.0, 3.0, 44.0, -18.0, 0.0, 119.0, 0.0, -342.0, -8.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 95.0, 0.0, 55.0, 0.0, 17.0, 27.0, 0.0, -2.0, -190.0, 12.0, 0.0, 27.0, -166.0, -8.0, 0.0, -10.0, 0.0, 0.0, 48.0, 0.0, -14.0, -14.0, 0.0, 140.0, -315.0, -316.0, 0.0, 187.0, -370.0, 0.0, -26.0, 0.0, 0.0, -12.0, 0.0, 0.0, 12.0, 150.0, 40.0, 187.0, 123.0, -8.0, -10.0, 0.0, 78.0, 1.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 20.0, 66.0, 161.0, 0.0, -19.0, 0.0, 0.0, 0.0, -400.0, 0.0, -324.0, -4.0, 0.0, 29.0, 84.0, 75.0], "policy_predator_policy_reward": [0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 103.0, 1.0, 7.0, 0.0, 65.0, 0.0, 19.0, 0.0, 0.0, 0.0, 29.0, 23.0, 0.0, 0.0, 4.0, 5.0, 46.0, 0.0, 11.0, 22.0, 27.0, 0.0, 108.0, 88.0, 0.0, 0.0, 61.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 42.0, 6.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 0.0, 84.0, 6.0, 97.0, 5.0, 5.0, 0.0, 0.0, 170.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 13.0, 6.0, 0.0, 153.0, 70.0, 3.0, 0.0, 6.0, 0.0, 0.0, 1.0, 20.0, 120.0, 0.0, 98.0, 0.0, 6.0, 7.0, 42.0, 0.0, 9.0, 9.0, 6.0, 44.0, 0.0, 0.0, 16.0, 19.0, 160.0, 0.0, 6.0, 0.0, 5.0, 7.0, 120.0, 0.0, 21.0, 25.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 0.0, 171.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 25.0, 39.0, 22.0, 51.0, 0.0, 2.0, 135.0, 111.0, 0.0, 7.0, 80.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 48.0, 4.0, 7.0, 0.0, 0.0, 159.0, 0.0, 0.0, 0.0, 180.0, 129.0, 22.0, 26.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 1.0, 0.0, 23.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 30.0, 22.0, 0.0, 0.0, 188.0, 153.0, 162.0, 10.0, 5.0, 0.0, 0.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9556847899172111, "mean_inference_ms": 2.871882556964477, "mean_action_processing_ms": 0.377278157285701, "mean_env_wait_ms": 0.34595115521368913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006457090377807617, "StateBufferConnector_ms": 0.0044678449630737305, "ViewRequirementAgentConnector_ms": 0.16568219661712646}, "num_episodes": 18, "episode_return_max": 228.0, "episode_return_min": -525.0, "episode_return_mean": 2.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.35001423943345, "num_env_steps_trained_throughput_per_sec": 313.35001423943345, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 15277.351, "restore_workers_time_ms": 0.12, "training_step_time_ms": 15277.125, "sample_time_ms": 2315.8, "learn_time_ms": 12929.582, "learn_throughput": 309.368, "synch_weights_time_ms": 26.258}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "f1691_00002", "date": "2024-08-13_19-32-35", "timestamp": 1723591955, "time_this_iter_s": 12.811348915100098, "time_total_s": 4477.485598087311, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37f60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4477.485598087311, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.03684210526316, "ram_util_percent": 82.81052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6549066742024725, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 2.1009239616217434, "policy_loss": -0.0044330589501581415, "vf_loss": 2.105047626911648, "vf_explained_var": -0.0001599239609228871, "kl": 0.011000671691389984, "entropy": 0.9117223314191929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.370186990326044, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 5.215800771889863, "policy_loss": -0.0023966004149298427, "vf_loss": 5.218194503128213, "vf_explained_var": 0.10411844931582294, "kl": 0.011596808355437815, "entropy": 0.6368418657590472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 330.0, "episode_reward_min": -525.0, "episode_reward_mean": 16.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -17.445, "predator_policy": 25.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 3.0, 22.0, -57.0, -75.0, 47.0, -2.0, 8.0, -139.0, 0.0, 24.0, -11.0, 3.0, 183.0, 10.0, 99.0, -153.0, 73.0, 10.0, 0.0, 62.0, -294.0, -138.0, 14.0, -27.0, 16.0, 119.0, 0.0, 26.0, -89.0, -5.0, -9.0, -120.0, 22.0, 1.0, -525.0, 47.0, -9.0, 143.0, -175.0, 0.0, -5.0, 0.0, 95.0, 119.0, 117.0, 0.0, 68.0, 34.0, -9.0, -5.0, 0.0, 96.0, -17.0, 140.0, -472.0, 187.0, -61.0, 22.0, -6.0, 0.0, 167.0, 228.0, 138.0, -5.0, 79.0, -8.0, 0.0, 0.0, 86.0, 163.0, 33.0, 0.0, -59.0, -156.0, 34.0, 181.0, 203.0, -28.0, 61.0, -483.0, 198.0, 62.0, -33.0, 39.0, 166.0, 309.0, 141.0, -147.0, 151.0, 206.0, -139.0, 196.0, 116.0, 13.0, 330.0, 134.0, -145.0, -4.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 24.0, 3.0, 0.0, 0.0, 22.0, -103.0, -6.0, -23.0, -136.0, -194.0, 138.0, 0.0, -12.0, 7.0, 1.0, -340.0, 31.0, 0.0, 0.0, -8.0, 24.0, -8.0, -14.0, 3.0, 0.0, -8.0, 187.0, 0.0, 10.0, 90.0, -10.0, 0.0, -306.0, 21.0, -21.0, 0.0, 4.0, 0.0, 0.0, 49.0, -8.0, -174.0, -240.0, -136.0, -100.0, -14.0, 15.0, -69.0, 0.0, 0.0, -2.0, 9.0, 60.0, 0.0, 0.0, 6.0, -15.0, -318.0, 69.0, 0.0, -11.0, -7.0, -14.0, 0.0, -240.0, -50.0, 26.0, 1.0, 0.0, -336.0, -378.0, 3.0, 44.0, -18.0, 0.0, 119.0, 0.0, -342.0, -8.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 95.0, 0.0, 55.0, 0.0, 17.0, 27.0, 0.0, -2.0, -190.0, 12.0, 0.0, 27.0, -166.0, -8.0, 0.0, -10.0, 0.0, 0.0, 48.0, 0.0, -14.0, -14.0, 0.0, 140.0, -315.0, -316.0, 0.0, 187.0, -370.0, 0.0, -26.0, 0.0, 0.0, -12.0, 0.0, 0.0, 12.0, 150.0, 40.0, 187.0, 123.0, -8.0, -10.0, 0.0, 78.0, 1.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 20.0, 66.0, 161.0, 0.0, -19.0, 0.0, 0.0, 0.0, -400.0, 0.0, -324.0, -4.0, 0.0, 29.0, 84.0, 75.0, 13.0, 187.0, -368.0, 143.0, 0.0, 41.0, -322.0, -322.0, 1.0, 197.0, 0.0, 53.0, -58.0, -8.0, 0.0, -124.0, -384.0, 193.0, 115.0, 163.0, 141.0, 0.0, 0.0, -294.0, 0.0, 142.0, 128.0, 77.0, 0.0, -278.0, 196.0, 0.0, 83.0, -8.0, -2.0, 0.0, 188.0, 142.0, -2.0, 118.0, -290.0, 0.0, -8.0, 0.0, 0.0, -39.0], "policy_predator_policy_reward": [0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 0.0, 84.0, 6.0, 97.0, 5.0, 5.0, 0.0, 0.0, 170.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 13.0, 6.0, 0.0, 153.0, 70.0, 3.0, 0.0, 6.0, 0.0, 0.0, 1.0, 20.0, 120.0, 0.0, 98.0, 0.0, 6.0, 7.0, 42.0, 0.0, 9.0, 9.0, 6.0, 44.0, 0.0, 0.0, 16.0, 19.0, 160.0, 0.0, 6.0, 0.0, 5.0, 7.0, 120.0, 0.0, 21.0, 25.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 0.0, 171.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 25.0, 39.0, 22.0, 51.0, 0.0, 2.0, 135.0, 111.0, 0.0, 7.0, 80.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 48.0, 4.0, 7.0, 0.0, 0.0, 159.0, 0.0, 0.0, 0.0, 180.0, 129.0, 22.0, 26.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 1.0, 0.0, 23.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 30.0, 22.0, 0.0, 0.0, 188.0, 153.0, 162.0, 10.0, 5.0, 0.0, 0.0, 22.0, 2.0, 1.0, 184.0, 13.0, 14.0, 6.0, 161.0, 0.0, 0.0, 0.0, 0.0, 9.0, 29.0, 4.0, 94.0, 69.0, 178.0, 179.0, 31.0, 0.0, 0.0, 0.0, 0.0, 147.0, 0.0, 9.0, 1.0, 0.0, 1.0, 138.0, 0.0, 0.0, 14.0, 27.0, 0.0, 15.0, 0.0, 0.0, 8.0, 10.0, 145.0, 0.0, 0.0, 4.0, 23.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9552340947354645, "mean_inference_ms": 2.871781218975373, "mean_action_processing_ms": 0.3769935316824888, "mean_env_wait_ms": 0.34574705750213375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01124274730682373, "StateBufferConnector_ms": 0.004579424858093262, "ViewRequirementAgentConnector_ms": 0.15905475616455078}, "num_episodes": 23, "episode_return_max": 330.0, "episode_return_min": -525.0, "episode_return_mean": 16.46, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.26300429792906, "num_env_steps_trained_throughput_per_sec": 256.26300429792906, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 15075.368, "restore_workers_time_ms": 0.12, "training_step_time_ms": 15075.177, "sample_time_ms": 2297.222, "learn_time_ms": 12752.097, "learn_throughput": 313.674, "synch_weights_time_ms": 21.137}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "f1691_00002", "date": "2024-08-13_19-32-51", "timestamp": 1723591971, "time_this_iter_s": 15.703904867172241, "time_total_s": 4493.189502954483, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4493.189502954483, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 70.65454545454544, "ram_util_percent": 83.11818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4716685794727513, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.9862866734070753, "policy_loss": -0.0016217215553359695, "vf_loss": 0.9876704071564649, "vf_explained_var": -0.0007376004779149616, "kl": 0.008461772450042657, "entropy": 0.9020600123380227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.065574256342554, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 5.394096878722862, "policy_loss": -0.004832587975062548, "vf_loss": 5.398921130321644, "vf_explained_var": 0.1796595385150304, "kl": 0.033705583519859916, "entropy": 0.7032038561566166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 351.0, "episode_reward_min": -525.0, "episode_reward_mean": 40.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -4.6, "predator_policy": 24.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 62.0, -294.0, -138.0, 14.0, -27.0, 16.0, 119.0, 0.0, 26.0, -89.0, -5.0, -9.0, -120.0, 22.0, 1.0, -525.0, 47.0, -9.0, 143.0, -175.0, 0.0, -5.0, 0.0, 95.0, 119.0, 117.0, 0.0, 68.0, 34.0, -9.0, -5.0, 0.0, 96.0, -17.0, 140.0, -472.0, 187.0, -61.0, 22.0, -6.0, 0.0, 167.0, 228.0, 138.0, -5.0, 79.0, -8.0, 0.0, 0.0, 86.0, 163.0, 33.0, 0.0, -59.0, -156.0, 34.0, 181.0, 203.0, -28.0, 61.0, -483.0, 198.0, 62.0, -33.0, 39.0, 166.0, 309.0, 141.0, -147.0, 151.0, 206.0, -139.0, 196.0, 116.0, 13.0, 330.0, 134.0, -145.0, -4.0, -16.0, 177.0, 121.0, 165.0, -40.0, 174.0, 174.0, 153.0, 141.0, 351.0, 153.0, 0.0, -12.0, 143.0, 0.0, 269.0, 176.0, -7.0, 328.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 4.0, 0.0, 0.0, 49.0, -8.0, -174.0, -240.0, -136.0, -100.0, -14.0, 15.0, -69.0, 0.0, 0.0, -2.0, 9.0, 60.0, 0.0, 0.0, 6.0, -15.0, -318.0, 69.0, 0.0, -11.0, -7.0, -14.0, 0.0, -240.0, -50.0, 26.0, 1.0, 0.0, -336.0, -378.0, 3.0, 44.0, -18.0, 0.0, 119.0, 0.0, -342.0, -8.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 95.0, 0.0, 55.0, 0.0, 17.0, 27.0, 0.0, -2.0, -190.0, 12.0, 0.0, 27.0, -166.0, -8.0, 0.0, -10.0, 0.0, 0.0, 48.0, 0.0, -14.0, -14.0, 0.0, 140.0, -315.0, -316.0, 0.0, 187.0, -370.0, 0.0, -26.0, 0.0, 0.0, -12.0, 0.0, 0.0, 12.0, 150.0, 40.0, 187.0, 123.0, -8.0, -10.0, 0.0, 78.0, 1.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 20.0, 66.0, 161.0, 0.0, -19.0, 0.0, 0.0, 0.0, -400.0, 0.0, -324.0, -4.0, 0.0, 29.0, 84.0, 75.0, 13.0, 187.0, -368.0, 143.0, 0.0, 41.0, -322.0, -322.0, 1.0, 197.0, 0.0, 53.0, -58.0, -8.0, 0.0, -124.0, -384.0, 193.0, 115.0, 163.0, 141.0, 0.0, 0.0, -294.0, 0.0, 142.0, 128.0, 77.0, 0.0, -278.0, 196.0, 0.0, 83.0, -8.0, -2.0, 0.0, 188.0, 142.0, -2.0, 118.0, -290.0, 0.0, -8.0, 0.0, 0.0, -39.0, 182.0, -10.0, 77.0, -8.0, 0.0, 165.0, -394.0, 156.0, 172.0, 0.0, 0.0, 161.0, 0.0, 153.0, 124.0, 0.0, 164.0, 182.0, 0.0, 148.0, 0.0, 0.0, -18.0, -12.0, 0.0, 143.0, 0.0, 0.0, 149.0, 111.0, 0.0, 176.0, 171.0, -368.0, 162.0, 155.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 0.0, 1.0, 20.0, 120.0, 0.0, 98.0, 0.0, 6.0, 7.0, 42.0, 0.0, 9.0, 9.0, 6.0, 44.0, 0.0, 0.0, 16.0, 19.0, 160.0, 0.0, 6.0, 0.0, 5.0, 7.0, 120.0, 0.0, 21.0, 25.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 0.0, 171.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 25.0, 39.0, 22.0, 51.0, 0.0, 2.0, 135.0, 111.0, 0.0, 7.0, 80.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 48.0, 4.0, 7.0, 0.0, 0.0, 159.0, 0.0, 0.0, 0.0, 180.0, 129.0, 22.0, 26.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 1.0, 0.0, 23.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 30.0, 22.0, 0.0, 0.0, 188.0, 153.0, 162.0, 10.0, 5.0, 0.0, 0.0, 22.0, 2.0, 1.0, 184.0, 13.0, 14.0, 6.0, 161.0, 0.0, 0.0, 0.0, 0.0, 9.0, 29.0, 4.0, 94.0, 69.0, 178.0, 179.0, 31.0, 0.0, 0.0, 0.0, 0.0, 147.0, 0.0, 9.0, 1.0, 0.0, 1.0, 138.0, 0.0, 0.0, 14.0, 27.0, 0.0, 15.0, 0.0, 0.0, 8.0, 10.0, 145.0, 0.0, 0.0, 4.0, 23.0, 0.0, 0.0, 5.0, 35.0, 17.0, 0.0, 0.0, 1.0, 197.0, 0.0, 2.0, 0.0, 13.0, 0.0, 0.0, 9.0, 8.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 6.0, 184.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9597154324455742, "mean_inference_ms": 2.8863154687323584, "mean_action_processing_ms": 0.3789134262097131, "mean_env_wait_ms": 0.34723073016980877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020864129066467285, "StateBufferConnector_ms": 0.004982352256774902, "ViewRequirementAgentConnector_ms": 0.1972801685333252}, "num_episodes": 18, "episode_return_max": 351.0, "episode_return_min": -525.0, "episode_return_mean": 40.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.02849078150268, "num_env_steps_trained_throughput_per_sec": 170.02849078150268, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 15809.476, "restore_workers_time_ms": 0.118, "training_step_time_ms": 15809.289, "sample_time_ms": 2657.193, "learn_time_ms": 13126.099, "learn_throughput": 304.736, "synch_weights_time_ms": 21.217}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "f1691_00002", "date": "2024-08-13_19-33-15", "timestamp": 1723591995, "time_this_iter_s": 23.608222007751465, "time_total_s": 4516.7977249622345, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4173790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4516.7977249622345, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 90.33333333333333, "ram_util_percent": 83.87575757575758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7400651659915054, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 2.50656671151913, "policy_loss": -0.000673956077092539, "vf_loss": 2.5070432410038337, "vf_explained_var": -0.0022917211686492595, "kl": 0.007019658125442971, "entropy": 0.8636457094755122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.431158384830548, "cur_kl_coeff": 0.0003707885742187501, "cur_lr": 0.00010000000000000003, "total_loss": 6.069472010425789, "policy_loss": -0.004292337234235472, "vf_loss": 6.073755919996393, "vf_explained_var": 0.1798093952514507, "kl": 0.02272611579661477, "entropy": 0.8698947273864948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": -483.0, "episode_reward_mean": 63.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": 8.02, "predator_policy": 23.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, -9.0, 143.0, -175.0, 0.0, -5.0, 0.0, 95.0, 119.0, 117.0, 0.0, 68.0, 34.0, -9.0, -5.0, 0.0, 96.0, -17.0, 140.0, -472.0, 187.0, -61.0, 22.0, -6.0, 0.0, 167.0, 228.0, 138.0, -5.0, 79.0, -8.0, 0.0, 0.0, 86.0, 163.0, 33.0, 0.0, -59.0, -156.0, 34.0, 181.0, 203.0, -28.0, 61.0, -483.0, 198.0, 62.0, -33.0, 39.0, 166.0, 309.0, 141.0, -147.0, 151.0, 206.0, -139.0, 196.0, 116.0, 13.0, 330.0, 134.0, -145.0, -4.0, -16.0, 177.0, 121.0, 165.0, -40.0, 174.0, 174.0, 153.0, 141.0, 351.0, 153.0, 0.0, -12.0, 143.0, 0.0, 269.0, 176.0, -7.0, 328.0, 1.0, 186.0, -4.0, -3.0, 183.0, -17.0, 362.0, -18.0, -132.0, 260.0, 284.0, -17.0, 69.0, 78.0, 129.0, -2.0, -91.0, 80.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 44.0, -18.0, 0.0, 119.0, 0.0, -342.0, -8.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 95.0, 0.0, 55.0, 0.0, 17.0, 27.0, 0.0, -2.0, -190.0, 12.0, 0.0, 27.0, -166.0, -8.0, 0.0, -10.0, 0.0, 0.0, 48.0, 0.0, -14.0, -14.0, 0.0, 140.0, -315.0, -316.0, 0.0, 187.0, -370.0, 0.0, -26.0, 0.0, 0.0, -12.0, 0.0, 0.0, 12.0, 150.0, 40.0, 187.0, 123.0, -8.0, -10.0, 0.0, 78.0, 1.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 20.0, 66.0, 161.0, 0.0, -19.0, 0.0, 0.0, 0.0, -400.0, 0.0, -324.0, -4.0, 0.0, 29.0, 84.0, 75.0, 13.0, 187.0, -368.0, 143.0, 0.0, 41.0, -322.0, -322.0, 1.0, 197.0, 0.0, 53.0, -58.0, -8.0, 0.0, -124.0, -384.0, 193.0, 115.0, 163.0, 141.0, 0.0, 0.0, -294.0, 0.0, 142.0, 128.0, 77.0, 0.0, -278.0, 196.0, 0.0, 83.0, -8.0, -2.0, 0.0, 188.0, 142.0, -2.0, 118.0, -290.0, 0.0, -8.0, 0.0, 0.0, -39.0, 182.0, -10.0, 77.0, -8.0, 0.0, 165.0, -394.0, 156.0, 172.0, 0.0, 0.0, 161.0, 0.0, 153.0, 124.0, 0.0, 164.0, 182.0, 0.0, 148.0, 0.0, 0.0, -18.0, -12.0, 0.0, 143.0, 0.0, 0.0, 149.0, 111.0, 0.0, 176.0, 171.0, -368.0, 162.0, 155.0, 152.0, -322.0, 186.0, 0.0, -8.0, 0.0, 0.0, -6.0, 183.0, 0.0, 0.0, -34.0, 169.0, 190.0, -14.0, -16.0, -168.0, -172.0, 71.0, 145.0, 114.0, 161.0, -23.0, -14.0, 69.0, 0.0, -42.0, 99.0, 121.0, 0.0, 0.0, -4.0, -144.0, -34.0, -174.0, 166.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 9.0, 24.0, 0.0, 171.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 25.0, 39.0, 22.0, 51.0, 0.0, 2.0, 135.0, 111.0, 0.0, 7.0, 80.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 48.0, 4.0, 7.0, 0.0, 0.0, 159.0, 0.0, 0.0, 0.0, 180.0, 129.0, 22.0, 26.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 1.0, 0.0, 23.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 30.0, 22.0, 0.0, 0.0, 188.0, 153.0, 162.0, 10.0, 5.0, 0.0, 0.0, 22.0, 2.0, 1.0, 184.0, 13.0, 14.0, 6.0, 161.0, 0.0, 0.0, 0.0, 0.0, 9.0, 29.0, 4.0, 94.0, 69.0, 178.0, 179.0, 31.0, 0.0, 0.0, 0.0, 0.0, 147.0, 0.0, 9.0, 1.0, 0.0, 1.0, 138.0, 0.0, 0.0, 14.0, 27.0, 0.0, 15.0, 0.0, 0.0, 8.0, 10.0, 145.0, 0.0, 0.0, 4.0, 23.0, 0.0, 0.0, 5.0, 35.0, 17.0, 0.0, 0.0, 1.0, 197.0, 0.0, 2.0, 0.0, 13.0, 0.0, 0.0, 9.0, 8.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 6.0, 184.0, 0.0, 11.0, 10.0, 161.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 0.0, 3.0, 11.0, 1.0, 84.0, 124.0, 24.0, 20.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 21.0, 0.0, 8.0, 0.0, 2.0, 0.0, 1.0, 86.0, 5.0, 83.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.966880040321376, "mean_inference_ms": 2.910003988938342, "mean_action_processing_ms": 0.38230340609147084, "mean_env_wait_ms": 0.34986258380219737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024524450302124023, "StateBufferConnector_ms": 0.0055086612701416016, "ViewRequirementAgentConnector_ms": 0.20150959491729736}, "num_episodes": 18, "episode_return_max": 362.0, "episode_return_min": -483.0, "episode_return_mean": 63.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.65681465600875, "num_env_steps_trained_throughput_per_sec": 187.65681465600875, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 16597.901, "restore_workers_time_ms": 0.118, "training_step_time_ms": 16597.713, "sample_time_ms": 2996.594, "learn_time_ms": 13573.799, "learn_throughput": 294.685, "synch_weights_time_ms": 22.566}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "f1691_00002", "date": "2024-08-13_19-33-36", "timestamp": 1723592016, "time_this_iter_s": 21.486815929412842, "time_total_s": 4538.284540891647, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41f8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4538.284540891647, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 84.23870967741938, "ram_util_percent": 82.30322580645162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2649786622672483, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.1496618778459609, "policy_loss": -0.0018953606062544087, "vf_loss": 1.1512305279572805, "vf_explained_var": 0.0008154945714133127, "kl": 0.011616365460654065, "entropy": 0.7960150925255326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.1942093767344, "cur_kl_coeff": 0.0005561828613281247, "cur_lr": 0.00010000000000000003, "total_loss": 3.7426875043798375, "policy_loss": -0.0019617574997788305, "vf_loss": 3.7446442462779856, "vf_explained_var": 0.22151125186965578, "kl": 0.009008428766186452, "entropy": 0.8805113875992083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 362.0, "episode_reward_min": -483.0, "episode_reward_mean": 72.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": 13.745, "predator_policy": 22.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, -6.0, 0.0, 167.0, 228.0, 138.0, -5.0, 79.0, -8.0, 0.0, 0.0, 86.0, 163.0, 33.0, 0.0, -59.0, -156.0, 34.0, 181.0, 203.0, -28.0, 61.0, -483.0, 198.0, 62.0, -33.0, 39.0, 166.0, 309.0, 141.0, -147.0, 151.0, 206.0, -139.0, 196.0, 116.0, 13.0, 330.0, 134.0, -145.0, -4.0, -16.0, 177.0, 121.0, 165.0, -40.0, 174.0, 174.0, 153.0, 141.0, 351.0, 153.0, 0.0, -12.0, 143.0, 0.0, 269.0, 176.0, -7.0, 328.0, 1.0, 186.0, -4.0, -3.0, 183.0, -17.0, 362.0, -18.0, -132.0, 260.0, 284.0, -17.0, 69.0, 78.0, 129.0, -2.0, -91.0, 80.0, 43.0, -96.0, 82.0, 198.0, 23.0, -95.0, -52.0, 0.0, 0.0, -284.0, 185.0, 200.0, -19.0, 52.0, 85.0, -10.0, 201.0, 238.0, 185.0, -8.0, 243.0, 45.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, 0.0, 0.0, -12.0, 0.0, 0.0, 12.0, 150.0, 40.0, 187.0, 123.0, -8.0, -10.0, 0.0, 78.0, 1.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 20.0, 66.0, 161.0, 0.0, -19.0, 0.0, 0.0, 0.0, -400.0, 0.0, -324.0, -4.0, 0.0, 29.0, 84.0, 75.0, 13.0, 187.0, -368.0, 143.0, 0.0, 41.0, -322.0, -322.0, 1.0, 197.0, 0.0, 53.0, -58.0, -8.0, 0.0, -124.0, -384.0, 193.0, 115.0, 163.0, 141.0, 0.0, 0.0, -294.0, 0.0, 142.0, 128.0, 77.0, 0.0, -278.0, 196.0, 0.0, 83.0, -8.0, -2.0, 0.0, 188.0, 142.0, -2.0, 118.0, -290.0, 0.0, -8.0, 0.0, 0.0, -39.0, 182.0, -10.0, 77.0, -8.0, 0.0, 165.0, -394.0, 156.0, 172.0, 0.0, 0.0, 161.0, 0.0, 153.0, 124.0, 0.0, 164.0, 182.0, 0.0, 148.0, 0.0, 0.0, -18.0, -12.0, 0.0, 143.0, 0.0, 0.0, 149.0, 111.0, 0.0, 176.0, 171.0, -368.0, 162.0, 155.0, 152.0, -322.0, 186.0, 0.0, -8.0, 0.0, 0.0, -6.0, 183.0, 0.0, 0.0, -34.0, 169.0, 190.0, -14.0, -16.0, -168.0, -172.0, 71.0, 145.0, 114.0, 161.0, -23.0, -14.0, 69.0, 0.0, -42.0, 99.0, 121.0, 0.0, 0.0, -4.0, -144.0, -34.0, -174.0, 166.0, 143.0, -202.0, 0.0, -244.0, 82.0, 0.0, 73.0, 120.0, 0.0, -60.0, -4.0, -186.0, -22.0, -60.0, 0.0, 0.0, 0.0, 0.0, -372.0, -98.0, 0.0, 179.0, 0.0, 200.0, -24.0, -14.0, 0.0, -14.0, -21.0, 42.0, 0.0, -20.0, 184.0, -23.0, 154.0, 40.0, -1.0, 50.0, -16.0, 0.0, 74.0, 134.0, 48.0, -6.0], "policy_predator_policy_reward": [22.0, 26.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 1.0, 0.0, 23.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 30.0, 22.0, 0.0, 0.0, 188.0, 153.0, 162.0, 10.0, 5.0, 0.0, 0.0, 22.0, 2.0, 1.0, 184.0, 13.0, 14.0, 6.0, 161.0, 0.0, 0.0, 0.0, 0.0, 9.0, 29.0, 4.0, 94.0, 69.0, 178.0, 179.0, 31.0, 0.0, 0.0, 0.0, 0.0, 147.0, 0.0, 9.0, 1.0, 0.0, 1.0, 138.0, 0.0, 0.0, 14.0, 27.0, 0.0, 15.0, 0.0, 0.0, 8.0, 10.0, 145.0, 0.0, 0.0, 4.0, 23.0, 0.0, 0.0, 5.0, 35.0, 17.0, 0.0, 0.0, 1.0, 197.0, 0.0, 2.0, 0.0, 13.0, 0.0, 0.0, 9.0, 8.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 6.0, 184.0, 0.0, 11.0, 10.0, 161.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 0.0, 3.0, 11.0, 1.0, 84.0, 124.0, 24.0, 20.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 21.0, 0.0, 8.0, 0.0, 2.0, 0.0, 1.0, 86.0, 5.0, 83.0, 101.0, 1.0, 0.0, 148.0, 0.0, 0.0, 4.0, 1.0, 0.0, 83.0, 93.0, 2.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 6.0, 0.0, 0.0, 0.0, 12.0, 7.0, 0.0, 66.0, 64.0, 0.0, 0.0, 10.0, 11.0, 29.0, 44.0, 0.0, 69.0, 67.0, 0.0, 8.0, 35.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9792177357011059, "mean_inference_ms": 2.9516255894916785, "mean_action_processing_ms": 0.4099251770096813, "mean_env_wait_ms": 0.3547152364467429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03649795055389404, "StateBufferConnector_ms": 0.007214546203613281, "ViewRequirementAgentConnector_ms": 0.2558549642562866}, "num_episodes": 22, "episode_return_max": 362.0, "episode_return_min": -483.0, "episode_return_mean": 72.57, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.5389346667045, "num_env_steps_trained_throughput_per_sec": 161.5389346667045, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 17492.566, "restore_workers_time_ms": 0.12, "training_step_time_ms": 17492.372, "sample_time_ms": 3720.602, "learn_time_ms": 13746.685, "learn_throughput": 290.979, "synch_weights_time_ms": 20.752}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "f1691_00002", "date": "2024-08-13_19-34-01", "timestamp": 1723592041, "time_this_iter_s": 25.12686586380005, "time_total_s": 4563.411406755447, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdb0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4563.411406755447, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 79.80833333333334, "ram_util_percent": 83.92777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.768591938226942, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.6590851587908608, "policy_loss": -0.0012755186508887659, "vf_loss": 1.660157829838455, "vf_explained_var": -0.00024239256899192852, "kl": 0.007212515514818977, "entropy": 0.7461458929947444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.480487236128283, "cur_kl_coeff": 0.0005561828613281247, "cur_lr": 0.00010000000000000003, "total_loss": 4.66954661260837, "policy_loss": -0.0065707181569277535, "vf_loss": 4.676081498716243, "vf_explained_var": 0.25410999343508767, "kl": 0.06441682870730737, "entropy": 0.8561512421678614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -284.0, "episode_reward_mean": 86.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": 22.545, "predator_policy": 20.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.0, 62.0, -33.0, 39.0, 166.0, 309.0, 141.0, -147.0, 151.0, 206.0, -139.0, 196.0, 116.0, 13.0, 330.0, 134.0, -145.0, -4.0, -16.0, 177.0, 121.0, 165.0, -40.0, 174.0, 174.0, 153.0, 141.0, 351.0, 153.0, 0.0, -12.0, 143.0, 0.0, 269.0, 176.0, -7.0, 328.0, 1.0, 186.0, -4.0, -3.0, 183.0, -17.0, 362.0, -18.0, -132.0, 260.0, 284.0, -17.0, 69.0, 78.0, 129.0, -2.0, -91.0, 80.0, 43.0, -96.0, 82.0, 198.0, 23.0, -95.0, -52.0, 0.0, 0.0, -284.0, 185.0, 200.0, -19.0, 52.0, 85.0, -10.0, 201.0, 238.0, 185.0, -8.0, 243.0, 45.0, 191.0, -92.0, -12.0, 169.0, 181.0, 0.0, 0.0, 365.0, 394.0, -4.0, 200.0, 164.0, -110.0, -191.0, -4.0, 182.0, 158.0, 0.0, 100.0, 0.0, -6.0, 170.0, 179.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 197.0, 0.0, 53.0, -58.0, -8.0, 0.0, -124.0, -384.0, 193.0, 115.0, 163.0, 141.0, 0.0, 0.0, -294.0, 0.0, 142.0, 128.0, 77.0, 0.0, -278.0, 196.0, 0.0, 83.0, -8.0, -2.0, 0.0, 188.0, 142.0, -2.0, 118.0, -290.0, 0.0, -8.0, 0.0, 0.0, -39.0, 182.0, -10.0, 77.0, -8.0, 0.0, 165.0, -394.0, 156.0, 172.0, 0.0, 0.0, 161.0, 0.0, 153.0, 124.0, 0.0, 164.0, 182.0, 0.0, 148.0, 0.0, 0.0, -18.0, -12.0, 0.0, 143.0, 0.0, 0.0, 149.0, 111.0, 0.0, 176.0, 171.0, -368.0, 162.0, 155.0, 152.0, -322.0, 186.0, 0.0, -8.0, 0.0, 0.0, -6.0, 183.0, 0.0, 0.0, -34.0, 169.0, 190.0, -14.0, -16.0, -168.0, -172.0, 71.0, 145.0, 114.0, 161.0, -23.0, -14.0, 69.0, 0.0, -42.0, 99.0, 121.0, 0.0, 0.0, -4.0, -144.0, -34.0, -174.0, 166.0, 143.0, -202.0, 0.0, -244.0, 82.0, 0.0, 73.0, 120.0, 0.0, -60.0, -4.0, -186.0, -22.0, -60.0, 0.0, 0.0, 0.0, 0.0, -372.0, -98.0, 0.0, 179.0, 0.0, 200.0, -24.0, -14.0, 0.0, -14.0, -21.0, 42.0, 0.0, -20.0, 184.0, -23.0, 154.0, 40.0, -1.0, 50.0, -16.0, 0.0, 74.0, 134.0, 48.0, -6.0, 190.0, 0.0, -38.0, -116.0, 0.0, -24.0, 169.0, 0.0, 32.0, 93.0, 0.0, 0.0, 0.0, 0.0, 173.0, 178.0, 194.0, 200.0, 0.0, -8.0, 200.0, 0.0, 0.0, 153.0, -250.0, 8.0, -97.0, -386.0, 0.0, -8.0, 177.0, 0.0, 137.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, -12.0, 149.0, 0.0, 0.0, 175.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 9.0, 29.0, 4.0, 94.0, 69.0, 178.0, 179.0, 31.0, 0.0, 0.0, 0.0, 0.0, 147.0, 0.0, 9.0, 1.0, 0.0, 1.0, 138.0, 0.0, 0.0, 14.0, 27.0, 0.0, 15.0, 0.0, 0.0, 8.0, 10.0, 145.0, 0.0, 0.0, 4.0, 23.0, 0.0, 0.0, 5.0, 35.0, 17.0, 0.0, 0.0, 1.0, 197.0, 0.0, 2.0, 0.0, 13.0, 0.0, 0.0, 9.0, 8.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 6.0, 184.0, 0.0, 11.0, 10.0, 161.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 0.0, 3.0, 11.0, 1.0, 84.0, 124.0, 24.0, 20.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 21.0, 0.0, 8.0, 0.0, 2.0, 0.0, 1.0, 86.0, 5.0, 83.0, 101.0, 1.0, 0.0, 148.0, 0.0, 0.0, 4.0, 1.0, 0.0, 83.0, 93.0, 2.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 6.0, 0.0, 0.0, 0.0, 12.0, 7.0, 0.0, 66.0, 64.0, 0.0, 0.0, 10.0, 11.0, 29.0, 44.0, 0.0, 69.0, 67.0, 0.0, 8.0, 35.0, 0.0, 0.0, 3.0, 0.0, 1.0, 62.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 5.0, 7.0, 125.0, 99.0, 193.0, 0.0, 4.0, 5.0, 0.0, 21.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 6.0, 12.0, 9.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9931265945338238, "mean_inference_ms": 2.9844047456673635, "mean_action_processing_ms": 0.43897785844726495, "mean_env_wait_ms": 0.35955800610377436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042900681495666504, "StateBufferConnector_ms": 0.00798940658569336, "ViewRequirementAgentConnector_ms": 0.302365779876709}, "num_episodes": 23, "episode_return_max": 394.0, "episode_return_min": -284.0, "episode_return_mean": 86.41, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.35390053665978, "num_env_steps_trained_throughput_per_sec": 233.35390053665978, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 17272.48, "restore_workers_time_ms": 0.122, "training_step_time_ms": 17272.283, "sample_time_ms": 3881.488, "learn_time_ms": 13366.678, "learn_throughput": 299.252, "synch_weights_time_ms": 19.665}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "f1691_00002", "date": "2024-08-13_19-34-19", "timestamp": 1723592059, "time_this_iter_s": 17.19241428375244, "time_total_s": 4580.6038210392, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4580.6038210392, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 73.75416666666666, "ram_util_percent": 82.10416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4447114782437445, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 1.5246696065973353, "policy_loss": -0.0004602115236656376, "vf_loss": 1.524988716951123, "vf_explained_var": 0.0020871517834839997, "kl": 0.005016882162195683, "entropy": 0.7546957759945481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.468144974349038, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 5.296830119279327, "policy_loss": -0.004031541012227535, "vf_loss": 5.300845425469535, "vf_explained_var": 0.24523407788503737, "kl": 0.019426484413534784, "entropy": 0.8556188151319191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -284.0, "episode_reward_mean": 95.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": 28.125, "predator_policy": 19.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, 177.0, 121.0, 165.0, -40.0, 174.0, 174.0, 153.0, 141.0, 351.0, 153.0, 0.0, -12.0, 143.0, 0.0, 269.0, 176.0, -7.0, 328.0, 1.0, 186.0, -4.0, -3.0, 183.0, -17.0, 362.0, -18.0, -132.0, 260.0, 284.0, -17.0, 69.0, 78.0, 129.0, -2.0, -91.0, 80.0, 43.0, -96.0, 82.0, 198.0, 23.0, -95.0, -52.0, 0.0, 0.0, -284.0, 185.0, 200.0, -19.0, 52.0, 85.0, -10.0, 201.0, 238.0, 185.0, -8.0, 243.0, 45.0, 191.0, -92.0, -12.0, 169.0, 181.0, 0.0, 0.0, 365.0, 394.0, -4.0, 200.0, 164.0, -110.0, -191.0, -4.0, 182.0, 158.0, 0.0, 100.0, 0.0, -6.0, 170.0, 179.0, -1.0, 82.0, 324.0, 9.0, 241.0, 377.0, 132.0, -18.0, 0.0, 28.0, 258.0, 0.0, 331.0, 178.0, 366.0, 0.0, -93.0, 327.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -39.0, 182.0, -10.0, 77.0, -8.0, 0.0, 165.0, -394.0, 156.0, 172.0, 0.0, 0.0, 161.0, 0.0, 153.0, 124.0, 0.0, 164.0, 182.0, 0.0, 148.0, 0.0, 0.0, -18.0, -12.0, 0.0, 143.0, 0.0, 0.0, 149.0, 111.0, 0.0, 176.0, 171.0, -368.0, 162.0, 155.0, 152.0, -322.0, 186.0, 0.0, -8.0, 0.0, 0.0, -6.0, 183.0, 0.0, 0.0, -34.0, 169.0, 190.0, -14.0, -16.0, -168.0, -172.0, 71.0, 145.0, 114.0, 161.0, -23.0, -14.0, 69.0, 0.0, -42.0, 99.0, 121.0, 0.0, 0.0, -4.0, -144.0, -34.0, -174.0, 166.0, 143.0, -202.0, 0.0, -244.0, 82.0, 0.0, 73.0, 120.0, 0.0, -60.0, -4.0, -186.0, -22.0, -60.0, 0.0, 0.0, 0.0, 0.0, -372.0, -98.0, 0.0, 179.0, 0.0, 200.0, -24.0, -14.0, 0.0, -14.0, -21.0, 42.0, 0.0, -20.0, 184.0, -23.0, 154.0, 40.0, -1.0, 50.0, -16.0, 0.0, 74.0, 134.0, 48.0, -6.0, 190.0, 0.0, -38.0, -116.0, 0.0, -24.0, 169.0, 0.0, 32.0, 93.0, 0.0, 0.0, 0.0, 0.0, 173.0, 178.0, 194.0, 200.0, 0.0, -8.0, 200.0, 0.0, 0.0, 153.0, -250.0, 8.0, -97.0, -386.0, 0.0, -8.0, 177.0, 0.0, 137.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, -12.0, 149.0, 0.0, 0.0, 175.0, 0.0, -2.0, 0.0, -133.0, 172.0, 68.0, -289.0, 0.0, 185.0, -16.0, 169.0, 198.0, 0.0, 109.0, -36.0, 0.0, 0.0, 0.0, 0.0, -118.0, 178.0, 80.0, 0.0, 0.0, 165.0, 157.0, 0.0, 171.0, 196.0, 169.0, 0.0, 0.0, -52.0, -82.0, 162.0, 146.0], "policy_predator_policy_reward": [23.0, 0.0, 0.0, 5.0, 35.0, 17.0, 0.0, 0.0, 1.0, 197.0, 0.0, 2.0, 0.0, 13.0, 0.0, 0.0, 9.0, 8.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 12.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 6.0, 184.0, 0.0, 11.0, 10.0, 161.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 0.0, 3.0, 11.0, 1.0, 84.0, 124.0, 24.0, 20.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 21.0, 0.0, 8.0, 0.0, 2.0, 0.0, 1.0, 86.0, 5.0, 83.0, 101.0, 1.0, 0.0, 148.0, 0.0, 0.0, 4.0, 1.0, 0.0, 83.0, 93.0, 2.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 6.0, 0.0, 0.0, 0.0, 12.0, 7.0, 0.0, 66.0, 64.0, 0.0, 0.0, 10.0, 11.0, 29.0, 44.0, 0.0, 69.0, 67.0, 0.0, 8.0, 35.0, 0.0, 0.0, 3.0, 0.0, 1.0, 62.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 5.0, 7.0, 125.0, 99.0, 193.0, 0.0, 4.0, 5.0, 0.0, 21.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 6.0, 12.0, 9.0, 0.0, 4.0, 1.0, 0.0, 106.0, 109.0, 41.0, 43.0, 147.0, 151.0, 72.0, 0.0, 10.0, 0.0, 10.0, 13.0, 13.0, 5.0, 0.0, 0.0, 95.0, 51.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 41.0, 9.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0050924117120419, "mean_inference_ms": 3.0355488183767476, "mean_action_processing_ms": 0.4628254806463342, "mean_env_wait_ms": 0.36473630004225394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037394165992736816, "StateBufferConnector_ms": 0.010749220848083496, "ViewRequirementAgentConnector_ms": 0.297379732131958}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -284.0, "episode_return_mean": 95.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.3267362184812, "num_env_steps_trained_throughput_per_sec": 311.3267362184812, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 16959.003, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16958.913, "sample_time_ms": 3769.634, "learn_time_ms": 13165.356, "learn_throughput": 303.828, "synch_weights_time_ms": 19.682}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "f1691_00002", "date": "2024-08-13_19-34-32", "timestamp": 1723592072, "time_this_iter_s": 12.894237995147705, "time_total_s": 4593.4980590343475, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4593.4980590343475, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 56.55263157894737, "ram_util_percent": 80.13157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.66804437470578, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.42976320041392846, "policy_loss": -0.00268769077587104, "vf_loss": 0.43217953494109373, "vf_explained_var": 0.004869130521855026, "kl": 0.009648217157159009, "entropy": 0.7509883226225615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.85683468430446, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 4.894877659706842, "policy_loss": -0.0022498872185313197, "vf_loss": 4.897122383622265, "vf_explained_var": 0.49210608371351133, "kl": 0.006189018612620924, "entropy": 0.799023958267989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -284.0, "episode_reward_mean": 108.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": 36.215, "predator_policy": 17.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.0, 1.0, 186.0, -4.0, -3.0, 183.0, -17.0, 362.0, -18.0, -132.0, 260.0, 284.0, -17.0, 69.0, 78.0, 129.0, -2.0, -91.0, 80.0, 43.0, -96.0, 82.0, 198.0, 23.0, -95.0, -52.0, 0.0, 0.0, -284.0, 185.0, 200.0, -19.0, 52.0, 85.0, -10.0, 201.0, 238.0, 185.0, -8.0, 243.0, 45.0, 191.0, -92.0, -12.0, 169.0, 181.0, 0.0, 0.0, 365.0, 394.0, -4.0, 200.0, 164.0, -110.0, -191.0, -4.0, 182.0, 158.0, 0.0, 100.0, 0.0, -6.0, 170.0, 179.0, -1.0, 82.0, 324.0, 9.0, 241.0, 377.0, 132.0, -18.0, 0.0, 28.0, 258.0, 0.0, 331.0, 178.0, 366.0, 0.0, -93.0, 327.0, 170.0, 176.0, 250.0, 158.0, 164.0, 196.0, 390.0, 0.0, 340.0, 200.0, -7.0, 332.0, 168.0, 200.0, 386.0, -6.0, 48.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.0, 155.0, 152.0, -322.0, 186.0, 0.0, -8.0, 0.0, 0.0, -6.0, 183.0, 0.0, 0.0, -34.0, 169.0, 190.0, -14.0, -16.0, -168.0, -172.0, 71.0, 145.0, 114.0, 161.0, -23.0, -14.0, 69.0, 0.0, -42.0, 99.0, 121.0, 0.0, 0.0, -4.0, -144.0, -34.0, -174.0, 166.0, 143.0, -202.0, 0.0, -244.0, 82.0, 0.0, 73.0, 120.0, 0.0, -60.0, -4.0, -186.0, -22.0, -60.0, 0.0, 0.0, 0.0, 0.0, -372.0, -98.0, 0.0, 179.0, 0.0, 200.0, -24.0, -14.0, 0.0, -14.0, -21.0, 42.0, 0.0, -20.0, 184.0, -23.0, 154.0, 40.0, -1.0, 50.0, -16.0, 0.0, 74.0, 134.0, 48.0, -6.0, 190.0, 0.0, -38.0, -116.0, 0.0, -24.0, 169.0, 0.0, 32.0, 93.0, 0.0, 0.0, 0.0, 0.0, 173.0, 178.0, 194.0, 200.0, 0.0, -8.0, 200.0, 0.0, 0.0, 153.0, -250.0, 8.0, -97.0, -386.0, 0.0, -8.0, 177.0, 0.0, 137.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, -12.0, 149.0, 0.0, 0.0, 175.0, 0.0, -2.0, 0.0, -133.0, 172.0, 68.0, -289.0, 0.0, 185.0, -16.0, 169.0, 198.0, 0.0, 109.0, -36.0, 0.0, 0.0, 0.0, 0.0, -118.0, 178.0, 80.0, 0.0, 0.0, 165.0, 157.0, 0.0, 171.0, 196.0, 169.0, 0.0, 0.0, -52.0, -82.0, 162.0, 146.0, 0.0, 170.0, 0.0, 169.0, 48.0, 191.0, -6.0, 143.0, 0.0, 156.0, 0.0, 196.0, 196.0, 193.0, 0.0, 0.0, 173.0, 158.0, 0.0, 200.0, 0.0, -14.0, 179.0, 148.0, -2.0, 159.0, 200.0, 0.0, 194.0, 191.0, 0.0, -12.0, 0.0, -27.0, 0.0, 200.0], "policy_predator_policy_reward": [0.0, 11.0, 10.0, 161.0, 0.0, 0.0, 0.0, 4.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 0.0, 3.0, 11.0, 1.0, 84.0, 124.0, 24.0, 20.0, 0.0, 9.0, 20.0, 0.0, 0.0, 0.0, 21.0, 0.0, 8.0, 0.0, 2.0, 0.0, 1.0, 86.0, 5.0, 83.0, 101.0, 1.0, 0.0, 148.0, 0.0, 0.0, 4.0, 1.0, 0.0, 83.0, 93.0, 2.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 6.0, 0.0, 0.0, 0.0, 12.0, 7.0, 0.0, 66.0, 64.0, 0.0, 0.0, 10.0, 11.0, 29.0, 44.0, 0.0, 69.0, 67.0, 0.0, 8.0, 35.0, 0.0, 0.0, 3.0, 0.0, 1.0, 62.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 5.0, 7.0, 125.0, 99.0, 193.0, 0.0, 4.0, 5.0, 0.0, 21.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 6.0, 12.0, 9.0, 0.0, 4.0, 1.0, 0.0, 106.0, 109.0, 41.0, 43.0, 147.0, 151.0, 72.0, 0.0, 10.0, 0.0, 10.0, 13.0, 13.0, 5.0, 0.0, 0.0, 95.0, 51.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 41.0, 9.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 21.0, 7.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 75.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.010976666699141, "mean_inference_ms": 3.0554909564443347, "mean_action_processing_ms": 0.48323535880151636, "mean_env_wait_ms": 0.36721664248747515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02801060676574707, "StateBufferConnector_ms": 0.010304689407348633, "ViewRequirementAgentConnector_ms": 0.25378167629241943}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -284.0, "episode_return_mean": 108.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.52892871971187, "num_env_steps_trained_throughput_per_sec": 311.52892871971187, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 16827.282, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16827.192, "sample_time_ms": 3706.754, "learn_time_ms": 13096.176, "learn_throughput": 305.433, "synch_weights_time_ms": 20.449}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "f1691_00002", "date": "2024-08-13_19-34-45", "timestamp": 1723592085, "time_this_iter_s": 12.86093807220459, "time_total_s": 4606.358997106552, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4606.358997106552, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 61.67222222222222, "ram_util_percent": 80.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.452677529309162, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.8132028497400738, "policy_loss": -0.0022750916506444653, "vf_loss": 0.8152398072774448, "vf_explained_var": 0.0024773983097581007, "kl": 0.00846702741064886, "entropy": 0.7853648166807871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.367206671282098, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 4.3759152093261635, "policy_loss": -0.0039886009066350874, "vf_loss": 4.379893517746496, "vf_explained_var": 0.5592045803549428, "kl": 0.012340346087590461, "entropy": 0.8252059807222356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -284.0, "episode_reward_mean": 122.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": 46.02, "predator_policy": 15.335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.0, 23.0, -95.0, -52.0, 0.0, 0.0, -284.0, 185.0, 200.0, -19.0, 52.0, 85.0, -10.0, 201.0, 238.0, 185.0, -8.0, 243.0, 45.0, 191.0, -92.0, -12.0, 169.0, 181.0, 0.0, 0.0, 365.0, 394.0, -4.0, 200.0, 164.0, -110.0, -191.0, -4.0, 182.0, 158.0, 0.0, 100.0, 0.0, -6.0, 170.0, 179.0, -1.0, 82.0, 324.0, 9.0, 241.0, 377.0, 132.0, -18.0, 0.0, 28.0, 258.0, 0.0, 331.0, 178.0, 366.0, 0.0, -93.0, 327.0, 170.0, 176.0, 250.0, 158.0, 164.0, 196.0, 390.0, 0.0, 340.0, 200.0, -7.0, 332.0, 168.0, 200.0, 386.0, -6.0, 48.0, 200.0, 185.0, 170.0, 361.0, 188.0, 333.0, -1.0, 138.0, 326.0, 0.0, 178.0, -17.0, 161.0, 184.0, 170.0, 218.0, 189.0, 0.0, 100.0, 189.0, 92.0, -17.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [73.0, 120.0, 0.0, -60.0, -4.0, -186.0, -22.0, -60.0, 0.0, 0.0, 0.0, 0.0, -372.0, -98.0, 0.0, 179.0, 0.0, 200.0, -24.0, -14.0, 0.0, -14.0, -21.0, 42.0, 0.0, -20.0, 184.0, -23.0, 154.0, 40.0, -1.0, 50.0, -16.0, 0.0, 74.0, 134.0, 48.0, -6.0, 190.0, 0.0, -38.0, -116.0, 0.0, -24.0, 169.0, 0.0, 32.0, 93.0, 0.0, 0.0, 0.0, 0.0, 173.0, 178.0, 194.0, 200.0, 0.0, -8.0, 200.0, 0.0, 0.0, 153.0, -250.0, 8.0, -97.0, -386.0, 0.0, -8.0, 177.0, 0.0, 137.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, -12.0, 149.0, 0.0, 0.0, 175.0, 0.0, -2.0, 0.0, -133.0, 172.0, 68.0, -289.0, 0.0, 185.0, -16.0, 169.0, 198.0, 0.0, 109.0, -36.0, 0.0, 0.0, 0.0, 0.0, -118.0, 178.0, 80.0, 0.0, 0.0, 165.0, 157.0, 0.0, 171.0, 196.0, 169.0, 0.0, 0.0, -52.0, -82.0, 162.0, 146.0, 0.0, 170.0, 0.0, 169.0, 48.0, 191.0, -6.0, 143.0, 0.0, 156.0, 0.0, 196.0, 196.0, 193.0, 0.0, 0.0, 173.0, 158.0, 0.0, 200.0, 0.0, -14.0, 179.0, 148.0, -2.0, 159.0, 200.0, 0.0, 194.0, 191.0, 0.0, -12.0, 0.0, -27.0, 0.0, 200.0, 0.0, 180.0, 158.0, 0.0, 167.0, 178.0, 0.0, 187.0, 113.0, 144.0, 0.0, -2.0, -16.0, 123.0, 106.0, 191.0, 0.0, 0.0, 0.0, 174.0, 0.0, -36.0, -6.0, 151.0, 184.0, -30.0, 0.0, 162.0, 145.0, 73.0, 0.0, 189.0, 0.0, 0.0, 60.0, 0.0, -56.0, 152.0, 57.0, 0.0, -34.0, 0.0, -6.0, 0.0], "policy_predator_policy_reward": [4.0, 1.0, 0.0, 83.0, 93.0, 2.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 6.0, 0.0, 0.0, 0.0, 12.0, 7.0, 0.0, 66.0, 64.0, 0.0, 0.0, 10.0, 11.0, 29.0, 44.0, 0.0, 69.0, 67.0, 0.0, 8.0, 35.0, 0.0, 0.0, 3.0, 0.0, 1.0, 62.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 5.0, 7.0, 125.0, 99.0, 193.0, 0.0, 4.0, 5.0, 0.0, 21.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 6.0, 12.0, 9.0, 0.0, 4.0, 1.0, 0.0, 106.0, 109.0, 41.0, 43.0, 147.0, 151.0, 72.0, 0.0, 10.0, 0.0, 10.0, 13.0, 13.0, 5.0, 0.0, 0.0, 95.0, 51.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 41.0, 9.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 21.0, 7.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 75.0, 0.0, 0.0, 0.0, 5.0, 12.0, 0.0, 4.0, 12.0, 1.0, 0.0, 36.0, 40.0, 0.0, 1.0, 31.0, 0.0, 0.0, 29.0, 0.0, 0.0, 4.0, 0.0, 18.0, 1.0, 16.0, 0.0, 15.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 93.0, 8.0, 27.0, 0.0, 17.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0131989545090516, "mean_inference_ms": 3.065333597275486, "mean_action_processing_ms": 0.502343285137729, "mean_env_wait_ms": 0.368683385077056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023633718490600586, "StateBufferConnector_ms": 0.009961128234863281, "ViewRequirementAgentConnector_ms": 0.22597908973693848}, "num_episodes": 22, "episode_return_max": 394.0, "episode_return_min": -284.0, "episode_return_mean": 122.71, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.89012123042806, "num_env_steps_trained_throughput_per_sec": 268.89012123042806, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 16935.744, "restore_workers_time_ms": 0.02, "training_step_time_ms": 16935.643, "sample_time_ms": 3671.826, "learn_time_ms": 13238.868, "learn_throughput": 302.141, "synch_weights_time_ms": 21.845}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "f1691_00002", "date": "2024-08-13_19-35-00", "timestamp": 1723592100, "time_this_iter_s": 14.941527843475342, "time_total_s": 4621.3005249500275, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4621.3005249500275, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 68.46666666666668, "ram_util_percent": 82.05238095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.613313276699138, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.14816960378343033, "policy_loss": -0.00032696358381558663, "vf_loss": 0.14832170639912692, "vf_explained_var": 0.028306443192971445, "kl": 0.006217266723410951, "entropy": 0.7959121918552137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.109308306518056, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 3.8143545583442404, "policy_loss": -0.0022044381752570784, "vf_loss": 3.8165453076993345, "vf_explained_var": 0.6028218611207589, "kl": 0.01639559110744572, "entropy": 0.8563918709439575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -191.0, "episode_reward_mean": 132.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 193.0}, "policy_reward_mean": {"prey_policy": 53.88, "predator_policy": 12.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.0, 191.0, -92.0, -12.0, 169.0, 181.0, 0.0, 0.0, 365.0, 394.0, -4.0, 200.0, 164.0, -110.0, -191.0, -4.0, 182.0, 158.0, 0.0, 100.0, 0.0, -6.0, 170.0, 179.0, -1.0, 82.0, 324.0, 9.0, 241.0, 377.0, 132.0, -18.0, 0.0, 28.0, 258.0, 0.0, 331.0, 178.0, 366.0, 0.0, -93.0, 327.0, 170.0, 176.0, 250.0, 158.0, 164.0, 196.0, 390.0, 0.0, 340.0, 200.0, -7.0, 332.0, 168.0, 200.0, 386.0, -6.0, 48.0, 200.0, 185.0, 170.0, 361.0, 188.0, 333.0, -1.0, 138.0, 326.0, 0.0, 178.0, -17.0, 161.0, 184.0, 170.0, 218.0, 189.0, 0.0, 100.0, 189.0, 92.0, -17.0, -3.0, -1.0, 163.0, 0.0, 175.0, 193.0, 312.0, 0.0, 332.0, -5.0, 194.0, 41.0, 91.0, 395.0, -33.0, 181.0, 0.0, 71.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.0, -6.0, 190.0, 0.0, -38.0, -116.0, 0.0, -24.0, 169.0, 0.0, 32.0, 93.0, 0.0, 0.0, 0.0, 0.0, 173.0, 178.0, 194.0, 200.0, 0.0, -8.0, 200.0, 0.0, 0.0, 153.0, -250.0, 8.0, -97.0, -386.0, 0.0, -8.0, 177.0, 0.0, 137.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, -12.0, 149.0, 0.0, 0.0, 175.0, 0.0, -2.0, 0.0, -133.0, 172.0, 68.0, -289.0, 0.0, 185.0, -16.0, 169.0, 198.0, 0.0, 109.0, -36.0, 0.0, 0.0, 0.0, 0.0, -118.0, 178.0, 80.0, 0.0, 0.0, 165.0, 157.0, 0.0, 171.0, 196.0, 169.0, 0.0, 0.0, -52.0, -82.0, 162.0, 146.0, 0.0, 170.0, 0.0, 169.0, 48.0, 191.0, -6.0, 143.0, 0.0, 156.0, 0.0, 196.0, 196.0, 193.0, 0.0, 0.0, 173.0, 158.0, 0.0, 200.0, 0.0, -14.0, 179.0, 148.0, -2.0, 159.0, 200.0, 0.0, 194.0, 191.0, 0.0, -12.0, 0.0, -27.0, 0.0, 200.0, 0.0, 180.0, 158.0, 0.0, 167.0, 178.0, 0.0, 187.0, 113.0, 144.0, 0.0, -2.0, -16.0, 123.0, 106.0, 191.0, 0.0, 0.0, 0.0, 174.0, 0.0, -36.0, -6.0, 151.0, 184.0, -30.0, 0.0, 162.0, 145.0, 73.0, 0.0, 189.0, 0.0, 0.0, 60.0, 0.0, -56.0, 152.0, 57.0, 0.0, -34.0, 0.0, -6.0, 0.0, -2.0, 0.0, 155.0, 0.0, 0.0, 0.0, 175.0, 0.0, 193.0, 0.0, 131.0, 167.0, 0.0, 0.0, 142.0, 165.0, -10.0, 0.0, 0.0, 194.0, 0.0, 31.0, 0.0, 76.0, 200.0, 195.0, -34.0, -16.0, 177.0, 0.0, 0.0, 0.0, -50.0, 0.0, -2.0, 0.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 1.0, 62.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 5.0, 7.0, 125.0, 99.0, 193.0, 0.0, 4.0, 5.0, 0.0, 21.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 6.0, 12.0, 9.0, 0.0, 4.0, 1.0, 0.0, 106.0, 109.0, 41.0, 43.0, 147.0, 151.0, 72.0, 0.0, 10.0, 0.0, 10.0, 13.0, 13.0, 5.0, 0.0, 0.0, 95.0, 51.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 41.0, 9.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 21.0, 7.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 75.0, 0.0, 0.0, 0.0, 5.0, 12.0, 0.0, 4.0, 12.0, 1.0, 0.0, 36.0, 40.0, 0.0, 1.0, 31.0, 0.0, 0.0, 29.0, 0.0, 0.0, 4.0, 0.0, 18.0, 1.0, 16.0, 0.0, 15.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 93.0, 8.0, 27.0, 0.0, 17.0, 0.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 12.0, 13.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 2.0, 2.0, 0.0, 0.0, 80.0, 41.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0130462156637694, "mean_inference_ms": 3.064710183331864, "mean_action_processing_ms": 0.5013670144477348, "mean_env_wait_ms": 0.36795879586381375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01170337200164795, "StateBufferConnector_ms": 0.009090662002563477, "ViewRequirementAgentConnector_ms": 0.18940365314483643}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -191.0, "episode_return_mean": 132.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.25161916434286, "num_env_steps_trained_throughput_per_sec": 214.25161916434286, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 17435.237, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17435.158, "sample_time_ms": 3681.723, "learn_time_ms": 13728.109, "learn_throughput": 291.373, "synch_weights_time_ms": 22.313}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "f1691_00002", "date": "2024-08-13_19-35-18", "timestamp": 1723592118, "time_this_iter_s": 18.74394416809082, "time_total_s": 4640.044469118118, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdb550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4640.044469118118, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 89.14615384615385, "ram_util_percent": 83.58461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.131172673569785, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.45037240976536713, "policy_loss": -0.0005229331700811311, "vf_loss": 0.4506393173966365, "vf_explained_var": 0.001348798804812961, "kl": 0.009103118065504723, "entropy": 0.771691354336562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.815037783617697, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 3.6907281734325266, "policy_loss": -0.0019162449463413507, "vf_loss": 3.6926393459713647, "vf_explained_var": 0.6417040244927482, "kl": 0.006075976667242488, "entropy": 0.8563523912871326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -93.0, "episode_reward_mean": 145.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -289.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": 62.695, "predator_policy": 10.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, -1.0, 82.0, 324.0, 9.0, 241.0, 377.0, 132.0, -18.0, 0.0, 28.0, 258.0, 0.0, 331.0, 178.0, 366.0, 0.0, -93.0, 327.0, 170.0, 176.0, 250.0, 158.0, 164.0, 196.0, 390.0, 0.0, 340.0, 200.0, -7.0, 332.0, 168.0, 200.0, 386.0, -6.0, 48.0, 200.0, 185.0, 170.0, 361.0, 188.0, 333.0, -1.0, 138.0, 326.0, 0.0, 178.0, -17.0, 161.0, 184.0, 170.0, 218.0, 189.0, 0.0, 100.0, 189.0, 92.0, -17.0, -3.0, -1.0, 163.0, 0.0, 175.0, 193.0, 312.0, 0.0, 332.0, -5.0, 194.0, 41.0, 91.0, 395.0, -33.0, 181.0, 0.0, 71.0, -1.0, 181.0, 130.0, 386.0, 0.0, 153.0, -2.0, 0.0, 193.0, 178.0, 250.0, 0.0, 0.0, 389.0, 180.0, 167.0, -2.0, 0.0, 311.0, 200.0, 163.0, 167.0, -6.0, 167.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 175.0, 0.0, -2.0, 0.0, -133.0, 172.0, 68.0, -289.0, 0.0, 185.0, -16.0, 169.0, 198.0, 0.0, 109.0, -36.0, 0.0, 0.0, 0.0, 0.0, -118.0, 178.0, 80.0, 0.0, 0.0, 165.0, 157.0, 0.0, 171.0, 196.0, 169.0, 0.0, 0.0, -52.0, -82.0, 162.0, 146.0, 0.0, 170.0, 0.0, 169.0, 48.0, 191.0, -6.0, 143.0, 0.0, 156.0, 0.0, 196.0, 196.0, 193.0, 0.0, 0.0, 173.0, 158.0, 0.0, 200.0, 0.0, -14.0, 179.0, 148.0, -2.0, 159.0, 200.0, 0.0, 194.0, 191.0, 0.0, -12.0, 0.0, -27.0, 0.0, 200.0, 0.0, 180.0, 158.0, 0.0, 167.0, 178.0, 0.0, 187.0, 113.0, 144.0, 0.0, -2.0, -16.0, 123.0, 106.0, 191.0, 0.0, 0.0, 0.0, 174.0, 0.0, -36.0, -6.0, 151.0, 184.0, -30.0, 0.0, 162.0, 145.0, 73.0, 0.0, 189.0, 0.0, 0.0, 60.0, 0.0, -56.0, 152.0, 57.0, 0.0, -34.0, 0.0, -6.0, 0.0, -2.0, 0.0, 155.0, 0.0, 0.0, 0.0, 175.0, 0.0, 193.0, 0.0, 131.0, 167.0, 0.0, 0.0, 142.0, 165.0, -10.0, 0.0, 0.0, 194.0, 0.0, 31.0, 0.0, 76.0, 200.0, 195.0, -34.0, -16.0, 177.0, 0.0, 0.0, 0.0, -50.0, 0.0, -2.0, 0.0, 179.0, 0.0, 0.0, 41.0, 194.0, 192.0, 0.0, 0.0, 0.0, 148.0, 0.0, -4.0, 0.0, 0.0, 0.0, 193.0, 178.0, 0.0, 8.0, 176.0, 0.0, 0.0, 0.0, 0.0, 192.0, 196.0, 172.0, 0.0, 0.0, 167.0, 0.0, -4.0, 0.0, 0.0, 185.0, 125.0, 0.0, 200.0, 149.0, -2.0, -4.0, 156.0, -14.0, 0.0, 146.0, 0.0], "policy_predator_policy_reward": [0.0, 4.0, 1.0, 0.0, 106.0, 109.0, 41.0, 43.0, 147.0, 151.0, 72.0, 0.0, 10.0, 0.0, 10.0, 13.0, 13.0, 5.0, 0.0, 0.0, 95.0, 51.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 41.0, 9.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 21.0, 7.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 75.0, 0.0, 0.0, 0.0, 5.0, 12.0, 0.0, 4.0, 12.0, 1.0, 0.0, 36.0, 40.0, 0.0, 1.0, 31.0, 0.0, 0.0, 29.0, 0.0, 0.0, 4.0, 0.0, 18.0, 1.0, 16.0, 0.0, 15.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 93.0, 8.0, 27.0, 0.0, 17.0, 0.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 12.0, 13.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 2.0, 2.0, 0.0, 0.0, 80.0, 41.0, 0.0, 1.0, 2.0, 0.0, 47.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 64.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 0.0, 4.0, 4.0, 12.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.011209542306211, "mean_inference_ms": 3.061387353612438, "mean_action_processing_ms": 0.4989447472913233, "mean_env_wait_ms": 0.36733546945558027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872560501098633, "StateBufferConnector_ms": 0.008742690086364746, "ViewRequirementAgentConnector_ms": 0.16351842880249023}, "num_episodes": 23, "episode_return_max": 395.0, "episode_return_min": -93.0, "episode_return_mean": 145.42, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.75748736771192, "num_env_steps_trained_throughput_per_sec": 252.75748736771192, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 17741.253, "restore_workers_time_ms": 0.019, "training_step_time_ms": 17741.175, "sample_time_ms": 3788.445, "learn_time_ms": 13927.727, "learn_throughput": 287.197, "synch_weights_time_ms": 22.052}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "f1691_00002", "date": "2024-08-13_19-35-34", "timestamp": 1723592134, "time_this_iter_s": 15.842495918273926, "time_total_s": 4655.886965036392, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4655.886965036392, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 72.70434782608694, "ram_util_percent": 83.11739130434782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9228419346744736, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.28990256020001004, "policy_loss": -0.00035921571180027315, "vf_loss": 0.29003534258208385, "vf_explained_var": -0.005881099568472968, "kl": 0.008050983937398575, "entropy": 0.8063527484734853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.31718583671504, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 4.1904991433733985, "policy_loss": 0.00048147431111564395, "vf_loss": 4.190013760485977, "vf_explained_var": 0.7081294985990676, "kl": 0.004684983506362468, "entropy": 0.8103094132488997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -33.0, "episode_reward_mean": 144.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 93.0}, "policy_reward_mean": {"prey_policy": 65.67, "predator_policy": 6.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.0, 170.0, 176.0, 250.0, 158.0, 164.0, 196.0, 390.0, 0.0, 340.0, 200.0, -7.0, 332.0, 168.0, 200.0, 386.0, -6.0, 48.0, 200.0, 185.0, 170.0, 361.0, 188.0, 333.0, -1.0, 138.0, 326.0, 0.0, 178.0, -17.0, 161.0, 184.0, 170.0, 218.0, 189.0, 0.0, 100.0, 189.0, 92.0, -17.0, -3.0, -1.0, 163.0, 0.0, 175.0, 193.0, 312.0, 0.0, 332.0, -5.0, 194.0, 41.0, 91.0, 395.0, -33.0, 181.0, 0.0, 71.0, -1.0, 181.0, 130.0, 386.0, 0.0, 153.0, -2.0, 0.0, 193.0, 178.0, 250.0, 0.0, 0.0, 389.0, 180.0, 167.0, -2.0, 0.0, 311.0, 200.0, 163.0, 167.0, -6.0, 167.0, 13.0, 174.0, -26.0, 186.0, 27.0, 176.0, -16.0, 198.0, 0.0, 4.0, 192.0, 128.0, 390.0, 199.0, 0.0, 170.0, 257.0, 190.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.0, 146.0, 0.0, 170.0, 0.0, 169.0, 48.0, 191.0, -6.0, 143.0, 0.0, 156.0, 0.0, 196.0, 196.0, 193.0, 0.0, 0.0, 173.0, 158.0, 0.0, 200.0, 0.0, -14.0, 179.0, 148.0, -2.0, 159.0, 200.0, 0.0, 194.0, 191.0, 0.0, -12.0, 0.0, -27.0, 0.0, 200.0, 0.0, 180.0, 158.0, 0.0, 167.0, 178.0, 0.0, 187.0, 113.0, 144.0, 0.0, -2.0, -16.0, 123.0, 106.0, 191.0, 0.0, 0.0, 0.0, 174.0, 0.0, -36.0, -6.0, 151.0, 184.0, -30.0, 0.0, 162.0, 145.0, 73.0, 0.0, 189.0, 0.0, 0.0, 60.0, 0.0, -56.0, 152.0, 57.0, 0.0, -34.0, 0.0, -6.0, 0.0, -2.0, 0.0, 155.0, 0.0, 0.0, 0.0, 175.0, 0.0, 193.0, 0.0, 131.0, 167.0, 0.0, 0.0, 142.0, 165.0, -10.0, 0.0, 0.0, 194.0, 0.0, 31.0, 0.0, 76.0, 200.0, 195.0, -34.0, -16.0, 177.0, 0.0, 0.0, 0.0, -50.0, 0.0, -2.0, 0.0, 179.0, 0.0, 0.0, 41.0, 194.0, 192.0, 0.0, 0.0, 0.0, 148.0, 0.0, -4.0, 0.0, 0.0, 0.0, 193.0, 178.0, 0.0, 8.0, 176.0, 0.0, 0.0, 0.0, 0.0, 192.0, 196.0, 172.0, 0.0, 0.0, 167.0, 0.0, -4.0, 0.0, 0.0, 185.0, 125.0, 0.0, 200.0, 149.0, -2.0, -4.0, 156.0, -14.0, 0.0, 146.0, 0.0, 13.0, 0.0, 0.0, 164.0, -52.0, 0.0, 194.0, -16.0, 0.0, 27.0, 0.0, 164.0, 0.0, -36.0, 198.0, 0.0, 0.0, 0.0, 0.0, 4.0, 190.0, 0.0, 24.0, 59.0, 186.0, 200.0, 199.0, 0.0, 0.0, 0.0, 0.0, 160.0, -5.0, 196.0, 190.0, 0.0], "policy_predator_policy_reward": [9.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 21.0, 7.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 75.0, 0.0, 0.0, 0.0, 5.0, 12.0, 0.0, 4.0, 12.0, 1.0, 0.0, 36.0, 40.0, 0.0, 1.0, 31.0, 0.0, 0.0, 29.0, 0.0, 0.0, 4.0, 0.0, 18.0, 1.0, 16.0, 0.0, 15.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 93.0, 8.0, 27.0, 0.0, 17.0, 0.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 12.0, 13.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 2.0, 2.0, 0.0, 0.0, 80.0, 41.0, 0.0, 1.0, 2.0, 0.0, 47.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 64.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 0.0, 4.0, 4.0, 12.0, 9.0, 0.0, 0.0, 0.0, 10.0, 26.0, 0.0, 0.0, 8.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 45.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 66.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0096514284730211, "mean_inference_ms": 3.057616693353582, "mean_action_processing_ms": 0.49705923299877497, "mean_env_wait_ms": 0.3667910007870408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004785060882568359, "StateBufferConnector_ms": 0.005904555320739746, "ViewRequirementAgentConnector_ms": 0.17805063724517822}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -33.0, "episode_return_mean": 144.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.6416124363478, "num_env_steps_trained_throughput_per_sec": 306.6416124363478, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 17484.811, "restore_workers_time_ms": 0.019, "training_step_time_ms": 17484.733, "sample_time_ms": 3719.527, "learn_time_ms": 13740.754, "learn_throughput": 291.105, "synch_weights_time_ms": 21.588}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "f1691_00002", "date": "2024-08-13_19-35-47", "timestamp": 1723592147, "time_this_iter_s": 13.055322170257568, "time_total_s": 4668.94228720665, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ffb9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4668.94228720665, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 59.12105263157895, "ram_util_percent": 74.38947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7893061348094197, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.22370763454172346, "policy_loss": -0.002361248295123457, "vf_loss": 0.22567068280312774, "vf_explained_var": -0.017943278916929133, "kl": 0.014158228806946479, "entropy": 0.7261365021032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.78977596053371, "cur_kl_coeff": 0.0004171371459960936, "cur_lr": 0.00010000000000000003, "total_loss": 5.116312449823612, "policy_loss": -0.004691242984195472, "vf_loss": 5.120995396281046, "vf_explained_var": 0.7077581268769724, "kl": 0.01990316937474663, "entropy": 0.741239251030816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -33.0, "episode_reward_mean": 140.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -56.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 93.0}, "policy_reward_mean": {"prey_policy": 64.315, "predator_policy": 6.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 333.0, -1.0, 138.0, 326.0, 0.0, 178.0, -17.0, 161.0, 184.0, 170.0, 218.0, 189.0, 0.0, 100.0, 189.0, 92.0, -17.0, -3.0, -1.0, 163.0, 0.0, 175.0, 193.0, 312.0, 0.0, 332.0, -5.0, 194.0, 41.0, 91.0, 395.0, -33.0, 181.0, 0.0, 71.0, -1.0, 181.0, 130.0, 386.0, 0.0, 153.0, -2.0, 0.0, 193.0, 178.0, 250.0, 0.0, 0.0, 389.0, 180.0, 167.0, -2.0, 0.0, 311.0, 200.0, 163.0, 167.0, -6.0, 167.0, 13.0, 174.0, -26.0, 186.0, 27.0, 176.0, -16.0, 198.0, 0.0, 4.0, 192.0, 128.0, 390.0, 199.0, 0.0, 170.0, 257.0, 190.0, 185.0, 217.0, 141.0, 189.0, -4.0, 167.0, 198.0, 161.0, 194.0, 0.0, 193.0, 370.0, 194.0, 193.0, 189.0, -7.0, 341.0, 186.0, 174.0, 324.0, 128.0, 360.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 187.0, 113.0, 144.0, 0.0, -2.0, -16.0, 123.0, 106.0, 191.0, 0.0, 0.0, 0.0, 174.0, 0.0, -36.0, -6.0, 151.0, 184.0, -30.0, 0.0, 162.0, 145.0, 73.0, 0.0, 189.0, 0.0, 0.0, 60.0, 0.0, -56.0, 152.0, 57.0, 0.0, -34.0, 0.0, -6.0, 0.0, -2.0, 0.0, 155.0, 0.0, 0.0, 0.0, 175.0, 0.0, 193.0, 0.0, 131.0, 167.0, 0.0, 0.0, 142.0, 165.0, -10.0, 0.0, 0.0, 194.0, 0.0, 31.0, 0.0, 76.0, 200.0, 195.0, -34.0, -16.0, 177.0, 0.0, 0.0, 0.0, -50.0, 0.0, -2.0, 0.0, 179.0, 0.0, 0.0, 41.0, 194.0, 192.0, 0.0, 0.0, 0.0, 148.0, 0.0, -4.0, 0.0, 0.0, 0.0, 193.0, 178.0, 0.0, 8.0, 176.0, 0.0, 0.0, 0.0, 0.0, 192.0, 196.0, 172.0, 0.0, 0.0, 167.0, 0.0, -4.0, 0.0, 0.0, 185.0, 125.0, 0.0, 200.0, 149.0, -2.0, -4.0, 156.0, -14.0, 0.0, 146.0, 0.0, 13.0, 0.0, 0.0, 164.0, -52.0, 0.0, 194.0, -16.0, 0.0, 27.0, 0.0, 164.0, 0.0, -36.0, 198.0, 0.0, 0.0, 0.0, 0.0, 4.0, 190.0, 0.0, 24.0, 59.0, 186.0, 200.0, 199.0, 0.0, 0.0, 0.0, 0.0, 160.0, -5.0, 196.0, 190.0, 0.0, 185.0, 0.0, 26.0, 191.0, -8.0, 127.0, 189.0, 0.0, 0.0, -8.0, 161.0, 0.0, 198.0, 0.0, 0.0, 118.0, 0.0, 194.0, 0.0, 0.0, -8.0, 197.0, 184.0, 180.0, -2.0, 195.0, 0.0, 193.0, 187.0, 0.0, -4.0, -10.0, 157.0, 168.0, 186.0, 0.0, 0.0, 169.0, 154.0, 152.0, 0.0, 93.0, 180.0, 179.0], "policy_predator_policy_reward": [1.0, 0.0, 36.0, 40.0, 0.0, 1.0, 31.0, 0.0, 0.0, 29.0, 0.0, 0.0, 4.0, 0.0, 18.0, 1.0, 16.0, 0.0, 15.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 93.0, 8.0, 27.0, 0.0, 17.0, 0.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 12.0, 13.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 2.0, 2.0, 0.0, 0.0, 80.0, 41.0, 0.0, 1.0, 2.0, 0.0, 47.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 64.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 0.0, 4.0, 4.0, 12.0, 9.0, 0.0, 0.0, 0.0, 10.0, 26.0, 0.0, 0.0, 8.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 45.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 18.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 17.0, 26.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 5.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 2.0, 5.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 3.0, 15.0, 0.0, 35.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0078882290788862, "mean_inference_ms": 3.054542290631465, "mean_action_processing_ms": 0.494701052367233, "mean_env_wait_ms": 0.36663527688088543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004714608192443848, "StateBufferConnector_ms": 0.005861043930053711, "ViewRequirementAgentConnector_ms": 0.17826569080352783}, "num_episodes": 22, "episode_return_max": 395.0, "episode_return_min": -33.0, "episode_return_mean": 140.96, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.9897054175543, "num_env_steps_trained_throughput_per_sec": 313.9897054175543, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 16406.191, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16406.114, "sample_time_ms": 3174.041, "learn_time_ms": 13208.71, "learn_throughput": 302.83, "synch_weights_time_ms": 21.006}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "f1691_00002", "date": "2024-08-13_19-36-00", "timestamp": 1723592160, "time_this_iter_s": 12.746202945709229, "time_total_s": 4681.688490152359, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b4115820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4681.688490152359, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 60.07777777777778, "ram_util_percent": 75.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.596266334275247, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.434614023156267, "policy_loss": -0.001005067898049241, "vf_loss": 0.43530558983166456, "vf_explained_var": 3.283648263840448e-06, "kl": 0.011146683201317616, "entropy": 0.7547893139735732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.33882466693404, "cur_kl_coeff": 0.0004171371459960936, "cur_lr": 0.00010000000000000003, "total_loss": 3.9817957000126913, "policy_loss": -0.0024742243406190366, "vf_loss": 3.9842581906646646, "vf_explained_var": 0.48623832789047683, "kl": 0.028108614811933934, "entropy": 0.8033703367546122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -180.0, "episode_reward_mean": 140.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 64.695, "predator_policy": 5.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -1.0, 163.0, 0.0, 175.0, 193.0, 312.0, 0.0, 332.0, -5.0, 194.0, 41.0, 91.0, 395.0, -33.0, 181.0, 0.0, 71.0, -1.0, 181.0, 130.0, 386.0, 0.0, 153.0, -2.0, 0.0, 193.0, 178.0, 250.0, 0.0, 0.0, 389.0, 180.0, 167.0, -2.0, 0.0, 311.0, 200.0, 163.0, 167.0, -6.0, 167.0, 13.0, 174.0, -26.0, 186.0, 27.0, 176.0, -16.0, 198.0, 0.0, 4.0, 192.0, 128.0, 390.0, 199.0, 0.0, 170.0, 257.0, 190.0, 185.0, 217.0, 141.0, 189.0, -4.0, 167.0, 198.0, 161.0, 194.0, 0.0, 193.0, 370.0, 194.0, 193.0, 189.0, -7.0, 341.0, 186.0, 174.0, 324.0, 128.0, 360.0, 400.0, 170.0, 197.0, -180.0, -4.0, 0.0, 0.0, 156.0, 358.0, 375.0, 334.0, 0.0, 0.0, 189.0, -1.0, 0.0, 0.0, 393.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, -2.0, 0.0, 155.0, 0.0, 0.0, 0.0, 175.0, 0.0, 193.0, 0.0, 131.0, 167.0, 0.0, 0.0, 142.0, 165.0, -10.0, 0.0, 0.0, 194.0, 0.0, 31.0, 0.0, 76.0, 200.0, 195.0, -34.0, -16.0, 177.0, 0.0, 0.0, 0.0, -50.0, 0.0, -2.0, 0.0, 179.0, 0.0, 0.0, 41.0, 194.0, 192.0, 0.0, 0.0, 0.0, 148.0, 0.0, -4.0, 0.0, 0.0, 0.0, 193.0, 178.0, 0.0, 8.0, 176.0, 0.0, 0.0, 0.0, 0.0, 192.0, 196.0, 172.0, 0.0, 0.0, 167.0, 0.0, -4.0, 0.0, 0.0, 185.0, 125.0, 0.0, 200.0, 149.0, -2.0, -4.0, 156.0, -14.0, 0.0, 146.0, 0.0, 13.0, 0.0, 0.0, 164.0, -52.0, 0.0, 194.0, -16.0, 0.0, 27.0, 0.0, 164.0, 0.0, -36.0, 198.0, 0.0, 0.0, 0.0, 0.0, 4.0, 190.0, 0.0, 24.0, 59.0, 186.0, 200.0, 199.0, 0.0, 0.0, 0.0, 0.0, 160.0, -5.0, 196.0, 190.0, 0.0, 185.0, 0.0, 26.0, 191.0, -8.0, 127.0, 189.0, 0.0, 0.0, -8.0, 161.0, 0.0, 198.0, 0.0, 0.0, 118.0, 0.0, 194.0, 0.0, 0.0, -8.0, 197.0, 184.0, 180.0, -2.0, 195.0, 0.0, 193.0, 187.0, 0.0, -4.0, -10.0, 157.0, 168.0, 186.0, 0.0, 0.0, 169.0, 154.0, 152.0, 0.0, 93.0, 180.0, 179.0, 200.0, 200.0, -16.0, 178.0, 197.0, 0.0, -370.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 175.0, 174.0, 172.0, 199.0, 162.0, 155.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 200.0, 193.0], "policy_predator_policy_reward": [0.0, 3.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 0.0, 12.0, 13.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 2.0, 2.0, 0.0, 0.0, 80.0, 41.0, 0.0, 1.0, 2.0, 0.0, 47.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 64.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 0.0, 4.0, 4.0, 12.0, 9.0, 0.0, 0.0, 0.0, 10.0, 26.0, 0.0, 0.0, 8.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 45.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 18.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 17.0, 26.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 5.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 2.0, 5.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 3.0, 15.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 190.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 27.0, 20.0, 0.0, 9.0, 1.0, 3.0, 15.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.007037827811763, "mean_inference_ms": 3.050953126139073, "mean_action_processing_ms": 0.49330476504410714, "mean_env_wait_ms": 0.36566389931938054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583477973937988, "StateBufferConnector_ms": 0.00577700138092041, "ViewRequirementAgentConnector_ms": 0.1759587526321411}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -180.0, "episode_return_mean": 140.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.2222895904243, "num_env_steps_trained_throughput_per_sec": 292.2222895904243, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 15643.462, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15643.385, "sample_time_ms": 2839.45, "learn_time_ms": 12780.983, "learn_throughput": 312.965, "synch_weights_time_ms": 20.713}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "f1691_00002", "date": "2024-08-13_19-36-14", "timestamp": 1723592174, "time_this_iter_s": 13.784616231918335, "time_total_s": 4695.473106384277, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41159d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4695.473106384277, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 59.45789473684209, "ram_util_percent": 77.55263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.160263756540402, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.3988494827318444, "policy_loss": -0.0005130041042027413, "vf_loss": 0.3991586791972319, "vf_explained_var": 0.0036084654785337902, "kl": 0.007246443163036287, "entropy": 0.7645773010279135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.88650053815236, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 4.228686587015788, "policy_loss": -0.0014974081341827673, "vf_loss": 4.230176213809422, "vf_explained_var": 0.7428247602212996, "kl": 0.012437699999753494, "entropy": 0.7943077498958224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -180.0, "episode_reward_mean": 145.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 67.475, "predator_policy": 5.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.0, -2.0, 0.0, 193.0, 178.0, 250.0, 0.0, 0.0, 389.0, 180.0, 167.0, -2.0, 0.0, 311.0, 200.0, 163.0, 167.0, -6.0, 167.0, 13.0, 174.0, -26.0, 186.0, 27.0, 176.0, -16.0, 198.0, 0.0, 4.0, 192.0, 128.0, 390.0, 199.0, 0.0, 170.0, 257.0, 190.0, 185.0, 217.0, 141.0, 189.0, -4.0, 167.0, 198.0, 161.0, 194.0, 0.0, 193.0, 370.0, 194.0, 193.0, 189.0, -7.0, 341.0, 186.0, 174.0, 324.0, 128.0, 360.0, 400.0, 170.0, 197.0, -180.0, -4.0, 0.0, 0.0, 156.0, 358.0, 375.0, 334.0, 0.0, 0.0, 189.0, -1.0, 0.0, 0.0, 393.0, 111.0, 349.0, 393.0, 95.0, 41.0, 182.0, 0.0, 168.0, 194.0, 184.0, 378.0, 0.0, 0.0, 91.0, 169.0, 195.0, 171.0, 191.0, 190.0, -3.0, -4.0, 187.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 148.0, 0.0, -4.0, 0.0, 0.0, 0.0, 193.0, 178.0, 0.0, 8.0, 176.0, 0.0, 0.0, 0.0, 0.0, 192.0, 196.0, 172.0, 0.0, 0.0, 167.0, 0.0, -4.0, 0.0, 0.0, 185.0, 125.0, 0.0, 200.0, 149.0, -2.0, -4.0, 156.0, -14.0, 0.0, 146.0, 0.0, 13.0, 0.0, 0.0, 164.0, -52.0, 0.0, 194.0, -16.0, 0.0, 27.0, 0.0, 164.0, 0.0, -36.0, 198.0, 0.0, 0.0, 0.0, 0.0, 4.0, 190.0, 0.0, 24.0, 59.0, 186.0, 200.0, 199.0, 0.0, 0.0, 0.0, 0.0, 160.0, -5.0, 196.0, 190.0, 0.0, 185.0, 0.0, 26.0, 191.0, -8.0, 127.0, 189.0, 0.0, 0.0, -8.0, 161.0, 0.0, 198.0, 0.0, 0.0, 118.0, 0.0, 194.0, 0.0, 0.0, -8.0, 197.0, 184.0, 180.0, -2.0, 195.0, 0.0, 193.0, 187.0, 0.0, -4.0, -10.0, 157.0, 168.0, 186.0, 0.0, 0.0, 169.0, 154.0, 152.0, 0.0, 93.0, 180.0, 179.0, 200.0, 200.0, -16.0, 178.0, 197.0, 0.0, -370.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 175.0, 174.0, 172.0, 199.0, 162.0, 155.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 200.0, 193.0, 0.0, 104.0, 176.0, 166.0, 193.0, 200.0, 0.0, 24.0, 0.0, -37.0, 175.0, 0.0, 0.0, 0.0, 0.0, 160.0, 0.0, 194.0, 0.0, 184.0, 172.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 169.0, 0.0, 195.0, 0.0, 0.0, 160.0, 0.0, 176.0, 0.0, 190.0, -6.0, 0.0, -8.0, 0.0, 187.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 5.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 64.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 0.0, 4.0, 4.0, 12.0, 9.0, 0.0, 0.0, 0.0, 10.0, 26.0, 0.0, 0.0, 8.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 45.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 18.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 17.0, 26.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 5.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 2.0, 5.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 3.0, 15.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 190.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 27.0, 20.0, 0.0, 9.0, 1.0, 3.0, 15.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 0.0, 28.0, 43.0, 0.0, 78.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0038864815801867, "mean_inference_ms": 3.030144334399799, "mean_action_processing_ms": 0.49078894136627244, "mean_env_wait_ms": 0.3644852451921756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004452705383300781, "StateBufferConnector_ms": 0.004136800765991211, "ViewRequirementAgentConnector_ms": 0.15316486358642578}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -180.0, "episode_return_mean": 145.32, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.28106724395056, "num_env_steps_trained_throughput_per_sec": 246.28106724395056, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 14791.436, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14791.366, "sample_time_ms": 2247.428, "learn_time_ms": 12520.252, "learn_throughput": 319.482, "synch_weights_time_ms": 21.102}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "f1691_00002", "date": "2024-08-13_19-36-31", "timestamp": 1723592191, "time_this_iter_s": 16.338814973831177, "time_total_s": 4711.8119213581085, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4711.8119213581085, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 71.39999999999999, "ram_util_percent": 81.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5585783611056665, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.3161117836714737, "policy_loss": -0.000852107115967012, "vf_loss": 0.31671485222359286, "vf_explained_var": 0.0033921385883654235, "kl": 0.00885470502223321, "entropy": 0.7047968894716293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.865226940187824, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 4.639488144778701, "policy_loss": -0.0027022787039636302, "vf_loss": 4.642178105298804, "vf_explained_var": 0.8171743256705147, "kl": 0.01966947175756334, "entropy": 0.7560545659254467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -180.0, "episode_reward_mean": 148.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 68.995, "predator_policy": 5.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.0, 13.0, 174.0, -26.0, 186.0, 27.0, 176.0, -16.0, 198.0, 0.0, 4.0, 192.0, 128.0, 390.0, 199.0, 0.0, 170.0, 257.0, 190.0, 185.0, 217.0, 141.0, 189.0, -4.0, 167.0, 198.0, 161.0, 194.0, 0.0, 193.0, 370.0, 194.0, 193.0, 189.0, -7.0, 341.0, 186.0, 174.0, 324.0, 128.0, 360.0, 400.0, 170.0, 197.0, -180.0, -4.0, 0.0, 0.0, 156.0, 358.0, 375.0, 334.0, 0.0, 0.0, 189.0, -1.0, 0.0, 0.0, 393.0, 111.0, 349.0, 393.0, 95.0, 41.0, 182.0, 0.0, 168.0, 194.0, 184.0, 378.0, 0.0, 0.0, 91.0, 169.0, 195.0, 171.0, 191.0, 190.0, -3.0, -4.0, 187.0, 0.0, 0.0, 197.0, -14.0, 176.0, 373.0, 384.0, -6.0, -2.0, -5.0, 191.0, 0.0, 141.0, 176.0, 175.0, 335.0, 391.0, 0.0, 185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [146.0, 0.0, 13.0, 0.0, 0.0, 164.0, -52.0, 0.0, 194.0, -16.0, 0.0, 27.0, 0.0, 164.0, 0.0, -36.0, 198.0, 0.0, 0.0, 0.0, 0.0, 4.0, 190.0, 0.0, 24.0, 59.0, 186.0, 200.0, 199.0, 0.0, 0.0, 0.0, 0.0, 160.0, -5.0, 196.0, 190.0, 0.0, 185.0, 0.0, 26.0, 191.0, -8.0, 127.0, 189.0, 0.0, 0.0, -8.0, 161.0, 0.0, 198.0, 0.0, 0.0, 118.0, 0.0, 194.0, 0.0, 0.0, -8.0, 197.0, 184.0, 180.0, -2.0, 195.0, 0.0, 193.0, 187.0, 0.0, -4.0, -10.0, 157.0, 168.0, 186.0, 0.0, 0.0, 169.0, 154.0, 152.0, 0.0, 93.0, 180.0, 179.0, 200.0, 200.0, -16.0, 178.0, 197.0, 0.0, -370.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 175.0, 174.0, 172.0, 199.0, 162.0, 155.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 200.0, 193.0, 0.0, 104.0, 176.0, 166.0, 193.0, 200.0, 0.0, 24.0, 0.0, -37.0, 175.0, 0.0, 0.0, 0.0, 0.0, 160.0, 0.0, 194.0, 0.0, 184.0, 172.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 169.0, 0.0, 195.0, 0.0, 0.0, 160.0, 0.0, 176.0, 0.0, 190.0, -6.0, 0.0, -8.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, -28.0, 0.0, 0.0, 165.0, 185.0, 182.0, 189.0, 195.0, -12.0, 0.0, 0.0, -4.0, -6.0, -2.0, 191.0, 0.0, 0.0, 0.0, -18.0, 142.0, 172.0, 0.0, 0.0, 160.0, 45.0, 199.0, 193.0, 198.0, 0.0, 0.0, -14.0, 192.0], "policy_predator_policy_reward": [12.0, 9.0, 0.0, 0.0, 0.0, 10.0, 26.0, 0.0, 0.0, 8.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 45.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 18.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 17.0, 26.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 5.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 2.0, 5.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 3.0, 15.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 190.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 27.0, 20.0, 0.0, 9.0, 1.0, 3.0, 15.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 0.0, 28.0, 43.0, 0.0, 78.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 7.0, 8.0, 47.0, 44.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0055369110512982, "mean_inference_ms": 3.0465951786726384, "mean_action_processing_ms": 0.49047942879601386, "mean_env_wait_ms": 0.3649678489939564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005849123001098633, "StateBufferConnector_ms": 0.003933429718017578, "ViewRequirementAgentConnector_ms": 0.21620070934295654}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -180.0, "episode_return_mean": 148.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.23570902564734, "num_env_steps_trained_throughput_per_sec": 273.23570902564734, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 14541.238, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14541.171, "sample_time_ms": 2205.313, "learn_time_ms": 12311.415, "learn_throughput": 324.902, "synch_weights_time_ms": 21.361}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "f1691_00002", "date": "2024-08-13_19-36-45", "timestamp": 1723592205, "time_this_iter_s": 14.67472505569458, "time_total_s": 4726.486646413803, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b419cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4726.486646413803, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 66.37619047619047, "ram_util_percent": 83.42857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9889993596999418, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.4647679778397399, "policy_loss": -0.0011828307291522385, "vf_loss": 0.46574897333670395, "vf_explained_var": 0.002973177918681392, "kl": 0.007176379660511634, "entropy": 0.7342864150408084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.46735087273613, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 4.7088460330609925, "policy_loss": -0.0036581665911913784, "vf_loss": 4.712492086773827, "vf_explained_var": 0.8479563073506431, "kl": 0.0193648151528468, "entropy": 0.7797357362098795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -180.0, "episode_reward_mean": 160.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 75.08, "predator_policy": 5.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 185.0, 217.0, 141.0, 189.0, -4.0, 167.0, 198.0, 161.0, 194.0, 0.0, 193.0, 370.0, 194.0, 193.0, 189.0, -7.0, 341.0, 186.0, 174.0, 324.0, 128.0, 360.0, 400.0, 170.0, 197.0, -180.0, -4.0, 0.0, 0.0, 156.0, 358.0, 375.0, 334.0, 0.0, 0.0, 189.0, -1.0, 0.0, 0.0, 393.0, 111.0, 349.0, 393.0, 95.0, 41.0, 182.0, 0.0, 168.0, 194.0, 184.0, 378.0, 0.0, 0.0, 91.0, 169.0, 195.0, 171.0, 191.0, 190.0, -3.0, -4.0, 187.0, 0.0, 0.0, 197.0, -14.0, 176.0, 373.0, 384.0, -6.0, -2.0, -5.0, 191.0, 0.0, 141.0, 176.0, 175.0, 335.0, 391.0, 0.0, 185.0, 384.0, 189.0, 382.0, 6.0, 0.0, 169.0, 343.0, 347.0, 198.0, -1.0, -6.0, 161.0, 185.0, 193.0, 376.0, 307.0, 0.0, 177.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.0, 0.0, 185.0, 0.0, 26.0, 191.0, -8.0, 127.0, 189.0, 0.0, 0.0, -8.0, 161.0, 0.0, 198.0, 0.0, 0.0, 118.0, 0.0, 194.0, 0.0, 0.0, -8.0, 197.0, 184.0, 180.0, -2.0, 195.0, 0.0, 193.0, 187.0, 0.0, -4.0, -10.0, 157.0, 168.0, 186.0, 0.0, 0.0, 169.0, 154.0, 152.0, 0.0, 93.0, 180.0, 179.0, 200.0, 200.0, -16.0, 178.0, 197.0, 0.0, -370.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 175.0, 174.0, 172.0, 199.0, 162.0, 155.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 200.0, 193.0, 0.0, 104.0, 176.0, 166.0, 193.0, 200.0, 0.0, 24.0, 0.0, -37.0, 175.0, 0.0, 0.0, 0.0, 0.0, 160.0, 0.0, 194.0, 0.0, 184.0, 172.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 169.0, 0.0, 195.0, 0.0, 0.0, 160.0, 0.0, 176.0, 0.0, 190.0, -6.0, 0.0, -8.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, -28.0, 0.0, 0.0, 165.0, 185.0, 182.0, 189.0, 195.0, -12.0, 0.0, 0.0, -4.0, -6.0, -2.0, 191.0, 0.0, 0.0, 0.0, -18.0, 142.0, 172.0, 0.0, 0.0, 160.0, 45.0, 199.0, 193.0, 198.0, 0.0, 0.0, -14.0, 192.0, 169.0, 200.0, 189.0, 0.0, 191.0, 188.0, 0.0, 6.0, 0.0, 0.0, 169.0, 0.0, 171.0, 150.0, 143.0, 133.0, 198.0, 0.0, 0.0, -2.0, 0.0, -12.0, 0.0, 156.0, -26.0, 198.0, 0.0, 193.0, 174.0, 196.0, 126.0, 155.0, 0.0, 0.0, 0.0, 167.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 18.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 17.0, 26.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 5.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 2.0, 5.0, 0.0, 16.0, 0.0, 0.0, 5.0, 0.0, 3.0, 15.0, 0.0, 35.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 190.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 27.0, 20.0, 0.0, 9.0, 1.0, 3.0, 15.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 0.0, 28.0, 43.0, 0.0, 78.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 7.0, 8.0, 47.0, 44.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 31.0, 40.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.005016331279734, "mean_inference_ms": 3.0453187767172185, "mean_action_processing_ms": 0.48931746488867317, "mean_env_wait_ms": 0.36456262742557644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005930066108703613, "StateBufferConnector_ms": 0.003771066665649414, "ViewRequirementAgentConnector_ms": 0.19465625286102295}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -180.0, "episode_return_mean": 160.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.4737556891321, "num_env_steps_trained_throughput_per_sec": 322.4737556891321, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 14496.815, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14496.759, "sample_time_ms": 2173.395, "learn_time_ms": 12297.805, "learn_throughput": 325.261, "synch_weights_time_ms": 22.269}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "f1691_00002", "date": "2024-08-13_19-36-58", "timestamp": 1723592218, "time_this_iter_s": 12.450128078460693, "time_total_s": 4738.936774492264, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ffb040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4738.936774492264, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 58.61764705882353, "ram_util_percent": 83.2235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7325589805171289, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.3395565883034751, "policy_loss": -0.00018923543984927828, "vf_loss": 0.3395705618420074, "vf_explained_var": 0.0008505508382484396, "kl": 0.006231500558123832, "entropy": 0.7122173388483664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.068958857261315, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 3.7546319651225257, "policy_loss": -0.0026608037304074045, "vf_loss": 3.7572833825671483, "vf_explained_var": 0.8624397465791652, "kl": 0.01499418064762168, "entropy": 0.8217514166440913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -180.0, "episode_reward_mean": 153.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 71.845, "predator_policy": 4.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 400.0, 170.0, 197.0, -180.0, -4.0, 0.0, 0.0, 156.0, 358.0, 375.0, 334.0, 0.0, 0.0, 189.0, -1.0, 0.0, 0.0, 393.0, 111.0, 349.0, 393.0, 95.0, 41.0, 182.0, 0.0, 168.0, 194.0, 184.0, 378.0, 0.0, 0.0, 91.0, 169.0, 195.0, 171.0, 191.0, 190.0, -3.0, -4.0, 187.0, 0.0, 0.0, 197.0, -14.0, 176.0, 373.0, 384.0, -6.0, -2.0, -5.0, 191.0, 0.0, 141.0, 176.0, 175.0, 335.0, 391.0, 0.0, 185.0, 384.0, 189.0, 382.0, 6.0, 0.0, 169.0, 343.0, 347.0, 198.0, -1.0, -6.0, 161.0, 185.0, 193.0, 376.0, 307.0, 0.0, 177.0, 198.0, 194.0, 180.0, 187.0, 374.0, 161.0, 0.0, -8.0, 0.0, 205.0, 160.0, -7.0, 172.0, -19.0, 171.0, -4.0, 0.0, 189.0, 353.0, 348.0, 368.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.0, 179.0, 200.0, 200.0, -16.0, 178.0, 197.0, 0.0, -370.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 175.0, 174.0, 172.0, 199.0, 162.0, 155.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 200.0, 193.0, 0.0, 104.0, 176.0, 166.0, 193.0, 200.0, 0.0, 24.0, 0.0, -37.0, 175.0, 0.0, 0.0, 0.0, 0.0, 160.0, 0.0, 194.0, 0.0, 184.0, 172.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 169.0, 0.0, 195.0, 0.0, 0.0, 160.0, 0.0, 176.0, 0.0, 190.0, -6.0, 0.0, -8.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, -28.0, 0.0, 0.0, 165.0, 185.0, 182.0, 189.0, 195.0, -12.0, 0.0, 0.0, -4.0, -6.0, -2.0, 191.0, 0.0, 0.0, 0.0, -18.0, 142.0, 172.0, 0.0, 0.0, 160.0, 45.0, 199.0, 193.0, 198.0, 0.0, 0.0, -14.0, 192.0, 169.0, 200.0, 189.0, 0.0, 191.0, 188.0, 0.0, 6.0, 0.0, 0.0, 169.0, 0.0, 171.0, 150.0, 143.0, 133.0, 198.0, 0.0, 0.0, -2.0, 0.0, -12.0, 0.0, 156.0, -26.0, 198.0, 0.0, 193.0, 174.0, 196.0, 126.0, 155.0, 0.0, 0.0, 0.0, 167.0, 0.0, 198.0, 194.0, 0.0, 172.0, 0.0, 0.0, 185.0, 195.0, 168.0, 0.0, 148.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 200.0, 5.0, -4.0, 162.0, -14.0, 0.0, 0.0, 172.0, -34.0, -4.0, 0.0, 163.0, 0.0, -8.0, 0.0, 0.0, 0.0, 189.0, 172.0, 176.0, 124.0, 200.0, 172.0, 192.0, 0.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 190.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 27.0, 20.0, 0.0, 9.0, 1.0, 3.0, 15.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 0.0, 28.0, 43.0, 0.0, 78.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 7.0, 8.0, 47.0, 44.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 31.0, 40.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 1.0, 10.0, 0.0, 13.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 17.0, 2.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 24.0, 0.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0047399942518105, "mean_inference_ms": 3.044648173666222, "mean_action_processing_ms": 0.4880401182609313, "mean_env_wait_ms": 0.36411308642360624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007183194160461426, "StateBufferConnector_ms": 0.004240989685058594, "ViewRequirementAgentConnector_ms": 0.21901428699493408}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -180.0, "episode_return_mean": 153.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.5040152559246, "num_env_steps_trained_throughput_per_sec": 320.5040152559246, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 14460.859, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14460.804, "sample_time_ms": 2223.745, "learn_time_ms": 12212.785, "learn_throughput": 327.526, "synch_weights_time_ms": 21.009}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "f1691_00002", "date": "2024-08-13_19-37-10", "timestamp": 1723592230, "time_this_iter_s": 12.522987127304077, "time_total_s": 4751.459761619568, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3ffbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4751.459761619568, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 56.011111111111106, "ram_util_percent": 83.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4876131865792173, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.29862230391729444, "policy_loss": -0.0004131852774806912, "vf_loss": 0.29886115747941266, "vf_explained_var": -0.0032558610830357468, "kl": 0.006198467269863973, "entropy": 0.7315565780357078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.618505985711614, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 4.268032487864216, "policy_loss": -0.0033296683340003253, "vf_loss": 4.2713518905891945, "vf_explained_var": 0.8474307795050283, "kl": 0.0164041441967327, "entropy": 0.7066290491472477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -19.0, "episode_reward_mean": 155.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -37.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": 73.52, "predator_policy": 4.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.0, 111.0, 349.0, 393.0, 95.0, 41.0, 182.0, 0.0, 168.0, 194.0, 184.0, 378.0, 0.0, 0.0, 91.0, 169.0, 195.0, 171.0, 191.0, 190.0, -3.0, -4.0, 187.0, 0.0, 0.0, 197.0, -14.0, 176.0, 373.0, 384.0, -6.0, -2.0, -5.0, 191.0, 0.0, 141.0, 176.0, 175.0, 335.0, 391.0, 0.0, 185.0, 384.0, 189.0, 382.0, 6.0, 0.0, 169.0, 343.0, 347.0, 198.0, -1.0, -6.0, 161.0, 185.0, 193.0, 376.0, 307.0, 0.0, 177.0, 198.0, 194.0, 180.0, 187.0, 374.0, 161.0, 0.0, -8.0, 0.0, 205.0, 160.0, -7.0, 172.0, -19.0, 171.0, -4.0, 0.0, 189.0, 353.0, 348.0, 368.0, 0.0, 0.0, 186.0, 200.0, 385.0, 358.0, 0.0, 191.0, 0.0, 180.0, -3.0, 0.0, 196.0, 196.0, 167.0, 0.0, 182.0, 119.0, 193.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 193.0, 0.0, 104.0, 176.0, 166.0, 193.0, 200.0, 0.0, 24.0, 0.0, -37.0, 175.0, 0.0, 0.0, 0.0, 0.0, 160.0, 0.0, 194.0, 0.0, 184.0, 172.0, 189.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 169.0, 0.0, 195.0, 0.0, 0.0, 160.0, 0.0, 176.0, 0.0, 190.0, -6.0, 0.0, -8.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, -28.0, 0.0, 0.0, 165.0, 185.0, 182.0, 189.0, 195.0, -12.0, 0.0, 0.0, -4.0, -6.0, -2.0, 191.0, 0.0, 0.0, 0.0, -18.0, 142.0, 172.0, 0.0, 0.0, 160.0, 45.0, 199.0, 193.0, 198.0, 0.0, 0.0, -14.0, 192.0, 169.0, 200.0, 189.0, 0.0, 191.0, 188.0, 0.0, 6.0, 0.0, 0.0, 169.0, 0.0, 171.0, 150.0, 143.0, 133.0, 198.0, 0.0, 0.0, -2.0, 0.0, -12.0, 0.0, 156.0, -26.0, 198.0, 0.0, 193.0, 174.0, 196.0, 126.0, 155.0, 0.0, 0.0, 0.0, 167.0, 0.0, 198.0, 194.0, 0.0, 172.0, 0.0, 0.0, 185.0, 195.0, 168.0, 0.0, 148.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 200.0, 5.0, -4.0, 162.0, -14.0, 0.0, 0.0, 172.0, -34.0, -4.0, 0.0, 163.0, 0.0, -8.0, 0.0, 0.0, 0.0, 189.0, 172.0, 176.0, 124.0, 200.0, 172.0, 192.0, 0.0, 0.0, 0.0, 0.0, -14.0, 193.0, 200.0, 0.0, 196.0, 188.0, 169.0, 169.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 196.0, 196.0, 0.0, 152.0, 0.0, 0.0, 0.0, 0.0, 182.0, 41.0, -6.0, -2.0, 194.0], "policy_predator_policy_reward": [0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 0.0, 28.0, 43.0, 0.0, 78.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 7.0, 8.0, 47.0, 44.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 31.0, 40.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 1.0, 10.0, 0.0, 13.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 17.0, 2.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 24.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 38.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0045066434799799, "mean_inference_ms": 3.0446146191983297, "mean_action_processing_ms": 0.4870230151373805, "mean_env_wait_ms": 0.3638828443833874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007221341133117676, "StateBufferConnector_ms": 0.004252314567565918, "ViewRequirementAgentConnector_ms": 0.22138774394989014}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -19.0, "episode_return_mean": 155.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.23033784212384, "num_env_steps_trained_throughput_per_sec": 294.23033784212384, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 14332.742, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14332.698, "sample_time_ms": 2214.378, "learn_time_ms": 12095.33, "learn_throughput": 330.706, "synch_weights_time_ms": 19.667}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "f1691_00002", "date": "2024-08-13_19-37-24", "timestamp": 1723592244, "time_this_iter_s": 13.651419878005981, "time_total_s": 4765.111181497574, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41f8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4765.111181497574, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 61.23499999999999, "ram_util_percent": 83.685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8798718513556258, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.6928793072858185, "policy_loss": -0.0023517817386953287, "vf_loss": 0.6950249196833403, "vf_explained_var": 0.00034885841702658033, "kl": 0.007330382504692916, "entropy": 0.6650347731416187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.7484098034561, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 5.357321636765091, "policy_loss": -0.001259163202023104, "vf_loss": 5.358570551998401, "vf_explained_var": 0.7543856131021308, "kl": 0.016381513087910166, "entropy": 0.7061603998380994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -19.0, "episode_reward_mean": 161.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -93.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 74.985, "predator_policy": 5.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 197.0, -14.0, 176.0, 373.0, 384.0, -6.0, -2.0, -5.0, 191.0, 0.0, 141.0, 176.0, 175.0, 335.0, 391.0, 0.0, 185.0, 384.0, 189.0, 382.0, 6.0, 0.0, 169.0, 343.0, 347.0, 198.0, -1.0, -6.0, 161.0, 185.0, 193.0, 376.0, 307.0, 0.0, 177.0, 198.0, 194.0, 180.0, 187.0, 374.0, 161.0, 0.0, -8.0, 0.0, 205.0, 160.0, -7.0, 172.0, -19.0, 171.0, -4.0, 0.0, 189.0, 353.0, 348.0, 368.0, 0.0, 0.0, 186.0, 200.0, 385.0, 358.0, 0.0, 191.0, 0.0, 180.0, -3.0, 0.0, 196.0, 196.0, 167.0, 0.0, 182.0, 119.0, 193.0, 164.0, 191.0, 139.0, 182.0, 386.0, 158.0, 0.0, 0.0, 100.0, 360.0, 143.0, 391.0, 171.0, 389.0, 168.0, 282.0, 257.0, 147.0, 116.0, 152.0, -4.0, 387.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 197.0, -28.0, 0.0, 0.0, 165.0, 185.0, 182.0, 189.0, 195.0, -12.0, 0.0, 0.0, -4.0, -6.0, -2.0, 191.0, 0.0, 0.0, 0.0, -18.0, 142.0, 172.0, 0.0, 0.0, 160.0, 45.0, 199.0, 193.0, 198.0, 0.0, 0.0, -14.0, 192.0, 169.0, 200.0, 189.0, 0.0, 191.0, 188.0, 0.0, 6.0, 0.0, 0.0, 169.0, 0.0, 171.0, 150.0, 143.0, 133.0, 198.0, 0.0, 0.0, -2.0, 0.0, -12.0, 0.0, 156.0, -26.0, 198.0, 0.0, 193.0, 174.0, 196.0, 126.0, 155.0, 0.0, 0.0, 0.0, 167.0, 0.0, 198.0, 194.0, 0.0, 172.0, 0.0, 0.0, 185.0, 195.0, 168.0, 0.0, 148.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 200.0, 5.0, -4.0, 162.0, -14.0, 0.0, 0.0, 172.0, -34.0, -4.0, 0.0, 163.0, 0.0, -8.0, 0.0, 0.0, 0.0, 189.0, 172.0, 176.0, 124.0, 200.0, 172.0, 192.0, 0.0, 0.0, 0.0, 0.0, -14.0, 193.0, 200.0, 0.0, 196.0, 188.0, 169.0, 169.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 196.0, 196.0, 0.0, 152.0, 0.0, 0.0, 0.0, 0.0, 182.0, 41.0, -6.0, -2.0, 194.0, 151.0, 0.0, 191.0, 0.0, 83.0, 0.0, 0.0, 182.0, 193.0, 193.0, 137.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, -76.0, 174.0, 186.0, 0.0, 117.0, 199.0, 192.0, 159.0, 0.0, 198.0, 191.0, 0.0, 168.0, 189.0, 41.0, 186.0, -93.0, -4.0, 124.0, 78.0, 0.0, 80.0, -2.0, -10.0, 0.0, 192.0, 195.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 7.0, 8.0, 47.0, 44.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 31.0, 40.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 1.0, 10.0, 0.0, 13.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 17.0, 2.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 24.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 38.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 27.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 41.0, 20.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 73.0, 91.0, 1.0, 26.0, 38.0, 0.0, 38.0, 36.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0044001096584132, "mean_inference_ms": 3.047664984069119, "mean_action_processing_ms": 0.4861361764936057, "mean_env_wait_ms": 0.36377343121819417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008525848388671875, "StateBufferConnector_ms": 0.006338834762573242, "ViewRequirementAgentConnector_ms": 0.22661685943603516}, "num_episodes": 23, "episode_return_max": 391.0, "episode_return_min": -19.0, "episode_return_mean": 161.58, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.89314264730837, "num_env_steps_trained_throughput_per_sec": 259.89314264730837, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 14004.872, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14004.827, "sample_time_ms": 2327.038, "learn_time_ms": 11655.13, "learn_throughput": 343.197, "synch_weights_time_ms": 19.217}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "f1691_00002", "date": "2024-08-13_19-37-40", "timestamp": 1723592260, "time_this_iter_s": 15.437119960784912, "time_total_s": 4780.548301458359, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4780.548301458359, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 83.42727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.306556225229035, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.27076549375892944, "policy_loss": -0.0014964243818429254, "vf_loss": 0.2721426344194533, "vf_explained_var": 0.011313233362934577, "kl": 0.004241196660933639, "entropy": 0.6583040733186025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.010392406945506, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 0.00010000000000000003, "total_loss": 4.3616253769586955, "policy_loss": -0.0032592123381734368, "vf_loss": 4.364868605830682, "vf_explained_var": 0.869037912194691, "kl": 0.025528579043538155, "entropy": 0.7068091149998721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -19.0, "episode_reward_mean": 164.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -93.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 76.855, "predator_policy": 5.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 384.0, 189.0, 382.0, 6.0, 0.0, 169.0, 343.0, 347.0, 198.0, -1.0, -6.0, 161.0, 185.0, 193.0, 376.0, 307.0, 0.0, 177.0, 198.0, 194.0, 180.0, 187.0, 374.0, 161.0, 0.0, -8.0, 0.0, 205.0, 160.0, -7.0, 172.0, -19.0, 171.0, -4.0, 0.0, 189.0, 353.0, 348.0, 368.0, 0.0, 0.0, 186.0, 200.0, 385.0, 358.0, 0.0, 191.0, 0.0, 180.0, -3.0, 0.0, 196.0, 196.0, 167.0, 0.0, 182.0, 119.0, 193.0, 164.0, 191.0, 139.0, 182.0, 386.0, 158.0, 0.0, 0.0, 100.0, 360.0, 143.0, 391.0, 171.0, 389.0, 168.0, 282.0, 257.0, 147.0, 116.0, 152.0, -4.0, 387.0, 0.0, 183.0, 359.0, 0.0, -6.0, 192.0, -6.0, 173.0, -1.0, 154.0, 359.0, 167.0, -16.0, 178.0, 386.0, 186.0, 166.0, 178.0, 196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 192.0, 169.0, 200.0, 189.0, 0.0, 191.0, 188.0, 0.0, 6.0, 0.0, 0.0, 169.0, 0.0, 171.0, 150.0, 143.0, 133.0, 198.0, 0.0, 0.0, -2.0, 0.0, -12.0, 0.0, 156.0, -26.0, 198.0, 0.0, 193.0, 174.0, 196.0, 126.0, 155.0, 0.0, 0.0, 0.0, 167.0, 0.0, 198.0, 194.0, 0.0, 172.0, 0.0, 0.0, 185.0, 195.0, 168.0, 0.0, 148.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 200.0, 5.0, -4.0, 162.0, -14.0, 0.0, 0.0, 172.0, -34.0, -4.0, 0.0, 163.0, 0.0, -8.0, 0.0, 0.0, 0.0, 189.0, 172.0, 176.0, 124.0, 200.0, 172.0, 192.0, 0.0, 0.0, 0.0, 0.0, -14.0, 193.0, 200.0, 0.0, 196.0, 188.0, 169.0, 169.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 196.0, 196.0, 0.0, 152.0, 0.0, 0.0, 0.0, 0.0, 182.0, 41.0, -6.0, -2.0, 194.0, 151.0, 0.0, 191.0, 0.0, 83.0, 0.0, 0.0, 182.0, 193.0, 193.0, 137.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, -76.0, 174.0, 186.0, 0.0, 117.0, 199.0, 192.0, 159.0, 0.0, 198.0, 191.0, 0.0, 168.0, 189.0, 41.0, 186.0, -93.0, -4.0, 124.0, 78.0, 0.0, 80.0, -2.0, -10.0, 0.0, 192.0, 195.0, 0.0, 0.0, 186.0, -6.0, 191.0, 163.0, 0.0, 0.0, -12.0, 0.0, 196.0, -8.0, -10.0, -2.0, 173.0, 0.0, -4.0, 0.0, 138.0, 0.0, 179.0, 170.0, 186.0, -62.0, 0.0, -32.0, 178.0, 0.0, 190.0, 195.0, 0.0, 186.0, 162.0, -14.0, 0.0, 178.0, 196.0, 0.0], "policy_predator_policy_reward": [7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 31.0, 40.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 1.0, 10.0, 0.0, 13.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 17.0, 2.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 24.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 38.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 27.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 41.0, 20.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 73.0, 91.0, 1.0, 26.0, 38.0, 0.0, 38.0, 36.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 1.0, 2.0, 0.0, 16.0, 10.0, 0.0, 12.0, 31.0, 0.0, 16.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0032621750486868, "mean_inference_ms": 3.0459114991360523, "mean_action_processing_ms": 0.484855494010184, "mean_env_wait_ms": 0.36326251571633206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006971955299377441, "StateBufferConnector_ms": 0.006061196327209473, "ViewRequirementAgentConnector_ms": 0.162949800491333}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -19.0, "episode_return_mean": 164.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.9766791115662, "num_env_steps_trained_throughput_per_sec": 299.9766791115662, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 13755.765, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13755.718, "sample_time_ms": 2235.272, "learn_time_ms": 11497.044, "learn_throughput": 347.916, "synch_weights_time_ms": 19.39}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "f1691_00002", "date": "2024-08-13_19-37-53", "timestamp": 1723592273, "time_this_iter_s": 13.398463010787964, "time_total_s": 4793.946764469147, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f95550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4793.946764469147, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 62.431578947368415, "ram_util_percent": 82.90526315789472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4225946480437877, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12545328370132852, "policy_loss": 0.0002031679775211073, "vf_loss": 0.12512639748990761, "vf_explained_var": -0.017359485828056537, "kl": 0.008797761946720467, "entropy": 0.6988374419628628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.95224407649545, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 0.00010000000000000003, "total_loss": 5.286675050018957, "policy_loss": -0.002038332445192195, "vf_loss": 5.2887041573802, "vf_explained_var": 0.869283005737123, "kl": 0.009832885253461663, "entropy": 0.6566320892679628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -19.0, "episode_reward_mean": 166.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -93.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 77.98, "predator_policy": 5.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.0, 374.0, 161.0, 0.0, -8.0, 0.0, 205.0, 160.0, -7.0, 172.0, -19.0, 171.0, -4.0, 0.0, 189.0, 353.0, 348.0, 368.0, 0.0, 0.0, 186.0, 200.0, 385.0, 358.0, 0.0, 191.0, 0.0, 180.0, -3.0, 0.0, 196.0, 196.0, 167.0, 0.0, 182.0, 119.0, 193.0, 164.0, 191.0, 139.0, 182.0, 386.0, 158.0, 0.0, 0.0, 100.0, 360.0, 143.0, 391.0, 171.0, 389.0, 168.0, 282.0, 257.0, 147.0, 116.0, 152.0, -4.0, 387.0, 0.0, 183.0, 359.0, 0.0, -6.0, 192.0, -6.0, 173.0, -1.0, 154.0, 359.0, 167.0, -16.0, 178.0, 386.0, 186.0, 166.0, 178.0, 196.0, 158.0, 383.0, -6.0, 156.0, 371.0, 359.0, 166.0, -1.0, 157.0, 23.0, 391.0, -2.0, 186.0, -19.0, 192.0, 375.0, 180.0, 178.0, 195.0, 171.0, 378.0, 368.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 185.0, 195.0, 168.0, 0.0, 148.0, 0.0, 0.0, -6.0, -10.0, 0.0, 0.0, 200.0, 5.0, -4.0, 162.0, -14.0, 0.0, 0.0, 172.0, -34.0, -4.0, 0.0, 163.0, 0.0, -8.0, 0.0, 0.0, 0.0, 189.0, 172.0, 176.0, 124.0, 200.0, 172.0, 192.0, 0.0, 0.0, 0.0, 0.0, -14.0, 193.0, 200.0, 0.0, 196.0, 188.0, 169.0, 169.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 196.0, 196.0, 0.0, 152.0, 0.0, 0.0, 0.0, 0.0, 182.0, 41.0, -6.0, -2.0, 194.0, 151.0, 0.0, 191.0, 0.0, 83.0, 0.0, 0.0, 182.0, 193.0, 193.0, 137.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, -76.0, 174.0, 186.0, 0.0, 117.0, 199.0, 192.0, 159.0, 0.0, 198.0, 191.0, 0.0, 168.0, 189.0, 41.0, 186.0, -93.0, -4.0, 124.0, 78.0, 0.0, 80.0, -2.0, -10.0, 0.0, 192.0, 195.0, 0.0, 0.0, 186.0, -6.0, 191.0, 163.0, 0.0, 0.0, -12.0, 0.0, 196.0, -8.0, -10.0, -2.0, 173.0, 0.0, -4.0, 0.0, 138.0, 0.0, 179.0, 170.0, 186.0, -62.0, 0.0, -32.0, 178.0, 0.0, 190.0, 195.0, 0.0, 186.0, 162.0, -14.0, 0.0, 178.0, 196.0, 0.0, 0.0, 110.0, 187.0, 196.0, 0.0, -12.0, 146.0, -16.0, 177.0, 191.0, 179.0, 167.0, 150.0, 0.0, -2.0, 0.0, -4.0, 150.0, 0.0, 22.0, 195.0, 196.0, 0.0, -4.0, 188.0, -4.0, -18.0, -10.0, 0.0, 192.0, 178.0, 190.0, 0.0, 180.0, 182.0, -8.0, 0.0, 195.0, 164.0, 0.0, 192.0, 182.0, 190.0, 178.0], "policy_predator_policy_reward": [2.0, 0.0, 1.0, 10.0, 0.0, 13.0, 0.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 0.0, 17.0, 2.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 24.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 38.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 27.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 41.0, 20.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 73.0, 91.0, 1.0, 26.0, 38.0, 0.0, 38.0, 36.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 1.0, 2.0, 0.0, 16.0, 10.0, 0.0, 12.0, 31.0, 0.0, 16.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 26.0, 22.0, 0.0, 0.0, 0.0, 6.0, 6.0, 20.0, 1.0, 2.0, 5.0, 8.0, 8.0, 8.0, 1.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 1.0, 1.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.002870417244958, "mean_inference_ms": 3.04824185171512, "mean_action_processing_ms": 0.4836722141881901, "mean_env_wait_ms": 0.3633819953975835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00704801082611084, "StateBufferConnector_ms": 0.0062934160232543945, "ViewRequirementAgentConnector_ms": 0.15298640727996826}, "num_episodes": 22, "episode_return_max": 391.0, "episode_return_min": -19.0, "episode_return_mean": 166.86, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.89298541511516, "num_env_steps_trained_throughput_per_sec": 223.89298541511516, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 14237.878, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14237.831, "sample_time_ms": 2356.039, "learn_time_ms": 11858.474, "learn_throughput": 337.312, "synch_weights_time_ms": 19.319}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "f1691_00002", "date": "2024-08-13_19-38-11", "timestamp": 1723592291, "time_this_iter_s": 17.89186978340149, "time_total_s": 4811.838634252548, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4811.838634252548, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 87.99600000000001, "ram_util_percent": 83.14399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5344053021853878, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.32176988043640026, "policy_loss": -0.0011891572194164077, "vf_loss": 0.322864840774755, "vf_explained_var": 0.02385056044058825, "kl": 0.006698428307762395, "entropy": 0.5941786463929232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.687998838210234, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 0.00010000000000000003, "total_loss": 5.067040582813283, "policy_loss": -0.002586227384144588, "vf_loss": 5.069620544948275, "vf_explained_var": 0.8759076299490752, "kl": 0.006697325514177528, "entropy": 0.624613474443476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -19.0, "episode_reward_mean": 173.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -93.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 80.685, "predator_policy": 5.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 186.0, 200.0, 385.0, 358.0, 0.0, 191.0, 0.0, 180.0, -3.0, 0.0, 196.0, 196.0, 167.0, 0.0, 182.0, 119.0, 193.0, 164.0, 191.0, 139.0, 182.0, 386.0, 158.0, 0.0, 0.0, 100.0, 360.0, 143.0, 391.0, 171.0, 389.0, 168.0, 282.0, 257.0, 147.0, 116.0, 152.0, -4.0, 387.0, 0.0, 183.0, 359.0, 0.0, -6.0, 192.0, -6.0, 173.0, -1.0, 154.0, 359.0, 167.0, -16.0, 178.0, 386.0, 186.0, 166.0, 178.0, 196.0, 158.0, 383.0, -6.0, 156.0, 371.0, 359.0, 166.0, -1.0, 157.0, 23.0, 391.0, -2.0, 186.0, -19.0, 192.0, 375.0, 180.0, 178.0, 195.0, 171.0, 378.0, 368.0, 177.0, 152.0, 346.0, 155.0, 175.0, 0.0, 131.0, -5.0, 170.0, 351.0, 145.0, 196.0, -3.0, 379.0, 390.0, 195.0, 180.0, 165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -14.0, 193.0, 200.0, 0.0, 196.0, 188.0, 169.0, 169.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 196.0, 196.0, 0.0, 152.0, 0.0, 0.0, 0.0, 0.0, 182.0, 41.0, -6.0, -2.0, 194.0, 151.0, 0.0, 191.0, 0.0, 83.0, 0.0, 0.0, 182.0, 193.0, 193.0, 137.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, -76.0, 174.0, 186.0, 0.0, 117.0, 199.0, 192.0, 159.0, 0.0, 198.0, 191.0, 0.0, 168.0, 189.0, 41.0, 186.0, -93.0, -4.0, 124.0, 78.0, 0.0, 80.0, -2.0, -10.0, 0.0, 192.0, 195.0, 0.0, 0.0, 186.0, -6.0, 191.0, 163.0, 0.0, 0.0, -12.0, 0.0, 196.0, -8.0, -10.0, -2.0, 173.0, 0.0, -4.0, 0.0, 138.0, 0.0, 179.0, 170.0, 186.0, -62.0, 0.0, -32.0, 178.0, 0.0, 190.0, 195.0, 0.0, 186.0, 162.0, -14.0, 0.0, 178.0, 196.0, 0.0, 0.0, 110.0, 187.0, 196.0, 0.0, -12.0, 146.0, -16.0, 177.0, 191.0, 179.0, 167.0, 150.0, 0.0, -2.0, 0.0, -4.0, 150.0, 0.0, 22.0, 195.0, 196.0, 0.0, -4.0, 188.0, -4.0, -18.0, -10.0, 0.0, 192.0, 178.0, 190.0, 0.0, 180.0, 182.0, -8.0, 0.0, 195.0, 164.0, 0.0, 192.0, 182.0, 190.0, 178.0, 162.0, -28.0, -26.0, 152.0, 158.0, 179.0, 0.0, 116.0, 0.0, 162.0, 0.0, 0.0, -8.0, 107.0, 0.0, -10.0, 167.0, 0.0, 197.0, 154.0, 0.0, 123.0, 0.0, 196.0, -6.0, 0.0, 200.0, 170.0, 196.0, 194.0, 195.0, 0.0, 180.0, 0.0, -18.0, 172.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 38.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 27.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 41.0, 20.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 73.0, 91.0, 1.0, 26.0, 38.0, 0.0, 38.0, 36.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 1.0, 2.0, 0.0, 16.0, 10.0, 0.0, 12.0, 31.0, 0.0, 16.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 26.0, 22.0, 0.0, 0.0, 0.0, 6.0, 6.0, 20.0, 1.0, 2.0, 5.0, 8.0, 8.0, 8.0, 1.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 1.0, 1.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 2.0, 0.0, 0.0, 20.0, 23.0, 15.0, 11.0, 0.0, 9.0, 20.0, 19.0, 7.0, 6.0, 0.0, 0.0, 32.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.002902847915749, "mean_inference_ms": 3.0484903416255986, "mean_action_processing_ms": 0.48298158365264543, "mean_env_wait_ms": 0.36276211514188456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006468415260314941, "StateBufferConnector_ms": 0.006312131881713867, "ViewRequirementAgentConnector_ms": 0.14549803733825684}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -19.0, "episode_return_mean": 173.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.57399211603655, "num_env_steps_trained_throughput_per_sec": 326.57399211603655, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 14188.789, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14188.742, "sample_time_ms": 2321.815, "learn_time_ms": 11843.828, "learn_throughput": 337.729, "synch_weights_time_ms": 19.111}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "f1691_00002", "date": "2024-08-13_19-38-23", "timestamp": 1723592303, "time_this_iter_s": 12.25423288345337, "time_total_s": 4824.092867136002, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41c11f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4824.092867136002, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 55.22941176470589, "ram_util_percent": 76.77058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5215555168924824, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.21951094093540358, "policy_loss": 7.387803332811152e-05, "vf_loss": 0.21935501699348192, "vf_explained_var": 0.003261364673180555, "kl": 0.005834347283646697, "entropy": 0.5999596920278337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.26634353771412, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 0.00010000000000000003, "total_loss": 4.5202520598810185, "policy_loss": -0.000856321210179616, "vf_loss": 4.5211017860937375, "vf_explained_var": 0.9122610444745058, "kl": 0.007025649292823174, "entropy": 0.6445040445163768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -19.0, "episode_reward_mean": 181.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -93.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 91.0}, "policy_reward_mean": {"prey_policy": 84.755, "predator_policy": 5.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.0, 158.0, 0.0, 0.0, 100.0, 360.0, 143.0, 391.0, 171.0, 389.0, 168.0, 282.0, 257.0, 147.0, 116.0, 152.0, -4.0, 387.0, 0.0, 183.0, 359.0, 0.0, -6.0, 192.0, -6.0, 173.0, -1.0, 154.0, 359.0, 167.0, -16.0, 178.0, 386.0, 186.0, 166.0, 178.0, 196.0, 158.0, 383.0, -6.0, 156.0, 371.0, 359.0, 166.0, -1.0, 157.0, 23.0, 391.0, -2.0, 186.0, -19.0, 192.0, 375.0, 180.0, 178.0, 195.0, 171.0, 378.0, 368.0, 177.0, 152.0, 346.0, 155.0, 175.0, 0.0, 131.0, -5.0, 170.0, 351.0, 145.0, 196.0, -3.0, 379.0, 390.0, 195.0, 180.0, 165.0, 192.0, 0.0, 170.0, 0.0, 180.0, 148.0, 358.0, 167.0, 365.0, 384.0, -15.0, -6.0, 382.0, 0.0, 188.0, 183.0, 199.0, 384.0, 0.0, -3.0, 0.0, 391.0, 345.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.0, 193.0, 137.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, -76.0, 174.0, 186.0, 0.0, 117.0, 199.0, 192.0, 159.0, 0.0, 198.0, 191.0, 0.0, 168.0, 189.0, 41.0, 186.0, -93.0, -4.0, 124.0, 78.0, 0.0, 80.0, -2.0, -10.0, 0.0, 192.0, 195.0, 0.0, 0.0, 186.0, -6.0, 191.0, 163.0, 0.0, 0.0, -12.0, 0.0, 196.0, -8.0, -10.0, -2.0, 173.0, 0.0, -4.0, 0.0, 138.0, 0.0, 179.0, 170.0, 186.0, -62.0, 0.0, -32.0, 178.0, 0.0, 190.0, 195.0, 0.0, 186.0, 162.0, -14.0, 0.0, 178.0, 196.0, 0.0, 0.0, 110.0, 187.0, 196.0, 0.0, -12.0, 146.0, -16.0, 177.0, 191.0, 179.0, 167.0, 150.0, 0.0, -2.0, 0.0, -4.0, 150.0, 0.0, 22.0, 195.0, 196.0, 0.0, -4.0, 188.0, -4.0, -18.0, -10.0, 0.0, 192.0, 178.0, 190.0, 0.0, 180.0, 182.0, -8.0, 0.0, 195.0, 164.0, 0.0, 192.0, 182.0, 190.0, 178.0, 162.0, -28.0, -26.0, 152.0, 158.0, 179.0, 0.0, 116.0, 0.0, 162.0, 0.0, 0.0, -8.0, 107.0, 0.0, -10.0, 167.0, 0.0, 197.0, 154.0, 0.0, 123.0, 0.0, 196.0, -6.0, 0.0, 200.0, 170.0, 196.0, 194.0, 195.0, 0.0, 180.0, 0.0, -18.0, 172.0, 0.0, 188.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, -20.0, 188.0, 0.0, 76.0, 177.0, 170.0, 0.0, 154.0, 160.0, 193.0, 186.0, 198.0, -30.0, 0.0, -12.0, 0.0, 200.0, 182.0, 0.0, 0.0, 0.0, 188.0, 182.0, 0.0, 0.0, 199.0, 199.0, 179.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 196.0, 195.0, 125.0, 196.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 41.0, 20.0, 0.0, 0.0, 0.0, 26.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 73.0, 91.0, 1.0, 26.0, 38.0, 0.0, 38.0, 36.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 1.0, 2.0, 0.0, 16.0, 10.0, 0.0, 12.0, 31.0, 0.0, 16.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 26.0, 22.0, 0.0, 0.0, 0.0, 6.0, 6.0, 20.0, 1.0, 2.0, 5.0, 8.0, 8.0, 8.0, 1.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 1.0, 1.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 2.0, 0.0, 0.0, 20.0, 23.0, 15.0, 11.0, 0.0, 9.0, 20.0, 19.0, 7.0, 6.0, 0.0, 0.0, 32.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 2.0, 38.0, 34.0, 11.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9994234157354924, "mean_inference_ms": 3.0298660709617473, "mean_action_processing_ms": 0.4809146913579334, "mean_env_wait_ms": 0.3614737367108565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068416595458984375, "StateBufferConnector_ms": 0.006284952163696289, "ViewRequirementAgentConnector_ms": 0.14333558082580566}, "num_episodes": 23, "episode_return_max": 391.0, "episode_return_min": -19.0, "episode_return_mean": 181.21, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.68434893537193, "num_env_steps_trained_throughput_per_sec": 308.68434893537193, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 14115.79, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14115.743, "sample_time_ms": 2277.608, "learn_time_ms": 11816.324, "learn_throughput": 338.515, "synch_weights_time_ms": 17.976}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "f1691_00002", "date": "2024-08-13_19-38-36", "timestamp": 1723592316, "time_this_iter_s": 12.978114128112793, "time_total_s": 4837.070981264114, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41c1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4837.070981264114, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 57.03157894736843, "ram_util_percent": 76.15789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8547862623931555, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.46585592740269566, "policy_loss": -5.3862404945508515e-05, "vf_loss": 0.465812958131277, "vf_explained_var": 0.01011151980470728, "kl": 0.0068857398770055265, "entropy": 0.5854646328580443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.09402662988693, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 0.00010000000000000003, "total_loss": 4.750613420476358, "policy_loss": -0.0011079332846704692, "vf_loss": 4.751714636156799, "vf_explained_var": 0.9117963790578186, "kl": 0.007151774950138365, "entropy": 0.6342370340748439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -19.0, "episode_reward_mean": 180.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -62.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 85.39, "predator_policy": 4.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 183.0, 359.0, 0.0, -6.0, 192.0, -6.0, 173.0, -1.0, 154.0, 359.0, 167.0, -16.0, 178.0, 386.0, 186.0, 166.0, 178.0, 196.0, 158.0, 383.0, -6.0, 156.0, 371.0, 359.0, 166.0, -1.0, 157.0, 23.0, 391.0, -2.0, 186.0, -19.0, 192.0, 375.0, 180.0, 178.0, 195.0, 171.0, 378.0, 368.0, 177.0, 152.0, 346.0, 155.0, 175.0, 0.0, 131.0, -5.0, 170.0, 351.0, 145.0, 196.0, -3.0, 379.0, 390.0, 195.0, 180.0, 165.0, 192.0, 0.0, 170.0, 0.0, 180.0, 148.0, 358.0, 167.0, 365.0, 384.0, -15.0, -6.0, 382.0, 0.0, 188.0, 183.0, 199.0, 384.0, 0.0, -3.0, 0.0, 391.0, 345.0, 383.0, 126.0, 186.0, 382.0, -9.0, 200.0, 382.0, 188.0, 283.0, 337.0, 0.0, 155.0, 354.0, 168.0, 0.0, 0.0, 176.0, 175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 186.0, -6.0, 191.0, 163.0, 0.0, 0.0, -12.0, 0.0, 196.0, -8.0, -10.0, -2.0, 173.0, 0.0, -4.0, 0.0, 138.0, 0.0, 179.0, 170.0, 186.0, -62.0, 0.0, -32.0, 178.0, 0.0, 190.0, 195.0, 0.0, 186.0, 162.0, -14.0, 0.0, 178.0, 196.0, 0.0, 0.0, 110.0, 187.0, 196.0, 0.0, -12.0, 146.0, -16.0, 177.0, 191.0, 179.0, 167.0, 150.0, 0.0, -2.0, 0.0, -4.0, 150.0, 0.0, 22.0, 195.0, 196.0, 0.0, -4.0, 188.0, -4.0, -18.0, -10.0, 0.0, 192.0, 178.0, 190.0, 0.0, 180.0, 182.0, -8.0, 0.0, 195.0, 164.0, 0.0, 192.0, 182.0, 190.0, 178.0, 162.0, -28.0, -26.0, 152.0, 158.0, 179.0, 0.0, 116.0, 0.0, 162.0, 0.0, 0.0, -8.0, 107.0, 0.0, -10.0, 167.0, 0.0, 197.0, 154.0, 0.0, 123.0, 0.0, 196.0, -6.0, 0.0, 200.0, 170.0, 196.0, 194.0, 195.0, 0.0, 180.0, 0.0, -18.0, 172.0, 0.0, 188.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, -20.0, 188.0, 0.0, 76.0, 177.0, 170.0, 0.0, 154.0, 160.0, 193.0, 186.0, 198.0, -30.0, 0.0, -12.0, 0.0, 200.0, 182.0, 0.0, 0.0, 0.0, 188.0, 182.0, 0.0, 0.0, 199.0, 199.0, 179.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 196.0, 195.0, 125.0, 196.0, 174.0, 200.0, 89.0, 0.0, 186.0, 0.0, 200.0, 173.0, -6.0, -10.0, 0.0, 200.0, 185.0, 191.0, 188.0, 0.0, 183.0, 29.0, 137.0, 179.0, 0.0, 0.0, 147.0, -10.0, 164.0, 178.0, 151.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 175.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 1.0, 2.0, 0.0, 16.0, 10.0, 0.0, 12.0, 31.0, 0.0, 16.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 26.0, 22.0, 0.0, 0.0, 0.0, 6.0, 6.0, 20.0, 1.0, 2.0, 5.0, 8.0, 8.0, 8.0, 1.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 1.0, 1.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 2.0, 0.0, 0.0, 20.0, 23.0, 15.0, 11.0, 0.0, 9.0, 20.0, 19.0, 7.0, 6.0, 0.0, 0.0, 32.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 2.0, 38.0, 34.0, 11.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 16.0, 3.0, 6.0, 0.0, 37.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 51.0, 20.0, 0.0, 21.0, 0.0, 0.0, 13.0, 5.0, 8.0, 4.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9999123324326067, "mean_inference_ms": 3.0425548345788034, "mean_action_processing_ms": 0.48019080990073243, "mean_env_wait_ms": 0.3613142919937012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006680011749267578, "StateBufferConnector_ms": 0.004135847091674805, "ViewRequirementAgentConnector_ms": 0.13242590427398682}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -19.0, "episode_return_mean": 180.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.7854089182157, "num_env_steps_trained_throughput_per_sec": 286.7854089182157, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 13886.4, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13886.351, "sample_time_ms": 2198.116, "learn_time_ms": 11666.133, "learn_throughput": 342.873, "synch_weights_time_ms": 18.756}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "f1691_00002", "date": "2024-08-13_19-38-50", "timestamp": 1723592330, "time_this_iter_s": 14.01062798500061, "time_total_s": 4851.081609249115, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdbaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4851.081609249115, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 63.085, "ram_util_percent": 76.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2257987533750199, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.26916154255233116, "policy_loss": -0.0004986963932101847, "vf_loss": 0.2695925973761992, "vf_explained_var": -0.004520625727517265, "kl": 0.004810054485533612, "entropy": 0.5917034282255424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.97907895360675, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 0.00010000000000000003, "total_loss": 4.866683056619432, "policy_loss": -0.0005689181750837378, "vf_loss": 4.867248870329882, "vf_explained_var": 0.9003320153743501, "kl": 0.0033050347801024324, "entropy": 0.6056200290483141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -19.0, "episode_reward_mean": 190.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -30.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 90.385, "predator_policy": 4.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.0, 158.0, 383.0, -6.0, 156.0, 371.0, 359.0, 166.0, -1.0, 157.0, 23.0, 391.0, -2.0, 186.0, -19.0, 192.0, 375.0, 180.0, 178.0, 195.0, 171.0, 378.0, 368.0, 177.0, 152.0, 346.0, 155.0, 175.0, 0.0, 131.0, -5.0, 170.0, 351.0, 145.0, 196.0, -3.0, 379.0, 390.0, 195.0, 180.0, 165.0, 192.0, 0.0, 170.0, 0.0, 180.0, 148.0, 358.0, 167.0, 365.0, 384.0, -15.0, -6.0, 382.0, 0.0, 188.0, 183.0, 199.0, 384.0, 0.0, -3.0, 0.0, 391.0, 345.0, 383.0, 126.0, 186.0, 382.0, -9.0, 200.0, 382.0, 188.0, 283.0, 337.0, 0.0, 155.0, 354.0, 168.0, 0.0, 0.0, 176.0, 175.0, 0.0, 163.0, 365.0, 356.0, 391.0, 394.0, 164.0, 127.0, 193.0, 180.0, 0.0, 200.0, 195.0, 173.0, 178.0, 196.0, 180.0, 197.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [196.0, 0.0, 0.0, 110.0, 187.0, 196.0, 0.0, -12.0, 146.0, -16.0, 177.0, 191.0, 179.0, 167.0, 150.0, 0.0, -2.0, 0.0, -4.0, 150.0, 0.0, 22.0, 195.0, 196.0, 0.0, -4.0, 188.0, -4.0, -18.0, -10.0, 0.0, 192.0, 178.0, 190.0, 0.0, 180.0, 182.0, -8.0, 0.0, 195.0, 164.0, 0.0, 192.0, 182.0, 190.0, 178.0, 162.0, -28.0, -26.0, 152.0, 158.0, 179.0, 0.0, 116.0, 0.0, 162.0, 0.0, 0.0, -8.0, 107.0, 0.0, -10.0, 167.0, 0.0, 197.0, 154.0, 0.0, 123.0, 0.0, 196.0, -6.0, 0.0, 200.0, 170.0, 196.0, 194.0, 195.0, 0.0, 180.0, 0.0, -18.0, 172.0, 0.0, 188.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, -20.0, 188.0, 0.0, 76.0, 177.0, 170.0, 0.0, 154.0, 160.0, 193.0, 186.0, 198.0, -30.0, 0.0, -12.0, 0.0, 200.0, 182.0, 0.0, 0.0, 0.0, 188.0, 182.0, 0.0, 0.0, 199.0, 199.0, 179.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 196.0, 195.0, 125.0, 196.0, 174.0, 200.0, 89.0, 0.0, 186.0, 0.0, 200.0, 173.0, -6.0, -10.0, 0.0, 200.0, 185.0, 191.0, 188.0, 0.0, 183.0, 29.0, 137.0, 179.0, 0.0, 0.0, 147.0, -10.0, 164.0, 178.0, 151.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 175.0, 0.0, 0.0, 0.0, 148.0, 0.0, 155.0, 195.0, 159.0, 185.0, 194.0, 197.0, 199.0, 195.0, 0.0, 149.0, 0.0, 80.0, 193.0, 0.0, 187.0, -14.0, 0.0, 0.0, 197.0, 3.0, -10.0, 200.0, 0.0, 167.0, 0.0, 172.0, 0.0, 196.0, -2.0, 178.0, 0.0, 197.0], "policy_predator_policy_reward": [0.0, 0.0, 26.0, 22.0, 0.0, 0.0, 0.0, 6.0, 6.0, 20.0, 1.0, 2.0, 5.0, 8.0, 8.0, 8.0, 1.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 1.0, 1.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 2.0, 0.0, 0.0, 20.0, 23.0, 15.0, 11.0, 0.0, 9.0, 20.0, 19.0, 7.0, 6.0, 0.0, 0.0, 32.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 2.0, 38.0, 34.0, 11.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 16.0, 3.0, 6.0, 0.0, 37.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 51.0, 20.0, 0.0, 21.0, 0.0, 0.0, 13.0, 5.0, 8.0, 4.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 40.0, 7.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9982092603968108, "mean_inference_ms": 3.0391427193335123, "mean_action_processing_ms": 0.47882819224478146, "mean_env_wait_ms": 0.3606174520425951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010742902755737305, "StateBufferConnector_ms": 0.00414586067199707, "ViewRequirementAgentConnector_ms": 0.14146006107330322}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -19.0, "episode_return_mean": 190.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.85858840440335, "num_env_steps_trained_throughput_per_sec": 276.85858840440335, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 13867.244, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13867.182, "sample_time_ms": 2087.878, "learn_time_ms": 11757.404, "learn_throughput": 340.211, "synch_weights_time_ms": 19.124}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "f1691_00002", "date": "2024-08-13_19-39-05", "timestamp": 1723592345, "time_this_iter_s": 14.502917766571045, "time_total_s": 4865.584527015686, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3fdbb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4865.584527015686, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 70.71999999999998, "ram_util_percent": 77.07500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4013679881043062, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.30555490016858416, "policy_loss": -0.002623270918176603, "vf_loss": 0.30806911915219476, "vf_explained_var": 0.004279447264141507, "kl": 0.01550965614557484, "entropy": 0.5767825016584346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 97.31059158125882, "cur_kl_coeff": 0.00046927928924560535, "cur_lr": 0.00010000000000000003, "total_loss": 3.5902079994716343, "policy_loss": -0.0018377188463798827, "vf_loss": 3.59203928399969, "vf_explained_var": 0.9231869233033013, "kl": 0.013691408901670157, "entropy": 0.6380558291440288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -15.0, "episode_reward_mean": 189.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -30.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 89.57, "predator_policy": 5.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [368.0, 177.0, 152.0, 346.0, 155.0, 175.0, 0.0, 131.0, -5.0, 170.0, 351.0, 145.0, 196.0, -3.0, 379.0, 390.0, 195.0, 180.0, 165.0, 192.0, 0.0, 170.0, 0.0, 180.0, 148.0, 358.0, 167.0, 365.0, 384.0, -15.0, -6.0, 382.0, 0.0, 188.0, 183.0, 199.0, 384.0, 0.0, -3.0, 0.0, 391.0, 345.0, 383.0, 126.0, 186.0, 382.0, -9.0, 200.0, 382.0, 188.0, 283.0, 337.0, 0.0, 155.0, 354.0, 168.0, 0.0, 0.0, 176.0, 175.0, 0.0, 163.0, 365.0, 356.0, 391.0, 394.0, 164.0, 127.0, 193.0, 180.0, 0.0, 200.0, 195.0, 173.0, 178.0, 196.0, 180.0, 197.0, 387.0, 169.0, 0.0, 361.0, 179.0, 178.0, 374.0, 152.0, 170.0, 7.0, 345.0, 190.0, 188.0, 145.0, 175.0, 0.0, 395.0, -4.0, 325.0, 173.0, 189.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.0, 178.0, 162.0, -28.0, -26.0, 152.0, 158.0, 179.0, 0.0, 116.0, 0.0, 162.0, 0.0, 0.0, -8.0, 107.0, 0.0, -10.0, 167.0, 0.0, 197.0, 154.0, 0.0, 123.0, 0.0, 196.0, -6.0, 0.0, 200.0, 170.0, 196.0, 194.0, 195.0, 0.0, 180.0, 0.0, -18.0, 172.0, 0.0, 188.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, -20.0, 188.0, 0.0, 76.0, 177.0, 170.0, 0.0, 154.0, 160.0, 193.0, 186.0, 198.0, -30.0, 0.0, -12.0, 0.0, 200.0, 182.0, 0.0, 0.0, 0.0, 188.0, 182.0, 0.0, 0.0, 199.0, 199.0, 179.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 196.0, 195.0, 125.0, 196.0, 174.0, 200.0, 89.0, 0.0, 186.0, 0.0, 200.0, 173.0, -6.0, -10.0, 0.0, 200.0, 185.0, 191.0, 188.0, 0.0, 183.0, 29.0, 137.0, 179.0, 0.0, 0.0, 147.0, -10.0, 164.0, 178.0, 151.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 175.0, 0.0, 0.0, 0.0, 148.0, 0.0, 155.0, 195.0, 159.0, 185.0, 194.0, 197.0, 199.0, 195.0, 0.0, 149.0, 0.0, 80.0, 193.0, 0.0, 187.0, -14.0, 0.0, 0.0, 197.0, 3.0, -10.0, 200.0, 0.0, 167.0, 0.0, 172.0, 0.0, 196.0, -2.0, 178.0, 0.0, 197.0, 188.0, 197.0, 165.0, 0.0, 0.0, 0.0, 195.0, 131.0, 0.0, 172.0, 178.0, 0.0, 188.0, 177.0, 0.0, 128.0, -10.0, 163.0, 7.0, 0.0, 167.0, 166.0, -26.0, 195.0, -6.0, 191.0, 80.0, 0.0, 0.0, 175.0, 0.0, 0.0, 195.0, 200.0, -16.0, 0.0, 126.0, 177.0, 173.0, 0.0, 190.0, -2.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 20.0, 23.0, 15.0, 11.0, 0.0, 9.0, 20.0, 19.0, 7.0, 6.0, 0.0, 0.0, 32.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 2.0, 38.0, 34.0, 11.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 16.0, 3.0, 6.0, 0.0, 37.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 51.0, 20.0, 0.0, 21.0, 0.0, 0.0, 13.0, 5.0, 8.0, 4.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 40.0, 7.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 21.0, 14.0, 4.0, 3.0, 0.0, 0.0, 3.0, 6.0, 24.0, 0.0, 5.0, 12.0, 0.0, 0.0, 0.0, 12.0, 9.0, 12.0, 0.0, 3.0, 40.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9966714496727537, "mean_inference_ms": 3.033858804311245, "mean_action_processing_ms": 0.4770974360544986, "mean_env_wait_ms": 0.3597291320172753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011532783508300781, "StateBufferConnector_ms": 0.004375100135803223, "ViewRequirementAgentConnector_ms": 0.15948498249053955}, "num_episodes": 22, "episode_return_max": 395.0, "episode_return_min": -15.0, "episode_return_mean": 189.15, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.9020662438718, "num_env_steps_trained_throughput_per_sec": 224.9020662438718, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 14405.386, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14405.319, "sample_time_ms": 2219.562, "learn_time_ms": 12164.79, "learn_throughput": 328.818, "synch_weights_time_ms": 18.248}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "f1691_00002", "date": "2024-08-13_19-39-23", "timestamp": 1723592363, "time_this_iter_s": 17.87364101409912, "time_total_s": 4883.458168029785, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41f8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4883.458168029785, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 88.62692307692308, "ram_util_percent": 82.51153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.455289345104543, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.45895034146529656, "policy_loss": -0.0028714719637439995, "vf_loss": 0.4617463155320683, "vf_explained_var": 0.0045356288158073625, "kl": 0.010737368027568618, "entropy": 0.6187939546726368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.60464311816074, "cur_kl_coeff": 0.00046927928924560535, "cur_lr": 0.00010000000000000003, "total_loss": 3.6120775549500075, "policy_loss": -0.0025749581789588014, "vf_loss": 3.6146498590550094, "vf_explained_var": 0.8805474478100973, "kl": 0.005661562552708417, "entropy": 0.6901723260601992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -15.0, "episode_reward_mean": 184.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 82.0}, "policy_reward_mean": {"prey_policy": 86.93, "predator_policy": 5.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.0, 192.0, 0.0, 170.0, 0.0, 180.0, 148.0, 358.0, 167.0, 365.0, 384.0, -15.0, -6.0, 382.0, 0.0, 188.0, 183.0, 199.0, 384.0, 0.0, -3.0, 0.0, 391.0, 345.0, 383.0, 126.0, 186.0, 382.0, -9.0, 200.0, 382.0, 188.0, 283.0, 337.0, 0.0, 155.0, 354.0, 168.0, 0.0, 0.0, 176.0, 175.0, 0.0, 163.0, 365.0, 356.0, 391.0, 394.0, 164.0, 127.0, 193.0, 180.0, 0.0, 200.0, 195.0, 173.0, 178.0, 196.0, 180.0, 197.0, 387.0, 169.0, 0.0, 361.0, 179.0, 178.0, 374.0, 152.0, 170.0, 7.0, 345.0, 190.0, 188.0, 145.0, 175.0, 0.0, 395.0, -4.0, 325.0, 173.0, 189.0, 0.0, 0.0, 152.0, 192.0, 156.0, 177.0, 274.0, 189.0, 180.0, 168.0, 192.0, 153.0, 194.0, 0.0, 75.0, 200.0, 194.0, 380.0, 193.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, 172.0, 0.0, 188.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, -20.0, 188.0, 0.0, 76.0, 177.0, 170.0, 0.0, 154.0, 160.0, 193.0, 186.0, 198.0, -30.0, 0.0, -12.0, 0.0, 200.0, 182.0, 0.0, 0.0, 0.0, 188.0, 182.0, 0.0, 0.0, 199.0, 199.0, 179.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 196.0, 195.0, 125.0, 196.0, 174.0, 200.0, 89.0, 0.0, 186.0, 0.0, 200.0, 173.0, -6.0, -10.0, 0.0, 200.0, 185.0, 191.0, 188.0, 0.0, 183.0, 29.0, 137.0, 179.0, 0.0, 0.0, 147.0, -10.0, 164.0, 178.0, 151.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 175.0, 0.0, 0.0, 0.0, 148.0, 0.0, 155.0, 195.0, 159.0, 185.0, 194.0, 197.0, 199.0, 195.0, 0.0, 149.0, 0.0, 80.0, 193.0, 0.0, 187.0, -14.0, 0.0, 0.0, 197.0, 3.0, -10.0, 200.0, 0.0, 167.0, 0.0, 172.0, 0.0, 196.0, -2.0, 178.0, 0.0, 197.0, 188.0, 197.0, 165.0, 0.0, 0.0, 0.0, 195.0, 131.0, 0.0, 172.0, 178.0, 0.0, 188.0, 177.0, 0.0, 128.0, -10.0, 163.0, 7.0, 0.0, 167.0, 166.0, -26.0, 195.0, -6.0, 191.0, 80.0, 0.0, 0.0, 175.0, 0.0, 0.0, 195.0, 200.0, -16.0, 0.0, 126.0, 177.0, 173.0, 0.0, 190.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 192.0, 0.0, 144.0, 0.0, 184.0, -14.0, 128.0, 102.0, 0.0, 189.0, 0.0, 178.0, 151.0, 0.0, 188.0, 0.0, -2.0, 131.0, 194.0, 0.0, 0.0, 0.0, -4.0, -79.0, 0.0, 200.0, -18.0, 200.0, 180.0, 200.0, 193.0, 0.0], "policy_predator_policy_reward": [2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 2.0, 38.0, 34.0, 11.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 16.0, 3.0, 6.0, 0.0, 37.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 51.0, 20.0, 0.0, 21.0, 0.0, 0.0, 13.0, 5.0, 8.0, 4.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 40.0, 7.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 21.0, 14.0, 4.0, 3.0, 0.0, 0.0, 3.0, 6.0, 24.0, 0.0, 5.0, 12.0, 0.0, 0.0, 0.0, 12.0, 9.0, 12.0, 0.0, 3.0, 40.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 13.0, 31.0, 0.0, 0.0, 1.0, 1.0, 10.0, 7.0, 0.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 76.0, 82.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9964216214873907, "mean_inference_ms": 3.0338563549613706, "mean_action_processing_ms": 0.4762592635747578, "mean_env_wait_ms": 0.3595951161868534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469050884246826, "StateBufferConnector_ms": 0.004668116569519043, "ViewRequirementAgentConnector_ms": 0.2033693790435791}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -15.0, "episode_return_mean": 184.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.36807946660974, "num_env_steps_trained_throughput_per_sec": 277.36807946660974, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 14599.479, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14599.37, "sample_time_ms": 2335.833, "learn_time_ms": 12242.436, "learn_throughput": 326.732, "synch_weights_time_ms": 18.354}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "f1691_00002", "date": "2024-08-13_19-39-37", "timestamp": 1723592377, "time_this_iter_s": 14.436079978942871, "time_total_s": 4897.894248008728, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b37c8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4897.894248008728, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 63.53500000000001, "ram_util_percent": 79.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4733037492664403, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.5892528779607601, "policy_loss": -0.0007594131145172965, "vf_loss": 0.5899596012320626, "vf_explained_var": 0.011022849719991129, "kl": 0.007493874524706559, "entropy": 0.5821313628128597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.33688215698514, "cur_kl_coeff": 0.00046927928924560535, "cur_lr": 0.00010000000000000003, "total_loss": 4.308731209033381, "policy_loss": -0.002565644227372354, "vf_loss": 4.311289197931845, "vf_explained_var": 0.8658629330377731, "kl": 0.016295770130523003, "entropy": 0.7000964188386524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -9.0, "episode_reward_mean": 192.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 82.0}, "policy_reward_mean": {"prey_policy": 90.385, "predator_policy": 5.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.0, 383.0, 126.0, 186.0, 382.0, -9.0, 200.0, 382.0, 188.0, 283.0, 337.0, 0.0, 155.0, 354.0, 168.0, 0.0, 0.0, 176.0, 175.0, 0.0, 163.0, 365.0, 356.0, 391.0, 394.0, 164.0, 127.0, 193.0, 180.0, 0.0, 200.0, 195.0, 173.0, 178.0, 196.0, 180.0, 197.0, 387.0, 169.0, 0.0, 361.0, 179.0, 178.0, 374.0, 152.0, 170.0, 7.0, 345.0, 190.0, 188.0, 145.0, 175.0, 0.0, 395.0, -4.0, 325.0, 173.0, 189.0, 0.0, 0.0, 152.0, 192.0, 156.0, 177.0, 274.0, 189.0, 180.0, 168.0, 192.0, 153.0, 194.0, 0.0, 75.0, 200.0, 194.0, 380.0, 193.0, 170.0, 379.0, 333.0, 355.0, 0.0, 387.0, 365.0, -9.0, 0.0, 0.0, 42.0, -7.0, 358.0, 171.0, 200.0, 180.0, 176.0, 196.0, 181.0, 363.0, 387.0, 180.0, 199.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [125.0, 196.0, 174.0, 200.0, 89.0, 0.0, 186.0, 0.0, 200.0, 173.0, -6.0, -10.0, 0.0, 200.0, 185.0, 191.0, 188.0, 0.0, 183.0, 29.0, 137.0, 179.0, 0.0, 0.0, 147.0, -10.0, 164.0, 178.0, 151.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 175.0, 0.0, 0.0, 0.0, 148.0, 0.0, 155.0, 195.0, 159.0, 185.0, 194.0, 197.0, 199.0, 195.0, 0.0, 149.0, 0.0, 80.0, 193.0, 0.0, 187.0, -14.0, 0.0, 0.0, 197.0, 3.0, -10.0, 200.0, 0.0, 167.0, 0.0, 172.0, 0.0, 196.0, -2.0, 178.0, 0.0, 197.0, 188.0, 197.0, 165.0, 0.0, 0.0, 0.0, 195.0, 131.0, 0.0, 172.0, 178.0, 0.0, 188.0, 177.0, 0.0, 128.0, -10.0, 163.0, 7.0, 0.0, 167.0, 166.0, -26.0, 195.0, -6.0, 191.0, 80.0, 0.0, 0.0, 175.0, 0.0, 0.0, 195.0, 200.0, -16.0, 0.0, 126.0, 177.0, 173.0, 0.0, 190.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 192.0, 0.0, 144.0, 0.0, 184.0, -14.0, 128.0, 102.0, 0.0, 189.0, 0.0, 178.0, 151.0, 0.0, 188.0, 0.0, -2.0, 131.0, 194.0, 0.0, 0.0, 0.0, -4.0, -79.0, 0.0, 200.0, -18.0, 200.0, 180.0, 200.0, 193.0, 0.0, 165.0, 0.0, 198.0, 181.0, 128.0, 176.0, 193.0, 144.0, 0.0, 0.0, 200.0, 181.0, 173.0, 179.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, 0.0, -14.0, 165.0, 176.0, 0.0, 151.0, 0.0, 200.0, -20.0, 188.0, 179.0, -6.0, 0.0, 196.0, 165.0, 0.0, 175.0, 175.0, 200.0, 181.0, 0.0, 180.0, 199.0, 0.0], "policy_predator_policy_reward": [8.0, 16.0, 3.0, 6.0, 0.0, 37.0, 0.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 51.0, 20.0, 0.0, 21.0, 0.0, 0.0, 13.0, 5.0, 8.0, 4.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 40.0, 7.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 21.0, 14.0, 4.0, 3.0, 0.0, 0.0, 3.0, 6.0, 24.0, 0.0, 5.0, 12.0, 0.0, 0.0, 0.0, 12.0, 9.0, 12.0, 0.0, 3.0, 40.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 13.0, 31.0, 0.0, 0.0, 1.0, 1.0, 10.0, 7.0, 0.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 76.0, 82.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 29.0, 10.0, 8.0, 0.0, 0.0, 0.0, 6.0, 7.0, 6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 79.0, 7.0, 0.0, 9.0, 8.0, 10.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 3.0, 0.0, 0.0, 10.0, 6.0, 0.0, 13.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9963571037216212, "mean_inference_ms": 3.035327779154351, "mean_action_processing_ms": 0.47533721817168534, "mean_env_wait_ms": 0.3595631338279803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0243222713470459, "StateBufferConnector_ms": 0.004812955856323242, "ViewRequirementAgentConnector_ms": 0.21228134632110596}, "num_episodes": 23, "episode_return_max": 395.0, "episode_return_min": -9.0, "episode_return_mean": 192.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.78533709872545, "num_env_steps_trained_throughput_per_sec": 268.78533709872545, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 14728.176, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14728.068, "sample_time_ms": 2340.205, "learn_time_ms": 12367.578, "learn_throughput": 323.426, "synch_weights_time_ms": 17.835}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "f1691_00002", "date": "2024-08-13_19-39-52", "timestamp": 1723592392, "time_this_iter_s": 14.920276880264282, "time_total_s": 4912.814524888992, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b425ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4912.814524888992, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 63.22272727272729, "ram_util_percent": 76.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.240286647794502, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.19882681381657089, "policy_loss": -0.0011396694197886126, "vf_loss": 0.19986611375557173, "vf_explained_var": -0.03770040853944405, "kl": 0.014274749252619432, "entropy": 0.5483962182014708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.67263484284992, "cur_kl_coeff": 0.00046927928924560535, "cur_lr": 0.00010000000000000003, "total_loss": 3.114842845964684, "policy_loss": -0.0023574981115026664, "vf_loss": 3.1171962262461426, "vf_explained_var": 0.9092658978606027, "kl": 0.008795184391476054, "entropy": 0.66086150269029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -9.0, "episode_reward_mean": 184.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 82.0}, "policy_reward_mean": {"prey_policy": 86.57, "predator_policy": 5.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 0.0, 163.0, 365.0, 356.0, 391.0, 394.0, 164.0, 127.0, 193.0, 180.0, 0.0, 200.0, 195.0, 173.0, 178.0, 196.0, 180.0, 197.0, 387.0, 169.0, 0.0, 361.0, 179.0, 178.0, 374.0, 152.0, 170.0, 7.0, 345.0, 190.0, 188.0, 145.0, 175.0, 0.0, 395.0, -4.0, 325.0, 173.0, 189.0, 0.0, 0.0, 152.0, 192.0, 156.0, 177.0, 274.0, 189.0, 180.0, 168.0, 192.0, 153.0, 194.0, 0.0, 75.0, 200.0, 194.0, 380.0, 193.0, 170.0, 379.0, 333.0, 355.0, 0.0, 387.0, 365.0, -9.0, 0.0, 0.0, 42.0, -7.0, 358.0, 171.0, 200.0, 180.0, 176.0, 196.0, 181.0, 363.0, 387.0, 180.0, 199.0, 353.0, 0.0, -5.0, 167.0, 390.0, 0.0, 179.0, 162.0, 380.0, 169.0, 180.0, 179.0, 327.0, -9.0, -5.0, 0.0, 162.0, 172.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [175.0, 0.0, 0.0, 0.0, 148.0, 0.0, 155.0, 195.0, 159.0, 185.0, 194.0, 197.0, 199.0, 195.0, 0.0, 149.0, 0.0, 80.0, 193.0, 0.0, 187.0, -14.0, 0.0, 0.0, 197.0, 3.0, -10.0, 200.0, 0.0, 167.0, 0.0, 172.0, 0.0, 196.0, -2.0, 178.0, 0.0, 197.0, 188.0, 197.0, 165.0, 0.0, 0.0, 0.0, 195.0, 131.0, 0.0, 172.0, 178.0, 0.0, 188.0, 177.0, 0.0, 128.0, -10.0, 163.0, 7.0, 0.0, 167.0, 166.0, -26.0, 195.0, -6.0, 191.0, 80.0, 0.0, 0.0, 175.0, 0.0, 0.0, 195.0, 200.0, -16.0, 0.0, 126.0, 177.0, 173.0, 0.0, 190.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 133.0, 192.0, 0.0, 144.0, 0.0, 184.0, -14.0, 128.0, 102.0, 0.0, 189.0, 0.0, 178.0, 151.0, 0.0, 188.0, 0.0, -2.0, 131.0, 194.0, 0.0, 0.0, 0.0, -4.0, -79.0, 0.0, 200.0, -18.0, 200.0, 180.0, 200.0, 193.0, 0.0, 165.0, 0.0, 198.0, 181.0, 128.0, 176.0, 193.0, 144.0, 0.0, 0.0, 200.0, 181.0, 173.0, 179.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, 0.0, -14.0, 165.0, 176.0, 0.0, 151.0, 0.0, 200.0, -20.0, 188.0, 179.0, -6.0, 0.0, 196.0, 165.0, 0.0, 175.0, 175.0, 200.0, 181.0, 0.0, 180.0, 199.0, 0.0, 183.0, 151.0, 0.0, 0.0, -24.0, 0.0, 167.0, 0.0, 196.0, 192.0, 0.0, 0.0, 0.0, 165.0, 153.0, -2.0, 189.0, 191.0, 0.0, 163.0, 182.0, -8.0, 171.0, 0.0, 131.0, 140.0, -18.0, 0.0, -10.0, 0.0, 0.0, 0.0, 170.0, -16.0, -12.0, 178.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 40.0, 7.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 21.0, 14.0, 4.0, 3.0, 0.0, 0.0, 3.0, 6.0, 24.0, 0.0, 5.0, 12.0, 0.0, 0.0, 0.0, 12.0, 9.0, 12.0, 0.0, 3.0, 40.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 22.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 13.0, 31.0, 0.0, 0.0, 1.0, 1.0, 10.0, 7.0, 0.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 76.0, 82.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 29.0, 10.0, 8.0, 0.0, 0.0, 0.0, 6.0, 7.0, 6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 79.0, 7.0, 0.0, 9.0, 8.0, 10.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 3.0, 0.0, 0.0, 10.0, 6.0, 0.0, 13.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 8.0, 11.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 8.0, 6.0, 11.0, 0.0, 0.0, 0.0, 6.0, 0.0, 2.0, 4.0, 2.0, 6.0, 27.0, 29.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9963524892872451, "mean_inference_ms": 3.0364648046804956, "mean_action_processing_ms": 0.4745188153830502, "mean_env_wait_ms": 0.35951143598487784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023298144340515137, "StateBufferConnector_ms": 0.004861593246459961, "ViewRequirementAgentConnector_ms": 0.21391630172729492}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -9.0, "episode_return_mean": 184.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.1357035143054, "num_env_steps_trained_throughput_per_sec": 277.1357035143054, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 14632.418, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14632.311, "sample_time_ms": 2181.908, "learn_time_ms": 12429.573, "learn_throughput": 321.813, "synch_weights_time_ms": 18.406}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "f1691_00002", "date": "2024-08-13_19-40-07", "timestamp": 1723592407, "time_this_iter_s": 14.498117923736572, "time_total_s": 4927.312642812729, "pid": 27268, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b41f8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4927.312642812729, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 63.665000000000006, "ram_util_percent": 77.285}}
